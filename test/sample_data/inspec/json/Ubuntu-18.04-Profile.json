{
    "name": "canonical-ubuntu-18.04-lts-server-cis-baseline",
    "title": "canonical-ubuntu-18.04-lts-server-cis-baseline",
    "maintainer": "MITRE SAF Team",
    "copyright": "MITRE, 2020",
    "copyright_email": null,
    "license": "Apache-2.0",
    "summary": "InSpec Validation Profile for Canonical Ubuntu 18.04 LTS Server CIS",
    "version": "2.0.2",
    "inspec_version": ">= 4.0",
    "supports": [
        {
            "platform-name": "ubuntu",
            "release": "18.04"
        }
    ],
    "inputs": [],
    "controls": [
        {
            "title": "Ensure nodev option set on removable media partitions",
            "desc": "The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.",
            "descriptions": {
                "default": "The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.",
                "rationale": "Removable media containing character and block special\ndevices could be used to circumvent security controls by allowing non-root\nusers to access sensitive device files such as `/dev/kmem` or the raw disk\npartitions.",
                "check": "Run the following command and verify that the `nodev` option is set on all\nremovable media partitions.\n\n    ```\n    # mount\n    ```",
                "fix": "Edit the `/etc/fstab` file and add `nodev` to the fourth field\n(mounting options) of all removable media partitions. Look for entries that\nhave mount points that contain words such as floppy or cdrom. See the\n`fstab(5)` manual page for more information."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.18"
            },
            "code": "control \"C-1.1.18\" do\n  title \"Ensure nodev option set on removable media partitions\"\n  desc  \"The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.\"\n  desc  \"rationale\", \"Removable media containing character and block special\ndevices could be used to circumvent security controls by allowing non-root\nusers to access sensitive device files such as `/dev/kmem` or the raw disk\npartitions.\"\n  desc  \"check\", \"\n    Run the following command and verify that the `nodev` option is set on all\nremovable media partitions.\n\n    ```\n    # mount\n    ```\n  \"\n  desc \"fix\", \"Edit the `/etc/fstab` file and add `nodev` to the fourth field\n(mounting options) of all removable media partitions. Look for entries that\nhave mount points that contain words such as floppy or cdrom. See the\n`fstab(5)` manual page for more information.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.18\"\n\n\n  mounts = command('mount').stdout.strip.split(\"\\n\").\n      map do |d|\n    split_mounts = d.split(%r{\\s+})\n    options = split_mounts[-1].match(%r{\\((.*)\\)$}).captures.first.split(',')\n    dev_file = file(split_mounts[0])\n    dev_link = dev_file.symlink? ? dev_file.link_path : dev_file.path\n    {'dev'=>split_mounts[0], 'link'=>dev_link, 'mount'=>split_mounts[2], 'options'=>options}\n  end\n\n  dev_mounts = mounts.\n      select { |mnt| mnt['dev'].start_with? '/' and !mnt['dev'].start_with? '//' }.\n      map do |mnt|\n    # https://unix.stackexchange.com/a/308724\n    partition = ['/sys/class/block', String(mnt['link']).sub(%r{^/dev/}, ''), 'partition'].join('/')\n    if file(partition).exist?\n      # root_dev = command('basename \"$(readlink -f \"/sys/class/block/sda1/..\")\"').stdout.strip\n      root_dev = mount('/').device()\n    else\n      mnt['root_dev'] = mnt['link']\n    end\n    mnt\n  end\n\n  removable_mounts = dev_mounts.select do |mnt|\n    removable = ['/sys/block', String(mnt['root_dev']).sub(%r{^/dev/}, ''), 'removable'].join('/')\n    #file(removable).content.strip == '1'\n    file(removable).file.stat.length > 0\n  end\n\n  if removable_mounts.empty?\n    describe \"Removable mounted devices\" do\n      subject { removable_mounts }\n      it { should be_empty }\n    end\n  else\n    removable_mounts.each do |mnt|\n      # describe \"Mount #{mnt['mount']} options\" do\n      #   subject { mnt['options'] }\n      #   it { should include 'nodev' }\n      # end\n      describe mount(mnt) do\n        it { should be_mounted }\n        its('options') { should include 'nosuid' }\n      end\n    end\n  end\n\n  # /bin/mount | /bin/grep -P 'on[\\\\s]+/dev/(floppy|cdrom|corder|mmcblk)'\"\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.18.rb",
                "line": 3
            },
            "id": "C-1.1.18"
        },
        {
            "title": "Ensure root login is restricted to system console",
            "desc": "The file `/etc/securetty` contains a list of valid terminals that may\nbe logged in directly as root.",
            "descriptions": {
                "default": "The file `/etc/securetty` contains a list of valid terminals that may\nbe logged in directly as root.",
                "rationale": "Since the system console has special properties to handle\nemergency situations, it is important to ensure that the console is in a\nphysically secure location and that unauthorized consoles have not been\ndefined.",
                "check": "```\n# cat /etc/securetty\n```",
                "fix": "Remove entries for any consoles that are not in a physically\nsecure location."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-6 (9)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.3"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "5.5"
            },
            "code": "control \"C-5.5\" do\n  title \"Ensure root login is restricted to system console\"\n  desc  \"The file `/etc/securetty` contains a list of valid terminals that may\nbe logged in directly as root.\"\n  desc  \"rationale\", \"Since the system console has special properties to handle\nemergency situations, it is important to ensure that the console is in a\nphysically secure location and that unauthorized consoles have not been\ndefined.\"\n  desc  \"check\", \"\n    ```\n    # cat /etc/securetty\n    ```\n  \"\n  desc \"fix\", \"Remove entries for any consoles that are not in a physically\nsecure location.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-6 (9)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.3\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"5.5\"\n\n  path = '/etc/securetty'\n  describe file(path) do\n    skip(\"This control must be reviewed manually. Inspect the contents of #{path}.\")\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.5.rb",
                "line": 3
            },
            "id": "C-5.5"
        },
        {
            "title": "Ensure secure ICMP redirects are not accepted",
            "desc": "Secure ICMP redirects are the same as ICMP redirects, except they come\nfrom gateways listed on the default gateway list. It is assumed that these\ngateways are known to your system, and that they are likely to be secure.",
            "descriptions": {
                "default": "Secure ICMP redirects are the same as ICMP redirects, except they come\nfrom gateways listed on the default gateway list. It is assumed that these\ngateways are known to your system, and that they are likely to be secure.",
                "rationale": "It is still possible for even known gateways to be\ncompromised. Setting `net.ipv4.conf.all.secure_redirects` to 0 protects the\nsystem from routing table updates by possibly compromised known gateways.",
                "check": "Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.secure_redirects\n\n    net.ipv4.conf.all.secure_redirects = 0\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.secure_redirects\n\n    net.ipv4.conf.default.secure_redirects = 0\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.all\\.secure_redirects\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.secure_redirects= 0\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.default\\.secure_redirects\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.default.secure_redirects= 0\n    ```",
                "fix": "Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.secure_redirects = 0\n    net.ipv4.conf.default.secure_redirects = 0\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.conf.all.secure_redirects=0\n    # sysctl -w net.ipv4.conf.default.secure_redirects=0\n    # sysctl -w net.ipv4.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.2.3"
            },
            "code": "control \"C-3.2.3\" do\n  title \"Ensure secure ICMP redirects are not accepted\"\n  desc  \"Secure ICMP redirects are the same as ICMP redirects, except they come\nfrom gateways listed on the default gateway list. It is assumed that these\ngateways are known to your system, and that they are likely to be secure.\"\n  desc  \"rationale\", \"It is still possible for even known gateways to be\ncompromised. Setting `net.ipv4.conf.all.secure_redirects` to 0 protects the\nsystem from routing table updates by possibly compromised known gateways.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.secure_redirects\n\n    net.ipv4.conf.all.secure_redirects = 0\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.secure_redirects\n\n    net.ipv4.conf.default.secure_redirects = 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.all\\\\.secure_redirects\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.secure_redirects= 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.default\\\\.secure_redirects\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.default.secure_redirects= 0\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.secure_redirects = 0\n    net.ipv4.conf.default.secure_redirects = 0\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.conf.all.secure_redirects=0\n    # sysctl -w net.ipv4.conf.default.secure_redirects=0\n    # sysctl -w net.ipv4.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.2.3\"\n\n  describe kernel_parameter('net.ipv4.conf.all.secure_redirects') do\n    its('value') { should cmp '0' }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.secure_redirects') do\n    its('value') { should cmp '0' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.2.3.rb",
                "line": 3
            },
            "id": "C-3.2.3"
        },
        {
            "title": "Ensure GPG keys are configured",
            "desc": "Most packages managers implement GPG key signing to verify package\nintegrity during installation.",
            "descriptions": {
                "default": "Most packages managers implement GPG key signing to verify package\nintegrity during installation.",
                "rationale": "It is important to ensure that updates are obtained from\na valid source to protect against spoofing that could lead to the inadvertent\ninstallation of malware on the system.",
                "check": "Verify GPG keys are configured correctly for your package manager:\n\n    ```\n    # apt-key list\n    ```\nExample.\n apt-key list\n/etc/apt/trusted.gpg.d/ubuntu-keyring-2012-archive.gpg\n------------------------------------------------------\npub   rsa4096 2012-05-11 [SC]\n      790B C727 7767 219C 42C8  6F93 3B4F E6AC C0B2 1F32\nuid           [ unknown] Ubuntu Archive Automatic Signing Key (2012) <ftpmaster@ubuntu.com>\n\n/etc/apt/trusted.gpg.d/ubuntu-keyring-2012-cdimage.gpg\n------------------------------------------------------\npub   rsa4096 2012-05-11 [SC]\n      8439 38DF 228D 22F7 B374  2BC0 D94A A3F0 EFE2 1092\nuid           [ unknown] Ubuntu CD Image Automatic Signing Key (2012) <cdimage@ubuntu.com>\n\n/etc/apt/trusted.gpg.d/ubuntu-keyring-2018-archive.gpg\n------------------------------------------------------\npub   rsa4096 2018-09-17 [SC]\n      F6EC B376 2474 EDA9 D21B  7022 8719 20D1 991B C93C\nuid           [ unknown] Ubuntu Archive Automatic Signing Key (2018) <ftpmaster@ubuntu.com>",
                "fix": "Update your package manager GPG keys in accordance with site\npolicy."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SI-2",
                    "SI-2",
                    "SI-7",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "3.4",
                    "3.5",
                    "4.5",
                    "Rev_7"
                ],
                "cis_rid": "1.2.2"
            },
            "code": "control \"C-1.2.2\" do\n  title \"Ensure GPG keys are configured\"\n  desc  \"Most packages managers implement GPG key signing to verify package\nintegrity during installation.\"\n  desc  \"rationale\", \"It is important to ensure that updates are obtained from\na valid source to protect against spoofing that could lead to the inadvertent\ninstallation of malware on the system.\"\n  desc  \"check\", \"\n    Verify GPG keys are configured correctly for your package manager:\n\n    ```\n    # apt-key list\n    ```\nExample.\n apt-key list\n/etc/apt/trusted.gpg.d/ubuntu-keyring-2012-archive.gpg\n------------------------------------------------------\npub   rsa4096 2012-05-11 [SC]\n      790B C727 7767 219C 42C8  6F93 3B4F E6AC C0B2 1F32\nuid           [ unknown] Ubuntu Archive Automatic Signing Key (2012) <ftpmaster@ubuntu.com>\n\n/etc/apt/trusted.gpg.d/ubuntu-keyring-2012-cdimage.gpg\n------------------------------------------------------\npub   rsa4096 2012-05-11 [SC]\n      8439 38DF 228D 22F7 B374  2BC0 D94A A3F0 EFE2 1092\nuid           [ unknown] Ubuntu CD Image Automatic Signing Key (2012) <cdimage@ubuntu.com>\n\n/etc/apt/trusted.gpg.d/ubuntu-keyring-2018-archive.gpg\n------------------------------------------------------\npub   rsa4096 2018-09-17 [SC]\n      F6EC B376 2474 EDA9 D21B  7022 8719 20D1 991B C93C\nuid           [ unknown] Ubuntu Archive Automatic Signing Key (2018) <ftpmaster@ubuntu.com>\n\n  \"\n  desc \"fix\", \"Update your package manager GPG keys in accordance with site\npolicy.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SI-2\", \"SI-2\", \"SI-7\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"3.4\", \"3.5\", \"4.5\", \"Rev_7\"]\n  tag cis_rid: \"1.2.2\"\n\n  describe command('apt-key list').stdout.strip.split(\"\\n\") do\n    its('length') { should be > 1 }\n    skip \"Run the following command and verify GPG keys are configured correctly for your package manager -\n ```apt-cache policy```.\"\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.2.2.rb",
                "line": 3
            },
            "id": "C-1.2.2"
        },
        {
            "title": "Ensure permissions on /etc/gshadow- are configured",
            "desc": "The `/etc/gshadow-` file is used to store backup information about\ngroups that is critical to the security of those accounts, such as the hashed\npassword and other security information.",
            "descriptions": {
                "default": "The `/etc/gshadow-` file is used to store backup information about\ngroups that is critical to the security of those accounts, such as the hashed\npassword and other security information.",
                "rationale": "It is critical to ensure that the `/etc/gshadow-` file is\nprotected from unauthorized access. Although it is protected by default, the\nfile permissions could be changed either inadvertently or through malicious\nactions.",
                "check": "Run the following command and verify verify `Uid` is `0/root,` `Gid` is\n`0/root` or `/shadow,` and `Access` is `640` or more restrictive:\n    ```\n    # stat /etc/gshadow-\n\n    Access: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the one of the following chown commands as appropriate and the chmod to\nset permissions on `/etc/gshadow-` :\n\n    ```\n    # chown root:root /etc/gshadow-\n    ```\n\n    **OR**\n\n    ```\n    # chown root:shadow /etc/gshadow-\n    ```\n\n    ```\n    # chmod g-wx,o-rwx /etc/gshadow-\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-28"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.3"
            },
            "code": "control \"C-6.1.3\" do\n  title \"Ensure permissions on /etc/gshadow- are configured\"\n  desc  \"The `/etc/gshadow-` file is used to store backup information about\ngroups that is critical to the security of those accounts, such as the hashed\npassword and other security information.\"\n  desc  \"rationale\", \"It is critical to ensure that the `/etc/gshadow-` file is\nprotected from unauthorized access. Although it is protected by default, the\nfile permissions could be changed either inadvertently or through malicious\nactions.\"\n  desc  \"check\", \"\n    Run the following command and verify verify `Uid` is `0/root,` `Gid` is\n`0/root` or `/shadow,` and `Access` is `640` or more restrictive:\n    ```\n    # stat /etc/gshadow-\n\n    Access: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the one of the following chown commands as appropriate and the chmod to\nset permissions on `/etc/gshadow-` :\n\n    ```\n    # chown root:root /etc/gshadow-\n    ```\n\n    **OR**\n\n    ```\n    # chown root:shadow /etc/gshadow-\n    ```\n\n    ```\n    # chmod g-wx,o-rwx /etc/gshadow-\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-28\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.3\"\n\n  describe file('/etc/gshadow-') do\n    it { should_not be_more_permissive_than('0640') }\n    it { should be_owned_by 'root' }\n    its('group') { should be_in ['root', 'shadow'] }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.3.rb",
                "line": 3
            },
            "id": "C-6.1.3"
        },
        {
            "title": "Ensure SSH PAM is enabled",
            "desc": "UsePAM Enables the Pluggable Authentication Module interface. If set\nto “yes” this will enable PAM authentication using\nChallengeResponseAuthentication and PasswordAuthentication in addition to PAM\naccount and session module processing for all authentication types",
            "descriptions": {
                "default": "UsePAM Enables the Pluggable Authentication Module interface. If set\nto “yes” this will enable PAM authentication using\nChallengeResponseAuthentication and PasswordAuthentication in addition to PAM\naccount and session module processing for all authentication types",
                "rationale": "When usePAM is set to yes, PAM runs through account and\nsession types properly. This is important if you want to restrict access to\nservices based off of IP, time or other factors of the account. Additionally,\nyou can make sure users inherit certain environment variables on login or\ndisallow access to the server",
                "check": "Run the following command and verify that output matches:\n\n```\n# sshd -T | grep -i usepam\n\nusepam yes\n```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nUsePAM yes\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_rid": "5.2.20",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.20\" do\n  title \"Ensure SSH PAM is enabled\"\n  desc  \"UsePAM Enables the Pluggable Authentication Module interface. If set\nto “yes” this will enable PAM authentication using\nChallengeResponseAuthentication and PasswordAuthentication in addition to PAM\naccount and session module processing for all authentication types\"\n  desc  \"rationale\", \"When usePAM is set to yes, PAM runs through account and\nsession types properly. This is important if you want to restrict access to\nservices based off of IP, time or other factors of the account. Additionally,\nyou can make sure users inherit certain environment variables on login or\ndisallow access to the server\"\n  desc  \"check\", \"\n    Run the following command and verify that output matches:\n\n    ```\n    # sshd -T | grep -i usepam\n\n    usepam yes\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    UsePAM yes\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_rid: \"5.2.20\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('UsePAM') { should cmp 'yes' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.20.rb",
                "line": 3
            },
            "id": "C-5.2.20"
        },
        {
            "title": "Ensure no legacy \"+\" entries exist in /etc/shadow",
            "desc": "The character + in various files used to be markers for systems to\ninsert data from NIS maps at a certain point in a system configuration file.\nThese entries are no longer required on most systems, but may exist in files\nthat have been imported from other platforms.",
            "descriptions": {
                "default": "The character + in various files used to be markers for systems to\ninsert data from NIS maps at a certain point in a system configuration file.\nThese entries are no longer required on most systems, but may exist in files\nthat have been imported from other platforms.",
                "rationale": "These entries may provide an avenue for attackers to gain\nprivileged access on the system.",
                "check": "Run the following command and verify that no output is returned:\n```\n# grep '^\\+:' /etc/shadow\n```",
                "fix": "Remove any legacy '+' entries from `/etc/shadow` if they exist."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-2",
                    "AC-2"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.9",
                    "16.2"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.4"
            },
            "code": "control \"C-6.2.4\" do\n  title \"Ensure no legacy \\\"+\\\" entries exist in /etc/shadow\"\n  desc  \"The character + in various files used to be markers for systems to\ninsert data from NIS maps at a certain point in a system configuration file.\nThese entries are no longer required on most systems, but may exist in files\nthat have been imported from other platforms.\"\n  desc  \"rationale\", \"These entries may provide an avenue for attackers to gain\nprivileged access on the system.\"\n  desc  \"check\", \"\n    Run the following command and verify that no output is returned:\n    ```\n    # grep '^\\\\+:' /etc/shadow\n    ```\n  \"\n  desc \"fix\", \"Remove any legacy '+' entries from `/etc/shadow` if they exist.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-2\", \"AC-2\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.9\", \"16.2\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.4\"\n\n  describe command(\"grep '^\\\\+:' /etc/shadow\").stdout.strip do\n    it { should be_empty }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.4.rb",
                "line": 3
            },
            "id": "C-6.2.4"
        },
        {
            "title": "Ensure noexec option set on /tmp partition",
            "desc": "The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.",
            "descriptions": {
                "default": "The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.",
                "rationale": "Since the `/tmp` filesystem is only intended for\ntemporary file storage, set this option to ensure that users cannot run\nexecutable binaries from `/tmp` .",
                "check": "Verify that the `noexec` option is set if a `/tmp` partition exists\n\nRun the following command and verify that nothing is returned:\n\n```\n# mount | grep -E '\\s/tmp\\s' | grep -v noexec\n```",
                "fix": "Edit the `/etc/fstab` file and add `noexec` to the fourth field (mounting\noptions) for the `/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/tmp` :\n    ```\n    # mount -o remount,noexec /tmp\n    ```\n\n    or\n\n    Edit `/etc/systemd/system/local-fs.target.wants/tmp.mount` to add `noexec`\nto the `/tmp` mount options:\n    ```\n    [Mount]\n    Options=mode=1777,strictatime,noexec,nodev,nosuid\n    ```\n    Run the following command to remount `/tmp` :\n    ```\n    # mount -o remount,noexec /tmp\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-2 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "2.6",
                    "Rev_7"
                ],
                "cis_rid": "1.1.5"
            },
            "code": "control \"C-1.1.5\" do\n  title \"Ensure noexec option set on /tmp partition\"\n  desc  \"The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.\"\n  desc  \"rationale\", \"Since the `/tmp` filesystem is only intended for\ntemporary file storage, set this option to ensure that users cannot run\nexecutable binaries from `/tmp` .\"\n  desc  \"check\", \"\n    Verify that the `noexec` option is set if a `/tmp` partition exists\n\n    Run the following command and verify that nothing is returned:\n\n    ```\n    # mount | grep -E '\\\\s/tmp\\\\s' | grep -v noexec\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/fstab` file and add `noexec` to the fourth field (mounting\noptions) for the `/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/tmp` :\n    ```\n    # mount -o remount,noexec /tmp\n    ```\n\n    or\n\n    Edit `/etc/systemd/system/local-fs.target.wants/tmp.mount` to add `noexec`\nto the `/tmp` mount options:\n    ```\n    [Mount]\n    Options=mode=1777,strictatime,noexec,nodev,nosuid\n    ```\n    Run the following command to remount `/tmp` :\n    ```\n    # mount -o remount,noexec /tmp\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-2 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"2.6\", \"Rev_7\"]\n  tag cis_rid: \"1.1.5\"\n\n  describe mount('/tmp') do\n    its('options') { should include 'noexec' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.5.rb",
                "line": 3
            },
            "id": "C-1.1.5"
        },
        {
            "title": "Ensure only strong MAC algorithms are used",
            "desc": "This variable limits the types of MAC algorithms that SSH can use\nduring communication.",
            "descriptions": {
                "default": "This variable limits the types of MAC algorithms that SSH can use\nduring communication.",
                "rationale": "MD5 and 96-bit MAC algorithms are considered weak and\nhave been shown to increase exploitability in SSH downgrade attacks. Weak\nalgorithms continue to have a great deal of attention as a weak spot that can\nbe exploited with expanded computing power. An attacker that breaks the\nalgorithm could take advantage of a MiTM position to decrypt the SSH tunnel and\ncapture credentials and information",
                "check": "Run the following command and verify that output does not contain any of\nthe listed weak MAC algorithms:\n\n    ```\n    # sshd -T | grep -i \"MACs\"\n    ```\n\n    Weak MAC algorithms:\n\n    ```\n    hmac-md5\n    hmac-md5-96\n    hmac-ripemd160\n    hmac-sha1\n    hmac-sha1-96\n    umac-64@openssh.com\n    umac-128@openssh.com\n    hmac-md5-etm@openssh.com\n    hmac-md5-96-etm@openssh.com\n    hmac-ripemd160-etm@openssh.com\n    hmac-sha1-etm@openssh.com\n    hmac-sha1-96-etm@openssh.com\n    umac-64-etm@openssh.com\n    umac-128-etm@openssh.com\n    ```",
                "fix": "Edit the `/etc/ssh/sshd_config` file and add/modify the MACs line to\ncontain a comma separated list of the site approved MACs\n\n    Example:\n\n    ```\n    MACs\nhmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-8",
                    "SC-8"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.4",
                    "16.5"
                ],
                "cis_rid": "5.2.14",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.14\" do\n  title \"Ensure only strong MAC algorithms are used\"\n  desc  \"This variable limits the types of MAC algorithms that SSH can use\nduring communication.\"\n  desc  \"rationale\", \"MD5 and 96-bit MAC algorithms are considered weak and\nhave been shown to increase exploitability in SSH downgrade attacks. Weak\nalgorithms continue to have a great deal of attention as a weak spot that can\nbe exploited with expanded computing power. An attacker that breaks the\nalgorithm could take advantage of a MiTM position to decrypt the SSH tunnel and\ncapture credentials and information\"\n  desc  \"check\", \"\n    Run the following command and verify that output does not contain any of\nthe listed weak MAC algorithms:\n\n    ```\n    # sshd -T | grep -i \\\"MACs\\\"\n    ```\n\n    Weak MAC algorithms:\n\n    ```\n    hmac-md5\n    hmac-md5-96\n    hmac-ripemd160\n    hmac-sha1\n    hmac-sha1-96\n    umac-64@openssh.com\n    umac-128@openssh.com\n    hmac-md5-etm@openssh.com\n    hmac-md5-96-etm@openssh.com\n    hmac-ripemd160-etm@openssh.com\n    hmac-sha1-etm@openssh.com\n    hmac-sha1-96-etm@openssh.com\n    umac-64-etm@openssh.com\n    umac-128-etm@openssh.com\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file and add/modify the MACs line to\ncontain a comma separated list of the site approved MACs\n\n    Example:\n\n    ```\n    MACs\nhmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-8\", \"SC-8\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.4\", \"16.5\"]\n  tag cis_rid: \"5.2.14\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  cfg = sshd_config\n  describe cfg do\n    describe 'it should have defined MACs' do\n      subject { cfg.MACs }\n      it { should_not be_empty }\n    end\n    its('MACs') { should_not include(\n      'hmac-md5', \n      'hmac-md5-96', \n      'hmac-ripemd160', \n      'hmac-sha1', \n      'hmac-sha1-96', \n      'umac-64@openssh.com', \n      'umac-128@openssh.com', \n      'hmac-md5-etm@openssh.com', \n      'hmac-md5-96-etm@openssh.com', \n      'hmac-ripemd160-etm@openssh.com', \n      'hmac-sha1-etm@openssh.com', \n      'hmac-sha1-96-etm@openssh.com', \n      'umac-64-etm@openssh.com', \n      'umac-128-etm@openssh.com') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.14.rb",
                "line": 3
            },
            "id": "C-5.2.14"
        },
        {
            "title": "Ensure logging is configured",
            "desc": "The `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf` files specifies\nrules for logging and which files are to be used to log certain classes of\nmessages.",
            "descriptions": {
                "default": "The `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf` files specifies\nrules for logging and which files are to be used to log certain classes of\nmessages.",
                "rationale": "A great deal of important security-related information is\nsent via `rsyslog` (e.g., successful and failed su attempts, failed login\nattempts, root login attempts, etc.).",
                "check": "Review the contents of the `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf`\nfiles to ensure appropriate logging is set. In addition, run the following\ncommand and verify that the log files are logging information:\n\n    ```\n    # ls -l /var/log/\n    ```",
                "fix": "Edit the following lines in the `/etc/rsyslog.conf` and\n`/etc/rsyslog.d/*.conf` files as appropriate for your environment:\n\n    ```\n    *.emerg :omusrmsg:*\n    auth,authpriv.* /var/log/auth.log\n    mail.* -/var/log/mail\n    mail.info -/var/log/mail.info\n    mail.warning -/var/log/mail.warn\n    mail.err /var/log/mail.err\n    news.crit -/var/log/news/news.crit\n    news.err -/var/log/news/news.err\n    news.notice -/var/log/news/news.notice\n    *.=warning;*.=err -/var/log/warn\n    *.crit /var/log/warn\n    *.*;mail.none;news.none -/var/log/messages\n    local0,local1.* -/var/log/localmessages\n    local2,local3.* -/var/log/localmessages\n    local4,local5.* -/var/log/localmessages\n    local6,local7.* -/var/log/localmessages\n    ```\n\n    Run the following command to reload the `rsyslog` configuration:\n\n    ```\n    # systemctl reload rsyslog\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-12",
                    "AU-3",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.2",
                    "6.3",
                    "Rev_7"
                ],
                "cis_rid": "4.2.1.3"
            },
            "code": "control \"C-4.2.1.3\" do\n  title \"Ensure logging is configured\"\n  desc  \"The `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf` files specifies\nrules for logging and which files are to be used to log certain classes of\nmessages.\"\n  desc  \"rationale\", \"A great deal of important security-related information is\nsent via `rsyslog` (e.g., successful and failed su attempts, failed login\nattempts, root login attempts, etc.).\"\n  desc  \"check\", \"\n    Review the contents of the `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf`\nfiles to ensure appropriate logging is set. In addition, run the following\ncommand and verify that the log files are logging information:\n\n    ```\n    # ls -l /var/log/\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the following lines in the `/etc/rsyslog.conf` and\n`/etc/rsyslog.d/*.conf` files as appropriate for your environment:\n\n    ```\n    *.emerg :omusrmsg:*\n    auth,authpriv.* /var/log/auth.log\n    mail.* -/var/log/mail\n    mail.info -/var/log/mail.info\n    mail.warning -/var/log/mail.warn\n    mail.err /var/log/mail.err\n    news.crit -/var/log/news/news.crit\n    news.err -/var/log/news/news.err\n    news.notice -/var/log/news/news.notice\n    *.=warning;*.=err -/var/log/warn\n    *.crit /var/log/warn\n    *.*;mail.none;news.none -/var/log/messages\n    local0,local1.* -/var/log/localmessages\n    local2,local3.* -/var/log/localmessages\n    local4,local5.* -/var/log/localmessages\n    local6,local7.* -/var/log/localmessages\n    ```\n\n    Run the following command to reload the `rsyslog` configuration:\n\n    ```\n    # systemctl reload rsyslog\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-12\", \"AU-3\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.2\", \"6.3\", \"Rev_7\"]\n  tag cis_rid: \"4.2.1.3\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.2.1.3.rb",
                "line": 3
            },
            "id": "C-4.2.1.3"
        },
        {
            "title": "Ensure default group for the root account is GID 0",
            "desc": "The usermod command can be used to specify which group the root user\nbelongs to. This affects permissions of files that are created by the root\nuser.",
            "descriptions": {
                "default": "The usermod command can be used to specify which group the root user\nbelongs to. This affects permissions of files that are created by the root\nuser.",
                "rationale": "Using GID 0 for the `root` account helps prevent `root`\n-owned files from accidentally becoming accessible to non-privileged users.",
                "check": "Run the following command and verify the result is `0` :\n```\n# grep \"^root:\" /etc/passwd | cut -f4 -d:\n0\n```",
                "fix": "Run the following command to set the `root` user default group to GID `0` :\n```\n# usermod -g 0 root\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-3 (3)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6",
                    "Rev_7"
                ],
                "cis_rid": "5.4.3"
            },
            "code": "control \"C-5.4.3\" do\n  title \"Ensure default group for the root account is GID 0\"\n  desc  \"The usermod command can be used to specify which group the root user\nbelongs to. This affects permissions of files that are created by the root\nuser.\"\n  desc  \"rationale\", \"Using GID 0 for the `root` account helps prevent `root`\n-owned files from accidentally becoming accessible to non-privileged users.\"\n  desc  \"check\", \"\n    Run the following command and verify the result is `0` :\n    ```\n    # grep \\\"^root:\\\" /etc/passwd | cut -f4 -d:\n    0\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to set the `root` user default group to GID `0` :\n    ```\n    # usermod -g 0 root\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-3 (3)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\", \"Rev_7\"]\n  tag cis_rid: \"5.4.3\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.4.3.rb",
                "line": 3
            },
            "id": "C-5.4.3"
        },
        {
            "title": "Ensure no world writable files exist",
            "desc": "Unix-based systems support variable settings to control access to\nfiles. World writable files are the least secure. See the `chmod(2)` man page\nfor more information.",
            "descriptions": {
                "default": "Unix-based systems support variable settings to control access to\nfiles. World writable files are the least secure. See the `chmod(2)` man page\nfor more information.",
                "rationale": "Data in world-writable files can be modified and\ncompromised by any user on the system. World writable files may also indicate\nan incorrectly written script or program that could potentially be the cause of\na larger compromise to the system's integrity.",
                "check": "Run the following command and verify no files are returned:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -type f -perm -0002\n    ```\n\n    The command above only searches local filesystems, there may still be\ncompromised items on network mounted partitions. Additionally the `--local`\noption to `df` is not universal to all versions, it can be omitted to search\nall filesystems on a system including network mounted filesystems or the\nfollowing command can be run manually for each partition:\n\n    ```\n    # find\n\n    \t -xdev -type f -perm -0002\n    ```",
                "fix": "Removing write access for the \"other\" category ( `chmod o-w `\n) is advisable, but always consult relevant vendor documentation to avoid\nbreaking any application dependencies on a given file."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.10"
            },
            "code": "control \"C-6.1.10\" do\n  title \"Ensure no world writable files exist\"\n  desc  \"Unix-based systems support variable settings to control access to\nfiles. World writable files are the least secure. See the `chmod(2)` man page\nfor more information.\"\n  desc  \"rationale\", \"Data in world-writable files can be modified and\ncompromised by any user on the system. World writable files may also indicate\nan incorrectly written script or program that could potentially be the cause of\na larger compromise to the system's integrity.\"\n  desc  \"check\", \"\n    Run the following command and verify no files are returned:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -type f -perm -0002\n    ```\n\n    The command above only searches local filesystems, there may still be\ncompromised items on network mounted partitions. Additionally the `--local`\noption to `df` is not universal to all versions, it can be omitted to search\nall filesystems on a system including network mounted filesystems or the\nfollowing command can be run manually for each partition:\n\n    ```\n    # find\n\n    \\t -xdev -type f -perm -0002\n    ```\n  \"\n  desc \"fix\", \"Removing write access for the \\\"other\\\" category ( `chmod o-w `\n) is advisable, but always consult relevant vendor documentation to avoid\nbreaking any application dependencies on a given file.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.10\"\n\n  describe command(\"df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -0002\") do\n    its('stdout') { should be_empty }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.10.rb",
                "line": 3
            },
            "id": "C-6.1.10"
        },
        {
            "title": "Ensure sudo log file exists",
            "desc": "sudo can use a custom log file",
            "descriptions": {
                "default": "sudo can use a custom log file",
                "rationale": "A sudo log file simplifies auditing of sudo commands",
                "check": "Verify that sudo has a custom log file configured\n\nRun the following command:\n\n```\n# grep -Ei '^\\s*Defaults\\s+logfile=\\S+' /etc/sudoers /etc/sudoers.d/*\n```\n\nverify output includes\n\n```\nDefaults logfile=\"\n\n```\n\nWhere `\n\n\t` Is a file location that conforms with local site policy",
                "fix": "edit the file `/etc/sudoers` or a file in `/etc/sudoers.d/` and add the\nfollowing line:\n\n    ```\n    Defaults logfile=\"\n\n    \t\"\n    ```\n\n    **Example**\n\n    ```\n    Defaults logfile=\"/var/log/sudo.log\"\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-3",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.3",
                    "Rev_7"
                ],
                "cis_rid": "1.3.3"
            },
            "code": "control \"C-1.3.3\" do\n  title \"Ensure sudo log file exists\"\n  desc  \"sudo can use a custom log file\"\n  desc  \"rationale\", \"A sudo log file simplifies auditing of sudo commands\"\n  desc  \"check\", \"\n    Verify that sudo has a custom log file configured\n\n    Run the following command:\n\n    ```\n    # grep -Ei '^\\\\s*Defaults\\\\s+logfile=\\\\S+' /etc/sudoers /etc/sudoers.d/*\n    ```\n\n    verify output includes\n\n    ```\n    Defaults logfile=\\\"\n\n    ```\n\n    Where `\n\n    \\t` Is a file location that conforms with local site policy\n  \"\n  desc \"fix\", \"\n    edit the file `/etc/sudoers` or a file in `/etc/sudoers.d/` and add the\nfollowing line:\n\n    ```\n    Defaults logfile=\\\"\n\n    \\t\\\"\n    ```\n\n    **Example**\n\n    ```\n    Defaults logfile=\\\"/var/log/sudo.log\\\"\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-3\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.3\", \"Rev_7\"]\n  tag cis_rid: \"1.3.3\"\n\n\n  describe command(\"grep -Ei '^\\\\s*Defaults\\\\s+([^#]+,\\\\s*)?logfile=(,\\\\s+\\\\S+\\\\s*)*(\\\\s+#.*)?' /etc/sudoers /etc/sudoers.d/*\").stdout.strip.split(\"\\n\") do\n    its('length') { should be > 0 }\n  end\n\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.3.3.rb",
                "line": 3
            },
            "id": "C-1.3.3"
        },
        {
            "title": "Ensure /etc/hosts.allow is configured",
            "desc": "The `/etc/hosts.allow` file specifies which IP addresses are permitted\nto connect to the host. It is intended to be used in conjunction with the\n`/etc/hosts.deny` file.",
            "descriptions": {
                "default": "The `/etc/hosts.allow` file specifies which IP addresses are permitted\nto connect to the host. It is intended to be used in conjunction with the\n`/etc/hosts.deny` file.",
                "rationale": "The `/etc/hosts.allow` file supports access control by IP\nand helps ensure that only authorized systems can connect to the system.",
                "check": "Run the following command and verify the contents of the `/etc/hosts.allow`\nfile:\n\n    ```\n    # cat /etc/hosts.allow\n    ```",
                "fix": "Run the following command to create `/etc/hosts.allow`:\n\n    ```\n    # echo \"ALL: /, /, ...\" >/etc/hosts.allow\n    ```\n    where each `/` combination (for example, \"192.168.1.0/255.255.255.0\")\nrepresents one network block in use by your organization that requires access\nto this system."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.3.2"
            },
            "code": "control \"C-3.3.2\" do\n  title \"Ensure /etc/hosts.allow is configured\"\n  desc  \"The `/etc/hosts.allow` file specifies which IP addresses are permitted\nto connect to the host. It is intended to be used in conjunction with the\n`/etc/hosts.deny` file.\"\n  desc  \"rationale\", \"The `/etc/hosts.allow` file supports access control by IP\nand helps ensure that only authorized systems can connect to the system.\"\n  desc  \"check\", \"\n    Run the following command and verify the contents of the `/etc/hosts.allow`\nfile:\n\n    ```\n    # cat /etc/hosts.allow\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to create `/etc/hosts.allow`:\n\n    ```\n    # echo \\\"ALL: /, /, ...\\\" >/etc/hosts.allow\n    ```\n    where each `/` combination (for example, \\\"192.168.1.0/255.255.255.0\\\")\nrepresents one network block in use by your organization that requires access\nto this system.\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.3.2\"\n\n  if file('/etc/hosts.allow').exist?\n    my_hosts_allow = command('cat /etc/hosts.allow').stdout.strip\n    describe \"Contents of /etc/hosts.allow shall be evaluated manually \" do\n      skip \" Contents of /etc/hosts.allow shall be evaluated manually.\\n #{my_hosts_allow} \"\n    end\n  else\n    describe file('/etc/hosts.allow') do\n      it { should exist }\n    end\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.3.2.rb",
                "line": 1
            },
            "id": "C-3.3.2"
        },
        {
            "title": "Ensure mounting of FAT filesystems is limited",
            "desc": "The `FAT` filesystem format is primarily used on older windows systems\nand portable USB drives or flash modules. It comes in three types `FAT12` ,\n`FAT16` , and `FAT32` all of which are supported by the `vfat` kernel module.",
            "descriptions": {
                "default": "The `FAT` filesystem format is primarily used on older windows systems\nand portable USB drives or flash modules. It comes in three types `FAT12` ,\n`FAT16` , and `FAT32` all of which are supported by the `vfat` kernel module.",
                "rationale": "Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.",
                "check": "If utilizing UEFI the `FAT` filesystem format is required. If this case,\nensure that the `FAT` filesystem is only used where appropriate\n\n    Run the following command\n\n    ```\n    grep -E -i '\\svfat\\s' /etc/fstab\n    ```\n\n    And review that any output is appropriate for your environment\n\n    If not utilizing UEFI\n\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe --showconfig | grep vfat\n\n    install vfat /bin/true\n    ```\n\n    ```\n    # lsmod | grep vfat\n\n    ```",
                "fix": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\n\nExample: `vi /etc/modprobe.d/vfat.conf`\n\n```\ninstall vfat /bin/true\n```\n\nRun the following command to unload the `vfat` module:\n\n```\n# rmmod vfat\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.1.8"
            },
            "code": "control \"C-1.1.1.8\" do\n  title \"Ensure mounting of FAT filesystems is limited\"\n  desc  \"The `FAT` filesystem format is primarily used on older windows systems\nand portable USB drives or flash modules. It comes in three types `FAT12` ,\n`FAT16` , and `FAT32` all of which are supported by the `vfat` kernel module.\"\n  desc  \"rationale\", \"Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.\"\n  desc  \"check\", \"\n    If utilizing UEFI the `FAT` filesystem format is required. If this case,\nensure that the `FAT` filesystem is only used where appropriate\n\n    Run the following command\n\n    ```\n    grep -E -i '\\\\svfat\\\\s' /etc/fstab\n    ```\n\n    And review that any output is appropriate for your environment\n\n    If not utilizing UEFI\n\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe --showconfig | grep vfat\n\n    install vfat /bin/true\n    ```\n\n    ```\n    # lsmod | grep vfat\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/vfat.conf`\n\n    ```\n    install vfat /bin/true\n    ```\n\n    Run the following command to unload the `vfat` module:\n\n    ```\n    # rmmod vfat\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.1.8\"\n\n  describe kernel_module('vfat') do\n    it { should_not be_loaded }\n    it { should be_disabled }\n    it { should be_blacklisted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.1.8.rb",
                "line": 3
            },
            "id": "C-1.1.1.8"
        },
        {
            "title": "Ensure Reverse Path Filtering is enabled",
            "desc": "Setting `net.ipv4.conf.all.rp_filter` and\n`net.ipv4.conf.default.rp_filter` to 1 forces the Linux kernel to utilize\nreverse path filtering on a received packet to determine if the packet was\nvalid. Essentially, with reverse path filtering, if the return packet does not\ngo out the same interface that the corresponding source packet came from, the\npacket is dropped (and logged if `log_martians` is set).",
            "descriptions": {
                "default": "Setting `net.ipv4.conf.all.rp_filter` and\n`net.ipv4.conf.default.rp_filter` to 1 forces the Linux kernel to utilize\nreverse path filtering on a received packet to determine if the packet was\nvalid. Essentially, with reverse path filtering, if the return packet does not\ngo out the same interface that the corresponding source packet came from, the\npacket is dropped (and logged if `log_martians` is set).",
                "rationale": "Setting these flags is a good way to deter attackers from\nsending your system bogus packets that cannot be responded to. One instance\nwhere this feature breaks down is if asymmetrical routing is employed. This\nwould occur when using dynamic routing protocols (bgp, ospf, etc) on your\nsystem. If you are using asymmetrical routing on your system, you will not be\nable to enable this feature without breaking the routing.",
                "check": "Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.rp_filter\n\n    net.ipv4.conf.all.rp_filter = 1\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.rp_filter\n\n    net.ipv4.conf.default.rp_filter = 1\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.all\\.rp_filter\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.rp_filter = 1\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.default\\.rp_filter\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.default.rp_filter = 1\n    ```",
                "fix": "Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.rp_filter = 1\n    net.ipv4.conf.default.rp_filter = 1\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.conf.all.rp_filter=1\n    ```\n\n    ```\n    # sysctl -w net.ipv4.conf.default.rp_filter=1\n    ```\n\n    ```\n    # sysctl -w net.ipv4.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.2.7"
            },
            "code": "control \"C-3.2.7\" do\n  title \"Ensure Reverse Path Filtering is enabled\"\n  desc  \"Setting `net.ipv4.conf.all.rp_filter` and\n`net.ipv4.conf.default.rp_filter` to 1 forces the Linux kernel to utilize\nreverse path filtering on a received packet to determine if the packet was\nvalid. Essentially, with reverse path filtering, if the return packet does not\ngo out the same interface that the corresponding source packet came from, the\npacket is dropped (and logged if `log_martians` is set).\"\n  desc  \"rationale\", \"Setting these flags is a good way to deter attackers from\nsending your system bogus packets that cannot be responded to. One instance\nwhere this feature breaks down is if asymmetrical routing is employed. This\nwould occur when using dynamic routing protocols (bgp, ospf, etc) on your\nsystem. If you are using asymmetrical routing on your system, you will not be\nable to enable this feature without breaking the routing.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.rp_filter\n\n    net.ipv4.conf.all.rp_filter = 1\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.rp_filter\n\n    net.ipv4.conf.default.rp_filter = 1\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.all\\\\.rp_filter\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.rp_filter = 1\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.default\\\\.rp_filter\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.default.rp_filter = 1\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.rp_filter = 1\n    net.ipv4.conf.default.rp_filter = 1\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.conf.all.rp_filter=1\n    ```\n\n    ```\n    # sysctl -w net.ipv4.conf.default.rp_filter=1\n    ```\n\n    ```\n    # sysctl -w net.ipv4.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.2.7\"\n\n  describe kernel_parameter('net.ipv4.conf.all.rp_filter') do\n    its('value') { should cmp '1' }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.rp_filter') do\n    its('value') { should cmp '1' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.2.7.rb",
                "line": 3
            },
            "id": "C-3.2.7"
        },
        {
            "title": "Ensure events that modify the system's Mandatory Access Controls are\ncollected",
            "desc": "Monitor AppArmor mandatory access controls. The parameters below\nmonitor any write access (potential additional, deletion or modification of\nfiles in the directory) or attribute changes to `/etc/apparmor` and\n`/etc/apparmor.d` directories.",
            "descriptions": {
                "default": "Monitor AppArmor mandatory access controls. The parameters below\nmonitor any write access (potential additional, deletion or modification of\nfiles in the directory) or attribute changes to `/etc/apparmor` and\n`/etc/apparmor.d` directories.",
                "rationale": "Changes to files in these directories could indicate that\nan unauthorized user is attempting to modify access controls and change\nsecurity contexts, leading to a compromise of the system.",
                "check": "run the following commands:\n\n```\n# grep MAC-policy /etc/audit/rules.d/*.rules\n```\n\nVerify output matches:\n\n```\n-w /etc/apparmor/ -p wa -k MAC-policy\n-w /etc/apparmor.d/ -p wa -k MAC-policy\n```\n\n```\n# auditctl -l | grep MAC-policy\n```\n\nVerify output matches:\n\n```\n-w /etc/apparmor/ -p wa -k MAC-policy\n-w /etc/apparmor.d/ -p wa -k MAC-policy\n```",
                "fix": "Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/MAC-policy.rules`\n\n    and add the following lines:\n\n    ```\n    -w /etc/apparmor/ -p wa -k MAC-policy\n    -w /etc/apparmor.d/ -p wa -k MAC-policy\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "CM-6 (1)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.5"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.6"
            },
            "code": "control \"C-4.1.6\" do\n  title \"Ensure events that modify the system's Mandatory Access Controls are\ncollected\"\n  desc  \"Monitor AppArmor mandatory access controls. The parameters below\nmonitor any write access (potential additional, deletion or modification of\nfiles in the directory) or attribute changes to `/etc/apparmor` and\n`/etc/apparmor.d` directories.\"\n  desc  \"rationale\", \"Changes to files in these directories could indicate that\nan unauthorized user is attempting to modify access controls and change\nsecurity contexts, leading to a compromise of the system.\"\n  desc  \"check\", \"\n    run the following commands:\n\n    ```\n    # grep MAC-policy /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -w /etc/apparmor/ -p wa -k MAC-policy\n    -w /etc/apparmor.d/ -p wa -k MAC-policy\n    ```\n\n    ```\n    # auditctl -l | grep MAC-policy\n    ```\n\n    Verify output matches:\n\n    ```\n    -w /etc/apparmor/ -p wa -k MAC-policy\n    -w /etc/apparmor.d/ -p wa -k MAC-policy\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/MAC-policy.rules`\n\n    and add the following lines:\n\n    ```\n    -w /etc/apparmor/ -p wa -k MAC-policy\n    -w /etc/apparmor.d/ -p wa -k MAC-policy\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"CM-6 (1)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.5\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.6\"\n\n  files = [\n    '/etc/apparmor', # note no trailing `/` on directories\n    '/etc/apparmor.d'\n  ]\n\n  files.each do |file|\n    describe auditd.file(file).where { key == \"MAC-policy\" } do\n      its('permissions') { should include ['w', 'a'] }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.6.rb",
                "line": 3
            },
            "id": "C-4.1.6"
        },
        {
            "title": "Ensure AppArmor is enabled in the bootloader configuration",
            "desc": "Configure AppArmor to be enabled at boot time and verify that it has\nnot been overwritten by the bootloader boot parameters.",
            "descriptions": {
                "default": "Configure AppArmor to be enabled at boot time and verify that it has\nnot been overwritten by the bootloader boot parameters.",
                "rationale": "AppArmor must be enabled at boot time in your bootloader\nconfiguration to ensure that the controls it provides are not overridden.",
                "check": "Run the following commands to verify that all linux lines have the\n`apparmor=1` and `security=apparmor` parameters set:\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v \"apparmor=1\" | grep -v '/boot/memtest86+.bin'\n\n    Nothing should be returned\n    ```\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v \"security=apparmor\" | grep -v '/boot/memtest86+.bin'\n\n    Nothing should be returned\n    ```",
                "fix": "edit `/etc/default/grub` and add the appermor=1 and security=apparmor\nparameters to the GRUB_CMDLINE_LINUX= line\n\n    ```\n    GRUB_CMDLINE_LINUX=\"apparmor=1 security=apparmor\"\n    ```\n\n    Run the following command to update the `grub2` configuration:\n\n    ```\n    # update-grub\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-3 (3)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6",
                    "Rev_7"
                ],
                "cis_rid": "1.7.1.2"
            },
            "code": "control \"C-1.7.1.2\" do\n  title \"Ensure AppArmor is enabled in the bootloader configuration\"\n  desc  \"Configure AppArmor to be enabled at boot time and verify that it has\nnot been overwritten by the bootloader boot parameters.\"\n  desc  \"rationale\", \"AppArmor must be enabled at boot time in your bootloader\nconfiguration to ensure that the controls it provides are not overridden.\"\n  desc  \"check\", \"\n    Run the following commands to verify that all linux lines have the\n`apparmor=1` and `security=apparmor` parameters set:\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v \\\"apparmor=1\\\" | grep -v '/boot/memtest86+.bin'\n\n    Nothing should be returned\n    ```\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v \\\"security=apparmor\\\" | grep -v '/boot/memtest86+.bin'\n\n    Nothing should be returned\n    ```\n  \"\n  desc \"fix\", \"\n    edit `/etc/default/grub` and add the appermor=1 and security=apparmor\nparameters to the GRUB_CMDLINE_LINUX= line\n\n    ```\n    GRUB_CMDLINE_LINUX=\\\"apparmor=1 security=apparmor\\\"\n    ```\n\n    Run the following command to update the `grub2` configuration:\n\n    ```\n    # update-grub\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-3 (3)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\", \"Rev_7\"]\n  tag cis_rid: \"1.7.1.2\"\n\n  describe service('apparmor') do\n    it { should be_installed }\n    it { should be_enabled }\n    it { should be_running }\n  end\n\n    describe grub_conf('/boot/grub/grub.cfg') do\n      its('kernel') { should include 'apparmor=1' }\n      its('kernel') { should include 'security=apparmor' }\n    end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.7.1.2.rb",
                "line": 3
            },
            "id": "C-1.7.1.2"
        },
        {
            "title": "Ensure SSH root login is disabled",
            "desc": "The `PermitRootLogin` parameter specifies if the root user can log in\nusing ssh. The default is no.",
            "descriptions": {
                "default": "The `PermitRootLogin` parameter specifies if the root user can log in\nusing ssh. The default is no.",
                "rationale": "Disallowing root logins over SSH requires system admins\nto authenticate using their own individual account, then escalating to root via\n`sudo` or `su`. This in turn limits opportunity for non-repudiation and\nprovides a clear audit trail in the event of a security incident",
                "check": "Run the following command and verify that output matches:\n\n```\n# sshd -T | grep permitrootlogin\n\nPermitRootLogin no\n```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nPermitRootLogin no\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-6 (9)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.3"
                ],
                "cis_rid": "5.2.10",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.10\" do\n  title \"Ensure SSH root login is disabled\"\n  desc  \"The `PermitRootLogin` parameter specifies if the root user can log in\nusing ssh. The default is no.\"\n  desc  \"rationale\", \"Disallowing root logins over SSH requires system admins\nto authenticate using their own individual account, then escalating to root via\n`sudo` or `su`. This in turn limits opportunity for non-repudiation and\nprovides a clear audit trail in the event of a security incident\"\n  desc  \"check\", \"\n    Run the following command and verify that output matches:\n\n    ```\n    # sshd -T | grep permitrootlogin\n\n    PermitRootLogin no\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    PermitRootLogin no\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-6 (9)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.3\"]\n  tag cis_rid: \"5.2.10\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('PermitRootLogin') { should cmp 'no' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.10.rb",
                "line": 3
            },
            "id": "C-5.2.10"
        },
        {
            "title": "Ensure permissions on /etc/shadow- are configured",
            "desc": "The `/etc/shadow-` file is used to store backup information about user\naccounts that is critical to the security of those accounts, such as the hashed\npassword and other security information.",
            "descriptions": {
                "default": "The `/etc/shadow-` file is used to store backup information about user\naccounts that is critical to the security of those accounts, such as the hashed\npassword and other security information.",
                "rationale": "It is critical to ensure that the `/etc/shadow-` file is\nprotected from unauthorized access. Although it is protected by default, the\nfile permissions could be changed either inadvertently or through malicious\nactions.",
                "check": "Run the following command and verify verify `Uid` is `0/root,` `Gid` is\n`0/root` or `/shadow,` and `Access` is `640` or more restrictive:\n\n    ```\n    # stat /etc/shadow-\n\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 42/ shadow)\n    ```",
                "fix": "Run the following commands to set permissions on `/etc/shadow-`:\n\n```\n# chown root:shadow /etc/shadow-\n```\n\n```\n# chmod u-x,go-rwx /etc/shadow-\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-28"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.7"
            },
            "code": "control \"C-6.1.7\" do\n  title \"Ensure permissions on /etc/shadow- are configured\"\n  desc  \"The `/etc/shadow-` file is used to store backup information about user\naccounts that is critical to the security of those accounts, such as the hashed\npassword and other security information.\"\n  desc  \"rationale\", \"It is critical to ensure that the `/etc/shadow-` file is\nprotected from unauthorized access. Although it is protected by default, the\nfile permissions could be changed either inadvertently or through malicious\nactions.\"\n  desc  \"check\", \"\n    Run the following command and verify verify `Uid` is `0/root,` `Gid` is\n`0/root` or `/shadow,` and `Access` is `640` or more restrictive:\n\n    ```\n    # stat /etc/shadow-\n\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 42/ shadow)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set permissions on `/etc/shadow-`:\n\n    ```\n    # chown root:shadow /etc/shadow-\n    ```\n\n    ```\n    # chmod u-x,go-rwx /etc/shadow-\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-28\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.7\"\n\n  describe file('/etc/shadow-') do\n    it { should_not be_more_permissive_than('0640') }\n    it { should be_owned_by 'root' }\n    its('group') { should be_in ['root', 'shadow'] }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.7.rb",
                "line": 3
            },
            "id": "C-6.1.7"
        },
        {
            "title": "Ensure updates, patches, and additional security software are\ninstalled",
            "desc": "Periodically patches are released for included software either due to\nsecurity flaws or to include additional functionality.",
            "descriptions": {
                "default": "Periodically patches are released for included software either due to\nsecurity flaws or to include additional functionality.",
                "rationale": "Newer patches may contain security enhancements that\nwould not be available through the latest full update. As a result, it is\nrecommended that the latest software patches be used to take advantage of the\nlatest functionality. As with any software installation, organizations need to\ndetermine if a given update meets their requirements and verify the\ncompatibility and supportability of any additional software against the update\nrevision that is selected.",
                "check": "Verify there are no updates or patches to install:\n\n```\n# apt -s upgrade\n```",
                "fix": "Use your package manager to update all packages on the system according to\nsite policy.\n\n    Run the following command to update all packages following local site\npolicy guidance on applying updates and patches:\n\n    ```\n    # apt upgrade\n    ```\n\n    OR\n\n    ```\n    # apt dist-upgrade\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SI-2",
                    "SI-2",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "3.4",
                    "3.5",
                    "Rev_7"
                ],
                "cis_rid": "1.9"
            },
            "code": "control \"C-1.9\" do\n  title \"Ensure updates, patches, and additional security software are\ninstalled\"\n  desc  \"Periodically patches are released for included software either due to\nsecurity flaws or to include additional functionality.\"\n  desc  \"rationale\", \"Newer patches may contain security enhancements that\nwould not be available through the latest full update. As a result, it is\nrecommended that the latest software patches be used to take advantage of the\nlatest functionality. As with any software installation, organizations need to\ndetermine if a given update meets their requirements and verify the\ncompatibility and supportability of any additional software against the update\nrevision that is selected.\"\n  desc  \"check\", \"\n    Verify there are no updates or patches to install:\n\n    ```\n    # apt -s upgrade\n    ```\n  \"\n  desc  \"fix\", \"\n    Use your package manager to update all packages on the system according to\nsite policy.\n\n    Run the following command to update all packages following local site\npolicy guidance on applying updates and patches:\n\n    ```\n    # apt upgrade\n    ```\n\n    OR\n\n    ```\n    # apt dist-upgrade\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SI-2\", \"SI-2\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"3.4\", \"3.5\", \"Rev_7\"]\n  tag cis_rid: \"1.9\"\n\n  describe command('apt -s upgrade') do\n    its('exit_status') { should cmp 0 }\n    its('stdout') { should match '^0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.$' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.9.rb",
                "line": 3
            },
            "id": "C-1.9"
        },
        {
            "title": "Audit SGID executables",
            "desc": "The owner of a file can set the file's permissions to run with the\nowner's or group's permissions, even if the user running the program is not the\nowner or a member of the group. The most common reason for a SGID program is to\nenable users to perform functions (such as changing their password) that\nrequire root privileges.",
            "descriptions": {
                "default": "The owner of a file can set the file's permissions to run with the\nowner's or group's permissions, even if the user running the program is not the\nowner or a member of the group. The most common reason for a SGID program is to\nenable users to perform functions (such as changing their password) that\nrequire root privileges.",
                "rationale": "There are valid reasons for SGID programs, but it is\nimportant to identify and review such programs to ensure they are legitimate.\nReview the files returned by the action in the audit section and check to see\nif system binaries have a different md5 checksum than what from the package.\nThis is an indication that the binary may have been replaced.",
                "check": "Run the following command to list SGID files:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -type f -perm -2000\n    ```\n\n    The command above only searches local filesystems, there may still be\ncompromised items on network mounted partitions. Additionally the `--local`\noption to `df` is not universal to all versions, it can be omitted to search\nall filesystems on a system including network mounted filesystems or the\nfollowing command can be run manually for each partition:\n\n    ```\n    # find\n\n    \t -xdev -type f -perm -2000\n    ```",
                "fix": "Ensure that no rogue SGID programs have been introduced into\nthe system. Review the files returned by the action in the Audit section and\nconfirm the integrity of these binaries."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.14"
            },
            "code": "control \"C-6.1.14\" do\n  title \"Audit SGID executables\"\n  desc  \"The owner of a file can set the file's permissions to run with the\nowner's or group's permissions, even if the user running the program is not the\nowner or a member of the group. The most common reason for a SGID program is to\nenable users to perform functions (such as changing their password) that\nrequire root privileges.\"\n  desc  \"rationale\", \"There are valid reasons for SGID programs, but it is\nimportant to identify and review such programs to ensure they are legitimate.\nReview the files returned by the action in the audit section and check to see\nif system binaries have a different md5 checksum than what from the package.\nThis is an indication that the binary may have been replaced.\"\n  desc  \"check\", \"\n    Run the following command to list SGID files:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -type f -perm -2000\n    ```\n\n    The command above only searches local filesystems, there may still be\ncompromised items on network mounted partitions. Additionally the `--local`\noption to `df` is not universal to all versions, it can be omitted to search\nall filesystems on a system including network mounted filesystems or the\nfollowing command can be run manually for each partition:\n\n    ```\n    # find\n\n    \\t -xdev -type f -perm -2000\n    ```\n  \"\n  desc \"fix\", \"Ensure that no rogue SGID programs have been introduced into\nthe system. Review the files returned by the action in the Audit section and\nconfirm the integrity of these binaries.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.14\"\n\n  cmd = \"df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -2000\"\n  describe command(cmd) do\n    skip \"This control must be reviewed manually. Run `#{cmd}` and review the results.\"\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.14.rb",
                "line": 3
            },
            "id": "C-6.1.14"
        },
        {
            "title": "Ensure SSH HostbasedAuthentication is disabled",
            "desc": "The `HostbasedAuthentication` parameter specifies if authentication is\nallowed through trusted hosts via the user of `.rhosts`, or `/etc/hosts.equiv`,\nalong with successful public key client host authentication. This option only\napplies to SSH Protocol Version 2.",
            "descriptions": {
                "default": "The `HostbasedAuthentication` parameter specifies if authentication is\nallowed through trusted hosts via the user of `.rhosts`, or `/etc/hosts.equiv`,\nalong with successful public key client host authentication. This option only\napplies to SSH Protocol Version 2.",
                "rationale": "Even though the `.rhosts` files are ineffective if\nsupport is disabled in `/etc/pam.conf`, disabling the ability to use `.rhosts`\nfiles in SSH provides an additional layer of protection.",
                "check": "Run the following command and verify that output matches:\n\n```\n# sshd -T | grep hostbasedauthentication\n\nHostbasedAuthentication no\n```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nHostbasedAuthentication no\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "IA-2 (1)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.3"
                ],
                "cis_rid": "5.2.9",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.9\" do\n  title \"Ensure SSH HostbasedAuthentication is disabled\"\n  desc  \"The `HostbasedAuthentication` parameter specifies if authentication is\nallowed through trusted hosts via the user of `.rhosts`, or `/etc/hosts.equiv`,\nalong with successful public key client host authentication. This option only\napplies to SSH Protocol Version 2.\"\n  desc  \"rationale\", \"Even though the `.rhosts` files are ineffective if\nsupport is disabled in `/etc/pam.conf`, disabling the ability to use `.rhosts`\nfiles in SSH provides an additional layer of protection.\"\n  desc  \"check\", \"\n    Run the following command and verify that output matches:\n\n    ```\n    # sshd -T | grep hostbasedauthentication\n\n    HostbasedAuthentication no\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    HostbasedAuthentication no\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"IA-2 (1)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.3\"]\n  tag cis_rid: \"5.2.9\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('HostbasedAuthentication') { should cmp 'no' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.9.rb",
                "line": 3
            },
            "id": "C-5.2.9"
        },
        {
            "title": "Ensure nftables rules are permanent",
            "desc": "nftables is a subsystem of the Linux kernel providing filtering and\nclassification of network packets/datagrams/frames.\n\n    The nftables service reads the `/etc/sysconfig/nftables.conf` file for a\nnftables file or files to include in the nftables ruleset.\n\n    A nftables ruleset containing the input, forward, and output base chains\nallow network traffic to be filtered.",
            "descriptions": {
                "default": "nftables is a subsystem of the Linux kernel providing filtering and\nclassification of network packets/datagrams/frames.\n\n    The nftables service reads the `/etc/sysconfig/nftables.conf` file for a\nnftables file or files to include in the nftables ruleset.\n\n    A nftables ruleset containing the input, forward, and output base chains\nallow network traffic to be filtered.",
                "rationale": "Changes made to nftables ruleset only affect the live\nsystem, you will also need to configure the nftables ruleset to apply on boot",
                "check": "Run the following commands to verify that input, forward, and output base\nchains are configured to be applied to a nftables ruleset on boot:\n\n    Run the following command to verify the input base chain:\n\n    ```\n    # awk '/hook input/,/}/' $(awk '$1 ~ /^\\s*include/ {\ngsub(\"\\\"\",\"\",$2);print $2 }' /etc/sysconfig/nftables.conf)\n    ```\n\n    Output should be similar to:\n\n    ```\n     type filter hook input priority 0; policy drop;\n\n     # Ensure loopback traffic is configured\n     iif \"lo\" accept\n     ip saddr 127.0.0.0/8 counter packets 0 bytes 0 drop\n     ip6 saddr ::1 counter packets 0 bytes 0 drop\n\n     # Ensure established connections are configured\n     ip protocol tcp ct state established accept\n     ip protocol udp ct state established accept\n     ip protocol icmp ct state established accept\n\n     # Accept port 22(SSH) traffic from anywhere\n     tcp dport ssh accept\n\n     # Accept ICMP and IGMP from anywhere\n     icmpv6 type { destination-unreachable, packet-too-big, time-exceeded,\nparameter-problem, mld-listener-query, mld-listener-report, mld-listener-done,\nnd-router-solicit, nd-router-advert, nd-neighbor-solicit, nd-neighbor-advert,\nind-neighbor-solicit, ind-neighbor-advert, mld2-listener-report } accept\n    ```\n\n    Note: Review the input base chain to ensure that it follows local site\npolicy\n\n    Run the following command to verify the forward base chain:\n\n    ```\n    # awk '/hook forward/,/}/' $(awk '$1 ~ /^\\s*include/ {\ngsub(\"\\\"\",\"\",$2);print $2 }' /etc/sysconfig/nftables.conf)\n    ```\n\n    Output should be similar to:\n\n    ```\n     # Base chain for hook forward named forward (Filters forwarded network\npackets)\n     chain forward {\n     type filter hook forward priority 0; policy drop;\n     }\n    ```\n\n    Note: Review the forward base chain to ensure that it follows local site\npolicy.\n\n    Run the following command to verify the forward base chain:\n\n    ```\n    # awk '/hook output/,/}/' $(awk '$1 ~ /^\\s*include/ {\ngsub(\"\\\"\",\"\",$2);print $2 }' /etc/sysconfig/nftables.conf)\n    ```\n\n    Output should be similar to:\n\n    ```\n     # Base chain for hook output named output (Filters outbound network\npackets)\n     chain output {\n     type filter hook output priority 0; policy drop;\n     # Ensure outbound and established connections are configured\n     ip protocol tcp ct state established,related,new accept\n     ip protocol tcp ct state established,related,new accept\n     ip protocol udp ct state established,related,new accept\n     ip protocol icmp ct state established,related,new accept\n     }\n    ```\n\n    Note: Review the output base chain to ensure that it follows local site\npolicy.",
                "fix": "Edit the `/etc/sysconfig/nftables.conf` file and un-comment or add a line\nwith `include ` for each nftables file you want included in the nftables\nruleset on boot\n\n    example:\n\n    ```\n    # vi /etc/sysconfig/nftables.conf\n    ```\n\n    Add the line:\n\n    ```\n    include \"/etc/nftables/nftables.rules\"\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.3.8"
            },
            "code": "control \"C-3.5.3.8\" do\n  title \"Ensure nftables rules are permanent\"\n  desc  \"nftables is a subsystem of the Linux kernel providing filtering and\nclassification of network packets/datagrams/frames.\n\n    The nftables service reads the `/etc/sysconfig/nftables.conf` file for a\nnftables file or files to include in the nftables ruleset.\n\n    A nftables ruleset containing the input, forward, and output base chains\nallow network traffic to be filtered.\n  \"\n  desc  \"rationale\", \"Changes made to nftables ruleset only affect the live\nsystem, you will also need to configure the nftables ruleset to apply on boot\"\n  desc  \"check\", \"\n    Run the following commands to verify that input, forward, and output base\nchains are configured to be applied to a nftables ruleset on boot:\n\n    Run the following command to verify the input base chain:\n\n    ```\n    # awk '/hook input/,/}/' $(awk '$1 ~ /^\\\\s*include/ {\ngsub(\\\"\\\\\\\"\\\",\\\"\\\",$2);print $2 }' /etc/sysconfig/nftables.conf)\n    ```\n\n    Output should be similar to:\n\n    ```\n     type filter hook input priority 0; policy drop;\n\n     # Ensure loopback traffic is configured\n     iif \\\"lo\\\" accept\n     ip saddr 127.0.0.0/8 counter packets 0 bytes 0 drop\n     ip6 saddr ::1 counter packets 0 bytes 0 drop\n\n     # Ensure established connections are configured\n     ip protocol tcp ct state established accept\n     ip protocol udp ct state established accept\n     ip protocol icmp ct state established accept\n\n     # Accept port 22(SSH) traffic from anywhere\n     tcp dport ssh accept\n\n     # Accept ICMP and IGMP from anywhere\n     icmpv6 type { destination-unreachable, packet-too-big, time-exceeded,\nparameter-problem, mld-listener-query, mld-listener-report, mld-listener-done,\nnd-router-solicit, nd-router-advert, nd-neighbor-solicit, nd-neighbor-advert,\nind-neighbor-solicit, ind-neighbor-advert, mld2-listener-report } accept\n    ```\n\n    Note: Review the input base chain to ensure that it follows local site\npolicy\n\n    Run the following command to verify the forward base chain:\n\n    ```\n    # awk '/hook forward/,/}/' $(awk '$1 ~ /^\\\\s*include/ {\ngsub(\\\"\\\\\\\"\\\",\\\"\\\",$2);print $2 }' /etc/sysconfig/nftables.conf)\n    ```\n\n    Output should be similar to:\n\n    ```\n     # Base chain for hook forward named forward (Filters forwarded network\npackets)\n     chain forward {\n     type filter hook forward priority 0; policy drop;\n     }\n    ```\n\n    Note: Review the forward base chain to ensure that it follows local site\npolicy.\n\n    Run the following command to verify the forward base chain:\n\n    ```\n    # awk '/hook output/,/}/' $(awk '$1 ~ /^\\\\s*include/ {\ngsub(\\\"\\\\\\\"\\\",\\\"\\\",$2);print $2 }' /etc/sysconfig/nftables.conf)\n    ```\n\n    Output should be similar to:\n\n    ```\n     # Base chain for hook output named output (Filters outbound network\npackets)\n     chain output {\n     type filter hook output priority 0; policy drop;\n     # Ensure outbound and established connections are configured\n     ip protocol tcp ct state established,related,new accept\n     ip protocol tcp ct state established,related,new accept\n     ip protocol udp ct state established,related,new accept\n     ip protocol icmp ct state established,related,new accept\n     }\n    ```\n\n    Note: Review the output base chain to ensure that it follows local site\npolicy.\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/sysconfig/nftables.conf` file and un-comment or add a line\nwith `include ` for each nftables file you want included in the nftables\nruleset on boot\n\n    example:\n\n    ```\n    # vi /etc/sysconfig/nftables.conf\n    ```\n\n    Add the line:\n\n    ```\n    include \\\"/etc/nftables/nftables.rules\\\"\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.3.8\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.3.8.rb",
                "line": 3
            },
            "id": "C-3.5.3.8"
        },
        {
            "title": "Ensure login and logout events are collected",
            "desc": "Monitor login and logout events. The parameters below track changes to\nfiles associated with login/logout events. The file `/var/log/faillog` tracks\nfailed events from login. The file `/var/log/lastlog` maintain records of the\nlast time a user successfully logged in. The file `/var/log/tallylog` maintains\nrecords of failures via the `pam_tally2` module",
            "descriptions": {
                "default": "Monitor login and logout events. The parameters below track changes to\nfiles associated with login/logout events. The file `/var/log/faillog` tracks\nfailed events from login. The file `/var/log/lastlog` maintain records of the\nlast time a user successfully logged in. The file `/var/log/tallylog` maintains\nrecords of failures via the `pam_tally2` module",
                "rationale": "Monitoring login/logout events could provide a system\nadministrator with information associated with brute force attacks against user\nlogins.",
                "check": "Run the following commands:\n\n```\n# grep logins /etc/audit/rules.d/*.rules\n```\n\nVerify output includes:\n\n```\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/log/tallylog -p wa -k logins\n```\n\n```\n# auditctl -l | grep logins\n```\n\nVerify output includes:\n\n```\n-w /var/log/faillog -p wa -k logins\n-w /var/log/lastlog -p wa -k logins\n-w /var/log/tallylog -p wa -k logins\n```",
                "fix": "Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/logins.rules`\n\n    and add the following lines:\n\n    ```\n    -w /var/log/faillog -p wa -k logins\n    -w /var/log/lastlog -p wa -k logins\n    -w /var/log/tallylog -p wa -k logins\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-2",
                    "AC-11",
                    "AC-2(12)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "4.9",
                    "16.11",
                    "16.13"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.7"
            },
            "code": "control \"C-4.1.7\" do\n  title \"Ensure login and logout events are collected\"\n  desc  \"Monitor login and logout events. The parameters below track changes to\nfiles associated with login/logout events. The file `/var/log/faillog` tracks\nfailed events from login. The file `/var/log/lastlog` maintain records of the\nlast time a user successfully logged in. The file `/var/log/tallylog` maintains\nrecords of failures via the `pam_tally2` module\"\n  desc  \"rationale\", \"Monitoring login/logout events could provide a system\nadministrator with information associated with brute force attacks against user\nlogins.\"\n  desc  \"check\", \"\n    Run the following commands:\n\n    ```\n    # grep logins /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output includes:\n\n    ```\n    -w /var/log/faillog -p wa -k logins\n    -w /var/log/lastlog -p wa -k logins\n    -w /var/log/tallylog -p wa -k logins\n    ```\n\n    ```\n    # auditctl -l | grep logins\n    ```\n\n    Verify output includes:\n\n    ```\n    -w /var/log/faillog -p wa -k logins\n    -w /var/log/lastlog -p wa -k logins\n    -w /var/log/tallylog -p wa -k logins\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/logins.rules`\n\n    and add the following lines:\n\n    ```\n    -w /var/log/faillog -p wa -k logins\n    -w /var/log/lastlog -p wa -k logins\n    -w /var/log/tallylog -p wa -k logins\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-2\", \"AC-11\", \"AC-2(12)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"4.9\", \"16.11\", \"16.13\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.7\"\n\n\n  files = [\n    '/var/log/faillog',\n    '/var/log/lastlog',\n    '/var/log/tallylog'\n  ]\n\n  files.each do |file|\n    describe auditd.file(file).where { key == \"logins\" } do\n      its('permissions') { should include ['w', 'a'] }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.7.rb",
                "line": 3
            },
            "id": "C-4.1.7"
        },
        {
            "title": "Ensure bogus ICMP responses are ignored",
            "desc": "Setting `icmp_ignore_bogus_error_responses` to 1 prevents the kernel\nfrom logging bogus responses (RFC-1122 non-compliant) from broadcast reframes,\nkeeping file systems from filling up with useless log messages.",
            "descriptions": {
                "default": "Setting `icmp_ignore_bogus_error_responses` to 1 prevents the kernel\nfrom logging bogus responses (RFC-1122 non-compliant) from broadcast reframes,\nkeeping file systems from filling up with useless log messages.",
                "rationale": "Some routers (and some attackers) will send responses\nthat violate RFC-1122 and attempt to fill up a log file system with many\nuseless error messages.",
                "check": "Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.icmp_ignore_bogus_error_responses\n\n    net.ipv4.icmp_ignore_bogus_error_responses = 1\n    ```\n\n    ```\n    # grep \"net.ipv4.icmp_ignore_bogus_error_responses\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.icmp_ignore_bogus_error_responses = 1\n    ```",
                "fix": "Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.icmp_ignore_bogus_error_responses = 1\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1\n    ```\n\n    ```\n    # sysctl -w net.ipv4.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.2.6"
            },
            "code": "control \"C-3.2.6\" do\n  title \"Ensure bogus ICMP responses are ignored\"\n  desc  \"Setting `icmp_ignore_bogus_error_responses` to 1 prevents the kernel\nfrom logging bogus responses (RFC-1122 non-compliant) from broadcast reframes,\nkeeping file systems from filling up with useless log messages.\"\n  desc  \"rationale\", \"Some routers (and some attackers) will send responses\nthat violate RFC-1122 and attempt to fill up a log file system with many\nuseless error messages.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.icmp_ignore_bogus_error_responses\n\n    net.ipv4.icmp_ignore_bogus_error_responses = 1\n    ```\n\n    ```\n    # grep \\\"net.ipv4.icmp_ignore_bogus_error_responses\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.icmp_ignore_bogus_error_responses = 1\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.icmp_ignore_bogus_error_responses = 1\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1\n    ```\n\n    ```\n    # sysctl -w net.ipv4.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.2.6\"\n\n  describe kernel_parameter('net.ipv4.icmp_ignore_bogus_error_responses') do\n    its('value') { should cmp '1' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.2.6.rb",
                "line": 3
            },
            "id": "C-3.2.6"
        },
        {
            "title": "Ensure packet redirect sending is disabled",
            "desc": "ICMP Redirects are used to send routing information to other hosts. As\na host itself does not act as a router (in a host only configuration), there is\nno need to send redirects.",
            "descriptions": {
                "default": "ICMP Redirects are used to send routing information to other hosts. As\na host itself does not act as a router (in a host only configuration), there is\nno need to send redirects.",
                "rationale": "An attacker could use a compromised host to send invalid\nICMP redirects to other router devices in an attempt to corrupt routing and\nhave users access a system set up by the attacker as opposed to a valid system.",
                "check": "Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.send_redirects\n    net.ipv4.conf.all.send_redirects = 0\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.send_redirects\n    net.ipv4.conf.default.send_redirects = 0\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.all\\.send_redirects\" /etc/sysctl.conf\n/etc/sysctl.d/*\n    net.ipv4.conf.all.send_redirects = 0\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.default\\.send_redirects\" /etc/sysctl.conf\n/etc/sysctl.d/*\n    net.ipv4.conf.default.send_redirects= 0\n    ```",
                "fix": "Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.send_redirects = 0\n    net.ipv4.conf.default.send_redirects = 0\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.conf.all.send_redirects=0\n    # sysctl -w net.ipv4.conf.default.send_redirects=0\n    # sysctl -w net.ipv4.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.1.1"
            },
            "code": "control \"C-3.1.1\" do\n  title \"Ensure packet redirect sending is disabled\"\n  desc  \"ICMP Redirects are used to send routing information to other hosts. As\na host itself does not act as a router (in a host only configuration), there is\nno need to send redirects.\"\n  desc  \"rationale\", \"An attacker could use a compromised host to send invalid\nICMP redirects to other router devices in an attempt to corrupt routing and\nhave users access a system set up by the attacker as opposed to a valid system.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.send_redirects\n    net.ipv4.conf.all.send_redirects = 0\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.send_redirects\n    net.ipv4.conf.default.send_redirects = 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.all\\\\.send_redirects\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n    net.ipv4.conf.all.send_redirects = 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.default\\\\.send_redirects\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n    net.ipv4.conf.default.send_redirects= 0\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.send_redirects = 0\n    net.ipv4.conf.default.send_redirects = 0\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.conf.all.send_redirects=0\n    # sysctl -w net.ipv4.conf.default.send_redirects=0\n    # sysctl -w net.ipv4.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.1.1\"\n\n\n  describe kernel_parameter('net.ipv4.conf.all.send_redirects') do\n    its('value') { should cmp '0' }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.send_redirects') do\n    its('value') { should cmp '0' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.1.1.rb",
                "line": 3
            },
            "id": "C-3.1.1"
        },
        {
            "title": "Ensure all AppArmor Profiles are in enforce or complain mode",
            "desc": "AppArmor profiles define what resources applications are able to\naccess.",
            "descriptions": {
                "default": "AppArmor profiles define what resources applications are able to\naccess.",
                "rationale": "Security configuration requirements vary from site to\nsite. Some sites may mandate a policy that is stricter than the default policy,\nwhich is perfectly acceptable. This item is intended to ensure that any\npolicies that exist on the system are activated.",
                "check": "Run the following command and verify that profiles are loaded, profiles are\nin enforce or complain mode, and no processes are unconfined:\n\n    ```\n    # apparmor_status | grep profiles\n    ```\n\n    Review output and ensure that profiles are loaded, and in either enforce or\ncomplain mode\n\n    ```\n    37 profiles are loaded.\n    35 profiles are in enforce mode.\n    2 profiles are in complain mode.\n    4 processes have profiles defined.\n    ```\n\n    ```\n    # apparmor_status | grep processes\n    ```\n\n    Review the output and ensure no processes are unconfined\n\n    ```\n    4 processes have profiles defined.\n    4 processes are in enforce mode.\n    0 processes are in complain mode.\n    0 processes are unconfined but have a profile defined.\n    ```",
                "fix": "Run the following command to set all profiles to enforce mode:\n\n    ```\n    # aa-enforce /etc/apparmor.d/*\n    ```\n\n    **OR**\n\n    Run the following command to set all profiles to complain mode:\n\n    ```\n    # aa-complain /etc/apparmor.d/*\n    ```\n\n    Any unconfined processes may need to have a profile created or activated\nfor them and then be restarted."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-3 (3)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6",
                    "Rev_7"
                ],
                "cis_rid": "1.7.1.3"
            },
            "code": "control \"C-1.7.1.3\" do\n  title \"Ensure all AppArmor Profiles are in enforce or complain mode\"\n  desc  \"AppArmor profiles define what resources applications are able to\naccess.\"\n  desc  \"rationale\", \"Security configuration requirements vary from site to\nsite. Some sites may mandate a policy that is stricter than the default policy,\nwhich is perfectly acceptable. This item is intended to ensure that any\npolicies that exist on the system are activated.\"\n  desc  \"check\", \"\n    Run the following command and verify that profiles are loaded, profiles are\nin enforce or complain mode, and no processes are unconfined:\n\n    ```\n    # apparmor_status | grep profiles\n    ```\n\n    Review output and ensure that profiles are loaded, and in either enforce or\ncomplain mode\n\n    ```\n    37 profiles are loaded.\n    35 profiles are in enforce mode.\n    2 profiles are in complain mode.\n    4 processes have profiles defined.\n    ```\n\n    ```\n    # apparmor_status | grep processes\n    ```\n\n    Review the output and ensure no processes are unconfined\n\n    ```\n    4 processes have profiles defined.\n    4 processes are in enforce mode.\n    0 processes are in complain mode.\n    0 processes are unconfined but have a profile defined.\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to set all profiles to enforce mode:\n\n    ```\n    # aa-enforce /etc/apparmor.d/*\n    ```\n\n    **OR**\n\n    Run the following command to set all profiles to complain mode:\n\n    ```\n    # aa-complain /etc/apparmor.d/*\n    ```\n\n    Any unconfined processes may need to have a profile created or activated\nfor them and then be restarted.\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-3 (3)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\", \"Rev_7\"]\n  tag cis_rid: \"1.7.1.3\"\n\n  describe service('apparmor') do\n    it { should be_installed }\n    it { should be_enabled }\n    it { should be_running }\n  end\n\n\n  num_loaded_profiles = inspec.command('apparmor_status | grep \"profiles are loaded.\" | cut -f 1 -d \" \"').stdout.to_i\n  num_enforced_profiles = inspec.command('apparmor_status | grep \"profiles are in enforce mode.\" | cut -f 1 -d \" \"').stdout.to_i\n  num_complain_profiles = inspec.command('apparmor_status | grep \"profiles are in complain mode.\" | cut -f 1 -d \" \"').stdout.to_i\n  num_enforced_and_complain_profiles = num_enforced_profiles + num_complain_profiles\n\n  describe \"AppArmor profiles #{num_loaded_profiles} are loaded\" do\n    it \"and in either enforce (found: #{num_enforced_profiles}) or complain mode (found: #{num_complain_profiles})\" do\n      expect(num_enforced_and_complain_profiles).to eq(num_loaded_profiles)\n    end\n  end\n\n  num_unconfigured_but_defined= inspec.command('apparmor_status | grep \"are unconfined but have a profile defined.\" | cut -f 1 -d \" \"').stdout.to_i\n  describe \"#{num_unconfigured_but_defined} AppArmor Processes\" do\n    it \"have profiles defined, but are unconfigured\" do\n      expect(num_unconfigured_but_defined).to eq(0)\n    end\n  end\n  # are unconfined but have a profile defined.\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.7.1.3.rb",
                "line": 3
            },
            "id": "C-1.7.1.3"
        },
        {
            "title": "Ensure password fields are not empty",
            "desc": "An account with an empty password field means that anybody may log in\nas that user without providing a password.",
            "descriptions": {
                "default": "An account with an empty password field means that anybody may log in\nas that user without providing a password.",
                "rationale": "All accounts must have passwords or be locked to prevent\nthe account from being used by an unauthorized user.",
                "check": "Run the following command and verify that no output is returned:\n\n    ```\n    # awk -F: '($2 == \"\" ) { print $1 \" does not have a password \"}'\n/etc/shadow\n    ```",
                "fix": "If any accounts in the `/etc/shadow` file do not have a password, run the\nfollowing command to lock the account until it can be determined why it does\nnot have a password:\n\n    ```\n    # passwd -l\n    ```\n\n    Also, check to see if the account is logged in and investigate what it is\nbeing used for to determine if it needs to be forced off."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "IA-5 (1)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.1"
            },
            "code": "control \"C-6.2.1\" do\n  title \"Ensure password fields are not empty\"\n  desc  \"An account with an empty password field means that anybody may log in\nas that user without providing a password.\"\n  desc  \"rationale\", \"All accounts must have passwords or be locked to prevent\nthe account from being used by an unauthorized user.\"\n  desc  \"check\", \"\n    Run the following command and verify that no output is returned:\n\n    ```\n    # awk -F: '($2 == \\\"\\\" ) { print $1 \\\" does not have a password \\\"}'\n/etc/shadow\n    ```\n  \"\n  desc \"fix\", \"\n    If any accounts in the `/etc/shadow` file do not have a password, run the\nfollowing command to lock the account until it can be determined why it does\nnot have a password:\n\n    ```\n    # passwd -l\n    ```\n\n    Also, check to see if the account is logged in and investigate what it is\nbeing used for to determine if it needs to be forced off.\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"IA-5 (1)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.1\"\n\n  describe shadow.where(password: '') do\n    its('users') { should be_empty }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.1.rb",
                "line": 3
            },
            "id": "C-6.2.1"
        },
        {
            "title": "Ensure remote rsyslog messages are only accepted on designated log\nhosts.",
            "desc": "By default, `rsyslog` does not listen for log messages coming in from\nremote systems. The `ModLoad` tells `rsyslog` to load the `imtcp.so` module so\nit can listen over a network via TCP. The `InputTCPServerRun` option instructs\n`rsyslogd` to listen on the specified TCP port.",
            "descriptions": {
                "default": "By default, `rsyslog` does not listen for log messages coming in from\nremote systems. The `ModLoad` tells `rsyslog` to load the `imtcp.so` module so\nit can listen over a network via TCP. The `InputTCPServerRun` option instructs\n`rsyslogd` to listen on the specified TCP port.",
                "rationale": "The guidance in the section ensures that remote log hosts\nare configured to only accept `rsyslog` data from hosts within the specified\ndomain and that those systems that are not designed to be log hosts do not\naccept any remote `rsyslog` messages. This provides protection from spoofed log\ndata and ensures that system administrators are reviewing reasonably complete\nsyslog data in a central location.",
                "check": "Run the following commands and verify the resulting lines are uncommented\non designated log hosts and commented or removed on all others:\n\n    ```\n    # grep '$ModLoad imtcp' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n\n    $ModLoad imtcp\n    ```\n\n    ```\n    # grep '$InputTCPServerRun' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n\n    $InputTCPServerRun 514\n    ```",
                "fix": "For hosts that are designated as log hosts, edit the `/etc/rsyslog.conf`\nfile and un-comment or add the following lines:\n\n    ```\n    $ModLoad imtcp\n\n    $InputTCPServerRun 514\n    ```\n\n    For hosts that are not designated as log hosts, edit the\n`/etc/rsyslog.conf` file and comment or remove the following lines:\n\n    ```\n    # $ModLoad imtcp\n\n    # $InputTCPServerRun 514\n    ```\n\n    Run the following command to reload the `rsyslogd` configuration:\n\n    ```\n    # systemctl restart rsyslog\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "4.2.1.6"
            },
            "code": "control \"C-4.2.1.6\" do\n  title \"Ensure remote rsyslog messages are only accepted on designated log\nhosts.\"\n  desc  \"By default, `rsyslog` does not listen for log messages coming in from\nremote systems. The `ModLoad` tells `rsyslog` to load the `imtcp.so` module so\nit can listen over a network via TCP. The `InputTCPServerRun` option instructs\n`rsyslogd` to listen on the specified TCP port.\"\n  desc  \"rationale\", \"The guidance in the section ensures that remote log hosts\nare configured to only accept `rsyslog` data from hosts within the specified\ndomain and that those systems that are not designed to be log hosts do not\naccept any remote `rsyslog` messages. This provides protection from spoofed log\ndata and ensures that system administrators are reviewing reasonably complete\nsyslog data in a central location.\"\n  desc  \"check\", \"\n    Run the following commands and verify the resulting lines are uncommented\non designated log hosts and commented or removed on all others:\n\n    ```\n    # grep '$ModLoad imtcp' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n\n    $ModLoad imtcp\n    ```\n\n    ```\n    # grep '$InputTCPServerRun' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n\n    $InputTCPServerRun 514\n    ```\n  \"\n  desc  \"fix\", \"\n    For hosts that are designated as log hosts, edit the `/etc/rsyslog.conf`\nfile and un-comment or add the following lines:\n\n    ```\n    $ModLoad imtcp\n\n    $InputTCPServerRun 514\n    ```\n\n    For hosts that are not designated as log hosts, edit the\n`/etc/rsyslog.conf` file and comment or remove the following lines:\n\n    ```\n    # $ModLoad imtcp\n\n    # $InputTCPServerRun 514\n    ```\n\n    Run the following command to reload the `rsyslogd` configuration:\n\n    ```\n    # systemctl restart rsyslog\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"4.2.1.6\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.2.1.6.rb",
                "line": 3
            },
            "id": "C-4.2.1.6"
        },
        {
            "title": "Ensure SSH PermitEmptyPasswords is disabled",
            "desc": "The `PermitEmptyPasswords` parameter specifies if the SSH server\nallows login to accounts with empty password strings.",
            "descriptions": {
                "default": "The `PermitEmptyPasswords` parameter specifies if the SSH server\nallows login to accounts with empty password strings.",
                "rationale": "Disallowing remote shell access to accounts that have an\nempty password reduces the probability of unauthorized access to the system",
                "check": "Run the following command and verify that output matches:\n\n```\n# sshd -T | grep permitemptypasswords\n\nPermitEmptyPasswords no\n```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nPermitEmptyPasswords no\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "IA-2 (1)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.3"
                ],
                "cis_rid": "5.2.11",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.11\" do\n  title \"Ensure SSH PermitEmptyPasswords is disabled\"\n  desc  \"The `PermitEmptyPasswords` parameter specifies if the SSH server\nallows login to accounts with empty password strings.\"\n  desc  \"rationale\", \"Disallowing remote shell access to accounts that have an\nempty password reduces the probability of unauthorized access to the system\"\n  desc  \"check\", \"\n    Run the following command and verify that output matches:\n\n    ```\n    # sshd -T | grep permitemptypasswords\n\n    PermitEmptyPasswords no\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    PermitEmptyPasswords no\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"IA-2 (1)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.3\"]\n  tag cis_rid: \"5.2.11\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('PermitEmptyPasswords') { should cmp 'no' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.11.rb",
                "line": 3
            },
            "id": "C-5.2.11"
        },
        {
            "title": "Ensure journald is configured to send logs to rsyslog",
            "desc": "Data from journald may be stored in volatile memory or persisted\nlocally on the server. Utilities exist to accept remote export of journald\nlogs, however, use of the rsyslog service provides a consistent means of log\ncollection and export.",
            "descriptions": {
                "default": "Data from journald may be stored in volatile memory or persisted\nlocally on the server. Utilities exist to accept remote export of journald\nlogs, however, use of the rsyslog service provides a consistent means of log\ncollection and export.",
                "rationale": "Storing log data on a remote host protects log integrity\nfrom local attacks. If an attacker gains root access on the local system, they\ncould tamper with or remove log data that is stored on the local system.",
                "check": "Review `/etc/systemd/journald.conf` and verify that logs are forwarded to\nsyslog\n\n    ```\n    # grep -E -i \"^\\s*ForwardToSyslog\" /etc/systemd/journald.conf\n\n    ForwardToSyslog=yes\n    ```",
                "fix": "Edit the `/etc/systemd/journald.conf` file and add the following line:\n\n```\nForwardToSyslog=yes\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SI-4 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.5",
                    "Rev_7"
                ],
                "cis_rid": "4.2.2.1"
            },
            "code": "control \"C-4.2.2.1\" do\n  title \"Ensure journald is configured to send logs to rsyslog\"\n  desc  \"Data from journald may be stored in volatile memory or persisted\nlocally on the server. Utilities exist to accept remote export of journald\nlogs, however, use of the rsyslog service provides a consistent means of log\ncollection and export.\"\n  desc  \"rationale\", \"Storing log data on a remote host protects log integrity\nfrom local attacks. If an attacker gains root access on the local system, they\ncould tamper with or remove log data that is stored on the local system.\"\n  desc  \"check\", \"\n    Review `/etc/systemd/journald.conf` and verify that logs are forwarded to\nsyslog\n\n    ```\n    # grep -E -i \\\"^\\\\s*ForwardToSyslog\\\" /etc/systemd/journald.conf\n\n    ForwardToSyslog=yes\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/systemd/journald.conf` file and add the following line:\n\n    ```\n    ForwardToSyslog=yes\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SI-4 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.5\", \"Rev_7\"]\n  tag cis_rid: \"4.2.2.1\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.2.2.1.rb",
                "line": 3
            },
            "id": "C-4.2.2.1"
        },
        {
            "title": "Ensure permissions on /etc/passwd- are configured",
            "desc": "The `/etc/passwd-` file contains backup user account information.",
            "descriptions": {
                "default": "The `/etc/passwd-` file contains backup user account information.",
                "rationale": "It is critical to ensure that the `/etc/passwd-` file is\nprotected from unauthorized access. Although it is protected by default, the\nfile permissions could be changed either inadvertently or through malicious\nactions.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `600` or more restrictive:\n\n    ```\n    # stat /etc/passwd-\n\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following command to set permissions on `/etc/passwd-` :\n\n```\n# chown root:root /etc/passwd-\n\n# chmod u-x,go-rwx /etc/passwd-\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-28"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.6"
            },
            "code": "control \"C-6.1.6\" do\n  title \"Ensure permissions on /etc/passwd- are configured\"\n  desc  \"The `/etc/passwd-` file contains backup user account information.\"\n  desc  \"rationale\", \"It is critical to ensure that the `/etc/passwd-` file is\nprotected from unauthorized access. Although it is protected by default, the\nfile permissions could be changed either inadvertently or through malicious\nactions.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `600` or more restrictive:\n\n    ```\n    # stat /etc/passwd-\n\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to set permissions on `/etc/passwd-` :\n\n    ```\n    # chown root:root /etc/passwd-\n\n    # chmod u-x,go-rwx /etc/passwd-\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-28\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.6\"\n\n  describe file('/etc/passwd-') do\n    it { should_not be_more_permissive_than('0600') }\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.6.rb",
                "line": 3
            },
            "id": "C-6.1.6"
        },
        {
            "title": "Ensure SSH IgnoreRhosts is enabled",
            "desc": "The `IgnoreRhosts` parameter specifies that `.rhosts` and `.shosts`\nfiles will not be used in `RhostsRSAAuthentication` or\n`HostbasedAuthentication`.",
            "descriptions": {
                "default": "The `IgnoreRhosts` parameter specifies that `.rhosts` and `.shosts`\nfiles will not be used in `RhostsRSAAuthentication` or\n`HostbasedAuthentication`.",
                "rationale": "Setting this parameter forces users to enter a password\nwhen authenticating with ssh.",
                "check": "Run the following command and verify that output matches:\n\n```\n# sshd -T | grep ignorerhosts\n\nIgnoreRhosts yes\n```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nIgnoreRhosts yes\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-7 (1)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2"
                ],
                "cis_rid": "5.2.8",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.8\" do\n  title \"Ensure SSH IgnoreRhosts is enabled\"\n  desc  \"The `IgnoreRhosts` parameter specifies that `.rhosts` and `.shosts`\nfiles will not be used in `RhostsRSAAuthentication` or\n`HostbasedAuthentication`.\"\n  desc  \"rationale\", \"Setting this parameter forces users to enter a password\nwhen authenticating with ssh.\"\n  desc  \"check\", \"\n    Run the following command and verify that output matches:\n\n    ```\n    # sshd -T | grep ignorerhosts\n\n    IgnoreRhosts yes\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    IgnoreRhosts yes\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-7 (1)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\"]\n  tag cis_rid: \"5.2.8\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('IgnoreRhosts') { should cmp 'yes' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.8.rb",
                "line": 3
            },
            "id": "C-5.2.8"
        },
        {
            "title": "Ensure nosuid option set on removable media partitions",
            "desc": "The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.",
            "descriptions": {
                "default": "The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.",
                "rationale": "Setting this option on a file system prevents users from\nintroducing privileged programs onto the system and allowing non-root users to\nexecute them.",
                "check": "Run the following command and verify that the `nosuid` option is set on all\nremovable media partitions.\n\n    ```\n    # mount\n    ```",
                "fix": "Edit the `/etc/fstab` file and add `nosuid` to the fourth field\n(mounting options) of all removable media partitions. Look for entries that\nhave mount points that contain words such as floppy or cdrom. See the\n`fstab(5)` manual page for more information."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.19"
            },
            "code": "control \"C-1.1.19\" do\n  title \"Ensure nosuid option set on removable media partitions\"\n  desc  \"The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.\"\n  desc  \"rationale\", \"Setting this option on a file system prevents users from\nintroducing privileged programs onto the system and allowing non-root users to\nexecute them.\"\n  desc  \"check\", \"\n    Run the following command and verify that the `nosuid` option is set on all\nremovable media partitions.\n\n    ```\n    # mount\n    ```\n  \"\n  desc \"fix\", \"Edit the `/etc/fstab` file and add `nosuid` to the fourth field\n(mounting options) of all removable media partitions. Look for entries that\nhave mount points that contain words such as floppy or cdrom. See the\n`fstab(5)` manual page for more information.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.19\"\n\n  mounts = command('mount').stdout.strip.split(\"\\n\").\n      map do |d|\n    split_mounts = d.split(%r{\\s+})\n    options = split_mounts[-1].match(%r{\\((.*)\\)$}).captures.first.split(',')\n    dev_file = file(split_mounts[0])\n    dev_link = dev_file.symlink? ? dev_file.link_path : dev_file.path\n    {'dev'=>split_mounts[0], 'link'=>dev_link, 'mount'=>split_mounts[2], 'options'=>options}\n  end\n\n  dev_mounts = mounts.\n      select { |mnt| mnt['dev'].start_with? '/' and !mnt['dev'].start_with? '//' }.\n      map do |mnt|\n    # https://unix.stackexchange.com/a/308724\n    partition = ['/sys/class/block', String(mnt['link']).sub(%r{^/dev/}, ''), 'partition'].join('/')\n    if file(partition).exist?\n      # root_dev = command('basename \"$(readlink -f \"/sys/class/block/sda1/..\")\"').stdout.strip\n      root_dev = mount('/').device()\n    else\n      mnt['root_dev'] = mnt['link']\n    end\n    mnt\n  end\n\n  removable_mounts = dev_mounts.select do |mnt|\n    removable = ['/sys/block', String(mnt['root_dev']).sub(%r{^/dev/}, ''), 'removable'].join('/')\n    #file(removable).content.strip == '1'\n    file(removable).file.stat.length > 0\n  end\n\n  if removable_mounts.empty?\n    describe \"Removable mounted devices\" do\n      subject { removable_mounts }\n      it { should be_empty }\n    end\n  else\n    removable_mounts.each do |mnt|\n      describe mount(mnt) do\n        it { should be_mounted }\n        its('options') { should include 'nosuid' }\n      end\n    end\n  end\n\n  #/bin/mount | /bin/grep -P 'on[\\\\s]+/dev/(floppy|cdrom|corder|mmcblk)'\"\n  #\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.19.rb",
                "line": 3
            },
            "id": "C-1.1.19"
        },
        {
            "title": "Ensure ICMP redirects are not accepted",
            "desc": "ICMP redirect messages are packets that convey routing information and\ntell your host (acting as a router) to send packets via an alternate path. It\nis a way of allowing an outside routing device to update your system routing\ntables. By setting `net.ipv4.conf.all.accept_redirects` and\n`net.ipv6.conf.all.accept_redirects` to 0, the system will not accept any ICMP\nredirect messages, and therefore, won't allow outsiders to update the system's\nrouting tables.",
            "descriptions": {
                "default": "ICMP redirect messages are packets that convey routing information and\ntell your host (acting as a router) to send packets via an alternate path. It\nis a way of allowing an outside routing device to update your system routing\ntables. By setting `net.ipv4.conf.all.accept_redirects` and\n`net.ipv6.conf.all.accept_redirects` to 0, the system will not accept any ICMP\nredirect messages, and therefore, won't allow outsiders to update the system's\nrouting tables.",
                "rationale": "Attackers could use bogus ICMP redirect messages to\nmaliciously alter the system routing tables and get them to send packets to\nincorrect networks and allow your system packets to be captured.",
                "check": "Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.accept_redirects\n\n    net.ipv4.conf.all.accept_redirects = 0\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.accept_redirects\n\n    net.ipv4.conf.default.accept_redirects = 0\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.all\\.accept_redirects\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.accept_redirects= 0\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.default\\.accept_redirects\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.default.accept_redirects= 0\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.all.accept_redirects\n\n    net.ipv6.conf.all.accept_redirects = 0\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.default.accept_redirects\n\n    net.ipv6.conf.default.accept_redirects = 0\n    ```\n\n    ```\n    # grep \"net\\.ipv6\\.conf\\.all\\.accept_redirects\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv6.conf.all.accept_redirects= 0\n    ```\n\n    ```\n    # grep \"net\\.ipv6\\.conf\\.default\\.accept_redirects\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv6.conf.default.accept_redirects= 0\n    ```",
                "fix": "Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.accept_redirects = 0\n    net.ipv4.conf.default.accept_redirects = 0\n    net.ipv6.conf.all.accept_redirects = 0\n    net.ipv6.conf.default.accept_redirects = 0\n    ```\n    Run the following commands to set the active kernel parameters:\n    ```\n    # sysctl -w net.ipv4.conf.all.accept_redirects=0\n    # sysctl -w net.ipv4.conf.default.accept_redirects=0\n    # sysctl -w net.ipv6.conf.all.accept_redirects=0\n    # sysctl -w net.ipv6.conf.default.accept_redirects=0\n    # sysctl -w net.ipv4.route.flush=1\n    # sysctl -w net.ipv6.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.2.2"
            },
            "code": "control \"C-3.2.2\" do\n  title \"Ensure ICMP redirects are not accepted\"\n  desc  \"ICMP redirect messages are packets that convey routing information and\ntell your host (acting as a router) to send packets via an alternate path. It\nis a way of allowing an outside routing device to update your system routing\ntables. By setting `net.ipv4.conf.all.accept_redirects` and\n`net.ipv6.conf.all.accept_redirects` to 0, the system will not accept any ICMP\nredirect messages, and therefore, won't allow outsiders to update the system's\nrouting tables.\"\n  desc  \"rationale\", \"Attackers could use bogus ICMP redirect messages to\nmaliciously alter the system routing tables and get them to send packets to\nincorrect networks and allow your system packets to be captured.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.accept_redirects\n\n    net.ipv4.conf.all.accept_redirects = 0\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.accept_redirects\n\n    net.ipv4.conf.default.accept_redirects = 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_redirects\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.accept_redirects= 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_redirects\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.default.accept_redirects= 0\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.all.accept_redirects\n\n    net.ipv6.conf.all.accept_redirects = 0\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.default.accept_redirects\n\n    net.ipv6.conf.default.accept_redirects = 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_redirects\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv6.conf.all.accept_redirects= 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_redirects\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv6.conf.default.accept_redirects= 0\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.accept_redirects = 0\n    net.ipv4.conf.default.accept_redirects = 0\n    net.ipv6.conf.all.accept_redirects = 0\n    net.ipv6.conf.default.accept_redirects = 0\n    ```\n    Run the following commands to set the active kernel parameters:\n    ```\n    # sysctl -w net.ipv4.conf.all.accept_redirects=0\n    # sysctl -w net.ipv4.conf.default.accept_redirects=0\n    # sysctl -w net.ipv6.conf.all.accept_redirects=0\n    # sysctl -w net.ipv6.conf.default.accept_redirects=0\n    # sysctl -w net.ipv4.route.flush=1\n    # sysctl -w net.ipv6.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.2.2\"\n\n  describe kernel_parameter('net.ipv4.conf.all.accept_redirects') do\n    its('value') { should cmp '0' }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.accept_redirects') do\n    its('value') { should cmp '0' }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.all.accept_redirects') do\n    its('value') { should cmp '0' }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.default.accept_redirects') do\n    its('value') { should cmp '0' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.2.2.rb",
                "line": 3
            },
            "id": "C-3.2.2"
        },
        {
            "title": "Ensure events that modify date and time information are collected",
            "desc": "Capture events where the system date and/or time has been modified.\nThe parameters in this section are set to determine if the `adjtimex` (tune\nkernel clock), `settimeofday` (Set time, using timeval and timezone structures)\n`stime` (using seconds since 1/1/1970) or `clock_settime` (allows for the\nsetting of several internal clocks and timers) system calls have been executed\nand always write an audit record to the `/var/log/audit.log` file upon exit,\ntagging the records with the identifier \"time-change\"",
            "descriptions": {
                "default": "Capture events where the system date and/or time has been modified.\nThe parameters in this section are set to determine if the `adjtimex` (tune\nkernel clock), `settimeofday` (Set time, using timeval and timezone structures)\n`stime` (using seconds since 1/1/1970) or `clock_settime` (allows for the\nsetting of several internal clocks and timers) system calls have been executed\nand always write an audit record to the `/var/log/audit.log` file upon exit,\ntagging the records with the identifier \"time-change\"",
                "rationale": "Unexpected changes in system date and/or time could be a\nsign of malicious activity on the system.",
                "check": "On a 32 bit system run the following commands:\n\n    ```\n    # grep time-change /etc/audit/rules.d/*.rules\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k\ntime-change\n    -a always,exit -F arch=b32 -S clock_settime -k time-change\n    -w /etc/localtime -p wa -k time-change\n    ```\n\n    ```\n    # auditctl -l | grep time-change\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S stime,settimeofday,adjtimex -F key=time-change\n    -a always,exit -F arch=b32 -S clock_settime -F key=time-change\n    -w /etc/localtime -p wa -k time-change\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep time-change /etc/audit/rules.d/*.rules\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change\n    -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k\ntime-change\n    -a always,exit -F arch=b64 -S clock_settime -k time-change\n    -a always,exit -F arch=b32 -S clock_settime -k time-change\n    -w /etc/localtime -p wa -k time-change\n    ```\n\n    ```\n    # auditctl -l | grep time-change\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=time-change\n    -a always,exit -F arch=b32 -S stime,settimeofday,adjtimex -F key=time-change\n    -a always,exit -F arch=b64 -S clock_settime -F key=time-change\n    -a always,exit -F arch=b32 -S clock_settime -F key=time-change\n    -w /etc/localtime -p wa -k time-change\n    ```",
                "fix": "For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/time-change.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k\ntime-change\n    -a always,exit -F arch=b32 -S clock_settime -k time-change\n    -w /etc/localtime -p wa -k time-change\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/time-change.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change\n    -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k\ntime-change\n    -a always,exit -F arch=b64 -S clock_settime -k time-change\n    -a always,exit -F arch=b32 -S clock_settime -k time-change\n    -w /etc/localtime -p wa -k time-change\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "CM-6 (1)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.5"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.3"
            },
            "code": "control \"C-4.1.3\" do\n  title \"Ensure events that modify date and time information are collected\"\n  desc  \"Capture events where the system date and/or time has been modified.\nThe parameters in this section are set to determine if the `adjtimex` (tune\nkernel clock), `settimeofday` (Set time, using timeval and timezone structures)\n`stime` (using seconds since 1/1/1970) or `clock_settime` (allows for the\nsetting of several internal clocks and timers) system calls have been executed\nand always write an audit record to the `/var/log/audit.log` file upon exit,\ntagging the records with the identifier \\\"time-change\\\"\"\n  desc  \"rationale\", \"Unexpected changes in system date and/or time could be a\nsign of malicious activity on the system.\"\n  desc  \"check\", \"\n    On a 32 bit system run the following commands:\n\n    ```\n    # grep time-change /etc/audit/rules.d/*.rules\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k\ntime-change\n    -a always,exit -F arch=b32 -S clock_settime -k time-change\n    -w /etc/localtime -p wa -k time-change\n    ```\n\n    ```\n    # auditctl -l | grep time-change\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S stime,settimeofday,adjtimex -F key=time-change\n    -a always,exit -F arch=b32 -S clock_settime -F key=time-change\n    -w /etc/localtime -p wa -k time-change\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep time-change /etc/audit/rules.d/*.rules\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change\n    -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k\ntime-change\n    -a always,exit -F arch=b64 -S clock_settime -k time-change\n    -a always,exit -F arch=b32 -S clock_settime -k time-change\n    -w /etc/localtime -p wa -k time-change\n    ```\n\n    ```\n    # auditctl -l | grep time-change\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=time-change\n    -a always,exit -F arch=b32 -S stime,settimeofday,adjtimex -F key=time-change\n    -a always,exit -F arch=b64 -S clock_settime -F key=time-change\n    -a always,exit -F arch=b32 -S clock_settime -F key=time-change\n    -w /etc/localtime -p wa -k time-change\n    ```\n  \"\n  desc  \"fix\", \"\n    For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/time-change.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k\ntime-change\n    -a always,exit -F arch=b32 -S clock_settime -k time-change\n    -w /etc/localtime -p wa -k time-change\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/time-change.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change\n    -a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k\ntime-change\n    -a always,exit -F arch=b64 -S clock_settime -k time-change\n    -a always,exit -F arch=b32 -S clock_settime -k time-change\n    -w /etc/localtime -p wa -k time-change\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"CM-6 (1)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.5\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.3\"\n\n\n  ['adjtimex', 'settimeofday', 'stime', 'clock_settime'].each do |syscall|\n    describe auditd.syscall(syscall).where { arch == 'b32' && key == 'time-change'  } do\n      its('action.uniq') { should eq ['always'] }\n      its('list.uniq') { should eq ['exit'] }\n    end\n  end\n  \n  describe auditd.file('/etc/localtime').where { key == \"time-change\" } do\n    its('permissions') { should include ['w', 'a'] }\n  end\n\n  if os.arch.match?(/64/)\n    ['adjtimex', 'settimeofday', 'clock_settime'].each do |syscall|\n      describe auditd.syscall(syscall).where { arch == 'b64' && key == 'time-change'  } do\n        its('action.uniq') { should eq ['always'] }\n        its('list.uniq') { should eq ['exit'] }\n      end\n    end\n  end\n  \nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.3.rb",
                "line": 3
            },
            "id": "C-4.1.3"
        },
        {
            "title": "Ensure permissions on /etc/passwd are configured",
            "desc": "The `/etc/passwd` file contains user account information that is used\nby many system utilities and therefore must be readable for these utilities to\noperate.",
            "descriptions": {
                "default": "The `/etc/passwd` file contains user account information that is used\nby many system utilities and therefore must be readable for these utilities to\noperate.",
                "rationale": "It is critical to ensure that the `/etc/passwd` file is\nprotected from unauthorized write access. Although it is protected by default,\nthe file permissions could be changed either inadvertently or through malicious\nactions.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644`:\n\n    ```\n    # stat /etc/passwd\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following command to set permissions on `/etc/passwd`:\n\n```\n# chown root:root /etc/passwd\n```\n\n```\n# chmod u-x,go-wx /etc/passwd\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-28"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.2"
            },
            "code": "control \"C-6.1.2\" do\n  title \"Ensure permissions on /etc/passwd are configured\"\n  desc  \"The `/etc/passwd` file contains user account information that is used\nby many system utilities and therefore must be readable for these utilities to\noperate.\"\n  desc  \"rationale\", \"It is critical to ensure that the `/etc/passwd` file is\nprotected from unauthorized write access. Although it is protected by default,\nthe file permissions could be changed either inadvertently or through malicious\nactions.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644`:\n\n    ```\n    # stat /etc/passwd\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to set permissions on `/etc/passwd`:\n\n    ```\n    # chown root:root /etc/passwd\n    ```\n\n    ```\n    # chmod u-x,go-wx /etc/passwd\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-28\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.2\"\n\n  describe file('/etc/passwd') do\n    it { should_not be_more_permissive_than('0644') }\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.2.rb",
                "line": 3
            },
            "id": "C-6.1.2"
        },
        {
            "title": "Ensure SSH AllowTcpForwarding is disabled",
            "desc": "SSH port forwarding is a mechanism in SSH for tunneling application\nports from the client to the server, or servers to clients. It can be used for\nadding encryption to legacy applications, going through firewalls, and some\nsystem administrators and IT professionals use it for opening backdoors into\nthe internal network from their home machines",
            "descriptions": {
                "default": "SSH port forwarding is a mechanism in SSH for tunneling application\nports from the client to the server, or servers to clients. It can be used for\nadding encryption to legacy applications, going through firewalls, and some\nsystem administrators and IT professionals use it for opening backdoors into\nthe internal network from their home machines",
                "rationale": "Leaving port forwarding enabled can expose the organization to security\nrisks and back-doors.\n\n    SSH connections are protected with strong encryption. This makes their\ncontents invisible to most deployed network monitoring and traffic filtering\nsolutions. This invisibility carries considerable risk potential if it is used\nfor malicious purposes such as data exfiltration. Cybercriminals or malware\ncould exploit SSH to hide their unauthorized communications, or to exfiltrate\nstolen data from the target network",
                "check": "Run the following command and verify that output matches:\n\n```\n# sshd -T | grep -i allowtcpforwarding\n\nAllowTcpForwarding no\n```",
                "fix": "Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\n```\nAllowTcpForwarding no\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "CM-7 (1)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "9.2"
                ],
                "cis_rid": "5.2.21",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.21\" do\n  title \"Ensure SSH AllowTcpForwarding is disabled\"\n  desc  \"SSH port forwarding is a mechanism in SSH for tunneling application\nports from the client to the server, or servers to clients. It can be used for\nadding encryption to legacy applications, going through firewalls, and some\nsystem administrators and IT professionals use it for opening backdoors into\nthe internal network from their home machines\"\n  desc  \"rationale\", \"\n    Leaving port forwarding enabled can expose the organization to security\nrisks and back-doors.\n\n    SSH connections are protected with strong encryption. This makes their\ncontents invisible to most deployed network monitoring and traffic filtering\nsolutions. This invisibility carries considerable risk potential if it is used\nfor malicious purposes such as data exfiltration. Cybercriminals or malware\ncould exploit SSH to hide their unauthorized communications, or to exfiltrate\nstolen data from the target network\n  \"\n  desc  \"check\", \"\n    Run the following command and verify that output matches:\n\n    ```\n    # sshd -T | grep -i allowtcpforwarding\n\n    AllowTcpForwarding no\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the /etc/ssh/sshd_config file to set the parameter as follows:\n\n    ```\n    AllowTcpForwarding no\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"CM-7 (1)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"9.2\"]\n  tag cis_rid: \"5.2.21\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('AllowTcpForwarding') { should cmp 'no' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.21.rb",
                "line": 3
            },
            "id": "C-5.2.21"
        },
        {
            "title": "Ensure nosuid option set on /tmp partition",
            "desc": "The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.",
            "descriptions": {
                "default": "The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.",
                "rationale": "Since the `/tmp` filesystem is only intended for\ntemporary file storage, set this option to ensure that users cannot create\n`setuid` files in `/tmp` .",
                "check": "Verify that the `nosuid` option is set if a `/tmp` partition exists\n\nRun the following command and verify that nothing is returned:\n\n```\n# mount | grep -E '\\s/tmp\\s' | grep -v nosuid\n```",
                "fix": "Edit the `/etc/fstab` file and add `nosuid` to the fourth field (mounting\noptions) for the `/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/tmp` :\n    ```\n    # mount -o remount,nosuid /tmp\n    ```\n\n    or\n\n    Edit `/etc/systemd/system/local-fs.target.wants/tmp.mount` to add `nosuid`\nto the `/tmp` mount options:\n    ```\n    [Mount]\n    Options=mode=1777,strictatime,noexec,nodev,nosuid\n    ```\n    Run the following command to remount `/tmp` :\n    ```\n    # mount -o remount,nosuid /tmp\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.4"
            },
            "code": "control \"C-1.1.4\" do\n  title \"Ensure nosuid option set on /tmp partition\"\n  desc  \"The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.\"\n  desc  \"rationale\", \"Since the `/tmp` filesystem is only intended for\ntemporary file storage, set this option to ensure that users cannot create\n`setuid` files in `/tmp` .\"\n  desc  \"check\", \"\n    Verify that the `nosuid` option is set if a `/tmp` partition exists\n\n    Run the following command and verify that nothing is returned:\n\n    ```\n    # mount | grep -E '\\\\s/tmp\\\\s' | grep -v nosuid\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/fstab` file and add `nosuid` to the fourth field (mounting\noptions) for the `/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/tmp` :\n    ```\n    # mount -o remount,nosuid /tmp\n    ```\n\n    or\n\n    Edit `/etc/systemd/system/local-fs.target.wants/tmp.mount` to add `nosuid`\nto the `/tmp` mount options:\n    ```\n    [Mount]\n    Options=mode=1777,strictatime,noexec,nodev,nosuid\n    ```\n    Run the following command to remount `/tmp` :\n    ```\n    # mount -o remount,nosuid /tmp\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.4\"\n\n  describe mount('/tmp') do\n    its('options') { should  include 'nosuid' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.4.rb",
                "line": 3
            },
            "id": "C-1.1.4"
        },
        {
            "title": "Ensure no legacy \"+\" entries exist in /etc/group",
            "desc": "The character + in various files used to be markers for systems to\ninsert data from NIS maps at a certain point in a system configuration file.\nThese entries are no longer required on most systems, but may exist in files\nthat have been imported from other platforms.",
            "descriptions": {
                "default": "The character + in various files used to be markers for systems to\ninsert data from NIS maps at a certain point in a system configuration file.\nThese entries are no longer required on most systems, but may exist in files\nthat have been imported from other platforms.",
                "rationale": "These entries may provide an avenue for attackers to gain\nprivileged access on the system.",
                "check": "Run the following command and verify that no output is returned:\n\n```\n# grep '^\\+:' /etc/group\n```",
                "fix": "Remove any legacy '+' entries from `/etc/group` if they exist."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-2"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.2"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.5"
            },
            "code": "control \"C-6.2.5\" do\n  title \"Ensure no legacy \\\"+\\\" entries exist in /etc/group\"\n  desc  \"The character + in various files used to be markers for systems to\ninsert data from NIS maps at a certain point in a system configuration file.\nThese entries are no longer required on most systems, but may exist in files\nthat have been imported from other platforms.\"\n  desc  \"rationale\", \"These entries may provide an avenue for attackers to gain\nprivileged access on the system.\"\n  desc  \"check\", \"\n    Run the following command and verify that no output is returned:\n\n    ```\n    # grep '^\\\\+:' /etc/group\n    ```\n  \"\n  desc \"fix\", \"Remove any legacy '+' entries from `/etc/group` if they exist.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-2\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.2\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.5\"\n\n  describe command(\"grep '^\\\\+:' /etc/group\").stdout.strip do\n    it { should be_empty }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.5.rb",
                "line": 3
            },
            "id": "C-6.2.5"
        },
        {
            "title": "Ensure only strong Key Exchange algorithms are used",
            "desc": "Key exchange is any method in cryptography by which cryptographic keys\nare exchanged between two parties, allowing use of a cryptographic algorithm.\nIf the sender and receiver wish to exchange encrypted messages, each must be\nequipped to encrypt messages to be sent and decrypt messages received",
            "descriptions": {
                "default": "Key exchange is any method in cryptography by which cryptographic keys\nare exchanged between two parties, allowing use of a cryptographic algorithm.\nIf the sender and receiver wish to exchange encrypted messages, each must be\nequipped to encrypt messages to be sent and decrypt messages received",
                "rationale": "Key exchange methods that are considered weak should be\nremoved. A key exchange method may be weak because too few bits are used, or\nthe hashing algorithm is considered too weak. Using weak algorithms could\nexpose connections to man-in-the-middle attacks",
                "check": "Run the following command and verify that output does not contain any of\nthe listed weak Key Exchange algorithms\n\n    ```\n    # sshd -T | grep kexalgorithms\n    ```\n\n    Weak Key Exchange Algorithms:\n\n    ```\n    diffie-hellman-group1-sha1\n    diffie-hellman-group14-sha1\n    diffie-hellman-group-exchange-sha1\n    ```",
                "fix": "Edit the /etc/ssh/sshd_config file add/modify the KexAlgorithms line to\ncontain a comma separated list of the site approved key exchange algorithms\n\n    Example:\n\n    ```\n    KexAlgorithms\ncurve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-8"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.4"
                ],
                "cis_rid": "5.2.15",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.15\" do\n  title \"Ensure only strong Key Exchange algorithms are used\"\n  desc  \"Key exchange is any method in cryptography by which cryptographic keys\nare exchanged between two parties, allowing use of a cryptographic algorithm.\nIf the sender and receiver wish to exchange encrypted messages, each must be\nequipped to encrypt messages to be sent and decrypt messages received\"\n  desc  \"rationale\", \"Key exchange methods that are considered weak should be\nremoved. A key exchange method may be weak because too few bits are used, or\nthe hashing algorithm is considered too weak. Using weak algorithms could\nexpose connections to man-in-the-middle attacks\"\n  desc  \"check\", \"\n    Run the following command and verify that output does not contain any of\nthe listed weak Key Exchange algorithms\n\n    ```\n    # sshd -T | grep kexalgorithms\n    ```\n\n    Weak Key Exchange Algorithms:\n\n    ```\n    diffie-hellman-group1-sha1\n    diffie-hellman-group14-sha1\n    diffie-hellman-group-exchange-sha1\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the /etc/ssh/sshd_config file add/modify the KexAlgorithms line to\ncontain a comma separated list of the site approved key exchange algorithms\n\n    Example:\n\n    ```\n    KexAlgorithms\ncurve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-8\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.4\"]\n  tag cis_rid: \"5.2.15\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  cfg = sshd_config\n  describe cfg do\n    describe 'it should have defined KexAlgorithms' do\n      subject { cfg.KexAlgorithms }\n        it { should_not be_empty }\n    end\n    its('KexAlgorithms') { should_not include(\n      'diffie-hellman-group1-sha1',\n      'diffie-hellman-group14-sha1',\n      'diffie-hellman-group-exchange-sha1') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.15.rb",
                "line": 3
            },
            "id": "C-5.2.15"
        },
        {
            "title": "Ensure rsyslog Service is enabled",
            "desc": "Once the `rsyslog` package is installed it needs to be activated.",
            "descriptions": {
                "default": "Once the `rsyslog` package is installed it needs to be activated.",
                "rationale": "If the `rsyslog` service is not activated the system may\ndefault to the `syslogd` service or lack logging instead.",
                "check": "Run one of the following commands to verify `rsyslog` is enabled:\n\n```\n# systemctl is-enabled rsyslog\n```\n\nVerify result is `enabled`.",
                "fix": "Run the following commands to enable `rsyslog`:\n\n```\n# systemctl --now enable rsyslog\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-12",
                    "AU-3",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.2",
                    "6.3",
                    "Rev_7"
                ],
                "cis_rid": "4.2.1.2"
            },
            "code": "control \"C-4.2.1.2\" do\n  title \"Ensure rsyslog Service is enabled\"\n  desc  \"Once the `rsyslog` package is installed it needs to be activated.\"\n  desc  \"rationale\", \"If the `rsyslog` service is not activated the system may\ndefault to the `syslogd` service or lack logging instead.\"\n  desc  \"check\", \"\n    Run one of the following commands to verify `rsyslog` is enabled:\n\n    ```\n    # systemctl is-enabled rsyslog\n    ```\n\n    Verify result is `enabled`.\n  \"\n  desc  \"fix\", \"\n    Run the following commands to enable `rsyslog`:\n\n    ```\n    # systemctl --now enable rsyslog\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-12\", \"AU-3\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.2\", \"6.3\", \"Rev_7\"]\n  tag cis_rid: \"4.2.1.2\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.2.1.2.rb",
                "line": 3
            },
            "id": "C-4.2.1.2"
        },
        {
            "title": "Ensure system accounts are secured",
            "desc": "There are a number of accounts provided with most distributions that\nare used to manage applications and are not intended to provide an interactive\nshell.",
            "descriptions": {
                "default": "There are a number of accounts provided with most distributions that\nare used to manage applications and are not intended to provide an interactive\nshell.",
                "rationale": "It is important to make sure that accounts that are not\nbeing used by regular users are prevented from being used to provide an\ninteractive shell. By default, most distributions set the password field for\nthese accounts to an invalid string, but it is also recommended that the shell\nfield in the password file be set to the `nologin` shell. This prevents the\naccount from potentially being used to run any commands.",
                "check": "Run the following commands and verify no results are returned:\n\n    ```\n    awk -F: '($1!=\"root\" && $1!=\"sync\" && $1!=\"shutdown\" && $1!=\"halt\"\n&& $1!~/^\\+/ && $3",
                "fix": "Run the commands appropriate for your distribution:\n\n    Set the shell for any accounts returned by the audit to nologin:\n\n    ```\n    # usermod -s $(which nologin)\n    ```\n\n    Lock any non root accounts returned by the audit:\n\n    ```\n    # usermod -L\n    ```\n\n    The following command will set all system accounts to a non login shell:\n\n    ```\n    awk -F: '($1!=\"root\" && $1!=\"sync\" && $1!=\"shutdown\" && $1!=\"halt\"\n&& $1!~/^\\+/ && $3"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-2",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16",
                    "Rev_7"
                ],
                "cis_rid": "5.4.2"
            },
            "code": "control \"C-5.4.2\" do\n  title \"Ensure system accounts are secured\"\n  desc  \"There are a number of accounts provided with most distributions that\nare used to manage applications and are not intended to provide an interactive\nshell.\"\n  desc  \"rationale\", \"It is important to make sure that accounts that are not\nbeing used by regular users are prevented from being used to provide an\ninteractive shell. By default, most distributions set the password field for\nthese accounts to an invalid string, but it is also recommended that the shell\nfield in the password file be set to the `nologin` shell. This prevents the\naccount from potentially being used to run any commands.\"\n  desc  \"check\", \"\n    Run the following commands and verify no results are returned:\n\n    ```\n    awk -F: '($1!=\\\"root\\\" && $1!=\\\"sync\\\" && $1!=\\\"shutdown\\\" && $1!=\\\"halt\\\"\n&& $1!~/^\\\\+/ && $3\n  \"\n  desc  \"fix\", \"\n    Run the commands appropriate for your distribution:\n\n    Set the shell for any accounts returned by the audit to nologin:\n\n    ```\n    # usermod -s $(which nologin)\n    ```\n\n    Lock any non root accounts returned by the audit:\n\n    ```\n    # usermod -L\n    ```\n\n    The following command will set all system accounts to a non login shell:\n\n    ```\n    awk -F: '($1!=\\\"root\\\" && $1!=\\\"sync\\\" && $1!=\\\"shutdown\\\" && $1!=\\\"halt\\\"\n&& $1!~/^\\\\+/ && $3\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-2\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16\", \"Rev_7\"]\n  tag cis_rid: \"5.4.2\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.4.2.rb",
                "line": 3
            },
            "id": "C-5.4.2"
        },
        {
            "title": "Ensure no unowned files or directories exist",
            "desc": "Sometimes when administrators delete users from the password file they\nneglect to remove all files owned by those users from the system.",
            "descriptions": {
                "default": "Sometimes when administrators delete users from the password file they\nneglect to remove all files owned by those users from the system.",
                "rationale": "A new user who is assigned the deleted user's user ID or\ngroup ID may then end up \"owning\" these files, and thus have more access on\nthe system than was intended.",
                "check": "Run the following command and verify no files are returned:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -nouser\n    ```\n\n    The command above only searches local filesystems, there may still be\ncompromised items on network mounted partitions. Additionally the `--local`\noption to `df` is not universal to all versions, it can be omitted to search\nall filesystems on a system including network mounted filesystems or the\nfollowing command can be run manually for each partition:\n\n    ```\n    # find\n\n    \t -xdev -nouser\n    ```",
                "fix": "Locate files that are owned by users or groups not listed in\nthe system configuration files, and reset the ownership of these files to some\nactive user on the system as appropriate."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-8 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "13.2"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.11"
            },
            "code": "control \"C-6.1.11\" do\n  title \"Ensure no unowned files or directories exist\"\n  desc  \"Sometimes when administrators delete users from the password file they\nneglect to remove all files owned by those users from the system.\"\n  desc  \"rationale\", \"A new user who is assigned the deleted user's user ID or\ngroup ID may then end up \\\"owning\\\" these files, and thus have more access on\nthe system than was intended.\"\n  desc  \"check\", \"\n    Run the following command and verify no files are returned:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -nouser\n    ```\n\n    The command above only searches local filesystems, there may still be\ncompromised items on network mounted partitions. Additionally the `--local`\noption to `df` is not universal to all versions, it can be omitted to search\nall filesystems on a system including network mounted filesystems or the\nfollowing command can be run manually for each partition:\n\n    ```\n    # find\n\n    \\t -xdev -nouser\n    ```\n  \"\n  desc \"fix\", \"Locate files that are owned by users or groups not listed in\nthe system configuration files, and reset the ownership of these files to some\nactive user on the system as appropriate.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-8 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"13.2\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.11\"\n\n  describe command(\"df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -nouser\") do\n    its('stdout') { should be_empty }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.11.rb",
                "line": 3
            },
            "id": "C-6.1.11"
        },
        {
            "title": "Ensure sudo commands use pty",
            "desc": "sudo can be configured to run only from a psuedo-pty",
            "descriptions": {
                "default": "sudo can be configured to run only from a psuedo-pty",
                "rationale": "Attackers can run a malicious program using sudo, which\nwould again fork a background process that remains even when the main program\nhas finished executing.",
                "check": "Verify that sudo can only run other commands from a psuedo-pty\n\n    Run the following command:\n\n    ```\n    # grep -Ei\n'^\\s*Defaults\\s+([^#]+,\\s*)?use_pty(,\\s+\\S+\\s*)*(\\s+#.*)?$' /etc/sudoers\n/etc/sudoers.d/*\n\n    Defaults use_pty\n    ```",
                "fix": "edit the file `/etc/sudoers` or a file in `/etc/sudoers.d/` and add the\nfollowing line:\n\n    ```\n    Defaults use_pty\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-6 (9)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.3",
                    "Rev_7"
                ],
                "cis_rid": "1.3.2"
            },
            "code": "control \"C-1.3.2\" do\n  title \"Ensure sudo commands use pty\"\n  desc  \"sudo can be configured to run only from a psuedo-pty\"\n  desc  \"rationale\", \"Attackers can run a malicious program using sudo, which\nwould again fork a background process that remains even when the main program\nhas finished executing.\"\n  desc  \"check\", \"\n    Verify that sudo can only run other commands from a psuedo-pty\n\n    Run the following command:\n\n    ```\n    # grep -Ei\n'^\\\\s*Defaults\\\\s+([^#]+,\\\\s*)?use_pty(,\\\\s+\\\\S+\\\\s*)*(\\\\s+#.*)?$' /etc/sudoers\n/etc/sudoers.d/*\n\n    Defaults use_pty\n    ```\n  \"\n  desc \"fix\", \"\n    edit the file `/etc/sudoers` or a file in `/etc/sudoers.d/` and add the\nfollowing line:\n\n    ```\n    Defaults use_pty\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-6 (9)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.3\", \"Rev_7\"]\n  tag cis_rid: \"1.3.2\"\n\n  describe command(\"grep -Ei '^\\\\s*Defaults\\\\s+([^#]+,\\\\s*)?use_pty(,\\\\s+\\\\S+\\\\s*)*(\\\\s+#.*)?$' /etc/sudoers /etc/sudoers.d/*\").stdout.strip.split(\"\\n\") do\n    its('length') { should be > 0 }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.3.2.rb",
                "line": 3
            },
            "id": "C-1.3.2"
        },
        {
            "title": "Ensure /etc/hosts.deny is configured",
            "desc": "The `/etc/hosts.deny` file specifies which IP addresses are **not**\npermitted to connect to the host. It is intended to be used in conjunction with\nthe `/etc/hosts.allow` file.",
            "descriptions": {
                "default": "The `/etc/hosts.deny` file specifies which IP addresses are **not**\npermitted to connect to the host. It is intended to be used in conjunction with\nthe `/etc/hosts.allow` file.",
                "rationale": "The `/etc/hosts.deny` file serves as a failsafe so that\nany host not specified in `/etc/hosts.allow` is denied access to the system.",
                "check": "Run the following command and verify the contents of the `/etc/hosts.deny`\nfile:\n\n    ```\n    # cat /etc/hosts.deny\n    ALL: ALL\n    ```",
                "fix": "Run the following command to create `/etc/hosts.deny`:\n\n```\n# echo \"ALL: ALL\" >> /etc/hosts.deny\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.3.3"
            },
            "code": "control \"C-3.3.3\" do\n  title \"Ensure /etc/hosts.deny is configured\"\n  desc  \"The `/etc/hosts.deny` file specifies which IP addresses are **not**\npermitted to connect to the host. It is intended to be used in conjunction with\nthe `/etc/hosts.allow` file.\"\n  desc  \"rationale\", \"The `/etc/hosts.deny` file serves as a failsafe so that\nany host not specified in `/etc/hosts.allow` is denied access to the system.\"\n  desc  \"check\", \"\n    Run the following command and verify the contents of the `/etc/hosts.deny`\nfile:\n\n    ```\n    # cat /etc/hosts.deny\n    ALL: ALL\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to create `/etc/hosts.deny`:\n\n    ```\n    # echo \\\"ALL: ALL\\\" >> /etc/hosts.deny\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.3.3\"\n\n  if file('/etc/hosts.deny').exist?\n    my_hosts_deny = command('cat /etc/hosts.allow').stdout.strip\n    describe \"Contents of /etc/hosts.deny shall be evaluated manually \" do\n      skip \" Contents of /etc/hosts.deny shall be evaluated manually.\\n #{my_hosts_deny} \"\n    end\n  else\n    describe file('/etc/hosts.deny') do\n      it { should exist }\n    end\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.3.3.rb",
                "line": 3
            },
            "id": "C-3.3.3"
        },
        {
            "title": "Ensure permissions on /etc/gshadow are configured",
            "desc": "The `/etc/gshadow` file is used to store the information about groups\nthat is critical to the security of those accounts, such as the hashed password\nand other security information.",
            "descriptions": {
                "default": "The `/etc/gshadow` file is used to store the information about groups\nthat is critical to the security of those accounts, such as the hashed password\nand other security information.",
                "rationale": "If attackers can gain read access to the `/etc/gshadow`\nfile, they can easily run a password cracking program against the hashed\npassword to break it. Other security information that is stored in the\n`/etc/gshadow` file (such as group administrators) could also be useful to\nsubvert the group.",
                "check": "Run the following command and verify `Uid` is `0/root,` `Gid` is `/shadow,`\nand `Access` is `640` or more restrictive:\n\n    ```\n    # stat /etc/gshadow\n\n    Access: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 42/ shadow)\n    ```",
                "fix": "Run the following commands to set permissions on `/etc/gshadow`:\n\n```\n# chown root:shadow /etc/gshadow\n\n# chmod o-rwx,g-wx /etc/gshadow\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-28"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.9"
            },
            "code": "control \"C-6.1.9\" do\n  title \"Ensure permissions on /etc/gshadow are configured\"\n  desc  \"The `/etc/gshadow` file is used to store the information about groups\nthat is critical to the security of those accounts, such as the hashed password\nand other security information.\"\n  desc  \"rationale\", \"If attackers can gain read access to the `/etc/gshadow`\nfile, they can easily run a password cracking program against the hashed\npassword to break it. Other security information that is stored in the\n`/etc/gshadow` file (such as group administrators) could also be useful to\nsubvert the group.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` is `0/root,` `Gid` is `/shadow,`\nand `Access` is `640` or more restrictive:\n\n    ```\n    # stat /etc/gshadow\n\n    Access: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 42/ shadow)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set permissions on `/etc/gshadow`:\n\n    ```\n    # chown root:shadow /etc/gshadow\n\n    # chmod o-rwx,g-wx /etc/gshadow\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-28\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.9\"\n\n  describe file('/etc/gshadow') do\n    it { should_not be_more_permissive_than('0640') }\n    it { should be_owned_by 'root' }\n    its('group') { should cmp 'shadow' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.9.rb",
                "line": 3
            },
            "id": "C-6.1.9"
        },
        {
            "title": "Ensure users' dot files are not group or world writable",
            "desc": "While the system administrator can establish secure permissions for\nusers' \"dot\" files, the users can easily override these.",
            "descriptions": {
                "default": "While the system administrator can establish secure permissions for\nusers' \"dot\" files, the users can easily override these.",
                "rationale": "Group or world-writable user configuration files may\nenable malicious users to steal or modify other users' data or to gain another\nuser's system privileges.",
                "check": "Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\"'\"$(which nologin)\"'\" & do\n     if [ ! -d \"$dir\" ]; then\n     echo \"The home directory \\\"$dir\\\" of user \\\"$user\\\" does not\nexist.\"\n     else\n     for file in \"$dir\"/.[A-Za-z0-9]*; do\n     if [ ! -h \"$file\" ] & then\n     fileperm=\"$(ls -ld \"$file\" | cut -f1 -d\" \")\"\n     if [ \"$(echo \"$fileperm\" | cut -c6)\" != \"-\" ]; then\n     echo \"Group Write permission set on file $file\"\n     fi\n     if [ \"$(echo \"$fileperm\" | cut -c9)\" != \"-\" ]; then\n     echo \"Other Write permission set on file \\\"$file\\\"\"\n     fi\n     fi\n     done\n     fi\n    done\n    ```",
                "fix": "Making global modifications to users' files without alerting\nthe user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser dot file permissions and determine the action to be taken in accordance\nwith site policy."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.10"
            },
            "code": "control \"C-6.2.10\" do\n  title \"Ensure users' dot files are not group or world writable\"\n  desc  \"While the system administrator can establish secure permissions for\nusers' \\\"dot\\\" files, the users can easily override these.\"\n  desc  \"rationale\", \"Group or world-writable user configuration files may\nenable malicious users to steal or modify other users' data or to gain another\nuser's system privileges.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\\\"'\\\"$(which nologin)\\\"'\\\" & do\n     if [ ! -d \\\"$dir\\\" ]; then\n     echo \\\"The home directory \\\\\\\"$dir\\\\\\\" of user \\\\\\\"$user\\\\\\\" does not\nexist.\\\"\n     else\n     for file in \\\"$dir\\\"/.[A-Za-z0-9]*; do\n     if [ ! -h \\\"$file\\\" ] & then\n     fileperm=\\\"$(ls -ld \\\"$file\\\" | cut -f1 -d\\\" \\\")\\\"\n     if [ \\\"$(echo \\\"$fileperm\\\" | cut -c6)\\\" != \\\"-\\\" ]; then\n     echo \\\"Group Write permission set on file $file\\\"\n     fi\n     if [ \\\"$(echo \\\"$fileperm\\\" | cut -c9)\\\" != \\\"-\\\" ]; then\n     echo \\\"Other Write permission set on file \\\\\\\"$file\\\\\\\"\\\"\n     fi\n     fi\n     done\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"Making global modifications to users' files without alerting\nthe user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser dot file permissions and determine the action to be taken in accordance\nwith site policy.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.10\"\n\n  nologin = command(\"which nologin\").stdout.strip\n  \n  passwd.where { user != 'halt' && user != 'sync' && user != 'shutdown' && shell != nologin }.entries.each do |user|\n    describe command(\"find #{user.home} -name '.*' -perm /022\" ) do\n      its('stdout.lines') { should be_empty }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.10.rb",
                "line": 3
            },
            "id": "C-6.2.10"
        },
        {
            "title": "Ensure separate partition exists for /var/log/audit",
            "desc": "The auditing daemon, `auditd` , stores log data in the\n`/var/log/audit` directory.",
            "descriptions": {
                "default": "The auditing daemon, `auditd` , stores log data in the\n`/var/log/audit` directory.",
                "rationale": "There are two important reasons to ensure that data\ngathered by `auditd` is stored on a separate partition: protection against\nresource exhaustion (since the `audit.log` file can grow quite large) and\nprotection of audit data. The audit daemon calculates how much free space is\nleft and performs actions based on the results. If other processes (such as\n`syslog` ) consume space in the same partition as `auditd` , it may not perform\nas desired.",
                "check": "Run the following command and verify output shows `/var/log/audit` is\nmounted:\n    ```\n    # mount | grep /var/log/audit\n    /dev/xvdi1 on /var/log/audit type ext4 (rw,relatime,data=ordered)\n    ```",
                "fix": "For new installations, during installation create a custom partition setup\nand specify a separate partition for `/var/log/audit` .\n\n    For systems that were previously installed, create a new partition and\nconfigure `/etc/fstab` as appropriate."
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-4",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "6.4",
                    "Rev_7"
                ],
                "cis_rid": "1.1.12"
            },
            "code": "control \"C-1.1.12\" do\n  title \"Ensure separate partition exists for /var/log/audit\"\n  desc  \"The auditing daemon, `auditd` , stores log data in the\n`/var/log/audit` directory.\"\n  desc  \"rationale\", \"There are two important reasons to ensure that data\ngathered by `auditd` is stored on a separate partition: protection against\nresource exhaustion (since the `audit.log` file can grow quite large) and\nprotection of audit data. The audit daemon calculates how much free space is\nleft and performs actions based on the results. If other processes (such as\n`syslog` ) consume space in the same partition as `auditd` , it may not perform\nas desired.\"\n  desc  \"check\", \"\n    Run the following command and verify output shows `/var/log/audit` is\nmounted:\n    ```\n    # mount | grep /var/log/audit\n    /dev/xvdi1 on /var/log/audit type ext4 (rw,relatime,data=ordered)\n    ```\n  \"\n  desc  \"fix\", \"\n    For new installations, during installation create a custom partition setup\nand specify a separate partition for `/var/log/audit` .\n\n    For systems that were previously installed, create a new partition and\nconfigure `/etc/fstab` as appropriate.\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-4\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"6.4\", \"Rev_7\"]\n  tag cis_rid: \"1.1.12\"\n\n  describe mount('/var/log/audit') do\n    it { should be_mounted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.12.rb",
                "line": 3
            },
            "id": "C-1.1.12"
        },
        {
            "title": "Ensure GDM login banner is configured",
            "desc": "GDM is the GNOME Display Manager which handles graphical login for\nGNOME based systems.",
            "descriptions": {
                "default": "GDM is the GNOME Display Manager which handles graphical login for\nGNOME based systems.",
                "rationale": "Warning messages inform users who are attempting to login\nto the system of their legal status regarding the system and must include the\nname of the organization that owns the system and any monitoring policies that\nare in place.",
                "check": "If GDM is installed on the system verify that\n`/etc/gdm3/greeter.dconf-defaults` file exists and contains the following:\n\n    ```\n    [org/gnome/login-screen]\n    banner-message-enable=true\n    banner-message-text=''\n    ```",
                "fix": "Edit or create the file `/etc/gdm3/greeter.dconf-defaults` and add the\nfollowing:\n\n    ```\n    [org/gnome/login-screen]\n    banner-message-enable=true\n    banner-message-text='Authorized uses only. All activity may be monitored\nand reported.'\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.8.2"
            },
            "code": "control \"C-1.8.2\" do\n  title \"Ensure GDM login banner is configured\"\n  desc  \"GDM is the GNOME Display Manager which handles graphical login for\nGNOME based systems.\"\n  desc  \"rationale\", \"Warning messages inform users who are attempting to login\nto the system of their legal status regarding the system and must include the\nname of the organization that owns the system and any monitoring policies that\nare in place.\"\n  desc  \"check\", \"\n    If GDM is installed on the system verify that\n`/etc/gdm3/greeter.dconf-defaults` file exists and contains the following:\n\n    ```\n    [org/gnome/login-screen]\n    banner-message-enable=true\n    banner-message-text=''\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create the file `/etc/gdm3/greeter.dconf-defaults` and add the\nfollowing:\n\n    ```\n    [org/gnome/login-screen]\n    banner-message-enable=true\n    banner-message-text='Authorized uses only. All activity may be monitored\nand reported.'\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.8.2\"\n\n  gnome_installed = (package('ubuntu-gnome-desktop').installed? || package('ubuntu-desktop').installed? || package('gdm3').installed?)\n\n  unless !package('gdm3').installed?\n    impact 0.0\n    describe \"The GNOME Display Manager (GDM3) Package is not installed on the system\" do\n      skip \"This control is Not Appliciable without the GNOME Display Manager (GDM3) Package installed.\"\n    end\n  else\n    describe file('/etc/gdm3/greeter.dconf-defaults') do\n      it { should exist }\n      its('content') { should match(%r{banner-message-text=}) }\n      end\n    describe parse_config_file('/etc/gdm3/greeter.dconf-defaults') do\n      its('banner-message-enable') { should cmp 'true' }\n      its('banner-message-enable') { should match %r{^true$}i }\n    end\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.8.2.rb",
                "line": 3
            },
            "id": "C-1.8.2"
        },
        {
            "title": "Ensure session initiation information is collected",
            "desc": "Monitor session initiation events. The parameters in this section\ntrack changes to the files associated with session events. The file\n`/var/run/utmp` tracks all currently logged in users. All audit records will be\ntagged with the identifier \"session.\" The `/var/log/wtmp` file tracks logins,\nlogouts, shutdown, and reboot events. The file `/var/log/btmp` keeps track of\nfailed login attempts and can be read by entering the command `/usr/bin/last -f\n/var/log/btmp` . All audit records will be tagged with the identifier\n\"logins.\"",
            "descriptions": {
                "default": "Monitor session initiation events. The parameters in this section\ntrack changes to the files associated with session events. The file\n`/var/run/utmp` tracks all currently logged in users. All audit records will be\ntagged with the identifier \"session.\" The `/var/log/wtmp` file tracks logins,\nlogouts, shutdown, and reboot events. The file `/var/log/btmp` keeps track of\nfailed login attempts and can be read by entering the command `/usr/bin/last -f\n/var/log/btmp` . All audit records will be tagged with the identifier\n\"logins.\"",
                "rationale": "Monitoring these files for changes could alert a system\nadministrator to logins occurring at unusual hours, which could indicate\nintruder activity (i.e. a user logging in at a time when they do not normally\nlog in).",
                "check": "Run the following commands:\n\n```\n# grep -E '(session|logins)' /etc/audit/rules.d/*.rules\n```\n\nVerify output includes:\n\n```\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k logins\n-w /var/log/btmp -p wa -k logins\n```\n\n```\n# auditctl -l | grep -E '(session|logins)'\n```\n\nVerify output includes:\n\n```\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k logins\n-w /var/log/btmp -p wa -k logins\n```",
                "fix": "Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/session.rules`\n\n    and add the following lines:\n\n    ```\n    -w /var/run/utmp -p wa -k session\n    -w /var/log/wtmp -p wa -k logins\n    -w /var/log/btmp -p wa -k logins\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-2",
                    "AC-11",
                    "AC-2(12)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "4.9",
                    "16.11",
                    "16.13"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.8"
            },
            "code": "control \"C-4.1.8\" do\n  title \"Ensure session initiation information is collected\"\n  desc  \"Monitor session initiation events. The parameters in this section\ntrack changes to the files associated with session events. The file\n`/var/run/utmp` tracks all currently logged in users. All audit records will be\ntagged with the identifier \\\"session.\\\" The `/var/log/wtmp` file tracks logins,\nlogouts, shutdown, and reboot events. The file `/var/log/btmp` keeps track of\nfailed login attempts and can be read by entering the command `/usr/bin/last -f\n/var/log/btmp` . All audit records will be tagged with the identifier\n\\\"logins.\\\"\"\n  desc  \"rationale\", \"Monitoring these files for changes could alert a system\nadministrator to logins occurring at unusual hours, which could indicate\nintruder activity (i.e. a user logging in at a time when they do not normally\nlog in).\"\n  desc  \"check\", \"\n    Run the following commands:\n\n    ```\n    # grep -E '(session|logins)' /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output includes:\n\n    ```\n    -w /var/run/utmp -p wa -k session\n    -w /var/log/wtmp -p wa -k logins\n    -w /var/log/btmp -p wa -k logins\n    ```\n\n    ```\n    # auditctl -l | grep -E '(session|logins)'\n    ```\n\n    Verify output includes:\n\n    ```\n    -w /var/run/utmp -p wa -k session\n    -w /var/log/wtmp -p wa -k logins\n    -w /var/log/btmp -p wa -k logins\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/session.rules`\n\n    and add the following lines:\n\n    ```\n    -w /var/run/utmp -p wa -k session\n    -w /var/log/wtmp -p wa -k logins\n    -w /var/log/btmp -p wa -k logins\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-2\", \"AC-11\", \"AC-2(12)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"4.9\", \"16.11\", \"16.13\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.8\"\n\n  files = [\n    '/var/log/wtmp',\n    '/var/log/btmp'\n  ]\n\n  files.each do |file|\n    describe auditd.file(file).where { key == \"logins\" } do\n      its('permissions') { should include ['w', 'a'] }\n    end\n  end\n\n\n  describe auditd.file('/var/run/utmp').where { key == \"session\" } do\n    its('permissions') { should include ['w', 'a'] }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.8.rb",
                "line": 3
            },
            "id": "C-4.1.8"
        },
        {
            "title": "Ensure IPv6 router advertisements are not accepted",
            "desc": "This setting disables the system's ability to accept IPv6 router\nadvertisements.",
            "descriptions": {
                "default": "This setting disables the system's ability to accept IPv6 router\nadvertisements.",
                "rationale": "It is recommended that systems do not accept router\nadvertisements as they could be tricked into routing traffic to compromised\nmachines. Setting hard routes within the system (usually a single default route\nto a trusted router) protects the system from bad routes.",
                "check": "Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv6.conf.all.accept_ra\n\n    net.ipv6.conf.all.accept_ra = 0\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.default.accept_ra\n\n    net.ipv6.conf.default.accept_ra = 0\n    ```\n\n    ```\n    # grep \"net\\.ipv6\\.conf\\.all\\.accept_ra\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv6.conf.all.accept_ra = 0\n    ```\n\n    ```\n    # grep \"net\\.ipv6\\.conf\\.default\\.accept_ra\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv6.conf.default.accept_ra = 0\n    ```",
                "fix": "Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv6.conf.all.accept_ra = 0\n    net.ipv6.conf.default.accept_ra = 0\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv6.conf.all.accept_ra=0\n    ```\n\n    ```\n    # sysctl -w net.ipv6.conf.default.accept_ra=0\n    ```\n\n    ```\n    # sysctl -w net.ipv6.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.2.9"
            },
            "code": "control \"C-3.2.9\" do\n  title \"Ensure IPv6 router advertisements are not accepted\"\n  desc  \"This setting disables the system's ability to accept IPv6 router\nadvertisements.\"\n  desc  \"rationale\", \"It is recommended that systems do not accept router\nadvertisements as they could be tricked into routing traffic to compromised\nmachines. Setting hard routes within the system (usually a single default route\nto a trusted router) protects the system from bad routes.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv6.conf.all.accept_ra\n\n    net.ipv6.conf.all.accept_ra = 0\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.default.accept_ra\n\n    net.ipv6.conf.default.accept_ra = 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_ra\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv6.conf.all.accept_ra = 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_ra\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv6.conf.default.accept_ra = 0\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv6.conf.all.accept_ra = 0\n    net.ipv6.conf.default.accept_ra = 0\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv6.conf.all.accept_ra=0\n    ```\n\n    ```\n    # sysctl -w net.ipv6.conf.default.accept_ra=0\n    ```\n\n    ```\n    # sysctl -w net.ipv6.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.2.9\"\n\n  describe kernel_parameter('net.ipv6.conf.all.accept_ra') do\n    its('value') { should cmp '0' }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.default.accept_ra') do\n    its('value') { should cmp '0' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.2.9.rb",
                "line": 3
            },
            "id": "C-3.2.9"
        },
        {
            "title": "Ensure default deny firewall policy",
            "desc": "Base chain policy is the default verdict that will be applied to\npackets reaching the end of the chain.",
            "descriptions": {
                "default": "Base chain policy is the default verdict that will be applied to\npackets reaching the end of the chain.",
                "rationale": "There are two policies: accept (Default) and drop. If the policy is set to\n`accept`, the firewall will accept any packet that is not configured to be\ndenied and the packet will continue transversing the network stack.\n\n    It is easier to white list acceptable usage than to black list unacceptable\nusage.",
                "check": "Run the following commands and verify that base chains contain a policy of\n`DROP`.\n\n    ```\n    # nft list ruleset | grep 'hook input'\n\n    type filter hook input priority 0; policy drop;\n    ```\n\n    ```\n    # nft list ruleset | grep 'hook forward'\n\n    type filter hook forward priority 0; policy drop;\n    ```\n\n    ```\n    # nft list ruleset | grep 'hook output'\n\n    type filter hook output priority 0; policy drop;\n    ```",
                "fix": "Run the following command for the base chains with the input, forward, and\noutput hooks to implement a default DROP policy:\n\n    ```\n    # nft chain\n\n      { policy drop \\; }\n    ```\n\n    Example:\n\n    ```\n    # nft chain inet filter input { policy drop \\; }\n\n    # nft chain inet filter forward { policy drop \\; }\n\n    # nft chain inet filter output { policy drop \\; }\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.3.6"
            },
            "code": "control \"C-3.5.3.6\" do\n  title \"Ensure default deny firewall policy\"\n  desc  \"Base chain policy is the default verdict that will be applied to\npackets reaching the end of the chain.\"\n  desc  \"rationale\", \"\n    There are two policies: accept (Default) and drop. If the policy is set to\n`accept`, the firewall will accept any packet that is not configured to be\ndenied and the packet will continue transversing the network stack.\n\n    It is easier to white list acceptable usage than to black list unacceptable\nusage.\n  \"\n  desc  \"check\", \"\n    Run the following commands and verify that base chains contain a policy of\n`DROP`.\n\n    ```\n    # nft list ruleset | grep 'hook input'\n\n    type filter hook input priority 0; policy drop;\n    ```\n\n    ```\n    # nft list ruleset | grep 'hook forward'\n\n    type filter hook forward priority 0; policy drop;\n    ```\n\n    ```\n    # nft list ruleset | grep 'hook output'\n\n    type filter hook output priority 0; policy drop;\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command for the base chains with the input, forward, and\noutput hooks to implement a default DROP policy:\n\n    ```\n    # nft chain\n\n      { policy drop \\\\; }\n    ```\n\n    Example:\n\n    ```\n    # nft chain inet filter input { policy drop \\\\; }\n\n    # nft chain inet filter forward { policy drop \\\\; }\n\n    # nft chain inet filter output { policy drop \\\\; }\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.3.6\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.3.6.rb",
                "line": 3
            },
            "id": "C-3.5.3.6"
        },
        {
            "title": "Ensure mounting of freevxfs filesystems is disabled",
            "desc": "The `freevxfs` filesystem type is a free version of the Veritas type\nfilesystem. This is the primary filesystem type for HP-UX operating systems.",
            "descriptions": {
                "default": "The `freevxfs` filesystem type is a free version of the Veritas type\nfilesystem. This is the primary filesystem type for HP-UX operating systems.",
                "rationale": "Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe -n -v freevxfs\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep freevxfs\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/freevxfs.conf`\n\nand add the following line:\n\n```\ninstall freevxfs /bin/true\n```\n\nRun the following command to unload the `freevxfs` module:\n\n```\nrmmod freevxfs\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.1.2"
            },
            "code": "control \"C-1.1.1.2\" do\n  title \"Ensure mounting of freevxfs filesystems is disabled\"\n  desc  \"The `freevxfs` filesystem type is a free version of the Veritas type\nfilesystem. This is the primary filesystem type for HP-UX operating systems.\"\n  desc  \"rationale\", \"Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe -n -v freevxfs\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep freevxfs\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/freevxfs.conf`\n\n    and add the following line:\n\n    ```\n    install freevxfs /bin/true\n    ```\n\n    Run the following command to unload the `freevxfs` module:\n\n    ```\n    rmmod freevxfs\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.1.2\"\n\n  describe kernel_module('freevxfs') do\n    it { should_not be_loaded }\n    it { should be_disabled }\n    it { should be_blacklisted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.1.2.rb",
                "line": 3
            },
            "id": "C-1.1.1.2"
        },
        {
            "title": "Ensure rsync service is not enabled",
            "desc": "The `rsyncd` service can be used to synchronize files between systems\nover network links.",
            "descriptions": {
                "default": "The `rsyncd` service can be used to synchronize files between systems\nover network links.",
                "rationale": "The `rsyncd` service presents a security risk as it uses\nunencrypted protocols for communication.",
                "check": "Run the following command to verify `rsyncd` is not enabled:\n\n```\n# systemctl is-enabled rsync\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run the following command to disable `rsyncd`:\n\n```\n# systemctl --now disable rsync\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.16"
            },
            "code": "control \"C-2.2.16\" do\n  title \"Ensure rsync service is not enabled\"\n  desc  \"The `rsyncd` service can be used to synchronize files between systems\nover network links.\"\n  desc  \"rationale\", \"The `rsyncd` service presents a security risk as it uses\nunencrypted protocols for communication.\"\n  desc  \"check\", \"\n    Run the following command to verify `rsyncd` is not enabled:\n\n    ```\n    # systemctl is-enabled rsync\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following command to disable `rsyncd`:\n\n    ```\n    # systemctl --now disable rsync\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.16\"\n\n    describe service('rsync') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.16.rb",
                "line": 3
            },
            "id": "C-2.2.16"
        },
        {
            "title": "Ensure SSH MaxAuthTries is set to 4 or less",
            "desc": "The `MaxAuthTries` parameter specifies the maximum number of\nauthentication attempts permitted per connection. When the login failure count\nreaches half the number, error messages will be written to the `syslog` file\ndetailing the login failure.",
            "descriptions": {
                "default": "The `MaxAuthTries` parameter specifies the maximum number of\nauthentication attempts permitted per connection. When the login failure count\nreaches half the number, error messages will be written to the `syslog` file\ndetailing the login failure.",
                "rationale": "Setting the `MaxAuthTries` parameter to a low number will\nminimize the risk of successful brute force attacks to the SSH server. While\nthe recommended setting is 4, set the number based on site policy.",
                "check": "Run the following command and verify that output `MaxAuthTries` is 4 or\nless:\n\n    ```\n    # sshd -T | grep maxauthtries\n\n    MaxAuthTries 4\n    ```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nMaxAuthTries 4\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-2(12)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.13"
                ],
                "cis_rid": "5.2.7",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.7\" do\n  title \"Ensure SSH MaxAuthTries is set to 4 or less\"\n  desc  \"The `MaxAuthTries` parameter specifies the maximum number of\nauthentication attempts permitted per connection. When the login failure count\nreaches half the number, error messages will be written to the `syslog` file\ndetailing the login failure.\"\n  desc  \"rationale\", \"Setting the `MaxAuthTries` parameter to a low number will\nminimize the risk of successful brute force attacks to the SSH server. While\nthe recommended setting is 4, set the number based on site policy.\"\n  desc  \"check\", \"\n    Run the following command and verify that output `MaxAuthTries` is 4 or\nless:\n\n    ```\n    # sshd -T | grep maxauthtries\n\n    MaxAuthTries 4\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    MaxAuthTries 4\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-2(12)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.13\"]\n  tag cis_rid: \"5.2.7\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('MaxAuthTries') { should cmp <= 4 }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.7.rb",
                "line": 3
            },
            "id": "C-5.2.7"
        },
        {
            "title": "Ensure IPv6 default deny firewall policy",
            "desc": "A default deny all policy on connections ensures that any unconfigured\nnetwork usage will be rejected.",
            "descriptions": {
                "default": "A default deny all policy on connections ensures that any unconfigured\nnetwork usage will be rejected.",
                "rationale": "With a default accept policy the firewall will accept any\npacket that is not configured to be denied. It is easier to white list\nacceptable usage than to black list unacceptable usage.",
                "check": "Run the following command and verify that the policy for the INPUT, OUTPUT,\nand FORWARD chains is DROP or REJECT:\n\n    ```\n    # ip6tables -L\n    Chain INPUT (policy DROP)\n    Chain FORWARD (policy DROP)\n    Chain OUTPUT (policy DROP)\n    ```\n\n    OR\n\n    If IPv6 is disabled:\n\n    Run the following command and verify that no lines are returned.\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1\n    ```\n\n    OR\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v ipv6.disable=1\n    ```",
                "fix": "Run the following commands to implement a default DROP policy:\n\n```\n# ip6tables -P INPUT DROP\n# ip6tables -P OUTPUT DROP\n# ip6tables -P FORWARD DROP\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.4.2.1"
            },
            "code": "control \"C-3.5.4.2.1\" do\n  title \"Ensure IPv6 default deny firewall policy\"\n  desc  \"A default deny all policy on connections ensures that any unconfigured\nnetwork usage will be rejected.\"\n  desc  \"rationale\", \"With a default accept policy the firewall will accept any\npacket that is not configured to be denied. It is easier to white list\nacceptable usage than to black list unacceptable usage.\"\n  desc  \"check\", \"\n    Run the following command and verify that the policy for the INPUT, OUTPUT,\nand FORWARD chains is DROP or REJECT:\n\n    ```\n    # ip6tables -L\n    Chain INPUT (policy DROP)\n    Chain FORWARD (policy DROP)\n    Chain OUTPUT (policy DROP)\n    ```\n\n    OR\n\n    If IPv6 is disabled:\n\n    Run the following command and verify that no lines are returned.\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1\n    ```\n\n    OR\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v ipv6.disable=1\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to implement a default DROP policy:\n\n    ```\n    # ip6tables -P INPUT DROP\n    # ip6tables -P OUTPUT DROP\n    # ip6tables -P FORWARD DROP\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.4.2.1\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.4.2.1.rb",
                "line": 3
            },
            "id": "C-3.5.4.2.1"
        },
        {
            "title": "Ensure permissions on /etc/issue are configured",
            "desc": "The contents of the `/etc/issue` file are displayed to users prior to\nlogin for local terminals.",
            "descriptions": {
                "default": "The contents of the `/etc/issue` file are displayed to users prior to\nlogin for local terminals.",
                "rationale": "If the `/etc/issue` file does not have the correct\nownership it could be modified by unauthorized users with incorrect or\nmisleading information.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` :\n\n    ```\n    # stat /etc/issue\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set permissions on `/etc/issue` :\n\n```\n# chown root:root /etc/issue\n```\n\n```\n# chmod u-x,go-wx /etc/issue\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.8.1.5"
            },
            "code": "control \"C-1.8.1.5\" do\n  title \"Ensure permissions on /etc/issue are configured\"\n  desc  \"The contents of the `/etc/issue` file are displayed to users prior to\nlogin for local terminals.\"\n  desc  \"rationale\", \"If the `/etc/issue` file does not have the correct\nownership it could be modified by unauthorized users with incorrect or\nmisleading information.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` :\n\n    ```\n    # stat /etc/issue\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set permissions on `/etc/issue` :\n\n    ```\n    # chown root:root /etc/issue\n    ```\n\n    ```\n    # chmod u-x,go-wx /etc/issue\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.8.1.5\"\n\n  describe file('/etc/issue') do\n    it { should exist }\n    it { should be_owned_by 'root' }\n    it { should_not be_more_permissive_than('0644') }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.8.1.5.rb",
                "line": 3
            },
            "id": "C-1.8.1.5"
        },
        {
            "title": "Ensure system administrator actions (sudolog) are collected",
            "desc": "Monitor the `sudo` log file. If the system has been properly\nconfigured to disable the use of the `su` command and force all administrators\nto have to log in first and then use `sudo` to execute privileged commands,\nthen all administrator commands will be logged to `/var/log/sudo.log` . Any\ntime a command is executed, an audit event will be triggered as the\n`/var/log/sudo.log` file will be opened for write and the executed\nadministration command will be written to the log.",
            "descriptions": {
                "default": "Monitor the `sudo` log file. If the system has been properly\nconfigured to disable the use of the `su` command and force all administrators\nto have to log in first and then use `sudo` to execute privileged commands,\nthen all administrator commands will be logged to `/var/log/sudo.log` . Any\ntime a command is executed, an audit event will be triggered as the\n`/var/log/sudo.log` file will be opened for write and the executed\nadministration command will be written to the log.",
                "rationale": "Changes in `/var/log/sudo.log` indicate that an\nadministrator has executed a command or the log file itself has been tampered\nwith. Administrators will want to correlate the events written to the audit\ntrail with the records written to `/var/log/sudo.log` to verify if unauthorized\ncommands have been executed.",
                "check": "Run the following commands:\n\n    ```\n    # grep -E \"^\\s*-w\\s+$(grep -r logfile /etc/sudoers* | sed -e\n's/.*logfile=//;s/,? .*//')\\s+-p\\s+wa\\s+-k\\s+actions\"\n/etc/audit/rules.d/*.rules\n\n    # auditctl -l | grep actions\n    ```\n\n    Verify output of both matches the output of the following command, and the\nthe output includes a file path\n\n    ```\n    echo \"-w $(grep -r logfile /etc/sudoers* | sed -e 's/.*logfile=//;s/,?\n.*//') -p wa -k actions\"\n    ```\n\n    **Example Output**\n\n    ```\n    -w /var/log/sudo.log -p wa -k actions\n    ```",
                "fix": "Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules` and add the following line:\n\n    ```\n    -w\n\n    \t -p wa -k actions\n    ```\n\n    Example: `vi /etc/audit/rules.d/actions.rules`\n\n    and add the following line:\n\n    ```\n    -w /var/log/sudo.log -p wa -k actions\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-2"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "4.9"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.15"
            },
            "code": "control \"C-4.1.15\" do\n  title \"Ensure system administrator actions (sudolog) are collected\"\n  desc  \"Monitor the `sudo` log file. If the system has been properly\nconfigured to disable the use of the `su` command and force all administrators\nto have to log in first and then use `sudo` to execute privileged commands,\nthen all administrator commands will be logged to `/var/log/sudo.log` . Any\ntime a command is executed, an audit event will be triggered as the\n`/var/log/sudo.log` file will be opened for write and the executed\nadministration command will be written to the log.\"\n  desc  \"rationale\", \"Changes in `/var/log/sudo.log` indicate that an\nadministrator has executed a command or the log file itself has been tampered\nwith. Administrators will want to correlate the events written to the audit\ntrail with the records written to `/var/log/sudo.log` to verify if unauthorized\ncommands have been executed.\"\n  desc  \"check\", \"\n    Run the following commands:\n\n    ```\n    # grep -E \\\"^\\\\s*-w\\\\s+$(grep -r logfile /etc/sudoers* | sed -e\n's/.*logfile=//;s/,? .*//')\\\\s+-p\\\\s+wa\\\\s+-k\\\\s+actions\\\"\n/etc/audit/rules.d/*.rules\n\n    # auditctl -l | grep actions\n    ```\n\n    Verify output of both matches the output of the following command, and the\nthe output includes a file path\n\n    ```\n    echo \\\"-w $(grep -r logfile /etc/sudoers* | sed -e 's/.*logfile=//;s/,?\n.*//') -p wa -k actions\\\"\n    ```\n\n    **Example Output**\n\n    ```\n    -w /var/log/sudo.log -p wa -k actions\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules` and add the following line:\n\n    ```\n    -w\n\n    \\t -p wa -k actions\n    ```\n\n    Example: `vi /etc/audit/rules.d/actions.rules`\n\n    and add the following line:\n\n    ```\n    -w /var/log/sudo.log -p wa -k actions\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-2\"]\n  tag cis_level: 2\n  tag cis_controls: [\"4.9\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.15\"\n  sudo_log_file = command(\"grep -r logfile /etc/sudoers* | sed -e 's/.*logfile=//;s/,? .*//;s/\\\"//g'\").stdout\n  describe \"sudo log file\" do\n    subject{ sudo_log_file }\n    it { should_not be_empty }\n  end\n  describe auditd.file(sudo_log_file.chomp).where { key == \"actions\" } do\n    its('permissions') { should include ['w', 'a'] }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.15.rb",
                "line": 3
            },
            "id": "C-4.1.15"
        },
        {
            "title": "Ensure no users have .rhosts files",
            "desc": "While no `.rhosts` files are shipped by default, users can easily\ncreate them.",
            "descriptions": {
                "default": "While no `.rhosts` files are shipped by default, users can easily\ncreate them.",
                "rationale": "This action is only meaningful if `.rhosts` support is\npermitted in the file `/etc/pam.conf` . Even though the `.rhosts` files are\nineffective if support is disabled in `/etc/pam.conf` , they may have been\nbrought over from other systems and could contain information useful to an\nattacker for those other systems.",
                "check": "Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\"'\"$(which nologin)\"'\" & do\n     if [ ! -d \"$dir\" ]; then\n     echo \"The home directory \\\"$dir\\\" of user \\\"$user\\\" does not\nexist.\"\n     else\n     for file in $dir/.rhosts; do\n     if [ ! -h \"$file\" ] & then\n     echo \".rhosts file in \\\"$dir\\\"\"\n     fi\n     done\n     fi\n    done\n    ```",
                "fix": "Making global modifications to users' files without alerting\nthe user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser `.rhosts` files and determine the action to be taken in accordance with\nsite policy."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-28"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.14"
            },
            "code": "control \"C-6.2.14\" do\n  title \"Ensure no users have .rhosts files\"\n  desc  \"While no `.rhosts` files are shipped by default, users can easily\ncreate them.\"\n  desc  \"rationale\", \"This action is only meaningful if `.rhosts` support is\npermitted in the file `/etc/pam.conf` . Even though the `.rhosts` files are\nineffective if support is disabled in `/etc/pam.conf` , they may have been\nbrought over from other systems and could contain information useful to an\nattacker for those other systems.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\\\"'\\\"$(which nologin)\\\"'\\\" & do\n     if [ ! -d \\\"$dir\\\" ]; then\n     echo \\\"The home directory \\\\\\\"$dir\\\\\\\" of user \\\\\\\"$user\\\\\\\" does not\nexist.\\\"\n     else\n     for file in $dir/.rhosts; do\n     if [ ! -h \\\"$file\\\" ] & then\n     echo \\\".rhosts file in \\\\\\\"$dir\\\\\\\"\\\"\n     fi\n     done\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"Making global modifications to users' files without alerting\nthe user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser `.rhosts` files and determine the action to be taken in accordance with\nsite policy.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-28\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.14\"\n\n  nologin = command(\"which nologin\").stdout.strip\n  \n  passwd.where { user != 'halt' && user != 'sync' && user != 'shutdown' && shell != nologin }.entries.each do |user|\n    describe file(\"#{user.home}/.rhosts\") do\n      it { should_not exist }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.14.rb",
                "line": 3
            },
            "id": "C-6.2.14"
        },
        {
            "title": "Ensure shadow group is empty",
            "desc": "The shadow group allows system programs which require access the\nability to read the /etc/shadow file. No users should be assigned to the shadow\ngroup.",
            "descriptions": {
                "default": "The shadow group allows system programs which require access the\nability to read the /etc/shadow file. No users should be assigned to the shadow\ngroup.",
                "rationale": "Any users assigned to the shadow group would be granted\nread access to the /etc/shadow file. If attackers can gain read access to the\n`/etc/shadow` file, they can easily run a password cracking program against the\nhashed passwords to break them. Other security information that is stored in\nthe `/etc/shadow` file (such as expiration) could also be useful to subvert\nadditional user accounts.",
                "check": "Run the following commands and verify no results are returned:\n\n```\n# grep ^shadow:[^:]*:[^:]*:[^:]+ /etc/group\n```\n\n```\n# awk -F: '($4 == \"\") { print }' /etc/passwd\n```",
                "fix": "Remove all users from the shadow group, and change the primary\ngroup of any users with shadow as their primary group."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.20"
            },
            "code": "control \"C-6.2.20\" do\n  title \"Ensure shadow group is empty\"\n  desc  \"The shadow group allows system programs which require access the\nability to read the /etc/shadow file. No users should be assigned to the shadow\ngroup.\"\n  desc  \"rationale\", \"Any users assigned to the shadow group would be granted\nread access to the /etc/shadow file. If attackers can gain read access to the\n`/etc/shadow` file, they can easily run a password cracking program against the\nhashed passwords to break them. Other security information that is stored in\nthe `/etc/shadow` file (such as expiration) could also be useful to subvert\nadditional user accounts.\"\n  desc  \"check\", \"\n    Run the following commands and verify no results are returned:\n\n    ```\n    # grep ^shadow:[^:]*:[^:]*:[^:]+ /etc/group\n    ```\n\n    ```\n    # awk -F: '($4 == \\\"\\\") { print }' /etc/passwd\n    ```\n  \"\n  desc \"fix\", \"Remove all users from the shadow group, and change the primary\ngroup of any users with shadow as their primary group.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.20\"\n\n  describe groups.where { name == 'shadow' } do\n    it { should exist }\n    its('members') { should be_empty }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.20.rb",
                "line": 3
            },
            "id": "C-6.2.20"
        },
        {
            "title": "Ensure RDS is disabled",
            "desc": "The Reliable Datagram Sockets (RDS) protocol is a transport layer\nprotocol designed to provide low-latency, high-bandwidth communications between\ncluster nodes. It was developed by the Oracle Corporation.",
            "descriptions": {
                "default": "The Reliable Datagram Sockets (RDS) protocol is a transport layer\nprotocol designed to provide low-latency, high-bandwidth communications between\ncluster nodes. It was developed by the Oracle Corporation.",
                "rationale": "If the protocol is not being used, it is recommended that\nkernel module not be loaded, disabling the service to reduce the potential\nattack surface.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe -n -v rds\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep rds\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/rds.conf`\n\nand add the following line:\n\n```\ninstall rds /bin/true\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "3.4.3"
            },
            "code": "control \"C-3.4.3\" do\n  title \"Ensure RDS is disabled\"\n  desc  \"The Reliable Datagram Sockets (RDS) protocol is a transport layer\nprotocol designed to provide low-latency, high-bandwidth communications between\ncluster nodes. It was developed by the Oracle Corporation.\"\n  desc  \"rationale\", \"If the protocol is not being used, it is recommended that\nkernel module not be loaded, disabling the service to reduce the potential\nattack surface.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe -n -v rds\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep rds\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/rds.conf`\n\n    and add the following line:\n\n    ```\n    install rds /bin/true\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"3.4.3\"\n\n  describe kernel_module('rds') do\n    it { should_not be_loaded }\n    it { should_not be_disabled }\n    it { should_not be_blacklisted }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.4.3.rb",
                "line": 3
            },
            "id": "C-3.4.3"
        },
        {
            "title": "Ensure telnet client is not installed",
            "desc": "The `telnet` package contains the `telnet` client, which allows users\nto start connections to other systems via the telnet protocol.",
            "descriptions": {
                "default": "The `telnet` package contains the `telnet` client, which allows users\nto start connections to other systems via the telnet protocol.",
                "rationale": "The `telnet` protocol is insecure and unencrypted. The\nuse of an unencrypted transmission medium could allow an unauthorized user to\nsteal credentials. The `ssh` package provides an encrypted session and stronger\nsecurity and is included in most Linux distributions.",
                "check": "Verify `telnet` is not installed. Use the following command to provide the\nneeded information:\n\n    ```\n    # dpkg -s telnet\n    ```",
                "fix": "Uninstall `telnet`:\n\n```\n# apt purge telnet\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "IA-2 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.5",
                    "Rev_7"
                ],
                "cis_rid": "2.3.4"
            },
            "code": "control \"C-2.3.4\" do\n  title \"Ensure telnet client is not installed\"\n  desc  \"The `telnet` package contains the `telnet` client, which allows users\nto start connections to other systems via the telnet protocol.\"\n  desc  \"rationale\", \"The `telnet` protocol is insecure and unencrypted. The\nuse of an unencrypted transmission medium could allow an unauthorized user to\nsteal credentials. The `ssh` package provides an encrypted session and stronger\nsecurity and is included in most Linux distributions.\"\n  desc  \"check\", \"\n    Verify `telnet` is not installed. Use the following command to provide the\nneeded information:\n\n    ```\n    # dpkg -s telnet\n    ```\n  \"\n  desc \"fix\", \"\n    Uninstall `telnet`:\n\n    ```\n    # apt purge telnet\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"IA-2 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.5\", \"Rev_7\"]\n  tag cis_rid: \"2.3.4\"\n\n  describe package('telnet') do\n    it { should_not be_installed }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.3.4.rb",
                "line": 3
            },
            "id": "C-2.3.4"
        },
        {
            "title": "Disable Automounting",
            "desc": "`autofs` allows automatic mounting of devices, typically including\nCD/DVDs and USB drives.",
            "descriptions": {
                "default": "`autofs` allows automatic mounting of devices, typically including\nCD/DVDs and USB drives.",
                "rationale": "With automounting enabled anyone with physical access\ncould attach a USB drive or disc and have its contents available in system even\nif they lacked permissions to mount it themselves.",
                "check": "autofs should be removed or disabled.\n\n    Run the following commands to verify that `autofs` is not installed or is\ndisabled\n\n    Run the following command to verify `autofs` is not enabled:\n\n    ```\n    # systemctl is-enabled autofs\n\n    disabled\n    ```\n\n    Verify result is not \"enabled\".\n\n    OR\n\n    Run the following command to verfiy that `autofs` is not installed\n\n    ```\n    # dpkg -s autofs\n    ```\n\n    Output should include:\n\n    ```\n    package `autofs` is not installed\n    ```",
                "fix": "Run one of the following commands:\n\nRun the following command to disable `autofs` :\n\n```\n# systemctl --now disable autofs\n```\n\nOR\n\nRun the following command to remove `autofs`\n\n```\n# apt purge autofs\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SI-3",
                    "SC-18(4)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "8.4",
                    "8.5",
                    "Rev_7"
                ],
                "cis_rid": "1.1.22"
            },
            "code": "control \"C-1.1.22\" do\n  title \"Disable Automounting\"\n  desc  \"`autofs` allows automatic mounting of devices, typically including\nCD/DVDs and USB drives.\"\n  desc  \"rationale\", \"With automounting enabled anyone with physical access\ncould attach a USB drive or disc and have its contents available in system even\nif they lacked permissions to mount it themselves.\"\n  desc  \"check\", \"\n    autofs should be removed or disabled.\n\n    Run the following commands to verify that `autofs` is not installed or is\ndisabled\n\n    Run the following command to verify `autofs` is not enabled:\n\n    ```\n    # systemctl is-enabled autofs\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n\n    OR\n\n    Run the following command to verfiy that `autofs` is not installed\n\n    ```\n    # dpkg -s autofs\n    ```\n\n    Output should include:\n\n    ```\n    package `autofs` is not installed\n    ```\n  \"\n  desc  \"fix\", \"\n    Run one of the following commands:\n\n    Run the following command to disable `autofs` :\n\n    ```\n    # systemctl --now disable autofs\n    ```\n\n    OR\n\n    Run the following command to remove `autofs`\n\n    ```\n    # apt purge autofs\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SI-3\", \"SC-18(4)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"8.4\", \"8.5\", \"Rev_7\"]\n  tag cis_rid: \"1.1.22\"\n\n  describe service('autofs') do\n    it { should_not be_enabled }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.22.rb",
                "line": 3
            },
            "id": "C-1.1.22"
        },
        {
            "title": "Ensure systemd-timesyncd is configured",
            "desc": "systemd-timesyncd is a daemon that has been added for synchronizing\nthe system clock across the network. It implements an SNTP client. In contrast\nto NTP implementations such as chrony or the NTP reference server this only\nimplements a client side, and does not bother with the full NTP complexity,\nfocusing only on querying time from one remote server and synchronizing the\nlocal clock to it. The daemon runs with minimal privileges, and has been hooked\nup with networkd to only operate when network connectivity is available. The\ndaemon saves the current clock to disk every time a new NTP sync has been\nacquired, and uses this to possibly correct the system clock early at bootup,\nin order to accommodate for systems that lack an RTC such as the Raspberry Pi\nand embedded devices, and make sure that time monotonically progresses on these\nsystems, even if it is not always correct. To make use of this daemon a new\nsystem user and group \"systemd-timesync\" needs to be created on installation\nof systemd.\n\n    **Note:** The systemd-timesyncd service specifically implements only SNTP.\nThis minimalistic service will set the system clock for large offsets or slowly\nadjust it for smaller deltas. More complex use cases are not covered by\nsystemd-timesyncd.\n\n    This recommendation only applies if timesyncd is in use on the system.",
            "descriptions": {
                "default": "systemd-timesyncd is a daemon that has been added for synchronizing\nthe system clock across the network. It implements an SNTP client. In contrast\nto NTP implementations such as chrony or the NTP reference server this only\nimplements a client side, and does not bother with the full NTP complexity,\nfocusing only on querying time from one remote server and synchronizing the\nlocal clock to it. The daemon runs with minimal privileges, and has been hooked\nup with networkd to only operate when network connectivity is available. The\ndaemon saves the current clock to disk every time a new NTP sync has been\nacquired, and uses this to possibly correct the system clock early at bootup,\nin order to accommodate for systems that lack an RTC such as the Raspberry Pi\nand embedded devices, and make sure that time monotonically progresses on these\nsystems, even if it is not always correct. To make use of this daemon a new\nsystem user and group \"systemd-timesync\" needs to be created on installation\nof systemd.\n\n    **Note:** The systemd-timesyncd service specifically implements only SNTP.\nThis minimalistic service will set the system clock for large offsets or slowly\nadjust it for smaller deltas. More complex use cases are not covered by\nsystemd-timesyncd.\n\n    This recommendation only applies if timesyncd is in use on the system.",
                "rationale": "Proper configuration is vital to ensuring time\nsynchronization is working properly.",
                "check": "Ensure that timesyncd is enabled and started\n\n    Run the following commands:\n\n    ```\n    # systemctl is-enabled systemd-timesyncd.service\n    ```\n\n    This should return:\n\n    ```\n    enabled\n    ```\n\n    Review `/etc/systemd/timesyncd.conf` and ensure that the NTP servers, NTP\nFallbackNTP servers, and RootDistanceMaxSec listed are in accordance with local\npolicy\n\n    Run the following command\n\n    ```\n    # timedatectl status\n    ```\n\n    This should return something similar to:\n\n    ```\n     Local time: Tue 2019-06-04 15:40:45 EDT\n     Universal time: Tue 2019-06-04 19:40:45 UTC\n     RTC time: Tue 2019-06-04 19:40:45\n     Time zone: America/New_York (EDT, -0400)\n     NTP enabled: yes\n    NTP synchronized: yes\n     RTC in local TZ: no\n     DST active: yes\n     Last DST change: DST began at\n     Sun 2019-03-10 01:59:59 EST\n     Sun 2019-03-10 03:00:00 EDT\n     Next DST change: DST ends (the clock jumps one hour backwards) at\n     Sun 2019-11-03 01:59:59 EDT\n     Sun 2019-11-03 01:00:00 EST\n    ```",
                "fix": "Run the following command to enable systemd-timesyncd\n\n    ```\n    # systemctl enable systemd-timesyncd.service\n    ```\n\n    edit the file /etc/systemd/timesyncd.conf and add/modify the following\nlines in accordance with local site policy\n\n    ```\n    NTP=0.ubuntu.pool.ntp.org 1.ubuntu.pool.ntp.org 2.ubuntu.pool.ntp.org\n\n    FallbackNTP=ntp.ubuntu.com 3.ubuntu.pool.ntp.org\n\n    RootDistanceMaxSec=1\n    ```\n\n    Run the following commands to start systemd-timesyncd.service\n\n    ```\n    # systemctl start systemd-timesyncd.service\n    ```\n\n    ```\n    # timedatectl set-ntp true\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-8 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.1",
                    "Rev_7"
                ],
                "cis_rid": "2.2.1.2"
            },
            "code": "control \"C-2.2.1.2\" do\n  title \"Ensure systemd-timesyncd is configured\"\n  desc  \"systemd-timesyncd is a daemon that has been added for synchronizing\nthe system clock across the network. It implements an SNTP client. In contrast\nto NTP implementations such as chrony or the NTP reference server this only\nimplements a client side, and does not bother with the full NTP complexity,\nfocusing only on querying time from one remote server and synchronizing the\nlocal clock to it. The daemon runs with minimal privileges, and has been hooked\nup with networkd to only operate when network connectivity is available. The\ndaemon saves the current clock to disk every time a new NTP sync has been\nacquired, and uses this to possibly correct the system clock early at bootup,\nin order to accommodate for systems that lack an RTC such as the Raspberry Pi\nand embedded devices, and make sure that time monotonically progresses on these\nsystems, even if it is not always correct. To make use of this daemon a new\nsystem user and group \\\"systemd-timesync\\\" needs to be created on installation\nof systemd.\n\n    **Note:** The systemd-timesyncd service specifically implements only SNTP.\nThis minimalistic service will set the system clock for large offsets or slowly\nadjust it for smaller deltas. More complex use cases are not covered by\nsystemd-timesyncd.\n\n    This recommendation only applies if timesyncd is in use on the system.\n  \"\n  desc  \"rationale\", \"Proper configuration is vital to ensuring time\nsynchronization is working properly.\"\n  desc  \"check\", \"\n    Ensure that timesyncd is enabled and started\n\n    Run the following commands:\n\n    ```\n    # systemctl is-enabled systemd-timesyncd.service\n    ```\n\n    This should return:\n\n    ```\n    enabled\n    ```\n\n    Review `/etc/systemd/timesyncd.conf` and ensure that the NTP servers, NTP\nFallbackNTP servers, and RootDistanceMaxSec listed are in accordance with local\npolicy\n\n    Run the following command\n\n    ```\n    # timedatectl status\n    ```\n\n    This should return something similar to:\n\n    ```\n     Local time: Tue 2019-06-04 15:40:45 EDT\n     Universal time: Tue 2019-06-04 19:40:45 UTC\n     RTC time: Tue 2019-06-04 19:40:45\n     Time zone: America/New_York (EDT, -0400)\n     NTP enabled: yes\n    NTP synchronized: yes\n     RTC in local TZ: no\n     DST active: yes\n     Last DST change: DST began at\n     Sun 2019-03-10 01:59:59 EST\n     Sun 2019-03-10 03:00:00 EDT\n     Next DST change: DST ends (the clock jumps one hour backwards) at\n     Sun 2019-11-03 01:59:59 EDT\n     Sun 2019-11-03 01:00:00 EST\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to enable systemd-timesyncd\n\n    ```\n    # systemctl enable systemd-timesyncd.service\n    ```\n\n    edit the file /etc/systemd/timesyncd.conf and add/modify the following\nlines in accordance with local site policy\n\n    ```\n    NTP=0.ubuntu.pool.ntp.org 1.ubuntu.pool.ntp.org 2.ubuntu.pool.ntp.org\n\n    FallbackNTP=ntp.ubuntu.com 3.ubuntu.pool.ntp.org\n\n    RootDistanceMaxSec=1\n    ```\n\n    Run the following commands to start systemd-timesyncd.service\n\n    ```\n    # systemctl start systemd-timesyncd.service\n    ```\n\n    ```\n    # timedatectl set-ntp true\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-8 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.1\", \"Rev_7\"]\n  tag cis_rid: \"2.2.1.2\"\n\n  \"\n  describe service('systemd-timesyncd') do\n    it { should be_installed }\n    it { should be_enabled }\n    it { should be_running }\n  end\n\n\n  describe file('/etc/systemd/timesyncd.conf') do\n    it { should exist }\n      #its('content') { should match(%r{FallbackNTP}) }\n  end\n\"\n\n  describe parse_config_file('/etc/systemd/timesyncd.conf') do\n    its('NTP') { should match(%r{\\w+\\.\\w+}) }\n    its('FallbackNTP') { should match(%r{\\w+\\.\\w+}) }\n    its('RootDistanceMaxSec') { should cmp 1 }\n  end\n  describe parse_config_file('/etc/systemd/timesyncd.conf') do\n    its('FallbackNTP') { should match(%r{\\w+\\.\\w+}) }\n  end\n  describe parse_config_file('/etc/systemd/timesyncd.conf') do\n    its('RootDistanceMaxSec') { should cmp '1' }\n  end\n\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.1.2.rb",
                "line": 3
            },
            "id": "C-2.2.1.2"
        },
        {
            "title": "Ensure loopback traffic is configured",
            "desc": "Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network (127.0.0.0/8 for IPv4\nand ::1/128 for IPv6).",
            "descriptions": {
                "default": "Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network (127.0.0.0/8 for IPv4\nand ::1/128 for IPv6).",
                "rationale": "Loopback traffic is generated between processes on\nmachine and is typically critical to operation of the system. The loopback\ninterface is the only place that loopback network (127.0.0.0/8 for IPv4 and\n::1/128 for IPv6) traffic should be seen, all other interfaces should ignore\ntraffic on this network as an anti-spoofing measure.",
                "check": "Run the following commands and verify output includes the listed rules in\norder:\n\n    ```\n    # ufw status verbose\n    ```\n\n    ```\n    To Action From\n    -- ------ ----\n    Anywhere on lo ALLOW IN Anywhere\n    Anywhere DENY IN 127.0.0.0/8\n    Anywhere (v6) on lo ALLOW IN Anywhere (v6)\n    Anywhere (v6) DENY IN ::1\n\n    Anywhere ALLOW OUT Anywhere on lo\n    Anywhere (v6) ALLOW OUT Anywhere (v6) on lo\n    ```",
                "fix": "Run the following commands to implement the loopback rules:\n\n```\n# ufw allow in on lo\n```\n\n```\n# ufw deny in from 127.0.0.0/8\n```\n\n```\n# ufw deny in from ::1\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.2.3"
            },
            "code": "control \"C-3.5.2.3\" do\n  title \"Ensure loopback traffic is configured\"\n  desc  \"Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network (127.0.0.0/8 for IPv4\nand ::1/128 for IPv6).\"\n  desc  \"rationale\", \"Loopback traffic is generated between processes on\nmachine and is typically critical to operation of the system. The loopback\ninterface is the only place that loopback network (127.0.0.0/8 for IPv4 and\n::1/128 for IPv6) traffic should be seen, all other interfaces should ignore\ntraffic on this network as an anti-spoofing measure.\"\n  desc  \"check\", \"\n    Run the following commands and verify output includes the listed rules in\norder:\n\n    ```\n    # ufw status verbose\n    ```\n\n    ```\n    To Action From\n    -- ------ ----\n    Anywhere on lo ALLOW IN Anywhere\n    Anywhere DENY IN 127.0.0.0/8\n    Anywhere (v6) on lo ALLOW IN Anywhere (v6)\n    Anywhere (v6) DENY IN ::1\n\n    Anywhere ALLOW OUT Anywhere on lo\n    Anywhere (v6) ALLOW OUT Anywhere (v6) on lo\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to implement the loopback rules:\n\n    ```\n    # ufw allow in on lo\n    ```\n\n    ```\n    # ufw deny in from 127.0.0.0/8\n    ```\n\n    ```\n    # ufw deny in from ::1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.2.3\"\n\n  ufw_status = command('ufw status verbose').stdout.strip\n  #ufw_status = command('ufw status verbose').stdout.strip.split(\"\\n\")\n\n  describe ufw_status do\n    it { should match 'Anywhere on lo             ALLOW IN    Anywhere' }\n    it { should match 'Anywhere\\s+DENY\\s+IN\\s+127.0.0.0/8' }\n    it { should match 'Anywhere\\s+\\(v6\\)\\s+on\\s+lo\\s+ALLOW\\s+IN\\s+Anywhere\\s+\\(v6\\)' }\n    it { should match 'Anywhere\\s+\\(v6\\)\\s+DENY\\s+IN\\s+::1' }\n    it { should match 'Anywhere\\s+ALLOW\\s+OUT\\s+Anywhere\\s+on\\s+lo' }\n    it { should match 'Anywhere\\s+\\(v6\\)\\s+ALLOW\\s+OUT\\s+Anywhere\\s+\\(v6\\)\\s+on\\s+lo' }\n  end\n\n  describe service('ufw') do\n    it { should be_running }\n    it { should be_enabled }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.2.3.rb",
                "line": 3
            },
            "id": "C-3.5.2.3"
        },
        {
            "title": "Ensure filesystem integrity is regularly checked",
            "desc": "Periodic checking of the filesystem integrity is needed to detect\nchanges to the filesystem.",
            "descriptions": {
                "default": "Periodic checking of the filesystem integrity is needed to detect\nchanges to the filesystem.",
                "rationale": "Periodic file checking allows the system administrator to\ndetermine on a regular basis if critical files have been changed in an\nunauthorized fashion.",
                "check": "Run the following to verify that aidcheck.service and aidcheck.timer are\nenabled and running\n\n    ```\n    # systemctl is-enabled aidecheck.service\n    # systemctl status aidecheck.service\n\n    # systemctl is-enabled aidecheck.timer\n    # systemctl status aidecheck.timer\n    ```\n    OR\n\n    Run the following commands to determine if there is a `cron` job scheduled\nto run the aide check.\n\n    ```\n    # crontab -u root -l | grep aide\n\n    # grep -r aide /etc/cron.* /etc/crontab\n    ```\n\n    Ensure a cron job in compliance with site policy is returned.",
                "fix": "Run the following commands:\n\n```\n# cp ./config/aidecheck.service /etc/systemd/system/aidecheck.service\n# cp ./config/aidecheck.timer /etc/systemd/system/aidecheck.timer\n# chmod 0644 /etc/systemd/system/aidecheck.*\n\n# systemctl reenable aidecheck.timer\n# systemctl restart aidecheck.timer\n# systemctl daemon-reload\n```\n\nOR\n\nRun the following command:\n\n```\n# crontab -u root -e\n```\n\nAdd the following line to the crontab:\n\n```\n0 5 * * * /usr/bin/aide.wrapper --config /etc/aide/aide.conf --check\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-2",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.9",
                    "Rev_7"
                ],
                "cis_rid": "1.4.2"
            },
            "code": "control \"C-1.4.2\" do\n  title \"Ensure filesystem integrity is regularly checked\"\n  desc  \"Periodic checking of the filesystem integrity is needed to detect\nchanges to the filesystem.\"\n  desc  \"rationale\", \"Periodic file checking allows the system administrator to\ndetermine on a regular basis if critical files have been changed in an\nunauthorized fashion.\"\n  desc  \"check\", \"\n    Run the following to verify that aidcheck.service and aidcheck.timer are\nenabled and running\n\n    ```\n    # systemctl is-enabled aidecheck.service\n    # systemctl status aidecheck.service\n\n    # systemctl is-enabled aidecheck.timer\n    # systemctl status aidecheck.timer\n    ```\n    OR\n\n    Run the following commands to determine if there is a `cron` job scheduled\nto run the aide check.\n\n    ```\n    # crontab -u root -l | grep aide\n\n    # grep -r aide /etc/cron.* /etc/crontab\n    ```\n\n    Ensure a cron job in compliance with site policy is returned.\n  \"\n  desc  \"fix\", \"\n    Run the following commands:\n\n    ```\n    # cp ./config/aidecheck.service /etc/systemd/system/aidecheck.service\n    # cp ./config/aidecheck.timer /etc/systemd/system/aidecheck.timer\n    # chmod 0644 /etc/systemd/system/aidecheck.*\n\n    # systemctl reenable aidecheck.timer\n    # systemctl restart aidecheck.timer\n    # systemctl daemon-reload\n    ```\n\n    OR\n\n    Run the following command:\n\n    ```\n    # crontab -u root -e\n    ```\n\n    Add the following line to the crontab:\n\n    ```\n    0 5 * * * /usr/bin/aide.wrapper --config /etc/aide/aide.conf --check\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-2\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.9\", \"Rev_7\"]\n  tag cis_rid: \"1.4.2\"\n\n  describe.one do\n    describe service('aide') do\n      it { should be_installed }\n      it { should be_enabled }\n      it { should be_running }\n    end\n\n    describe crontab('root') do\n      its('user') { should include 'root'}\n      its('commands') { should include '/usr/bin/aide --check' }\n    end\n  end\n\n\n\n\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.4.2.rb",
                "line": 3
            },
            "id": "C-1.4.2"
        },
        {
            "title": "Ensure nosuid option set on /dev/shm partition",
            "desc": "The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.",
            "descriptions": {
                "default": "The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.",
                "rationale": "Setting this option on a file system prevents users from\nintroducing privileged programs onto the system and allowing non-root users to\nexecute them.",
                "check": "Verify that the `nosuid` option is set if a `/dev/shm` partition exists.\n\nRun the following command and verify that nothing is returned:\n\n```\n# mount | grep -E '\\s/dev/shm\\s' | grep -v nosuid\n```",
                "fix": "Edit the `/etc/fstab` file and add `nosuid` to the fourth field (mounting\noptions) for the `/dev/shm` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/dev/shm` :\n\n    ```\n    # mount -o remount,nosuid /dev/shm\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.16"
            },
            "code": "control \"C-1.1.16\" do\n  title \"Ensure nosuid option set on /dev/shm partition\"\n  desc  \"The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.\"\n  desc  \"rationale\", \"Setting this option on a file system prevents users from\nintroducing privileged programs onto the system and allowing non-root users to\nexecute them.\"\n  desc  \"check\", \"\n    Verify that the `nosuid` option is set if a `/dev/shm` partition exists.\n\n    Run the following command and verify that nothing is returned:\n\n    ```\n    # mount | grep -E '\\\\s/dev/shm\\\\s' | grep -v nosuid\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/fstab` file and add `nosuid` to the fourth field (mounting\noptions) for the `/dev/shm` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/dev/shm` :\n\n    ```\n    # mount -o remount,nosuid /dev/shm\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.16\"\n\n  describe mount('/dev/shm') do\n    its('options') { should include 'nosuid' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.16.rb",
                "line": 3
            },
            "id": "C-1.1.16"
        },
        {
            "title": "Ensure lockout for failed password attempts is configured",
            "desc": "Lock out users after _n_ unsuccessful consecutive login attempts. The\nfirst sets of changes are made to the PAM configuration files. The second set\nof changes are applied to the program specific PAM configuration file. The\nsecond set of changes must be applied to each program that will lock out users.\nCheck the documentation for each secondary program for instructions on how to\nconfigure them to work with PAM.\n\n    - deny=`n` - `n` represents the number of failed attempts before the\naccount is locked\n    - unlock_time=`n` - `n` represents the number of seconds before the account\nis unlocked\n    - audit - Will log the user name into the system log if the user is not\nfound.\n    - silent - Don't print informative messages.\n\n    Set the lockout number and unlock time in accordance with local site policy.",
            "descriptions": {
                "default": "Lock out users after _n_ unsuccessful consecutive login attempts. The\nfirst sets of changes are made to the PAM configuration files. The second set\nof changes are applied to the program specific PAM configuration file. The\nsecond set of changes must be applied to each program that will lock out users.\nCheck the documentation for each secondary program for instructions on how to\nconfigure them to work with PAM.\n\n    - deny=`n` - `n` represents the number of failed attempts before the\naccount is locked\n    - unlock_time=`n` - `n` represents the number of seconds before the account\nis unlocked\n    - audit - Will log the user name into the system log if the user is not\nfound.\n    - silent - Don't print informative messages.\n\n    Set the lockout number and unlock time in accordance with local site policy.",
                "rationale": "Locking out user IDs after `n` unsuccessful consecutive\nlogin attempts mitigates brute force password attacks against your systems.",
                "check": "Verify password lockouts are configured. These settings are commonly\nconfigured with the `pam_tally2.so` modules found in `/etc/pam.d/common-auth`.\n\n    ```\n    # grep \"pam_tally2\" /etc/pam.d/common-auth\n\n    auth required pam_tally2.so onerr=fail audit silent deny=5 unlock_time=900\n    ```\n\n    Verify the pam_deny.so module and pam_tally2.so modules are included in\n`/etc/pam.d/common-account`\n\n    ```\n    # grep -E \"pam_(tally2|deny)\\.so\" /etc/pam.d/common-account\n\n    account requisite pam_deny.so\n    account required pam_tally2.so\n    ```",
                "fix": "Edit the `/etc/pam.d/common-auth` file and add the auth line below:\n\n    ```\n    auth required pam_tally2.so onerr=fail audit silent deny=5 unlock_time=900\n    ```\n\n    Edit the `/etc/pam.d/common-account` file and add the account lines bellow:\n\n    ```\n    account requisite pam_deny.so\n    account required pam_tally.so\n    ```\n\n    **Note:** If a user has been locked out because they have reached the\nmaximum consecutive failure count defined by `deny=` in the `pam_tally2.so`\nmodule, the user can be unlocked by issuing the command `/sbin/pam_tally2 -u\n--reset`. This command sets the failed count to 0, effectively unlocking the\nuser."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-2",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.7",
                    "Rev_7"
                ],
                "cis_rid": "5.3.2"
            },
            "code": "control \"C-5.3.2\" do\n  title \"Ensure lockout for failed password attempts is configured\"\n  desc  \"Lock out users after _n_ unsuccessful consecutive login attempts. The\nfirst sets of changes are made to the PAM configuration files. The second set\nof changes are applied to the program specific PAM configuration file. The\nsecond set of changes must be applied to each program that will lock out users.\nCheck the documentation for each secondary program for instructions on how to\nconfigure them to work with PAM.\n\n    - deny=`n` - `n` represents the number of failed attempts before the\naccount is locked\n    - unlock_time=`n` - `n` represents the number of seconds before the account\nis unlocked\n    - audit - Will log the user name into the system log if the user is not\nfound.\n    - silent - Don't print informative messages.\n\n    Set the lockout number and unlock time in accordance with local site policy.\n  \"\n  desc  \"rationale\", \"Locking out user IDs after `n` unsuccessful consecutive\nlogin attempts mitigates brute force password attacks against your systems.\"\n  desc  \"check\", \"\n    Verify password lockouts are configured. These settings are commonly\nconfigured with the `pam_tally2.so` modules found in `/etc/pam.d/common-auth`.\n\n    ```\n    # grep \\\"pam_tally2\\\" /etc/pam.d/common-auth\n\n    auth required pam_tally2.so onerr=fail audit silent deny=5 unlock_time=900\n    ```\n\n    Verify the pam_deny.so module and pam_tally2.so modules are included in\n`/etc/pam.d/common-account`\n\n    ```\n    # grep -E \\\"pam_(tally2|deny)\\\\.so\\\" /etc/pam.d/common-account\n\n    account requisite pam_deny.so\n    account required pam_tally2.so\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/pam.d/common-auth` file and add the auth line below:\n\n    ```\n    auth required pam_tally2.so onerr=fail audit silent deny=5 unlock_time=900\n    ```\n\n    Edit the `/etc/pam.d/common-account` file and add the account lines bellow:\n\n    ```\n    account requisite pam_deny.so\n    account required pam_tally.so\n    ```\n\n    **Note:** If a user has been locked out because they have reached the\nmaximum consecutive failure count defined by `deny=` in the `pam_tally2.so`\nmodule, the user can be unlocked by issuing the command `/sbin/pam_tally2 -u\n--reset`. This command sets the failed count to 0, effectively unlocking the\nuser.\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-2\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.7\", \"Rev_7\"]\n  tag cis_rid: \"5.3.2\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.3.2.rb",
                "line": 3
            },
            "id": "C-5.3.2"
        },
        {
            "title": "Ensure message of the day is configured properly",
            "desc": "The contents of the `/etc/motd` file are displayed to users after\nlogin and function as a message of the day for authenticated users.\n\n    Unix-based systems have typically displayed information about the OS\nrelease and patch level upon logging in to the system. This information can be\nuseful to developers who are developing software for a particular OS platform.\nIf `mingetty(8)` supports the following options, they display operating system\ninformation: `\\m` - machine architecture `` - operating system release `\\s` - operating system name `\\v` - operating\nsystem version",
            "descriptions": {
                "default": "The contents of the `/etc/motd` file are displayed to users after\nlogin and function as a message of the day for authenticated users.\n\n    Unix-based systems have typically displayed information about the OS\nrelease and patch level upon logging in to the system. This information can be\nuseful to developers who are developing software for a particular OS platform.\nIf `mingetty(8)` supports the following options, they display operating system\ninformation: `\\m` - machine architecture `` - operating system release `\\s` - operating system name `\\v` - operating\nsystem version",
                "rationale": "Warning messages inform users who are attempting to login\nto the system of their legal status regarding the system and must include the\nname of the organization that owns the system and any monitoring policies that\nare in place. Displaying OS and patch level information in login banners also\nhas the side effect of providing detailed system information to attackers\nattempting to target specific exploits of a system. Authorized users can easily\nget this information by running the \" `uname -a` \" command once they have\nlogged in.",
                "check": "Run the following command and verify that the contents match site policy:\n\n```\n# cat /etc/motd\n```\n\nRun the following command and verify no results are returned:\n\n```\n# grep -E -i -s \"(\\\\\\v|\\\\|\\\\\\m|\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e's/\"//g'))\" /etc/motd\n```",
                "fix": "Edit the `/etc/motd` file with the appropriate contents according to your\nsite policy, remove any instances of `\\m` , `` , `\\s` , `\\v` or references to the `OS platform`\n\n    OR\n\n    If the motd is not used, this file can be removed.\n\n    Run the following command to remove the motd file:\n\n    ```\n    # rm /etc/motd\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.8.1.1"
            },
            "code": "control \"C-1.8.1.1\" do\n  title \"Ensure message of the day is configured properly\"\n  desc  \"The contents of the `/etc/motd` file are displayed to users after\nlogin and function as a message of the day for authenticated users.\n\n    Unix-based systems have typically displayed information about the OS\nrelease and patch level upon logging in to the system. This information can be\nuseful to developers who are developing software for a particular OS platform.\nIf `mingetty(8)` supports the following options, they display operating system\ninformation: `\\\\m` - machine architecture `\\\n` - operating system release `\\\\s` - operating system name `\\\\v` - operating\nsystem version\n  \"\n  desc  \"rationale\", \"Warning messages inform users who are attempting to login\nto the system of their legal status regarding the system and must include the\nname of the organization that owns the system and any monitoring policies that\nare in place. Displaying OS and patch level information in login banners also\nhas the side effect of providing detailed system information to attackers\nattempting to target specific exploits of a system. Authorized users can easily\nget this information by running the \\\" `uname -a` \\\" command once they have\nlogged in.\"\n  desc  \"check\", \"\n    Run the following command and verify that the contents match site policy:\n\n    ```\n    # cat /etc/motd\n    ```\n\n    Run the following command and verify no results are returned:\n\n    ```\n    # grep -E -i -s \\\"(\\\\\\\\\\\\v|\\\\\\\\\\|\\\\\\\\\\\\m|\\\\\\\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e's/\\\"//g'))\\\" /etc/motd\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/motd` file with the appropriate contents according to your\nsite policy, remove any instances of `\\\\m` , `\\\n` , `\\\\s` , `\\\\v` or references to the `OS platform`\n\n    OR\n\n    If the motd is not used, this file can be removed.\n\n    Run the following command to remove the motd file:\n\n    ```\n    # rm /etc/motd\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.8.1.1\"\n\n  describe command(\"grep '/etc/os-release' /etc/motd\").stdout.strip.split(\"\\n\") do\n    its('length') { should be < 1 }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.8.1.1.rb",
                "line": 3
            },
            "id": "C-1.8.1.1"
        },
        {
            "title": "Ensure openbsd-inetd is not installed",
            "desc": "The `inetd` daemon listens for well known services and dispatches the\nappropriate daemon to properly respond to service requests.",
            "descriptions": {
                "default": "The `inetd` daemon listens for well known services and dispatches the\nappropriate daemon to properly respond to service requests.",
                "rationale": "If there are no `inetd` services required, it is\nrecommended that the daemon be removed.",
                "check": "Run the following command and verify `openbsd-inetd` is not installed:\n\n```\ndpkg -s openbsd-inetd\n```",
                "fix": "Run the following command to uninstall `openbsd-inetd`:\n\n```\napt-get remove openbsd-inetd\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.1.2"
            },
            "code": "control \"C-2.1.2\" do\n  title \"Ensure openbsd-inetd is not installed\"\n  desc  \"The `inetd` daemon listens for well known services and dispatches the\nappropriate daemon to properly respond to service requests.\"\n  desc  \"rationale\", \"If there are no `inetd` services required, it is\nrecommended that the daemon be removed.\"\n  desc  \"check\", \"\n    Run the following command and verify `openbsd-inetd` is not installed:\n\n    ```\n    dpkg -s openbsd-inetd\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to uninstall `openbsd-inetd`:\n\n    ```\n    apt-get remove openbsd-inetd\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.1.2\"\n\n  describe package(\"openbsd-inetd\") do\n    it { should_not be_installed }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.1.2.rb",
                "line": 3
            },
            "id": "C-2.1.2"
        },
        {
            "title": "Ensure Samba is not enabled",
            "desc": "The Samba daemon allows system administrators to configure their Linux\nsystems to share file systems and directories with Windows desktops. Samba will\nadvertise the file systems and directories via the Server Message Block (SMB)\nprotocol. Windows desktop users will be able to mount these directories and\nfile systems as letter drives on their systems.",
            "descriptions": {
                "default": "The Samba daemon allows system administrators to configure their Linux\nsystems to share file systems and directories with Windows desktops. Samba will\nadvertise the file systems and directories via the Server Message Block (SMB)\nprotocol. Windows desktop users will be able to mount these directories and\nfile systems as letter drives on their systems.",
                "rationale": "If there is no need to mount directories and file systems\nto Windows systems, then this service can be deleted to reduce the potential\nattack surface.",
                "check": "Run the following command to verify `Samba` is not enabled:\n\n```\n# systemctl is-enabled smbd\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run the following command to disable `Samba`:\n\n```\n# systemctl --now disable smbd\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.12"
            },
            "code": "control \"C-2.2.12\" do\n  title \"Ensure Samba is not enabled\"\n  desc  \"The Samba daemon allows system administrators to configure their Linux\nsystems to share file systems and directories with Windows desktops. Samba will\nadvertise the file systems and directories via the Server Message Block (SMB)\nprotocol. Windows desktop users will be able to mount these directories and\nfile systems as letter drives on their systems.\"\n  desc  \"rationale\", \"If there is no need to mount directories and file systems\nto Windows systems, then this service can be deleted to reduce the potential\nattack surface.\"\n  desc  \"check\", \"\n    Run the following command to verify `Samba` is not enabled:\n\n    ```\n    # systemctl is-enabled smbd\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following command to disable `Samba`:\n\n    ```\n    # systemctl --now disable smbd\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.12\"\n\n  if package('samba').installed?\n    describe service('smbd') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n  else\n    impact 0.0\n    describe \"The Samba Server package is not installed\" do\n      skip \"The Samba Server package is not installed.\"\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.12.rb",
                "line": 3
            },
            "id": "C-2.2.12"
        },
        {
            "title": "Ensure permissions on SSH public host key files are configured",
            "desc": "An SSH public key is one of two files used in SSH public key\nauthentication. In this authentication method, a public key is a key that can\nbe used for verifying digital signatures generated using a corresponding\nprivate key. Only a public key that corresponds to a private key will be able\nto authenticate successfully.",
            "descriptions": {
                "default": "An SSH public key is one of two files used in SSH public key\nauthentication. In this authentication method, a public key is a key that can\nbe used for verifying digital signatures generated using a corresponding\nprivate key. Only a public key that corresponds to a private key will be able\nto authenticate successfully.",
                "rationale": "If a public host key file is modified by an unauthorized\nuser, the SSH service may be compromised.",
                "check": "Run the following command and verify Access does not grant write or execute\npermissions to group or other for all returned files\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec stat {} \\;\n\n     File: ‘/etc/ssh/ssh_host_rsa_key.pub’\n     Size: 382 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8631758 Links: 1\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    Access: 2018-10-22 18:24:56.861750616 +0000\n    Modify: 2018-10-22 18:24:56.861750616 +0000\n    Change: 2018-10-22 18:24:56.881750616 +0000\n     Birth: -\n     File: ‘/etc/ssh/ssh_host_ecdsa_key.pub’\n     Size: 162 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8631761 Links: 1\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    Access: 2018-10-22 18:24:56.897750616 +0000\n    Modify: 2018-10-22 18:24:56.897750616 +0000\n    Change: 2018-10-22 18:24:56.917750616 +0000\n     Birth: -\n     File: ‘/etc/ssh/ssh_host_ed25519_key.pub’\n     Size: 82 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8631763 Links: 1\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    Access: 2018-10-22 18:24:56.945750616 +0000\n    Modify: 2018-10-22 18:24:56.945750616 +0000\n    Change: 2018-10-22 18:24:56.961750616 +0000\n     Birth: -\n    ```",
                "fix": "Run the following commands to set permissions and ownership on the SSH host\npublic key files\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chmod 0644\n{} \\;\n    ```\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chown\nroot:root {} \\;\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_rid": "5.2.3",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.3\" do\n  title \"Ensure permissions on SSH public host key files are configured\"\n  desc  \"An SSH public key is one of two files used in SSH public key\nauthentication. In this authentication method, a public key is a key that can\nbe used for verifying digital signatures generated using a corresponding\nprivate key. Only a public key that corresponds to a private key will be able\nto authenticate successfully.\"\n  desc  \"rationale\", \"If a public host key file is modified by an unauthorized\nuser, the SSH service may be compromised.\"\n  desc  \"check\", \"\n    Run the following command and verify Access does not grant write or execute\npermissions to group or other for all returned files\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec stat {} \\\\;\n\n     File: ‘/etc/ssh/ssh_host_rsa_key.pub’\n     Size: 382 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8631758 Links: 1\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    Access: 2018-10-22 18:24:56.861750616 +0000\n    Modify: 2018-10-22 18:24:56.861750616 +0000\n    Change: 2018-10-22 18:24:56.881750616 +0000\n     Birth: -\n     File: ‘/etc/ssh/ssh_host_ecdsa_key.pub’\n     Size: 162 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8631761 Links: 1\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    Access: 2018-10-22 18:24:56.897750616 +0000\n    Modify: 2018-10-22 18:24:56.897750616 +0000\n    Change: 2018-10-22 18:24:56.917750616 +0000\n     Birth: -\n     File: ‘/etc/ssh/ssh_host_ed25519_key.pub’\n     Size: 82 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8631763 Links: 1\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    Access: 2018-10-22 18:24:56.945750616 +0000\n    Modify: 2018-10-22 18:24:56.945750616 +0000\n    Change: 2018-10-22 18:24:56.961750616 +0000\n     Birth: -\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set permissions and ownership on the SSH host\npublic key files\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chmod 0644\n{} \\\\;\n    ```\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chown\nroot:root {} \\\\;\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_rid: \"5.2.3\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  if inspec.directory('/etc/ssh').exist?\n    find_command = command(\"find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub'\").stdout.lines\n    unless find_command.empty?\n      find_command.each do |key_file|\n        describe file(key_file.chomp) do\n          it { should be_file }\n          it { should be_owned_by 'root' }\n          it { should be_grouped_into 'root' }\n          it { should_not be_more_permissive_than('00644') }\n        end\n      end\n    else \n      descibe \"No 'ssh_host_*_key.pub' files were found in '/etc/ssh'\" do \n        skip \"You must validate this control manually or correct your sshd config\"\n      end\n    end\n  else\n    descibe \"'/etc/ssh' does not seem to exist, you must check this control by hand\" do\n      skip '/etc/ssh did not exist, please check this control by hand'\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.3.rb",
                "line": 3
            },
            "id": "C-5.2.3"
        },
        {
            "title": "Ensure core dumps are restricted",
            "desc": "A core dump is the memory of an executable program. It is generally\nused to determine why a program aborted. It can also be used to glean\nconfidential information from a core file. The system provides the ability to\nset a soft limit for core dumps, but this can be overridden by the user.",
            "descriptions": {
                "default": "A core dump is the memory of an executable program. It is generally\nused to determine why a program aborted. It can also be used to glean\nconfidential information from a core file. The system provides the ability to\nset a soft limit for core dumps, but this can be overridden by the user.",
                "rationale": "Setting a hard limit on core dumps prevents users from\noverriding the soft variable. If core dumps are required, consider setting\nlimits for user groups (see `limits.conf(5)` ). In addition, setting the\n`fs.suid_dumpable` variable to 0 will prevent setuid programs from dumping\ncore.",
                "check": "Run the following commands and verify output matches:\n\n```\n# grep \"hard core\" /etc/security/limits.conf /etc/security/limits.d/*\n\n* hard core 0\n```\n\n```\n# sysctl fs.suid_dumpable\n\nfs.suid_dumpable = 0\n```\n\n```\n# grep \"fs\\.suid_dumpable\" /etc/sysctl.conf /etc/sysctl.d/*\n\nfs.suid_dumpable = 0\n```\n\nRun the following command to check if systemd-coredump is installed:\n\n```\n# systemctl is-enabled coredump.service\n```\n\nif `enabled` or `disabled` is returned systemd-coredump is installed",
                "fix": "Add the following line to `/etc/security/limits.conf` or a\n`/etc/security/limits.d/*` file:\n\n    ```\n    * hard core 0\n    ```\n\n    Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    fs.suid_dumpable = 0\n    ```\n\n    Run the following command to set the active kernel parameter:\n\n    ```\n    # sysctl -w fs.suid_dumpable=0\n    ```\n\n    If systemd-coredump is installed:\n\n    edit `/etc/systemd/coredump.conf` and add/modify the following lines:\n\n    ```\n    Storage=none\n    ProcessSizeMax=0\n    ```\n\n    Run the command:\n\n    ```\n    systemctl daemon-reload\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.6.4"
            },
            "code": "control \"C-1.6.4\" do\n  title \"Ensure core dumps are restricted\"\n  desc  \"A core dump is the memory of an executable program. It is generally\nused to determine why a program aborted. It can also be used to glean\nconfidential information from a core file. The system provides the ability to\nset a soft limit for core dumps, but this can be overridden by the user.\"\n  desc  \"rationale\", \"Setting a hard limit on core dumps prevents users from\noverriding the soft variable. If core dumps are required, consider setting\nlimits for user groups (see `limits.conf(5)` ). In addition, setting the\n`fs.suid_dumpable` variable to 0 will prevent setuid programs from dumping\ncore.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # grep \\\"hard core\\\" /etc/security/limits.conf /etc/security/limits.d/*\n\n    * hard core 0\n    ```\n\n    ```\n    # sysctl fs.suid_dumpable\n\n    fs.suid_dumpable = 0\n    ```\n\n    ```\n    # grep \\\"fs\\\\.suid_dumpable\\\" /etc/sysctl.conf /etc/sysctl.d/*\n\n    fs.suid_dumpable = 0\n    ```\n\n    Run the following command to check if systemd-coredump is installed:\n\n    ```\n    # systemctl is-enabled coredump.service\n    ```\n\n    if `enabled` or `disabled` is returned systemd-coredump is installed\n  \"\n  desc  \"fix\", \"\n    Add the following line to `/etc/security/limits.conf` or a\n`/etc/security/limits.d/*` file:\n\n    ```\n    * hard core 0\n    ```\n\n    Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    fs.suid_dumpable = 0\n    ```\n\n    Run the following command to set the active kernel parameter:\n\n    ```\n    # sysctl -w fs.suid_dumpable=0\n    ```\n\n    If systemd-coredump is installed:\n\n    edit `/etc/systemd/coredump.conf` and add/modify the following lines:\n\n    ```\n    Storage=none\n    ProcessSizeMax=0\n    ```\n\n    Run the command:\n\n    ```\n    systemctl daemon-reload\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.6.4\"\n\n\n  describe package('systemd-coredump') do\n    it { should_not be_installed }\n  end\n\n  describe kernel_parameter('fs.suid_dumpable') do\n    its('value') { should cmp 0 }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.6.4.rb",
                "line": 3
            },
            "id": "C-1.6.4"
        },
        {
            "title": "Ensure audit_backlog_limit is sufficient",
            "desc": "The backlog limit has a default setting of 64",
            "descriptions": {
                "default": "The backlog limit has a default setting of 64",
                "rationale": "during boot if audit=1, then the backlog will hold 64\nrecords. If more that 64 records are created during boot, auditd records will\nbe lost and potential malicious activity could go undetected.",
                "check": "Run the following commands and verify the `audit_backlog_limit=` parameter\nis set to an appropriate size for your organization\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v \"audit_backlog_limit=\"\n    ```\n\n    Nothing should be returned\n\n    ```\n    # grep \"audit_backlog_limit=\" /boot/grub/grub.cfg\n    ```\n\n    Ensure the the returned value complies with local site policy\n\n    **Recommended that this value be `8192` or larger.**",
                "fix": "Edit /etc/default/grub and add `audit_backlog_limit=` to GRUB_CMDLINE_LINUX:\n\n**Example:**\n\n```\nGRUB_CMDLINE_LINUX=\"audit_backlog_limit=8192\"\n```\n\nRun the following command to update the grub2 configuration:\n\n```\n# update-grub\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-12",
                    "AU-3"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "6.2",
                    "6.3"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.1.4"
            },
            "code": "control \"C-4.1.1.4\" do\n  title \"Ensure audit_backlog_limit is sufficient\"\n  desc  \"The backlog limit has a default setting of 64\"\n  desc  \"rationale\", \"during boot if audit=1, then the backlog will hold 64\nrecords. If more that 64 records are created during boot, auditd records will\nbe lost and potential malicious activity could go undetected.\"\n  desc  \"check\", \"\n    Run the following commands and verify the `audit_backlog_limit=` parameter\nis set to an appropriate size for your organization\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v \\\"audit_backlog_limit=\\\"\n    ```\n\n    Nothing should be returned\n\n    ```\n    # grep \\\"audit_backlog_limit=\\\" /boot/grub/grub.cfg\n    ```\n\n    Ensure the the returned value complies with local site policy\n\n    **Recommended that this value be `8192` or larger.**\n  \"\n  desc \"fix\", \"\n    Edit /etc/default/grub and add `audit_backlog_limit=` to GRUB_CMDLINE_LINUX:\n\n    **Example:**\n\n    ```\n    GRUB_CMDLINE_LINUX=\\\"audit_backlog_limit=8192\\\"\n    ```\n\n    Run the following command to update the grub2 configuration:\n\n    ```\n    # update-grub\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-12\", \"AU-3\"]\n  tag cis_level: 2\n  tag cis_controls: [\"6.2\", \"6.3\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.1.4\"\n  grep_command = command(\"grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v \\\"audit_backlog_limit=\\\"\").stdout.lines\n  describe \"All grub bootloader linux lines should include an audit_backlog_limit parameter\" do\n    subject { grep_command }\n    it { should be_empty }\n  end\n  grep_command.each do |line|\n    describe line.chomp do\n      it { should include \"audit_backlog_limit=\" }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.1.4.rb",
                "line": 3
            },
            "id": "C-4.1.1.4"
        },
        {
            "title": "Ensure system is disabled when audit logs are full",
            "desc": "The `auditd` daemon can be configured to halt the system when the\naudit logs are full.",
            "descriptions": {
                "default": "The `auditd` daemon can be configured to halt the system when the\naudit logs are full.",
                "rationale": "In high security contexts, the risk of detecting\nunauthorized access or nonrepudiation exceeds the benefit of the system's\navailability.",
                "check": "Run the following commands and verify output matches:\n\n```\n# grep space_left_action /etc/audit/auditd.conf\n\nspace_left_action = email\n```\n\n```\n# grep action_mail_acct /etc/audit/auditd.conf\n\naction_mail_acct = root\n```\n\n```\n# grep admin_space_left_action /etc/audit/auditd.conf\n\nadmin_space_left_action = halt\n```",
                "fix": "Set the following parameters in `/etc/audit/auditd.conf:`\n\n```\nspace_left_action = email\naction_mail_acct = root\nadmin_space_left_action = halt\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "6.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.2.3"
            },
            "code": "control \"C-4.1.2.3\" do\n  title \"Ensure system is disabled when audit logs are full\"\n  desc  \"The `auditd` daemon can be configured to halt the system when the\naudit logs are full.\"\n  desc  \"rationale\", \"In high security contexts, the risk of detecting\nunauthorized access or nonrepudiation exceeds the benefit of the system's\navailability.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # grep space_left_action /etc/audit/auditd.conf\n\n    space_left_action = email\n    ```\n\n    ```\n    # grep action_mail_acct /etc/audit/auditd.conf\n\n    action_mail_acct = root\n    ```\n\n    ```\n    # grep admin_space_left_action /etc/audit/auditd.conf\n\n    admin_space_left_action = halt\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameters in `/etc/audit/auditd.conf:`\n\n    ```\n    space_left_action = email\n    action_mail_acct = root\n    admin_space_left_action = halt\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"6.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.2.3\"\n\n  describe auditd_conf do\n    its('space_left_action') { should cmp 'email' }\n    its('action_mail_acct') { should cmp 'root' }\n    its('admin_space_left_action') { should cmp 'halt' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.2.3.rb",
                "line": 3
            },
            "id": "C-4.1.2.3"
        },
        {
            "title": "Ensure authentication required for single user mode",
            "desc": "Single user mode is used for recovery when the system detects an issue\nduring boot or by manual selection from the bootloader.",
            "descriptions": {
                "default": "Single user mode is used for recovery when the system detects an issue\nduring boot or by manual selection from the bootloader.",
                "rationale": "Requiring authentication in single user mode prevents an\nunauthorized user from rebooting the system into single user to gain root\nprivileges without credentials.",
                "check": "Perform the following to determine if a password is set for the `root` user:\n\n```\n# grep ^root:[*\\!]: /etc/shadow\n```\n\nNo results should be returned.",
                "fix": "Run the following command and follow the prompts to set a password for the\n`root` user:\n\n    ```\n    # passwd root\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.5.3"
            },
            "code": "control \"C-1.5.3\" do\n  title \"Ensure authentication required for single user mode\"\n  desc  \"Single user mode is used for recovery when the system detects an issue\nduring boot or by manual selection from the bootloader.\"\n  desc  \"rationale\", \"Requiring authentication in single user mode prevents an\nunauthorized user from rebooting the system into single user to gain root\nprivileges without credentials.\"\n  desc  \"check\", \"\n    Perform the following to determine if a password is set for the `root` user:\n\n    ```\n    # grep ^root:[*\\\\!]: /etc/shadow\n    ```\n\n    No results should be returned.\n  \"\n  desc  \"fix\", \"\n    Run the following command and follow the prompts to set a password for the\n`root` user:\n\n    ```\n    # passwd root\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.5.3\"\n\n  describe shadow do\n    its('users') { should include 'root' }\n  end\n\n  describe shadow.where(user: 'root') do\n    its('passwords') { should_not include '!' }\n  end\n  describe shadow.where(user: 'root') do\n    its('passwords') { should_not include '*' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.5.3.rb",
                "line": 3
            },
            "id": "C-1.5.3"
        },
        {
            "title": "Ensure a table exists",
            "desc": "Tables hold chains. Each table only has one address family and only\napplies to packets of this family. Tables can have one of five families.",
            "descriptions": {
                "default": "Tables hold chains. Each table only has one address family and only\napplies to packets of this family. Tables can have one of five families.",
                "rationale": "nftables doesn't have any default tables. Without a table\nbeing build, nftables will not filter network traffic.",
                "check": "Run the following command to verify that a nftables table exists:\n\n```\n# nft list tables\n```\n\nReturn should include a list of nftables:\n\nexample:\n\n```\ntable inet filter\n```",
                "fix": "Run the following command to create a table in nftables\n\n```\n# nft create table inet\n\n```\n\nExample:\n\n```\n# nft create table inet filter\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.3.2"
            },
            "code": "control \"C-3.5.3.2\" do\n  title \"Ensure a table exists\"\n  desc  \"Tables hold chains. Each table only has one address family and only\napplies to packets of this family. Tables can have one of five families.\"\n  desc  \"rationale\", \"nftables doesn't have any default tables. Without a table\nbeing build, nftables will not filter network traffic.\"\n  desc  \"check\", \"\n    Run the following command to verify that a nftables table exists:\n\n    ```\n    # nft list tables\n    ```\n\n    Return should include a list of nftables:\n\n    example:\n\n    ```\n    table inet filter\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to create a table in nftables\n\n    ```\n    # nft create table inet\n\n    ```\n\n    Example:\n\n    ```\n    # nft create table inet filter\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.3.2\"\n\n  nft_tables = command('nft list tables').stdout.strip\n\n  if service('nftables').running? && service('nftables').enabled?\n    describe \"File '#{nft_tables}' \\n Manually verification required.\\n verify that a nftables table exists.\" do\n      skip \"File '#{nft_tables}' \\n Manually verification required.\\n Aerify that a nftables table exists.\"\n    end\n  else\n    describe service('nftables') do\n      it { should be_running }\n      it { should be_enabled }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.3.2.rb",
                "line": 3
            },
            "id": "C-3.5.3.2"
        },
        {
            "title": "Ensure permissions on /etc/cron.daily are configured",
            "desc": "The `/etc/cron.daily` directory contains system cron jobs that need to\nrun on a daily basis. The files in this directory cannot be manipulated by the\n`crontab` command, but are instead edited by system administrators using a text\neditor. The commands below restrict read/write and search access to user and\ngroup root, preventing regular users from accessing this directory.",
            "descriptions": {
                "default": "The `/etc/cron.daily` directory contains system cron jobs that need to\nrun on a daily basis. The files in this directory cannot be manipulated by the\n`crontab` command, but are instead edited by system administrators using a text\neditor. The commands below restrict read/write and search access to user and\ngroup root, preventing regular users from accessing this directory.",
                "rationale": "Granting write access to this directory for\nnon-privileged users could provide them the means for gaining unauthorized\nelevated privileges. Granting read access to this directory could give an\nunprivileged user insight in how to gain elevated privileges or circumvent\nauditing controls.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/cron.daily\n\n    Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set ownership and permissions on\n`/etc/cron.daily` :\n\n    ```\n    # chown root:root /etc/cron.daily\n    ```\n\n    ```\n    # chmod og-rwx /etc/cron.daily\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "5.1.4"
            },
            "code": "control \"C-5.1.4\" do\n  title \"Ensure permissions on /etc/cron.daily are configured\"\n  desc  \"The `/etc/cron.daily` directory contains system cron jobs that need to\nrun on a daily basis. The files in this directory cannot be manipulated by the\n`crontab` command, but are instead edited by system administrators using a text\neditor. The commands below restrict read/write and search access to user and\ngroup root, preventing regular users from accessing this directory.\"\n  desc  \"rationale\", \"Granting write access to this directory for\nnon-privileged users could provide them the means for gaining unauthorized\nelevated privileges. Granting read access to this directory could give an\nunprivileged user insight in how to gain elevated privileges or circumvent\nauditing controls.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/cron.daily\n\n    Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set ownership and permissions on\n`/etc/cron.daily` :\n\n    ```\n    # chown root:root /etc/cron.daily\n    ```\n\n    ```\n    # chmod og-rwx /etc/cron.daily\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"5.1.4\"\n\n  describe file('/etc/cron.daily') do \n    its('owner') { should cmp 'root' }\n    its('group') { should cmp 'root' }\n    it { should be_directory }\n    it { should_not be_more_permissive_than('0700') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.1.4.rb",
                "line": 3
            },
            "id": "C-5.1.4"
        },
        {
            "title": "Ensure DHCP Server is not enabled",
            "desc": "The Dynamic Host Configuration Protocol (DHCP) is a service that\nallows machines to be dynamically assigned IP addresses.",
            "descriptions": {
                "default": "The Dynamic Host Configuration Protocol (DHCP) is a service that\nallows machines to be dynamically assigned IP addresses.",
                "rationale": "Unless a system is specifically set up to act as a DHCP\nserver, it is recommended that this service be deleted to reduce the potential\nattack surface.",
                "check": "Run the following commands to verify `dhcpd` is not enabled:\n\n```\n# systemctl is-enabled isc-dhcp-server\n\ndisabled\n```\n\n```\n# systemctl is-enabled isc-dhcp-server6\n\ndisabled\n```\n\nVerify results are not `enabled`.",
                "fix": "Run one of the following commands to disable `dhcpd`:\n\n```\n# systemctl --now disable isc-dhcp-server\n```\n\n```\n# systemctl --now disable isc-dhcp-server6\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.5"
            },
            "code": "control \"C-2.2.5\" do\n  title \"Ensure DHCP Server is not enabled\"\n  desc  \"The Dynamic Host Configuration Protocol (DHCP) is a service that\nallows machines to be dynamically assigned IP addresses.\"\n  desc  \"rationale\", \"Unless a system is specifically set up to act as a DHCP\nserver, it is recommended that this service be deleted to reduce the potential\nattack surface.\"\n  desc  \"check\", \"\n    Run the following commands to verify `dhcpd` is not enabled:\n\n    ```\n    # systemctl is-enabled isc-dhcp-server\n\n    disabled\n    ```\n\n    ```\n    # systemctl is-enabled isc-dhcp-server6\n\n    disabled\n    ```\n\n    Verify results are not `enabled`.\n  \"\n  desc  \"fix\", \"\n    Run one of the following commands to disable `dhcpd`:\n\n    ```\n    # systemctl --now disable isc-dhcp-server\n    ```\n\n    ```\n    # systemctl --now disable isc-dhcp-server6\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.5\"\n\n  if package('wide-dhcpv6-server').installed? || package('kea-dhcp4-server').installed? || package('isc-dhcp-server').installed?\n    if package('wide-dhcpv6-server').installed?\n    describe service('wide-dhcpv6-server') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n    end\n    if package('kea-dhcp4-server').installed?\n    describe service('kea-dhcp4-server') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n    end\n    if package('isc-dhcp-server').installed?\n      describe service('isc-dhcp-server') do\n        it { should_not be_enabled }\n        it { should_not be_running }\n      end\n    end\n  else\n    impact 0.0\n    describe \"A DHCP Server package is not installed\" do\n      skip \"A DHCP Server package is not installed, this control is Not Applicable.\"\n    end\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.5.rb",
                "line": 3
            },
            "id": "C-2.2.5"
        },
        {
            "title": "Ensure loopback traffic is configured",
            "desc": "Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network (127.0.0.0/8).",
            "descriptions": {
                "default": "Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network (127.0.0.0/8).",
                "rationale": "Loopback traffic is generated between processes on\nmachine and is typically critical to operation of the system. The loopback\ninterface is the only place that loopback network (127.0.0.0/8) traffic should\nbe seen, all other interfaces should ignore traffic on this network as an\nanti-spoofing measure.",
                "check": "Run the following commands and verify output includes the listed rules in\norder (packet and byte counts may differ):\n\n    ```\n    # iptables -L INPUT -v -n\n    Chain INPUT (policy DROP 0 packets, 0 bytes)\n     pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all -- lo * 0.0.0.0/0 0.0.0.0/0\n     0 0 DROP all -- * * 127.0.0.0/8 0.0.0.0/0\n\n     # iptables -L OUTPUT -v -n\n    Chain OUTPUT (policy DROP 0 packets, 0 bytes)\n     pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all -- * lo 0.0.0.0/0 0.0.0.0/0\n    ```",
                "fix": "Run the following commands to implement the loopback rules:\n\n```\n# iptables -A INPUT -i lo -j ACCEPT\n# iptables -A OUTPUT -o lo -j ACCEPT\n# iptables -A INPUT -s 127.0.0.0/8 -j DROP\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.4.1.2"
            },
            "code": "control \"C-3.5.4.1.2\" do\n  title \"Ensure loopback traffic is configured\"\n  desc  \"Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network (127.0.0.0/8).\"\n  desc  \"rationale\", \"Loopback traffic is generated between processes on\nmachine and is typically critical to operation of the system. The loopback\ninterface is the only place that loopback network (127.0.0.0/8) traffic should\nbe seen, all other interfaces should ignore traffic on this network as an\nanti-spoofing measure.\"\n  desc  \"check\", \"\n    Run the following commands and verify output includes the listed rules in\norder (packet and byte counts may differ):\n\n    ```\n    # iptables -L INPUT -v -n\n    Chain INPUT (policy DROP 0 packets, 0 bytes)\n     pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all -- lo * 0.0.0.0/0 0.0.0.0/0\n     0 0 DROP all -- * * 127.0.0.0/8 0.0.0.0/0\n\n     # iptables -L OUTPUT -v -n\n    Chain OUTPUT (policy DROP 0 packets, 0 bytes)\n     pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all -- * lo 0.0.0.0/0 0.0.0.0/0\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to implement the loopback rules:\n\n    ```\n    # iptables -A INPUT -i lo -j ACCEPT\n    # iptables -A OUTPUT -o lo -j ACCEPT\n    # iptables -A INPUT -s 127.0.0.0/8 -j DROP\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.4.1.2\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.4.1.2.rb",
                "line": 3
            },
            "id": "C-3.5.4.1.2"
        },
        {
            "title": "Ensure mounting of squashfs filesystems is disabled",
            "desc": "The `squashfs` filesystem type is a compressed read-only Linux\nfilesystem embedded in small footprint systems (similar to `cramfs` ). A\n`squashfs` image can be used without having to first decompress the image.",
            "descriptions": {
                "default": "The `squashfs` filesystem type is a compressed read-only Linux\nfilesystem embedded in small footprint systems (similar to `cramfs` ). A\n`squashfs` image can be used without having to first decompress the image.",
                "rationale": "Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe --showconfig | grep squashfs\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep squashfs\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/squashfs.conf`\n\nand add the following line:\n\n```\ninstall squashfs /bin/true\n```\n\nRun the following command to unload the `squashfs` module:\n\n```\n# rmmod squashfs\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.1.6"
            },
            "code": "control \"C-1.1.1.6\" do\n  title \"Ensure mounting of squashfs filesystems is disabled\"\n  desc  \"The `squashfs` filesystem type is a compressed read-only Linux\nfilesystem embedded in small footprint systems (similar to `cramfs` ). A\n`squashfs` image can be used without having to first decompress the image.\"\n  desc  \"rationale\", \"Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe --showconfig | grep squashfs\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep squashfs\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/squashfs.conf`\n\n    and add the following line:\n\n    ```\n    install squashfs /bin/true\n    ```\n\n    Run the following command to unload the `squashfs` module:\n\n    ```\n    # rmmod squashfs\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.1.6\"\n\n  describe kernel_module('squashfs') do\n    it { should_not be_loaded }\n    it { should be_disabled }\n    it { should be_blacklisted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.1.6.rb",
                "line": 3
            },
            "id": "C-1.1.1.6"
        },
        {
            "title": "Ensure password expiration warning days is 7 or more",
            "desc": "The `PASS_WARN_AGE` parameter in `/etc/login.defs` allows an\nadministrator to notify users that their password will expire in a defined\nnumber of days. It is recommended that the `PASS_WARN_AGE` parameter be set to\n7 or more days.",
            "descriptions": {
                "default": "The `PASS_WARN_AGE` parameter in `/etc/login.defs` allows an\nadministrator to notify users that their password will expire in a defined\nnumber of days. It is recommended that the `PASS_WARN_AGE` parameter be set to\n7 or more days.",
                "rationale": "Providing an advance warning that a password will be\nexpiring gives users time to think of a secure password. Users caught unaware\nmay choose a simple password or write it down where it may be discovered.",
                "check": "Run the following command and verify `PASS_WARN_AGE` conforms to site\npolicy (No less than 7 days):\n\n    ```\n    # grep PASS_WARN_AGE /etc/login.defs\n\n    PASS_WARN_AGE 7\n    ```\n\n    Verify all users with a password have their number of days of warning\nbefore password expires set to 7 or more:\n    Run the following command and Review list of users and `PASS_WARN_AGE` to\nverify that all users' `PASS_WARN_AGE` conforms to site policy (No less than 7\ndays):\n\n    ```\n    # grep -E ^[^:]+:[^\\!*] /etc/shadow | cut -d: -f1,6\n\n    :\n\n    ```",
                "fix": "Set the `PASS_WARN_AGE` parameter to 7 in `/etc/login.defs` :\n\n```\nPASS_WARN_AGE 7\n```\n\nModify user parameters for all users with a password set to match:\n\n```\n# chage --warndays 7\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "IA-5 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.4",
                    "Rev_7"
                ],
                "cis_rid": "5.4.1.3"
            },
            "code": "control \"C-5.4.1.3\" do\n  title \"Ensure password expiration warning days is 7 or more\"\n  desc  \"The `PASS_WARN_AGE` parameter in `/etc/login.defs` allows an\nadministrator to notify users that their password will expire in a defined\nnumber of days. It is recommended that the `PASS_WARN_AGE` parameter be set to\n7 or more days.\"\n  desc  \"rationale\", \"Providing an advance warning that a password will be\nexpiring gives users time to think of a secure password. Users caught unaware\nmay choose a simple password or write it down where it may be discovered.\"\n  desc  \"check\", \"\n    Run the following command and verify `PASS_WARN_AGE` conforms to site\npolicy (No less than 7 days):\n\n    ```\n    # grep PASS_WARN_AGE /etc/login.defs\n\n    PASS_WARN_AGE 7\n    ```\n\n    Verify all users with a password have their number of days of warning\nbefore password expires set to 7 or more:\n    Run the following command and Review list of users and `PASS_WARN_AGE` to\nverify that all users' `PASS_WARN_AGE` conforms to site policy (No less than 7\ndays):\n\n    ```\n    # grep -E ^[^:]+:[^\\\\!*] /etc/shadow | cut -d: -f1,6\n\n    :\n\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the `PASS_WARN_AGE` parameter to 7 in `/etc/login.defs` :\n\n    ```\n    PASS_WARN_AGE 7\n    ```\n\n    Modify user parameters for all users with a password set to match:\n\n    ```\n    # chage --warndays 7\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"IA-5 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.4\", \"Rev_7\"]\n  tag cis_rid: \"5.4.1.3\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.4.1.3.rb",
                "line": 3
            },
            "id": "C-5.4.1.3"
        },
        {
            "title": "Ensure use of privileged commands is collected",
            "desc": "Monitor privileged programs (those that have the setuid and/or setgid\nbit set on execution) to determine if unprivileged users are running these\ncommands.\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.",
            "descriptions": {
                "default": "Monitor privileged programs (those that have the setuid and/or setgid\nbit set on execution) to determine if unprivileged users are running these\ncommands.\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.",
                "rationale": "Execution of privileged commands by non-privileged users\ncould be an indication of someone trying to gain unauthorized access to the\nsystem.",
                "check": "Run the following command replacing `\n\n    \t` with a list of partitions where programs can be executed from on your\nsystem:\n\n    ```\n    # find\n\n    \t -xdev \\( -perm -4000 -o -perm -2000 \\) -type f | awk '{print \\\n    \"-a always,exit -F path=\" $1 \" -F perm=x -F auid>=1000 -F\nauid!=4294967295 \\\n    -k privileged\" }'\n    ```\n\n    Verify all resulting lines are a `.rules` file in `/etc/audit/rules.d/` and\nthe output of `auditctl -l`.\n\n    NOTE: The `.rules` file output will be `auid!=-1` not `auid!=4294967295`",
                "fix": "To remediate this issue, the system administrator will have to execute a\nfind command to locate all the privileged programs and then add an audit line\nfor each one of them. The audit parameters associated with this are as follows:\n     `-F path=\" $1 \"` - will populate each file name found through the find\ncommand and processed by awk. `-F perm=x` - will write an audit record if the\nfile is executed. `-F auid>=1000` - will write a record if the user executing\nthe command is not a privileged user. `-F auid!= 4294967295` - will ignore\nDaemon events\n\n    All audit records should be tagged with the identifier \"privileged\".\n\n    Run the following command replacing _\n\n    \t_ with a list of partitions where programs can be executed from on your\nsystem:\n\n    ```\n    # find\n\n    \t -xdev \\( -perm -4000 -o -perm -2000 \\) -type f | awk '{print \\\n    \"-a always,exit -F path=\" $1 \" -F perm=x -F auid>=1000 -F\nauid!=4294967295 \\\n    -k privileged\" }'\n    ```\n\n    Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/privileged.rules`\n\n    And add all resulting lines to the file."
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.1"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.11"
            },
            "code": "control \"C-4.1.11\" do\n  title \"Ensure use of privileged commands is collected\"\n  desc  \"Monitor privileged programs (those that have the setuid and/or setgid\nbit set on execution) to determine if unprivileged users are running these\ncommands.\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.\n  \"\n  desc  \"rationale\", \"Execution of privileged commands by non-privileged users\ncould be an indication of someone trying to gain unauthorized access to the\nsystem.\"\n  desc  \"check\", \"\n    Run the following command replacing `\n\n    \\t` with a list of partitions where programs can be executed from on your\nsystem:\n\n    ```\n    # find\n\n    \\t -xdev \\\\( -perm -4000 -o -perm -2000 \\\\) -type f | awk '{print \\\\\n    \\\"-a always,exit -F path=\\\" $1 \\\" -F perm=x -F auid>=1000 -F\nauid!=4294967295 \\\\\n    -k privileged\\\" }'\n    ```\n\n    Verify all resulting lines are a `.rules` file in `/etc/audit/rules.d/` and\nthe output of `auditctl -l`.\n\n    NOTE: The `.rules` file output will be `auid!=-1` not `auid!=4294967295`\n  \"\n  desc \"fix\", \"\n    To remediate this issue, the system administrator will have to execute a\nfind command to locate all the privileged programs and then add an audit line\nfor each one of them. The audit parameters associated with this are as follows:\n     `-F path=\\\" $1 \\\"` - will populate each file name found through the find\ncommand and processed by awk. `-F perm=x` - will write an audit record if the\nfile is executed. `-F auid>=1000` - will write a record if the user executing\nthe command is not a privileged user. `-F auid!= 4294967295` - will ignore\nDaemon events\n\n    All audit records should be tagged with the identifier \\\"privileged\\\".\n\n    Run the following command replacing _\n\n    \\t_ with a list of partitions where programs can be executed from on your\nsystem:\n\n    ```\n    # find\n\n    \\t -xdev \\\\( -perm -4000 -o -perm -2000 \\\\) -type f | awk '{print \\\\\n    \\\"-a always,exit -F path=\\\" $1 \\\" -F perm=x -F auid>=1000 -F\nauid!=4294967295 \\\\\n    -k privileged\\\" }'\n    ```\n\n    Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/privileged.rules`\n\n    And add all resulting lines to the file.\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.1\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.11\"\n  command(\"mount |grep -v noexec|cut -d' ' -f3\").stdout.lines.each do |line|\n    command(\"find #{line.chomp} -xdev \\\\( -perm -4000 -o -perm -2000 \\\\) -type f\").stdout.lines.each do |executable|\n      describe auditd.where { key == 'privileged' && path == executable} do\n        its('action.uniq') { should eq ['always'] }\n        its('list.uniq') { should eq ['exit'] }\n        its('permissions') { should include ['x'] }\n      end\n\n      # the rule states that `auid!=4294967295` but this comes back as `auid!=-1` when queries via `auditctl -l`\n      # this check will allow either.\n      describe.one do\n        describe auditd.where { key == 'privileged' && path == executable} do\n          its('fields.flatten.uniq') {  should include \"auid!=-1\" }\n        end\n        describe auditd.where { key == 'privileged' && path == executable} do\n          its('fields.flatten.uniq') {  should include \"auid!=4294967295\" }\n        end\n      end\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.11.rb",
                "line": 3
            },
            "id": "C-4.1.11"
        },
        {
            "title": "Ensure all groups in /etc/passwd exist in /etc/group",
            "desc": "Over time, system administration errors and changes can lead to groups\nbeing defined in `/etc/passwd` but not in `/etc/group` .",
            "descriptions": {
                "default": "Over time, system administration errors and changes can lead to groups\nbeing defined in `/etc/passwd` but not in `/etc/group` .",
                "rationale": "Groups defined in the `/etc/passwd` file but not in the\n`/etc/group` file pose a threat to system security since group permissions are\nnot properly managed.",
                "check": "Run the following script and verify no results are returned:\n\n```\n#!/bin/bash\n\nawk -F: '{print $4}' /etc/passwd | while read -r gid; do\n if ! grep -E -q \"^.*?:[^:]*:$gid:\" /etc/group; then\n echo \"The group ID \\\"$gid\\\" does not exist in /etc/group\"\n fi\ndone\n```",
                "fix": "Analyze the output of the Audit step above and perform the\nappropriate action to correct any discrepancies found."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-2",
                    "AC-2",
                    "AC-2"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.6",
                    "16.7",
                    "16.8"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.15"
            },
            "code": "control \"C-6.2.15\" do\n  title \"Ensure all groups in /etc/passwd exist in /etc/group\"\n  desc  \"Over time, system administration errors and changes can lead to groups\nbeing defined in `/etc/passwd` but not in `/etc/group` .\"\n  desc  \"rationale\", \"Groups defined in the `/etc/passwd` file but not in the\n`/etc/group` file pose a threat to system security since group permissions are\nnot properly managed.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    awk -F: '{print $4}' /etc/passwd | while read -r gid; do\n     if ! grep -E -q \\\"^.*?:[^:]*:$gid:\\\" /etc/group; then\n     echo \\\"The group ID \\\\\\\"$gid\\\\\\\" does not exist in /etc/group\\\"\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"Analyze the output of the Audit step above and perform the\nappropriate action to correct any discrepancies found.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-2\", \"AC-2\", \"AC-2\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.6\", \"16.7\", \"16.8\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.15\"\n\n  # passwd.gids returns a list of strings, while groups.gids returns a list of integers\n  all_gids = groups.gids.map { |gid| gid.to_s }\n\n  describe passwd do\n    its('gids') { should be_in all_gids }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.15.rb",
                "line": 3
            },
            "id": "C-6.2.15"
        },
        {
            "title": "Ensure SCTP is disabled",
            "desc": "The Stream Control Transmission Protocol (SCTP) is a transport layer\nprotocol used to support message oriented communication, with several streams\nof messages in one connection. It serves a similar function as TCP and UDP,\nincorporating features of both. It is message-oriented like UDP, and ensures\nreliable in-sequence transport of messages with congestion control like TCP.",
            "descriptions": {
                "default": "The Stream Control Transmission Protocol (SCTP) is a transport layer\nprotocol used to support message oriented communication, with several streams\nof messages in one connection. It serves a similar function as TCP and UDP,\nincorporating features of both. It is message-oriented like UDP, and ensures\nreliable in-sequence transport of messages with congestion control like TCP.",
                "rationale": "If the protocol is not being used, it is recommended that\nkernel module not be loaded, disabling the service to reduce the potential\nattack surface.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe -n -v sctp\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep sctp\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/sctp.conf`\n\nand add the following line:\n\n```\ninstall sctp /bin/true\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "3.4.2"
            },
            "code": "control \"C-3.4.2\" do\n  title \"Ensure SCTP is disabled\"\n  desc  \"The Stream Control Transmission Protocol (SCTP) is a transport layer\nprotocol used to support message oriented communication, with several streams\nof messages in one connection. It serves a similar function as TCP and UDP,\nincorporating features of both. It is message-oriented like UDP, and ensures\nreliable in-sequence transport of messages with congestion control like TCP.\"\n  desc  \"rationale\", \"If the protocol is not being used, it is recommended that\nkernel module not be loaded, disabling the service to reduce the potential\nattack surface.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe -n -v sctp\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep sctp\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/sctp.conf`\n\n    and add the following line:\n\n    ```\n    install sctp /bin/true\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"3.4.2\"\n\n  describe kernel_module('sctp') do\n    it { should_not be_loaded }\n    it { should_not be_disabled }\n    it { should_not be_blacklisted }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.4.2.rb",
                "line": 3
            },
            "id": "C-3.4.2"
        },
        {
            "title": "Disable USB Storage",
            "desc": "USB storage provides a means to transfer and store files insuring\n        persistence and availability of the files independent of network connection\n        status. Its popularity and utility has led to USB-based malware being a simple\n        and common means for network infiltration and a first step to establishing a\n        persistent threat within a networked environment.",
            "descriptions": {
                "default": "USB storage provides a means to transfer and store files insuring\n        persistence and availability of the files independent of network connection\n        status. Its popularity and utility has led to USB-based malware being a simple\n        and common means for network infiltration and a first step to establishing a\n        persistent threat within a networked environment.",
                "rationale": "Restricting USB access on the system will decrease the\n        physical attack surface for a device and diminish the possible vectors to\n        introduce malware.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe -n -v usb-storage\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep usb-storage\n\n```",
                "fix": "Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\n\nExample: vi /etc/modprobe.d/usb_storage.conf\nand add the following line:\n\n```\ninstall usb-storage /bin/true\n```\n\nRun the following command to unload the usb-storage module:\n\n```\nrmmod usb-storage\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SI-3",
                    "SC-18(4)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "8.4",
                    "8.5"
                ],
                "cis_rid": "1.1.23",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-1.1.23\" do\n  title \"Disable USB Storage\"\n  desc  \"USB storage provides a means to transfer and store files insuring\n        persistence and availability of the files independent of network connection\n        status. Its popularity and utility has led to USB-based malware being a simple\n        and common means for network infiltration and a first step to establishing a\n        persistent threat within a networked environment.\"\n  desc  \"rationale\", \"Restricting USB access on the system will decrease the\n        physical attack surface for a device and diminish the possible vectors to\n        introduce malware.\"\n  desc  \"check\", \"\n        Run the following commands and verify the output is as indicated:\n\n        ```\n        # modprobe -n -v usb-storage\n\n        install /bin/true\n        ```\n\n        ```\n        # lsmod | grep usb-storage\n\n        ```\"\n  desc \"fix\", \"\n        Edit or create a file in the /etc/modprobe.d/ directory ending in .conf\n\n        Example: vi /etc/modprobe.d/usb_storage.conf\n        and add the following line:\n\n        ```\n        install usb-storage /bin/true\n        ```\n\n        Run the following command to unload the usb-storage module:\n\n        ```\n        rmmod usb-storage\n        ```\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SI-3\", \"SC-18(4)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"8.4\", \"8.5\"]\n  tag cis_rid: '1.1.23'\n  tag cis_scored: true\n  tag cis_version: '2.0.1'\n  tag cis_cdc_version: 7\n \n  describe kernel_module('usb_storage') do\n    it { should_not be_loaded }\n    it { should be_disabled }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.23.rb",
                "line": 3
            },
            "id": "C-1.1.23"
        },
        {
            "title": "Ensure LDAP client is not installed",
            "desc": "The Lightweight Directory Access Protocol (LDAP) was introduced as a\nreplacement for NIS/YP. It is a service that provides a method for looking up\ninformation from a central database.",
            "descriptions": {
                "default": "The Lightweight Directory Access Protocol (LDAP) was introduced as a\nreplacement for NIS/YP. It is a service that provides a method for looking up\ninformation from a central database.",
                "rationale": "If the system will not need to act as an LDAP client, it\nis recommended that the software be removed to reduce the potential attack\nsurface.",
                "check": "Verify that `ldap-utils` is not installed. Use the following command to\nprovide the needed information:\n\n    ```\n    # dpkg -s ldap-utils\n    ```",
                "fix": "Uninstall `ldap-utils`:\n\n```\n# apt purge ldap-utils\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-2 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "2.6",
                    "Rev_7"
                ],
                "cis_rid": "2.3.5"
            },
            "code": "control \"C-2.3.5\" do\n  title \"Ensure LDAP client is not installed\"\n  desc  \"The Lightweight Directory Access Protocol (LDAP) was introduced as a\nreplacement for NIS/YP. It is a service that provides a method for looking up\ninformation from a central database.\"\n  desc  \"rationale\", \"If the system will not need to act as an LDAP client, it\nis recommended that the software be removed to reduce the potential attack\nsurface.\"\n  desc  \"check\", \"\n    Verify that `ldap-utils` is not installed. Use the following command to\nprovide the needed information:\n\n    ```\n    # dpkg -s ldap-utils\n    ```\n  \"\n  desc \"fix\", \"\n    Uninstall `ldap-utils`:\n\n    ```\n    # apt purge ldap-utils\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-2 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"2.6\", \"Rev_7\"]\n  tag cis_rid: \"2.3.5\"\n\n  describe package('ldap-utils') do\n    it { should_not be_installed }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.3.5.rb",
                "line": 3
            },
            "id": "C-2.3.5"
        },
        {
            "title": "Ensure chrony is configured",
            "desc": "`chrony` is a daemon which implements the Network Time Protocol (NTP)\nis designed to synchronize system clocks across a variety of systems and use a\nsource that is highly accurate. More information on `chrony` can be found at .\n`chrony` can be configured to be a client and/or a server.",
            "descriptions": {
                "default": "`chrony` is a daemon which implements the Network Time Protocol (NTP)\nis designed to synchronize system clocks across a variety of systems and use a\nsource that is highly accurate. More information on `chrony` can be found at .\n`chrony` can be configured to be a client and/or a server.",
                "rationale": "If chrony is in use on the system proper configuration is vital to ensuring\ntime synchronization is working properly.\n\n    This recommendation only applies if chrony is in use on the system.",
                "check": "Run the following command and verify remote server is configured properly:\n\n    ```\n    # grep -E \"^(server|pool)\" /etc/chrony.conf\n    server\n    ```\n\n    Multiple servers may be configured.\n\n    Run the following command and verify the first field for the `chronyd`\nprocess is `chrony`:\n\n    ```\n    # ps -ef | grep chronyd\n    chrony 491 1 0 20:32 ? 00:00:00 /usr/sbin/chronyd\n    ```",
                "fix": "Add or edit server or pool lines to `/etc/chrony.conf` as appropriate:\n\n    ```\n    server\n    ```\n\n    Configure `chrony` to run as the `chrony` user by configuring the\nappropriate startup script for your distribution. Startup scripts are typically\nstored in `/etc/init.d` or `/etc/systemd`."
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-8 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.1",
                    "Rev_7"
                ],
                "cis_rid": "2.2.1.3"
            },
            "code": "control \"C-2.2.1.3\" do\n  title \"Ensure chrony is configured\"\n  desc  \"`chrony` is a daemon which implements the Network Time Protocol (NTP)\nis designed to synchronize system clocks across a variety of systems and use a\nsource that is highly accurate. More information on `chrony` can be found at .\n`chrony` can be configured to be a client and/or a server.\"\n  desc  \"rationale\", \"\n    If chrony is in use on the system proper configuration is vital to ensuring\ntime synchronization is working properly.\n\n    This recommendation only applies if chrony is in use on the system.\n  \"\n  desc  \"check\", \"\n    Run the following command and verify remote server is configured properly:\n\n    ```\n    # grep -E \\\"^(server|pool)\\\" /etc/chrony.conf\n    server\n    ```\n\n    Multiple servers may be configured.\n\n    Run the following command and verify the first field for the `chronyd`\nprocess is `chrony`:\n\n    ```\n    # ps -ef | grep chronyd\n    chrony 491 1 0 20:32 ? 00:00:00 /usr/sbin/chronyd\n    ```\n  \"\n  desc  \"fix\", \"\n    Add or edit server or pool lines to `/etc/chrony.conf` as appropriate:\n\n    ```\n    server\n    ```\n\n    Configure `chrony` to run as the `chrony` user by configuring the\nappropriate startup script for your distribution. Startup scripts are typically\nstored in `/etc/init.d` or `/etc/systemd`.\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-8 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.1\", \"Rev_7\"]\n  tag cis_rid: \"2.2.1.3\"\n\n  if package('chrony').installed?\n    describe service('chrony') do\n      it { should be_enabled }\n      it { should be_running }\n    end\n\n    Number_Of_Servers_Configured_in_Chrony = command('grep -E \"^(server|pool)\" /etc/chrony/chrony.conf| wc -l').stdout.strip.split\n\n    describe Number_Of_Servers_Configured_in_Chrony do\n      its('length') { should be > 0 }\n    end\n\n    describe processes('chronyd') do\n      it { should exist }\n      its('users') { should include '_chrony'}\n    end\n\n  else\n    impact 0.0\n    describe \"The chrony package is not installed\" do\n      skip \"The chrony package is not installed, this control is Not Applicable.\"\n    end\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.1.3.rb",
                "line": 3
            },
            "id": "C-2.2.1.3"
        },
        {
            "title": "Ensure default deny firewall policy",
            "desc": "A default deny policy on connections ensures that any unconfigured\nnetwork usage will be rejected.",
            "descriptions": {
                "default": "A default deny policy on connections ensures that any unconfigured\nnetwork usage will be rejected.",
                "rationale": "With a default accept policy the firewall will accept any\npacket that is not configured to be denied. It is easier to white list\nacceptable usage than to black list unacceptable usage.",
                "check": "Run the following command and verify that the default policy for\n**incoming** , **outgoing** , and **routed** directions is **deny** or\n**reject**:\n\n    ```\n    # ufw status verbose\n    ```",
                "fix": "Run the following commands to implement a default *deny* policy:\n\n```\n# ufw default deny incoming\n```\n\n```\n# ufw default deny outgoing\n```\n\n```\n# ufw default deny routed\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.2.2"
            },
            "code": "control \"C-3.5.2.2\" do\n  title \"Ensure default deny firewall policy\"\n  desc  \"A default deny policy on connections ensures that any unconfigured\nnetwork usage will be rejected.\"\n  desc  \"rationale\", \"With a default accept policy the firewall will accept any\npacket that is not configured to be denied. It is easier to white list\nacceptable usage than to black list unacceptable usage.\"\n  desc  \"check\", \"\n    Run the following command and verify that the default policy for\n**incoming** , **outgoing** , and **routed** directions is **deny** or\n**reject**:\n\n    ```\n    # ufw status verbose\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to implement a default *deny* policy:\n\n    ```\n    # ufw default deny incoming\n    ```\n\n    ```\n    # ufw default deny outgoing\n    ```\n\n    ```\n    # ufw default deny routed\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.2.2\"\n\n  ufw_status = command('ufw status').stdout.strip.lines.first\n  value = ufw_status.split(':')[1].strip\n\n  describe 'UFW status' do\n    subject { value }\n    it { should cmp 'active' }\n  end\n\n  describe service('ufw') do\n    it { should be_running }\n    it { should be_enabled }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.2.2.rb",
                "line": 3
            },
            "id": "C-3.5.2.2"
        },
        {
            "title": "Ensure noexec option set on /dev/shm partition",
            "desc": "The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.",
            "descriptions": {
                "default": "The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.",
                "rationale": "Setting this option on a file system prevents users from\nexecuting programs from shared memory. This deters users from introducing\npotentially malicious software on the system.",
                "check": "Verify that the `noexec` option is set if a `/dev/shm` partition exists.\n\nRun the following command and verify that nothing is returned:\n\n```\n# mount | grep -E '\\s/dev/shm\\s' | grep -v noexec\n```",
                "fix": "Edit the `/etc/fstab` file and add `noexec` to the fourth field (mounting\noptions) for the `/dev/shm` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/dev/shm`:\n\n    ```\n    # mount -o remount,noexec /dev/shm\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-2 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "2.6",
                    "Rev_7"
                ],
                "cis_rid": "1.1.17"
            },
            "code": "control \"C-1.1.17\" do\n  title \"Ensure noexec option set on /dev/shm partition\"\n  desc  \"The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.\"\n  desc  \"rationale\", \"Setting this option on a file system prevents users from\nexecuting programs from shared memory. This deters users from introducing\npotentially malicious software on the system.\"\n  desc  \"check\", \"\n    Verify that the `noexec` option is set if a `/dev/shm` partition exists.\n\n    Run the following command and verify that nothing is returned:\n\n    ```\n    # mount | grep -E '\\\\s/dev/shm\\\\s' | grep -v noexec\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/fstab` file and add `noexec` to the fourth field (mounting\noptions) for the `/dev/shm` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/dev/shm`:\n\n    ```\n    # mount -o remount,noexec /dev/shm\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-2 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"2.6\", \"Rev_7\"]\n  tag cis_rid: \"1.1.17\"\n\n  describe mount('/dev/shm') do\n    its('options') { should include 'noexec' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.17.rb",
                "line": 3
            },
            "id": "C-1.1.17"
        },
        {
            "title": "Ensure password reuse is limited",
            "desc": "The `/etc/security/opasswd` file stores the users' old passwords and\ncan be checked to ensure that users are not recycling recent passwords.",
            "descriptions": {
                "default": "The `/etc/security/opasswd` file stores the users' old passwords and\ncan be checked to ensure that users are not recycling recent passwords.",
                "rationale": "Forcing users not to reuse their past 5 passwords make it less likely that\nan attacker will be able to guess the password.\n\n    Note that these change only apply to accounts configured on the local\nsystem.",
                "check": "Run the following commands and ensure the `remember` option is '`5`' or\nmore and included in all results:\n\n    ```\n    # grep -E '^password\\s+required\\s+pam_pwhistory.so'\n/etc/pam.d/common-password\n\n    password required pam_pwhistory.so remember=5\n    ```",
                "fix": "Edit the `/etc/pam.d/common-password` file to include the `remember` option\nand conform to site policy as shown:\n\n    ```\n    password required pam_pwhistory.so remember=5\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-2",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16",
                    "Rev_7"
                ],
                "cis_rid": "5.3.3"
            },
            "code": "control \"C-5.3.3\" do\n  title \"Ensure password reuse is limited\"\n  desc  \"The `/etc/security/opasswd` file stores the users' old passwords and\ncan be checked to ensure that users are not recycling recent passwords.\"\n  desc  \"rationale\", \"\n    Forcing users not to reuse their past 5 passwords make it less likely that\nan attacker will be able to guess the password.\n\n    Note that these change only apply to accounts configured on the local\nsystem.\n  \"\n  desc  \"check\", \"\n    Run the following commands and ensure the `remember` option is '`5`' or\nmore and included in all results:\n\n    ```\n    # grep -E '^password\\\\s+required\\\\s+pam_pwhistory.so'\n/etc/pam.d/common-password\n\n    password required pam_pwhistory.so remember=5\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/pam.d/common-password` file to include the `remember` option\nand conform to site policy as shown:\n\n    ```\n    password required pam_pwhistory.so remember=5\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-2\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16\", \"Rev_7\"]\n  tag cis_rid: \"5.3.3\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.3.3.rb",
                "line": 3
            },
            "id": "C-5.3.3"
        },
        {
            "title": "Ensure IPv6 firewall rules exist for all open ports",
            "desc": "Any ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.",
            "descriptions": {
                "default": "Any ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.",
                "rationale": "Without a firewall rule configured for open ports default\nfirewall policy will drop all packets to these ports.",
                "check": "Run the following command to determine open ports:\n\n    ```\n    # ss -6tuln\n\n    Netid State Recv-Q Send-Q Local Address:Port Peer Address:Port\n    udp UNCONN 0 0 ::1:123 :::*\n    udp UNCONN 0 0 :::123 :::*\n    tcp LISTEN 0 128 :::22 :::*\n    tcp LISTEN 0 20 ::1:25 :::*\n    ```\n\n    Run the following command to determine firewall rules:\n\n    ```\n    # ip6tables -L INPUT -v -n\n\n    Chain INPUT (policy DROP 0 packets, 0 bytes)\n     pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all lo * ::/0 ::/0\n     0 0 DROP all * * ::1 ::/0\n     0 0 ACCEPT tcp * * ::/0 ::/0 tcp dpt:22 state NEW\n    ```\n\n    Verify all open ports listening on non-localhost addresses have at least\none firewall rule.\n\n    The last line identified by the \"tcp dpt:22 state NEW\" identifies it as a\nfirewall rule for new connections on tcp port 22.\n\n    OR\n\n    If IPv6 is disabled:\n\n    Run the following command and verify that no lines are returned.\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1\n    ```\n\n    OR\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v ipv6.disable=1\n    ```",
                "fix": "For each port identified in the audit which does not have a firewall rule\nestablish a proper rule for accepting inbound connections:\n\n    ```\n    # ip6tables -A INPUT -p\n\n    \t --dport\n\n    \t -m state --state NEW -j ACCEPT\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "CM-8",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "9.1",
                    "Rev_7"
                ],
                "cis_rid": "3.5.4.2.4"
            },
            "code": "control \"C-3.5.4.2.4\" do\n  title \"Ensure IPv6 firewall rules exist for all open ports\"\n  desc  \"Any ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.\"\n  desc  \"rationale\", \"Without a firewall rule configured for open ports default\nfirewall policy will drop all packets to these ports.\"\n  desc  \"check\", \"\n    Run the following command to determine open ports:\n\n    ```\n    # ss -6tuln\n\n    Netid State Recv-Q Send-Q Local Address:Port Peer Address:Port\n    udp UNCONN 0 0 ::1:123 :::*\n    udp UNCONN 0 0 :::123 :::*\n    tcp LISTEN 0 128 :::22 :::*\n    tcp LISTEN 0 20 ::1:25 :::*\n    ```\n\n    Run the following command to determine firewall rules:\n\n    ```\n    # ip6tables -L INPUT -v -n\n\n    Chain INPUT (policy DROP 0 packets, 0 bytes)\n     pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all lo * ::/0 ::/0\n     0 0 DROP all * * ::1 ::/0\n     0 0 ACCEPT tcp * * ::/0 ::/0 tcp dpt:22 state NEW\n    ```\n\n    Verify all open ports listening on non-localhost addresses have at least\none firewall rule.\n\n    The last line identified by the \\\"tcp dpt:22 state NEW\\\" identifies it as a\nfirewall rule for new connections on tcp port 22.\n\n    OR\n\n    If IPv6 is disabled:\n\n    Run the following command and verify that no lines are returned.\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1\n    ```\n\n    OR\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v ipv6.disable=1\n    ```\n  \"\n  desc  \"fix\", \"\n    For each port identified in the audit which does not have a firewall rule\nestablish a proper rule for accepting inbound connections:\n\n    ```\n    # ip6tables -A INPUT -p\n\n    \\t --dport\n\n    \\t -m state --state NEW -j ACCEPT\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"CM-8\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"9.1\", \"Rev_7\"]\n  tag cis_rid: \"3.5.4.2.4\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.4.2.4.rb",
                "line": 3
            },
            "id": "C-3.5.4.2.4"
        },
        {
            "title": "Ensure HTTP Proxy Server is not enabled",
            "desc": "Squid is a standard proxy server used in many distributions and\nenvironments.",
            "descriptions": {
                "default": "Squid is a standard proxy server used in many distributions and\nenvironments.",
                "rationale": "If there is no need for a proxy server, it is recommended\nthat the squid proxy be deleted to reduce the potential attack surface.",
                "check": "Run the following command to verify `squid` is not enabled:\n\n```\n# systemctl is-enabled squid\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run the following command to disable `squid`:\n\n```\n# systemctl --now disable squid\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.13"
            },
            "code": "control \"C-2.2.13\" do\n  title \"Ensure HTTP Proxy Server is not enabled\"\n  desc  \"Squid is a standard proxy server used in many distributions and\nenvironments.\"\n  desc  \"rationale\", \"If there is no need for a proxy server, it is recommended\nthat the squid proxy be deleted to reduce the potential attack surface.\"\n  desc  \"check\", \"\n    Run the following command to verify `squid` is not enabled:\n\n    ```\n    # systemctl is-enabled squid\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following command to disable `squid`:\n\n    ```\n    # systemctl --now disable squid\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.13\"\n\n  if package('squid').installed?\n    describe service('squid') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n  else\n    impact 0.0\n    describe \"The HTTP Proxy Server package is not installed\" do\n      skip \"The HTTP Proxy Server package is not installed.\"\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.13.rb",
                "line": 3
            },
            "id": "C-2.2.13"
        },
        {
            "title": "Ensure permissions on SSH private host key files are configured",
            "desc": "An SSH private key is one of two files used in SSH public key\nauthentication. In this authentication method, The possession of the private\nkey is proof of identity. Only a private key that corresponds to a public key\nwill be able to authenticate successfully. The private keys need to be stored\nand handled carefully, and no copies of the private key should be distributed.",
            "descriptions": {
                "default": "An SSH private key is one of two files used in SSH public key\nauthentication. In this authentication method, The possession of the private\nkey is proof of identity. Only a private key that corresponds to a public key\nwill be able to authenticate successfully. The private keys need to be stored\nand handled carefully, and no copies of the private key should be distributed.",
                "rationale": "If an unauthorized user obtains the private SSH host key\nfile, the host could be impersonated",
                "check": "Run the following command and verify Uid is 0/root and and Gid is 0/root.\nEnsure group and other do not have permissions\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec stat {} \\;\n\n     File: ‘/etc/ssh/ssh_host_rsa_key’\n     Size: 1679 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8628138 Links: 1\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/root)\n    Access: 2018-10-22 18:24:56.861750616 +0000\n    Modify: 2018-10-22 18:24:56.861750616 +0000\n    Change: 2018-10-22 18:24:56.873750616 +0000\n     Birth: -\n     File: ‘/etc/ssh/ssh_host_ecdsa_key’\n     Size: 227 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8631760 Links: 1\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/root)\n    Access: 2018-10-22 18:24:56.897750616 +0000\n    Modify: 2018-10-22 18:24:56.897750616 +0000\n    Change: 2018-10-22 18:24:56.905750616 +0000\n     Birth: -\n     File: ‘/etc/ssh/ssh_host_ed25519_key’\n     Size: 387 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8631762 Links: 1\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/root)\n    Access: 2018-10-22 18:24:56.945750616 +0000\n    Modify: 2018-10-22 18:24:56.945750616 +0000\n    Change: 2018-10-22 18:24:56.957750616 +0000\n     Birth: -",
                "fix": "Run the following commands to set ownership and permissions on the private\nSSH host key files\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chown root:root\n{} \\;\n    ```\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chmod 0600 {} \\;\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_rid": "5.2.2",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.2\" do\n  title \"Ensure permissions on SSH private host key files are configured\"\n  desc  \"An SSH private key is one of two files used in SSH public key\nauthentication. In this authentication method, The possession of the private\nkey is proof of identity. Only a private key that corresponds to a public key\nwill be able to authenticate successfully. The private keys need to be stored\nand handled carefully, and no copies of the private key should be distributed.\"\n  desc  \"rationale\", \"If an unauthorized user obtains the private SSH host key\nfile, the host could be impersonated\"\n  desc  \"check\", \"\n    Run the following command and verify Uid is 0/root and and Gid is 0/root.\nEnsure group and other do not have permissions\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec stat {} \\\\;\n\n     File: ‘/etc/ssh/ssh_host_rsa_key’\n     Size: 1679 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8628138 Links: 1\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/root)\n    Access: 2018-10-22 18:24:56.861750616 +0000\n    Modify: 2018-10-22 18:24:56.861750616 +0000\n    Change: 2018-10-22 18:24:56.873750616 +0000\n     Birth: -\n     File: ‘/etc/ssh/ssh_host_ecdsa_key’\n     Size: 227 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8631760 Links: 1\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/root)\n    Access: 2018-10-22 18:24:56.897750616 +0000\n    Modify: 2018-10-22 18:24:56.897750616 +0000\n    Change: 2018-10-22 18:24:56.905750616 +0000\n     Birth: -\n     File: ‘/etc/ssh/ssh_host_ed25519_key’\n     Size: 387 Blocks: 8 IO Block: 4096 regular file\n    Device: ca01h/51713d Inode: 8631762 Links: 1\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/root)\n    Access: 2018-10-22 18:24:56.945750616 +0000\n    Modify: 2018-10-22 18:24:56.945750616 +0000\n    Change: 2018-10-22 18:24:56.957750616 +0000\n     Birth: -\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set ownership and permissions on the private\nSSH host key files\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chown root:root\n{} \\\\;\n    ```\n\n    ```\n    # find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec chmod 0600 {} \\\\;\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_rid: \"5.2.2\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  if inspec.directory('/etc/ssh').exist?\n    find_command = command(\"find /etc/ssh -xdev -type f -name 'ssh_host_*_key'\").stdout.lines\n    unless find_command.empty?\n      find_command.each do |key_file|\n        describe file(key_file.chomp) do\n          it { should be_file }\n          it { should be_owned_by 'root' }\n          it { should be_grouped_into 'root' }\n          it { should_not be_more_permissive_than('0600') }\n        end\n      end\n    else\n      descibe \"No 'ssh_host_*_key' files were found in '/etc/ssh'\" do \n        skip \"You must validate this control manually or correct your sshd config\"\n      end\n    end\n  else\n    descibe \"'/etc/ssh' does not seem to exist, you must check this control by hand\" do\n      skip '/etc/ssh did not exist, please check this control by hand'\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.2.rb",
                "line": 3
            },
            "id": "C-5.2.2"
        },
        {
            "title": "Ensure base chains exist",
            "desc": "Chains are containers for rules. They exist in two kinds, base chains\nand regular chains. A base chain is an entry point for packets from the\nnetworking stack, a regular chain may be used as jump target and is used for\nbetter rule organization.",
            "descriptions": {
                "default": "Chains are containers for rules. They exist in two kinds, base chains\nand regular chains. A base chain is an entry point for packets from the\nnetworking stack, a regular chain may be used as jump target and is used for\nbetter rule organization.",
                "rationale": "If a base chain doesn't exist with a hook for input,\nforward, and delete, packets that would flow through those chains will not be\ntouched by nftables.",
                "check": "Run the following commands and verify that base chains exist for `INPUT`,\n`FORWARD`, and `OUTPUT`.\n\n    ```\n    # nft list ruleset | grep 'hook input'\n\n    type filter hook input priority 0;\n    ```\n\n    ```\n    # nft list ruleset | grep 'hook forward'\n\n    type filter hook forward priority 0;\n    ```\n\n    ```\n    # nft list ruleset | grep 'hook output'\n\n    type filter hook output priority 0;\n    ```",
                "fix": "Run the following command to create the base chains:\n\n    ```\n    # nft create chain inet\n\n      { type filter hook  priority 0 \\; }\n    ```\n\n    Example:\n\n    ```\n    # nft create chain inet filter input { type filter hook input priority 0\n\\; }\n\n    # nft create chain inet filter forward { type filter hook forward priority\n0 \\; }\n\n    # nft create chain inet filter output { type filter hook output priority 0\n\\; }\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.3.3"
            },
            "code": "control \"C-3.5.3.3\" do\n  title \"Ensure base chains exist\"\n  desc  \"Chains are containers for rules. They exist in two kinds, base chains\nand regular chains. A base chain is an entry point for packets from the\nnetworking stack, a regular chain may be used as jump target and is used for\nbetter rule organization.\"\n  desc  \"rationale\", \"If a base chain doesn't exist with a hook for input,\nforward, and delete, packets that would flow through those chains will not be\ntouched by nftables.\"\n  desc  \"check\", \"\n    Run the following commands and verify that base chains exist for `INPUT`,\n`FORWARD`, and `OUTPUT`.\n\n    ```\n    # nft list ruleset | grep 'hook input'\n\n    type filter hook input priority 0;\n    ```\n\n    ```\n    # nft list ruleset | grep 'hook forward'\n\n    type filter hook forward priority 0;\n    ```\n\n    ```\n    # nft list ruleset | grep 'hook output'\n\n    type filter hook output priority 0;\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to create the base chains:\n\n    ```\n    # nft create chain inet\n\n      { type filter hook  priority 0 \\\\; }\n    ```\n\n    Example:\n\n    ```\n    # nft create chain inet filter input { type filter hook input priority 0\n\\\\; }\n\n    # nft create chain inet filter forward { type filter hook forward priority\n0 \\\\; }\n\n    # nft create chain inet filter output { type filter hook output priority 0\n\\\\; }\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.3.3\"\n\n  nft_tables = command('nft list ruleset').stdout.strip.split(/[\\n|;]/)\n\n  if service('nftables').running? && service('nftables').enabled?\n    describe nft_tables do\n      it { should match '\\s+type\\s+filter\\s+hook\\s+input\\s+priority\\s+0' }\n      it { should match 'type filter hook forward priority 0' }\n      it { should match 'type filter hook output priority 0' }\n    end\n  else\n    describe service('nftables') do\n      it { should be_running }\n      it { should be_enabled }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.3.3.rb",
                "line": 3
            },
            "id": "C-3.5.3.3"
        },
        {
            "title": "Ensure bootloader password is set",
            "desc": "Setting the boot loader password will require that anyone rebooting\nthe system must enter a password before being able to set command line boot\nparameters",
            "descriptions": {
                "default": "Setting the boot loader password will require that anyone rebooting\nthe system must enter a password before being able to set command line boot\nparameters",
                "rationale": "Requiring a boot password upon execution of the boot\nloader will prevent an unauthorized user from entering boot parameters or\nchanging the boot partition. This prevents users from weakening security (e.g.\nturning off AppArmor at boot time).",
                "check": "Run the following commands and verify output matches:\n\n```\n# grep \"^set superusers\" /boot/grub/grub.cfg\n\nset superusers=\"\"\n```\n\n```\n# grep \"^password\" /boot/grub/grub.cfg\n\npassword_pbkdf2\n```",
                "fix": "Create an encrypted password with `grub-mkpasswd-pbkdf2`:\n\n```\n# grub-mkpasswd-pbkdf2\nEnter password:\n\nReenter password:\n\nYour PBKDF2 is\n```\nAdd the following into a custom `/etc/grub.d` configuration file:\n\n```\ncat"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.5.2"
            },
            "code": "control \"C-1.5.2\" do\n  title \"Ensure bootloader password is set\"\n  desc  \"Setting the boot loader password will require that anyone rebooting\nthe system must enter a password before being able to set command line boot\nparameters\"\n  desc  \"rationale\", \"Requiring a boot password upon execution of the boot\nloader will prevent an unauthorized user from entering boot parameters or\nchanging the boot partition. This prevents users from weakening security (e.g.\nturning off AppArmor at boot time).\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # grep \\\"^set superusers\\\" /boot/grub/grub.cfg\n\n    set superusers=\\\"\\\"\n    ```\n\n    ```\n    # grep \\\"^password\\\" /boot/grub/grub.cfg\n\n    password_pbkdf2\n    ```\n  \"\n  desc \"fix\", \"\n    Create an encrypted password with `grub-mkpasswd-pbkdf2`:\n\n    ```\n    # grub-mkpasswd-pbkdf2\n    Enter password:\n\n    Reenter password:\n\n    Your PBKDF2 is\n    ```\n    Add the following into a custom `/etc/grub.d` configuration file:\n\n    ```\n    cat\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.5.2\"\n\n  # grub_conf resource does not support this yet ...\n  #describe grub_conf('/boot/grub/grub.cfg') do\n  #  its('content') { should match '^password_pbkdf2' }\n  #end\n\n  describe file('/boot/grub/grub.cfg') do\n    its('content') { should match '^\\\\s*superusers\\\\s*=' }\n  end\n  describe file('/boot/grub/grub.cfg') do\n    its('content') { should match '^\\\\s*password_pbkdf2' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.5.2.rb",
                "line": 3
            },
            "id": "C-1.5.2"
        },
        {
            "title": "Ensure audit logs are not automatically deleted",
            "desc": "The `max_log_file_action` setting determines how to handle the audit\nlog file reaching the max file size. A value of `keep_logs` will rotate the\nlogs but never delete old logs.",
            "descriptions": {
                "default": "The `max_log_file_action` setting determines how to handle the audit\nlog file reaching the max file size. A value of `keep_logs` will rotate the\nlogs but never delete old logs.",
                "rationale": "In high security contexts, the benefits of maintaining a\nlong audit history exceed the cost of storing the audit history.",
                "check": "Run the following command and verify output matches:\n\n```\n# grep max_log_file_action /etc/audit/auditd.conf\n\nmax_log_file_action = keep_logs\n```",
                "fix": "Set the following parameter in `/etc/audit/auditd.conf:`\n\n```\nmax_log_file_action = keep_logs\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "6.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.2.2"
            },
            "code": "control \"C-4.1.2.2\" do\n  title \"Ensure audit logs are not automatically deleted\"\n  desc  \"The `max_log_file_action` setting determines how to handle the audit\nlog file reaching the max file size. A value of `keep_logs` will rotate the\nlogs but never delete old logs.\"\n  desc  \"rationale\", \"In high security contexts, the benefits of maintaining a\nlong audit history exceed the cost of storing the audit history.\"\n  desc  \"check\", \"\n    Run the following command and verify output matches:\n\n    ```\n    # grep max_log_file_action /etc/audit/auditd.conf\n\n    max_log_file_action = keep_logs\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameter in `/etc/audit/auditd.conf:`\n\n    ```\n    max_log_file_action = keep_logs\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"6.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.2.2\"\n  describe auditd_conf do\n    its('max_log_file_action') { should cmp 'keep_logs' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.2.2.rb",
                "line": 3
            },
            "id": "C-4.1.2.2"
        },
        {
            "title": "Ensure CUPS is not enabled",
            "desc": "The Common Unix Print System (CUPS) provides the ability to print to\nboth local and network printers. A system running CUPS can also accept print\njobs from remote systems and print them to local printers. It also provides a\nweb based remote administration capability.",
            "descriptions": {
                "default": "The Common Unix Print System (CUPS) provides the ability to print to\nboth local and network printers. A system running CUPS can also accept print\njobs from remote systems and print them to local printers. It also provides a\nweb based remote administration capability.",
                "rationale": "If the system does not need to print jobs or accept print\njobs from other systems, it is recommended that CUPS be disabled to reduce the\npotential attack surface.",
                "check": "Run the following command to verify `cups` is not enabled:\n\n```\n# systemctl is-enabled cups\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run one of the following commands to disable `cups` :\n\n```\n# systemctl --now disable cups\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.4"
            },
            "code": "control \"C-2.2.4\" do\n  title \"Ensure CUPS is not enabled\"\n  desc  \"The Common Unix Print System (CUPS) provides the ability to print to\nboth local and network printers. A system running CUPS can also accept print\njobs from remote systems and print them to local printers. It also provides a\nweb based remote administration capability.\"\n  desc  \"rationale\", \"If the system does not need to print jobs or accept print\njobs from other systems, it is recommended that CUPS be disabled to reduce the\npotential attack surface.\"\n  desc  \"check\", \"\n    Run the following command to verify `cups` is not enabled:\n\n    ```\n    # systemctl is-enabled cups\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run one of the following commands to disable `cups` :\n\n    ```\n    # systemctl --now disable cups\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.4\"\n\n  if package('cups').installed?\n    describe service('cups') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n  else\n    impact 0.0\n    describe \"The Common Unix Print System (CUPS) package is not installed\" do\n      skip \"The Common Unix Print System (CUPS) package is not installed, this control is Not Applicable.\"\n    end\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.4.rb",
                "line": 3
            },
            "id": "C-2.2.4"
        },
        {
            "title": "Ensure permissions on /etc/cron.weekly are configured",
            "desc": "The `/etc/cron.weekly` directory contains system cron jobs that need\nto run on a weekly basis. The files in this directory cannot be manipulated by\nthe `crontab` command, but are instead edited by system administrators using a\ntext editor. The commands below restrict read/write and search access to user\nand group root, preventing regular users from accessing this directory.",
            "descriptions": {
                "default": "The `/etc/cron.weekly` directory contains system cron jobs that need\nto run on a weekly basis. The files in this directory cannot be manipulated by\nthe `crontab` command, but are instead edited by system administrators using a\ntext editor. The commands below restrict read/write and search access to user\nand group root, preventing regular users from accessing this directory.",
                "rationale": "Granting write access to this directory for\nnon-privileged users could provide them the means for gaining unauthorized\nelevated privileges. Granting read access to this directory could give an\nunprivileged user insight in how to gain elevated privileges or circumvent\nauditing controls.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/cron.weekly\n\n    Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set ownership and permissions on\n`/etc/cron.weekly` :\n\n    ```\n    # chown root:root /etc/cron.weekly\n    ```\n\n    ```\n    # chmod og-rwx /etc/cron.weekly\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "5.1.5"
            },
            "code": "control \"C-5.1.5\" do\n  title \"Ensure permissions on /etc/cron.weekly are configured\"\n  desc  \"The `/etc/cron.weekly` directory contains system cron jobs that need\nto run on a weekly basis. The files in this directory cannot be manipulated by\nthe `crontab` command, but are instead edited by system administrators using a\ntext editor. The commands below restrict read/write and search access to user\nand group root, preventing regular users from accessing this directory.\"\n  desc  \"rationale\", \"Granting write access to this directory for\nnon-privileged users could provide them the means for gaining unauthorized\nelevated privileges. Granting read access to this directory could give an\nunprivileged user insight in how to gain elevated privileges or circumvent\nauditing controls.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/cron.weekly\n\n    Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set ownership and permissions on\n`/etc/cron.weekly` :\n\n    ```\n    # chown root:root /etc/cron.weekly\n    ```\n\n    ```\n    # chmod og-rwx /etc/cron.weekly\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"5.1.5\"\n\n  describe file('/etc/cron.weekly') do \n    its('owner') { should cmp 'root' }\n    its('group') { should cmp 'root' }\n    it { should be_directory }\n    it { should_not be_more_permissive_than('0700') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.1.5.rb",
                "line": 3
            },
            "id": "C-5.1.5"
        },
        {
            "title": "Ensure outbound and established connections are configured",
            "desc": "Configure the firewall rules for new outbound, and established\nconnections.",
            "descriptions": {
                "default": "Configure the firewall rules for new outbound, and established\nconnections.",
                "rationale": "If rules are not in place for new outbound, and\nestablished connections all packets will be dropped by the default policy\npreventing network usage.",
                "check": "Run the following command and verify all rules for new outbound, and\nestablished connections match site policy:\n\n    ```\n    # iptables -L -v -n\n    ```",
                "fix": "Configure iptables in accordance with site policy. The following commands\nwill implement a policy to allow all outbound connections and all established\nconnections:\n\n    ```\n    # iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # iptables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # iptables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n    # iptables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n    # iptables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.4.1.3"
            },
            "code": "control \"C-3.5.4.1.3\" do\n  title \"Ensure outbound and established connections are configured\"\n  desc  \"Configure the firewall rules for new outbound, and established\nconnections.\"\n  desc  \"rationale\", \"If rules are not in place for new outbound, and\nestablished connections all packets will be dropped by the default policy\npreventing network usage.\"\n  desc  \"check\", \"\n    Run the following command and verify all rules for new outbound, and\nestablished connections match site policy:\n\n    ```\n    # iptables -L -v -n\n    ```\n  \"\n  desc \"fix\", \"\n    Configure iptables in accordance with site policy. The following commands\nwill implement a policy to allow all outbound connections and all established\nconnections:\n\n    ```\n    # iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # iptables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # iptables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n    # iptables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n    # iptables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.4.1.3\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.4.1.3.rb",
                "line": 3
            },
            "id": "C-3.5.4.1.3"
        },
        {
            "title": "Ensure mounting of udf filesystems is disabled",
            "desc": "The `udf` filesystem type is the universal disk format used to\nimplement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor\nfilesystem type for data storage on a broad range of media. This filesystem\ntype is necessary to support writing DVDs and newer optical disc formats.",
            "descriptions": {
                "default": "The `udf` filesystem type is the universal disk format used to\nimplement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor\nfilesystem type for data storage on a broad range of media. This filesystem\ntype is necessary to support writing DVDs and newer optical disc formats.",
                "rationale": "Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe -n -v udf | grep -v crc-itu-t\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep udf\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/udf.conf`\n\nand add the following line:\n\n```\ninstall udf /bin/true\n```\n\nRun the following command to unload the `udf` module:\n\n```\n# rmmod udf\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.1.7"
            },
            "code": "control \"C-1.1.1.7\" do\n  title \"Ensure mounting of udf filesystems is disabled\"\n  desc  \"The `udf` filesystem type is the universal disk format used to\nimplement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor\nfilesystem type for data storage on a broad range of media. This filesystem\ntype is necessary to support writing DVDs and newer optical disc formats.\"\n  desc  \"rationale\", \"Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe -n -v udf | grep -v crc-itu-t\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep udf\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/udf.conf`\n\n    and add the following line:\n\n    ```\n    install udf /bin/true\n    ```\n\n    Run the following command to unload the `udf` module:\n\n    ```\n    # rmmod udf\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.1.7\"\n\n  describe kernel_module('udf') do\n    it { should_not be_loaded }\n    it { should be_disabled }\n    it { should be_blacklisted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.1.7.rb",
                "line": 3
            },
            "id": "C-1.1.1.7"
        },
        {
            "title": "Ensure minimum days between password changes is  configured",
            "desc": "The `PASS_MIN_DAYS` parameter in `/etc/login.defs` allows an\nadministrator to prevent users from changing their password until a minimum\nnumber of days have passed since the last time the user changed their password.\nIt is recommended that `PASS_MIN_DAYS` parameter be set to 1 or more days.",
            "descriptions": {
                "default": "The `PASS_MIN_DAYS` parameter in `/etc/login.defs` allows an\nadministrator to prevent users from changing their password until a minimum\nnumber of days have passed since the last time the user changed their password.\nIt is recommended that `PASS_MIN_DAYS` parameter be set to 1 or more days.",
                "rationale": "By restricting the frequency of password changes, an\nadministrator can prevent users from repeatedly changing their password in an\nattempt to circumvent password reuse controls.",
                "check": "Run the following command and verify `PASS_MIN_DAYS` conforms to site\npolicy (no less than 1 day):\n\n    ```\n    # grep PASS_MIN_DAYS /etc/login.defs\n\n    PASS_MIN_DAYS 1\n    ```\n\n    Run the following command and Review list of users and PAS_MIN_DAYS to\nVerify that all users' PAS_MIN_DAYS conforms to site policy (no less than 1\nday):\n\n    ```\n    # grep -E ^[^:]+:[^\\!*] /etc/shadow | cut -d: -f1,4\n\n    :\n\n    ```",
                "fix": "Set the `PASS_MIN_DAYS` parameter to 1 in `/etc/login.defs` :\n\n```\nPASS_MIN_DAYS 1\n```\n\nModify user parameters for all users with a password set to match:\n\n```\n# chage --mindays 1\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-2",
                    "IA-5 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16",
                    "4.4",
                    "Rev_6"
                ],
                "cis_rid": "5.4.1.2"
            },
            "code": "control \"C-5.4.1.2\" do\n  title \"Ensure minimum days between password changes is  configured\"\n  desc  \"The `PASS_MIN_DAYS` parameter in `/etc/login.defs` allows an\nadministrator to prevent users from changing their password until a minimum\nnumber of days have passed since the last time the user changed their password.\nIt is recommended that `PASS_MIN_DAYS` parameter be set to 1 or more days.\"\n  desc  \"rationale\", \"By restricting the frequency of password changes, an\nadministrator can prevent users from repeatedly changing their password in an\nattempt to circumvent password reuse controls.\"\n  desc  \"check\", \"\n    Run the following command and verify `PASS_MIN_DAYS` conforms to site\npolicy (no less than 1 day):\n\n    ```\n    # grep PASS_MIN_DAYS /etc/login.defs\n\n    PASS_MIN_DAYS 1\n    ```\n\n    Run the following command and Review list of users and PAS_MIN_DAYS to\nVerify that all users' PAS_MIN_DAYS conforms to site policy (no less than 1\nday):\n\n    ```\n    # grep -E ^[^:]+:[^\\\\!*] /etc/shadow | cut -d: -f1,4\n\n    :\n\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the `PASS_MIN_DAYS` parameter to 1 in `/etc/login.defs` :\n\n    ```\n    PASS_MIN_DAYS 1\n    ```\n\n    Modify user parameters for all users with a password set to match:\n\n    ```\n    # chage --mindays 1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-2\", \"IA-5 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16\", \"4.4\", \"Rev_6\"]\n  tag cis_rid: \"5.4.1.2\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.4.1.2.rb",
                "line": 3
            },
            "id": "C-5.4.1.2"
        },
        {
            "title": "Ensure unsuccessful unauthorized file access attempts are collected",
            "desc": "Monitor for unsuccessful attempts to access files. The parameters\nbelow are associated with system calls that control creation ( `creat` ),\nopening ( `open` , `openat` ) and truncation ( `truncate` , `ftruncate` ) of\nfiles. An audit log record will only be written if the user is a non-privileged\nuser (auid > = 1000), is not a Daemon event (auid=4294967295) and if the system\ncall returned EACCES (permission denied to the file) or EPERM (some other\npermanent error associated with the specific system call). All audit records\nwill be tagged with the identifier \"access.\"\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.",
            "descriptions": {
                "default": "Monitor for unsuccessful attempts to access files. The parameters\nbelow are associated with system calls that control creation ( `creat` ),\nopening ( `open` , `openat` ) and truncation ( `truncate` , `ftruncate` ) of\nfiles. An audit log record will only be written if the user is a non-privileged\nuser (auid > = 1000), is not a Daemon event (auid=4294967295) and if the system\ncall returned EACCES (permission denied to the file) or EPERM (some other\npermanent error associated with the specific system call). All audit records\nwill be tagged with the identifier \"access.\"\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.",
                "rationale": "Failed attempts to open, create or truncate files could\nbe an indication that an individual or process is trying to gain unauthorized\naccess to the system.",
                "check": "On a 32 bit system run the following commands:\n\n    ```\n    # grep access /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    ```\n\n    ```\n    # auditctl -l | grep access\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F\nexit=-EACCES -F auid>=1000 -F auid!=-1 -F key=access\n    -a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F\nexit=-EPERM -F auid>=1000 -F auid!=-1 -F key=access\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep access /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    ```\n\n    ```\n    # auditctl -l | grep access\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat -F\nexit=-EACCES -F auid>=1000 -F auid!=-1 -F key=access\n    -a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F\nexit=-EACCES -F auid>=1000 -F auid!=-1 -F key=access\n    -a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat -F\nexit=-EPERM -F auid>=1000 -F auid!=-1 -F key=access\n    -a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F\nexit=-EPERM -F auid>=1000 -F auid!=-1 -F key=access\n    ```",
                "fix": "For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/audit.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/access.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-2"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "14.9"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.10"
            },
            "code": "control \"C-4.1.10\" do\n  title \"Ensure unsuccessful unauthorized file access attempts are collected\"\n  desc  \"Monitor for unsuccessful attempts to access files. The parameters\nbelow are associated with system calls that control creation ( `creat` ),\nopening ( `open` , `openat` ) and truncation ( `truncate` , `ftruncate` ) of\nfiles. An audit log record will only be written if the user is a non-privileged\nuser (auid > = 1000), is not a Daemon event (auid=4294967295) and if the system\ncall returned EACCES (permission denied to the file) or EPERM (some other\npermanent error associated with the specific system call). All audit records\nwill be tagged with the identifier \\\"access.\\\"\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.\n  \"\n  desc  \"rationale\", \"Failed attempts to open, create or truncate files could\nbe an indication that an individual or process is trying to gain unauthorized\naccess to the system.\"\n  desc  \"check\", \"\n    On a 32 bit system run the following commands:\n\n    ```\n    # grep access /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    ```\n\n    ```\n    # auditctl -l | grep access\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F\nexit=-EACCES -F auid>=1000 -F auid!=-1 -F key=access\n    -a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F\nexit=-EPERM -F auid>=1000 -F auid!=-1 -F key=access\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep access /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    ```\n\n    ```\n    # auditctl -l | grep access\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat -F\nexit=-EACCES -F auid>=1000 -F auid!=-1 -F key=access\n    -a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F\nexit=-EACCES -F auid>=1000 -F auid!=-1 -F key=access\n    -a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat -F\nexit=-EPERM -F auid>=1000 -F auid!=-1 -F key=access\n    -a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat -F\nexit=-EPERM -F auid>=1000 -F auid!=-1 -F key=access\n    ```\n  \"\n  desc  \"fix\", \"\n    For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/audit.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/access.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    -a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S\nftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-2\"]\n  tag cis_level: 2\n  tag cis_controls: [\"14.9\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.10\"\n\n  arches = ['b32']\n  if os.arch.match?(/64/)\n    arches.push('b64')\n  end\n\n  syscalls = [\n    'creat',\n    'open',\n    'openat',\n    'truncate',\n    'ftruncate'\n  ]\n\n  syscalls.each do |syscall|\n    arches.each do |a|\n      describe auditd.syscall(syscall).where { arch == a && key == 'access'  } do\n        its('action.uniq') { should eq ['always'] }\n        its('list.uniq') { should eq ['exit'] }\n        its('fields.flatten.uniq') {  should include \"auid>=#{login_defs.UID_MIN}\" }\n        its('exit') { should include '-EACCES' }\n        its('exit') { should include '-EPERM' }\n      end\n\n      # the rule states that `auid!=4294967295` but this comes back as `auid!=-1` when queries via `auditctl -l`\n      # this check will allow either.\n      describe.one do\n        describe auditd.syscall(syscall).where { arch == a && key == 'access'  } do\n          its('fields.flatten.uniq') {  should include \"auid!=-1\" }\n        end\n        describe auditd.syscall(syscall).where { arch == a && key == 'access'  } do\n          its('fields.flatten.uniq') {  should include \"auid!=4294967295\" }\n        end\n      end\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.10.rb",
                "line": 3
            },
            "id": "C-4.1.10"
        },
        {
            "title": "Ensure permissions on /etc/group- are configured",
            "desc": "The `/etc/group-` file contains a backup list of all the valid groups\ndefined in the system.",
            "descriptions": {
                "default": "The `/etc/group-` file contains a backup list of all the valid groups\ndefined in the system.",
                "rationale": "It is critical to ensure that the `/etc/group-` file is\nprotected from unauthorized access. Although it is protected by default, the\nfile permissions could be changed either inadvertently or through malicious\nactions.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` or more restrictive:\n\n    ```\n    # stat /etc/group-\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following command to set permissions on `/etc/group-` :\n\n```\n# chown root:root /etc/group-\n\n# chmod u-x,go-wx /etc/group-\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-28"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.8"
            },
            "code": "control \"C-6.1.8\" do\n  title \"Ensure permissions on /etc/group- are configured\"\n  desc  \"The `/etc/group-` file contains a backup list of all the valid groups\ndefined in the system.\"\n  desc  \"rationale\", \"It is critical to ensure that the `/etc/group-` file is\nprotected from unauthorized access. Although it is protected by default, the\nfile permissions could be changed either inadvertently or through malicious\nactions.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` or more restrictive:\n\n    ```\n    # stat /etc/group-\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to set permissions on `/etc/group-` :\n\n    ```\n    # chown root:root /etc/group-\n\n    # chmod u-x,go-wx /etc/group-\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-28\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.8\"\n\n  describe file('/etc/group') do\n    it { should_not be_more_permissive_than('0644') }\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.8.rb",
                "line": 3
            },
            "id": "C-6.1.8"
        },
        {
            "title": "Ensure no users have .forward files",
            "desc": "The `.forward` file specifies an email address to forward the user's\nmail to.",
            "descriptions": {
                "default": "The `.forward` file specifies an email address to forward the user's\nmail to.",
                "rationale": "Use of the `.forward` file poses a security risk in that\nsensitive data may be inadvertently transferred outside the organization. The\n`.forward` file also poses a risk as it can be used to execute commands that\nmay perform unintended actions.",
                "check": "Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\"'\"$(which nologin)\"'\" & do\n     if [ ! -d \"$dir\" ]; then\n     echo \"The home directory ($dir) of user $user does not exist.\"\n     else\n     if [ ! -h \"$dir/.forward\" ] & then\n     echo \".forward file \\\"$dir/.forward\\\" exists\"\n     fi\n     fi\n    done\n    ```",
                "fix": "Making global modifications to users' files without alerting\nthe user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser `.forward` files and determine the action to be taken in accordance with\nsite policy."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.11"
            },
            "code": "control \"C-6.2.11\" do\n  title \"Ensure no users have .forward files\"\n  desc  \"The `.forward` file specifies an email address to forward the user's\nmail to.\"\n  desc  \"rationale\", \"Use of the `.forward` file poses a security risk in that\nsensitive data may be inadvertently transferred outside the organization. The\n`.forward` file also poses a risk as it can be used to execute commands that\nmay perform unintended actions.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\\\"'\\\"$(which nologin)\\\"'\\\" & do\n     if [ ! -d \\\"$dir\\\" ]; then\n     echo \\\"The home directory ($dir) of user $user does not exist.\\\"\n     else\n     if [ ! -h \\\"$dir/.forward\\\" ] & then\n     echo \\\".forward file \\\\\\\"$dir/.forward\\\\\\\" exists\\\"\n     fi\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"Making global modifications to users' files without alerting\nthe user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser `.forward` files and determine the action to be taken in accordance with\nsite policy.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.11\"\n\n  nologin = command(\"which nologin\").stdout.strip\n  \n  passwd.where { user != 'halt' && user != 'sync' && user != 'shutdown' && shell != nologin }.entries.each do |user|\n    describe file(\"#{user.home}/.forward\") do\n      it { should_not exist }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.11.rb",
                "line": 3
            },
            "id": "C-6.2.11"
        },
        {
            "title": "Ensure separate partition exists for /home",
            "desc": "The `/home` directory is used to support disk storage needs of local\nusers.",
            "descriptions": {
                "default": "The `/home` directory is used to support disk storage needs of local\nusers.",
                "rationale": "If the system is intended to support local users, create\na separate partition for the `/home` directory to protect against resource\nexhaustion and restrict the type of files that can be stored under `/home` .",
                "check": "Run the following command and verify output shows `/home` is mounted:\n```\n# mount | grep /home\n/dev/xvdf1 on /home type ext4 (rw,nodev,relatime,data=ordered)\n```",
                "fix": "For new installations, during installation create a custom partition setup\nand specify a separate partition for `/home` .\n\n    For systems that were previously installed, create a new partition and\nconfigure `/etc/fstab` as appropriate."
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.13"
            },
            "code": "control \"C-1.1.13\" do\n  title \"Ensure separate partition exists for /home\"\n  desc  \"The `/home` directory is used to support disk storage needs of local\nusers.\"\n  desc  \"rationale\", \"If the system is intended to support local users, create\na separate partition for the `/home` directory to protect against resource\nexhaustion and restrict the type of files that can be stored under `/home` .\"\n  desc  \"check\", \"\n    Run the following command and verify output shows `/home` is mounted:\n    ```\n    # mount | grep /home\n    /dev/xvdf1 on /home type ext4 (rw,nodev,relatime,data=ordered)\n    ```\n  \"\n  desc  \"fix\", \"\n    For new installations, during installation create a custom partition setup\nand specify a separate partition for `/home` .\n\n    For systems that were previously installed, create a new partition and\nconfigure `/etc/fstab` as appropriate.\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.13\"\n\n  describe mount('/home') do\n    it { should be_mounted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.13.rb",
                "line": 3
            },
            "id": "C-1.1.13"
        },
        {
            "title": "Ensure a Firewall package is installed",
            "desc": "A Firewall package should be selected. Most firewall configuration\nutilities operate as a front end to nftables or iptables.",
            "descriptions": {
                "default": "A Firewall package should be selected. Most firewall configuration\nutilities operate as a front end to nftables or iptables.",
                "rationale": "A Firewall package is required for firewall management\nand configuration.",
                "check": "Run **one** of the following commands to verify that a Firewall package is\ninstalled that follows local site policy:\n\n    To verify that `Uncomplicated Firewall` (`UFW`) is installed, run the\nfollowing command:\n\n    ```\n    # dpkg -s ufw | grep -i status\n\n    Status: install ok installed\n    ```\n\n    To verify that `nftables` is installed, run the following command:\n\n    ```\n    # dpkg -s nftables | grep -i status\n\n    Status: install ok installed\n    ```\n\n    To verify that `iptables` is installed, run the following command:\n\n    ```\n    # dpkg -s iptables | grep -i status\n\n    Status: install ok installed\n    ```",
                "fix": "Run **one** of the following commands to install the Firewall package that\nfollows local site policy:\n\n    To install `UFW`, run the following command:\n\n    ```\n    # apt install ufw\n    ```\n\n    To install `nftables`, run the following command:\n\n    ```\n    # apt install nftables\n    ```\n\n    To install `iptables`, run the following command:\n\n    ```\n    # apt install iptables\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.1.1"
            },
            "code": "control \"C-3.5.1.1\" do\n  title \"Ensure a Firewall package is installed\"\n  desc  \"A Firewall package should be selected. Most firewall configuration\nutilities operate as a front end to nftables or iptables.\"\n  desc  \"rationale\", \"A Firewall package is required for firewall management\nand configuration.\"\n  desc  \"check\", \"\n    Run **one** of the following commands to verify that a Firewall package is\ninstalled that follows local site policy:\n\n    To verify that `Uncomplicated Firewall` (`UFW`) is installed, run the\nfollowing command:\n\n    ```\n    # dpkg -s ufw | grep -i status\n\n    Status: install ok installed\n    ```\n\n    To verify that `nftables` is installed, run the following command:\n\n    ```\n    # dpkg -s nftables | grep -i status\n\n    Status: install ok installed\n    ```\n\n    To verify that `iptables` is installed, run the following command:\n\n    ```\n    # dpkg -s iptables | grep -i status\n\n    Status: install ok installed\n    ```\n  \"\n  desc  \"fix\", \"\n    Run **one** of the following commands to install the Firewall package that\nfollows local site policy:\n\n    To install `UFW`, run the following command:\n\n    ```\n    # apt install ufw\n    ```\n\n    To install `nftables`, run the following command:\n\n    ```\n    # apt install nftables\n    ```\n\n    To install `iptables`, run the following command:\n\n    ```\n    # apt install iptables\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.1.1\"\n\n  describe.one do\n    describe package('ufw') do\n      it { should be_installed }\n    end\n    describe package('nftables') do\n      it { should be_installed }\n    end\n    describe package('iptables') do\n      it { should be_installed }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.1.1.rb",
                "line": 3
            },
            "id": "C-3.5.1.1"
        },
        {
            "title": "Ensure TCP SYN Cookies is enabled",
            "desc": "When `tcp_syncookies` is set, the kernel will handle TCP SYN packets\nnormally until the half-open connection queue is full, at which time, the SYN\ncookie functionality kicks in. SYN cookies work by not using the SYN queue at\nall. Instead, the kernel simply replies to the SYN with a SYN|ACK, but will\ninclude a specially crafted TCP sequence number that encodes the source and\ndestination IP address and port number and the time the packet was sent. A\nlegitimate connection would send the ACK packet of the three way handshake with\nthe specially crafted sequence number. This allows the system to verify that it\nhas received a valid response to a SYN cookie and allow the connection, even\nthough there is no corresponding SYN in the queue.",
            "descriptions": {
                "default": "When `tcp_syncookies` is set, the kernel will handle TCP SYN packets\nnormally until the half-open connection queue is full, at which time, the SYN\ncookie functionality kicks in. SYN cookies work by not using the SYN queue at\nall. Instead, the kernel simply replies to the SYN with a SYN|ACK, but will\ninclude a specially crafted TCP sequence number that encodes the source and\ndestination IP address and port number and the time the packet was sent. A\nlegitimate connection would send the ACK packet of the three way handshake with\nthe specially crafted sequence number. This allows the system to verify that it\nhas received a valid response to a SYN cookie and allow the connection, even\nthough there is no corresponding SYN in the queue.",
                "rationale": "Attackers use SYN flood attacks to perform a denial of\nservice attacked on a system by sending many SYN packets without completing the\nthree way handshake. This will quickly use up slots in the kernel's half-open\nconnection queue and prevent legitimate connections from succeeding. SYN\ncookies allow the system to keep accepting valid connections, even if under a\ndenial of service attack.",
                "check": "Run the following commands and verify output matches:\n\n```\n# sysctl net.ipv4.tcp_syncookies\n\nnet.ipv4.tcp_syncookies = 1\n```\n\n```\n# grep \"net\\.ipv4\\.tcp_syncookies\" /etc/sysctl.conf /etc/sysctl.d/*\n\nnet.ipv4.tcp_syncookies = 1\n```",
                "fix": "Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.tcp_syncookies = 1\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.tcp_syncookies=1\n    ```\n\n    ```\n    # sysctl -w net.ipv4.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.2.8"
            },
            "code": "control \"C-3.2.8\" do\n  title \"Ensure TCP SYN Cookies is enabled\"\n  desc  \"When `tcp_syncookies` is set, the kernel will handle TCP SYN packets\nnormally until the half-open connection queue is full, at which time, the SYN\ncookie functionality kicks in. SYN cookies work by not using the SYN queue at\nall. Instead, the kernel simply replies to the SYN with a SYN|ACK, but will\ninclude a specially crafted TCP sequence number that encodes the source and\ndestination IP address and port number and the time the packet was sent. A\nlegitimate connection would send the ACK packet of the three way handshake with\nthe specially crafted sequence number. This allows the system to verify that it\nhas received a valid response to a SYN cookie and allow the connection, even\nthough there is no corresponding SYN in the queue.\"\n  desc  \"rationale\", \"Attackers use SYN flood attacks to perform a denial of\nservice attacked on a system by sending many SYN packets without completing the\nthree way handshake. This will quickly use up slots in the kernel's half-open\nconnection queue and prevent legitimate connections from succeeding. SYN\ncookies allow the system to keep accepting valid connections, even if under a\ndenial of service attack.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.tcp_syncookies\n\n    net.ipv4.tcp_syncookies = 1\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.tcp_syncookies\\\" /etc/sysctl.conf /etc/sysctl.d/*\n\n    net.ipv4.tcp_syncookies = 1\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.tcp_syncookies = 1\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.tcp_syncookies=1\n    ```\n\n    ```\n    # sysctl -w net.ipv4.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.2.8\"\n\n  describe kernel_parameter('net.ipv4.tcp_syncookies') do\n    its('value') { should cmp '1' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.2.8.rb",
                "line": 3
            },
            "id": "C-3.2.8"
        },
        {
            "title": "Ensure discretionary access control permission modification events are\ncollected",
            "desc": "Monitor changes to file permissions, attributes, ownership and group.\nThe parameters in this section track changes for system calls that affect file\npermissions and attributes. The `chmod` , `fchmod` and `fchmodat` system calls\naffect the permissions associated with a file. The `chown` , `fchown` ,\n`fchownat` and `lchown` system calls affect owner and group attributes on a\nfile. The `setxattr` , `lsetxattr` , `fsetxattr` (set extended file attributes)\nand `removexattr` , `lremovexattr` , `fremovexattr` (remove extended file\nattributes) control extended file attributes. In all cases, an audit record\nwill only be written for non-system user ids (auid >= 1000) and will ignore\nDaemon events (auid = 4294967295). All audit records will be tagged with the\nidentifier \"perm_mod.\"\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not `1000`, replace `audit>=1000` with\n`audit>=` in the Audit and Remediation procedures.",
            "descriptions": {
                "default": "Monitor changes to file permissions, attributes, ownership and group.\nThe parameters in this section track changes for system calls that affect file\npermissions and attributes. The `chmod` , `fchmod` and `fchmodat` system calls\naffect the permissions associated with a file. The `chown` , `fchown` ,\n`fchownat` and `lchown` system calls affect owner and group attributes on a\nfile. The `setxattr` , `lsetxattr` , `fsetxattr` (set extended file attributes)\nand `removexattr` , `lremovexattr` , `fremovexattr` (remove extended file\nattributes) control extended file attributes. In all cases, an audit record\nwill only be written for non-system user ids (auid >= 1000) and will ignore\nDaemon events (auid = 4294967295). All audit records will be tagged with the\nidentifier \"perm_mod.\"\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not `1000`, replace `audit>=1000` with\n`audit>=` in the Audit and Remediation procedures.",
                "rationale": "Monitoring for changes in file attributes could alert a\nsystem administrator to activity that could indicate intruder activity or\npolicy violation.",
                "check": "On a 32 bit system run the following commands:\n\n    ```\n    # grep perm_mod /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    ```\n\n    ```\n    # auditctl -l | grep perm_mod\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b32 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F\nauid>=1000 -F auid!=-1 -F key=perm_mod\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep perm_mod /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    ```\n\n    ```\n    # auditctl -l | grep auditctl -l | grep perm_mod\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b64 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F\nauid>=1000 -F auid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b32 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F\nauid>=1000 -F auid!=-1 -F key=perm_mod\n    ```",
                "fix": "For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/perm_mod.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/perm_mod.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "CM-6 (1)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.5"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.9"
            },
            "code": "control \"C-4.1.9\" do\n  title \"Ensure discretionary access control permission modification events are\ncollected\"\n  desc  \"Monitor changes to file permissions, attributes, ownership and group.\nThe parameters in this section track changes for system calls that affect file\npermissions and attributes. The `chmod` , `fchmod` and `fchmodat` system calls\naffect the permissions associated with a file. The `chown` , `fchown` ,\n`fchownat` and `lchown` system calls affect owner and group attributes on a\nfile. The `setxattr` , `lsetxattr` , `fsetxattr` (set extended file attributes)\nand `removexattr` , `lremovexattr` , `fremovexattr` (remove extended file\nattributes) control extended file attributes. In all cases, an audit record\nwill only be written for non-system user ids (auid >= 1000) and will ignore\nDaemon events (auid = 4294967295). All audit records will be tagged with the\nidentifier \\\"perm_mod.\\\"\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    awk '/^\\\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not `1000`, replace `audit>=1000` with\n`audit>=` in the Audit and Remediation procedures.\n  \"\n  desc  \"rationale\", \"Monitoring for changes in file attributes could alert a\nsystem administrator to activity that could indicate intruder activity or\npolicy violation.\"\n  desc  \"check\", \"\n    On a 32 bit system run the following commands:\n\n    ```\n    # grep perm_mod /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    ```\n\n    ```\n    # auditctl -l | grep perm_mod\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b32 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F\nauid>=1000 -F auid!=-1 -F key=perm_mod\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep perm_mod /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    ```\n\n    ```\n    # auditctl -l | grep auditctl -l | grep perm_mod\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F auid>=1000 -F\nauid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b64 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F\nauid>=1000 -F auid!=-1 -F key=perm_mod\n    -a always,exit -F arch=b32 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F\nauid>=1000 -F auid!=-1 -F key=perm_mod\n    ```\n  \"\n  desc  \"fix\", \"\n    For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/perm_mod.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/perm_mod.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F\nauid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F\nauid>=1000 -F auid!=4294967295 -k perm_mod\n    -a always,exit -F arch=b64 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    -a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S\nremovexattr -S lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295\n-k perm_mod\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"CM-6 (1)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.5\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.9\"\n\n  arches = ['b32']\n  if os.arch.match?(/64/)\n    arches.push('b64')\n  end\n\n  syscalls = [\n    'chmod',\n    'fchmod',\n    'fchmodat',\n    'chown',\n    'fchown',\n    'fchownat',\n    'lchown',\n    'setxattr',\n    'lsetxattr',\n    'fsetxattr',\n    'removexattr',\n    'lremovexattr',\n    'fremovexattr',\n  ]\n\n  syscalls.each do |syscall|\n    arches.each do |a|\n      describe auditd.syscall(syscall).where { arch == a && key == 'perm_mod'  } do\n        its('action.uniq') { should eq ['always'] }\n        its('list.uniq') { should eq ['exit'] }\n        its('fields.flatten.uniq') {  should include \"auid>=#{login_defs.UID_MIN}\" }\n      end\n\n      # the rule states that `auid!=4294967295` but this comes back as `auid!=-1` when queries via `auditctl -l`\n      # this check will allow either.\n      describe.one do\n        describe auditd.syscall(syscall).where { arch == a && key == 'perm_mod'  } do\n          its('fields.flatten.uniq') {  should include \"auid!=-1\" }\n        end\n        describe auditd.syscall(syscall).where { arch == a && key == 'perm_mod'  } do\n          its('fields.flatten.uniq') {  should include \"auid!=4294967295\" }\n        end\n      end\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.9.rb",
                "line": 3
            },
            "id": "C-4.1.9"
        },
        {
            "title": "Ensure NIS Client is not installed",
            "desc": "The Network Information Service (NIS), formerly known as Yellow Pages,\nis a client-server directory service protocol used to distribute system\nconfiguration files. The NIS client was used to bind a machine to an NIS server\nand receive the distributed configuration files.",
            "descriptions": {
                "default": "The Network Information Service (NIS), formerly known as Yellow Pages,\nis a client-server directory service protocol used to distribute system\nconfiguration files. The NIS client was used to bind a machine to an NIS server\nand receive the distributed configuration files.",
                "rationale": "The NIS service is inherently an insecure system that has\nbeen vulnerable to DOS attacks, buffer overflows and has poor authentication\nfor querying NIS maps. NIS generally has been replaced by such protocols as\nLightweight Directory Access Protocol (LDAP). It is recommended that the\nservice be removed.",
                "check": "Verify `nis` is not installed. Use the following command to provide the\nneeded information:\n\n    ```\n    dpkg -s nis\n    ```",
                "fix": "Uninstall `nis`:\n\n```\napt purge nis\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-2 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "2.6",
                    "Rev_7"
                ],
                "cis_rid": "2.3.1"
            },
            "code": "control \"C-2.3.1\" do\n  title \"Ensure NIS Client is not installed\"\n  desc  \"The Network Information Service (NIS), formerly known as Yellow Pages,\nis a client-server directory service protocol used to distribute system\nconfiguration files. The NIS client was used to bind a machine to an NIS server\nand receive the distributed configuration files.\"\n  desc  \"rationale\", \"The NIS service is inherently an insecure system that has\nbeen vulnerable to DOS attacks, buffer overflows and has poor authentication\nfor querying NIS maps. NIS generally has been replaced by such protocols as\nLightweight Directory Access Protocol (LDAP). It is recommended that the\nservice be removed.\"\n  desc  \"check\", \"\n    Verify `nis` is not installed. Use the following command to provide the\nneeded information:\n\n    ```\n    dpkg -s nis\n    ```\n  \"\n  desc \"fix\", \"\n    Uninstall `nis`:\n\n    ```\n    apt purge nis\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-2 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"2.6\", \"Rev_7\"]\n  tag cis_rid: \"2.3.1\"\n\n  describe package('nis') do\n    it { should_not be_installed }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.3.1.rb",
                "line": 3
            },
            "id": "C-2.3.1"
        },
        {
            "title": "Ensure nftables service is enabled",
            "desc": "The nftables service allows for the loading of nftables rulesets\nduring boot, or starting on the nftables service",
            "descriptions": {
                "default": "The nftables service allows for the loading of nftables rulesets\nduring boot, or starting on the nftables service",
                "rationale": "The nftables service restores the nftables rules from the\nrules files referenced in the `/etc/sysconfig/nftables.conf` file durring boot\nor the starting of the nftables service",
                "check": "Run the following command and verify that the nftables service is enabled:\n\n```\n# systemctl is-enabled nftables\n\nenabled\n```",
                "fix": "Run the following command to enable the nftables service:\n\n```\n# systemctl enable nftables\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.3.7"
            },
            "code": "control \"C-3.5.3.7\" do\n  title \"Ensure nftables service is enabled\"\n  desc  \"The nftables service allows for the loading of nftables rulesets\nduring boot, or starting on the nftables service\"\n  desc  \"rationale\", \"The nftables service restores the nftables rules from the\nrules files referenced in the `/etc/sysconfig/nftables.conf` file durring boot\nor the starting of the nftables service\"\n  desc  \"check\", \"\n    Run the following command and verify that the nftables service is enabled:\n\n    ```\n    # systemctl is-enabled nftables\n\n    enabled\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to enable the nftables service:\n\n    ```\n    # systemctl enable nftables\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.3.7\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.3.7.rb",
                "line": 3
            },
            "id": "C-3.5.3.7"
        },
        {
            "title": "Ensure mounting of jffs2 filesystems is disabled",
            "desc": "The `jffs2` (journaling flash filesystem 2) filesystem type is a\nlog-structured filesystem used in flash memory devices.",
            "descriptions": {
                "default": "The `jffs2` (journaling flash filesystem 2) filesystem type is a\nlog-structured filesystem used in flash memory devices.",
                "rationale": "Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe -n -v jffs2 | grep -v mtd\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep jffs2\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/jffs2.conf`\n\nand add the following line:\n\n```\ninstall jffs2 /bin/true\n```\n\nRun the following command to unload the `jffs2` module:\n\n```\n# rmmod jffs2\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.1.3"
            },
            "code": "control \"C-1.1.1.3\" do\n  title \"Ensure mounting of jffs2 filesystems is disabled\"\n  desc  \"The `jffs2` (journaling flash filesystem 2) filesystem type is a\nlog-structured filesystem used in flash memory devices.\"\n  desc  \"rationale\", \"Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe -n -v jffs2 | grep -v mtd\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep jffs2\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/jffs2.conf`\n\n    and add the following line:\n\n    ```\n    install jffs2 /bin/true\n    ```\n\n    Run the following command to unload the `jffs2` module:\n\n    ```\n    # rmmod jffs2\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.1.3\"\n\n  describe kernel_module('jffs2') do\n    it { should_not be_loaded }\n    it { should be_disabled }\n    it { should be_blacklisted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.1.3.rb",
                "line": 3
            },
            "id": "C-1.1.1.3"
        },
        {
            "title": "Ensure cron daemon is enabled",
            "desc": "The `cron` daemon is used to execute batch jobs on the system.",
            "descriptions": {
                "default": "The `cron` daemon is used to execute batch jobs on the system.",
                "rationale": "While there may not be user jobs that need to be run on\nthe system, the system does have maintenance jobs that may include security\nmonitoring that have to run, and `cron` is used to execute them.",
                "check": "Based on your system configuration, run the appropriate one of the\nfollowing commands to verify `cron` is enabled:\n\n    ```\n    # systemctl is-enabled cron\n\n    enabled\n    ```\n\n    Verify result is \"enabled\".",
                "fix": "Based on your system configuration, run the appropriate one of the\nfollowing commands to enable `cron`:\n\n    ```\n    # systemctl --now enable cron\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AU-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "5.1.1"
            },
            "code": "control \"C-5.1.1\" do\n  title \"Ensure cron daemon is enabled\"\n  desc  \"The `cron` daemon is used to execute batch jobs on the system.\"\n  desc  \"rationale\", \"While there may not be user jobs that need to be run on\nthe system, the system does have maintenance jobs that may include security\nmonitoring that have to run, and `cron` is used to execute them.\"\n  desc  \"check\", \"\n    Based on your system configuration, run the appropriate one of the\nfollowing commands to verify `cron` is enabled:\n\n    ```\n    # systemctl is-enabled cron\n\n    enabled\n    ```\n\n    Verify result is \\\"enabled\\\".\n  \"\n  desc \"fix\", \"\n    Based on your system configuration, run the appropriate one of the\nfollowing commands to enable `cron`:\n\n    ```\n    # systemctl --now enable cron\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AU-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"5.1.1\"\n\n  describe systemd_service('cron') do\n    it { should be_enabled }\n  end\n  \nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.1.1.rb",
                "line": 3
            },
            "id": "C-5.1.1"
        },
        {
            "title": "Ensure NIS Server is not enabled",
            "desc": "The Network Information Service (NIS) (formally known as Yellow Pages)\nis a client-server directory service protocol for distributing system\nconfiguration files. The NIS server is a collection of programs that allow for\nthe distribution of configuration files.",
            "descriptions": {
                "default": "The Network Information Service (NIS) (formally known as Yellow Pages)\nis a client-server directory service protocol for distributing system\nconfiguration files. The NIS server is a collection of programs that allow for\nthe distribution of configuration files.",
                "rationale": "The NIS service is inherently an insecure system that has\nbeen vulnerable to DOS attacks, buffer overflows and has poor authentication\nfor querying NIS maps. NIS generally has been replaced by such protocols as\nLightweight Directory Access Protocol (LDAP). It is recommended that the\nservice be disabled and other, more secure services be used",
                "check": "Run the following command to verify `nis` is not enabled:\n\n```\n# systemctl is-enabled nis\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run the following command to disable `nis`:\n\n```\n# systemctl --now disable nis\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.17"
            },
            "code": "control \"C-2.2.17\" do\n  title \"Ensure NIS Server is not enabled\"\n  desc  \"The Network Information Service (NIS) (formally known as Yellow Pages)\nis a client-server directory service protocol for distributing system\nconfiguration files. The NIS server is a collection of programs that allow for\nthe distribution of configuration files.\"\n  desc  \"rationale\", \"The NIS service is inherently an insecure system that has\nbeen vulnerable to DOS attacks, buffer overflows and has poor authentication\nfor querying NIS maps. NIS generally has been replaced by such protocols as\nLightweight Directory Access Protocol (LDAP). It is recommended that the\nservice be disabled and other, more secure services be used\"\n  desc  \"check\", \"\n    Run the following command to verify `nis` is not enabled:\n\n    ```\n    # systemctl is-enabled nis\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following command to disable `nis`:\n\n    ```\n    # systemctl --now disable nis\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.17\"\n\n  describe service('nis') do\n    it { should_not be_enabled }\n    it { should_not be_running }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.17.rb",
                "line": 3
            },
            "id": "C-2.2.17"
        },
        {
            "title": "Ensure SSH X11 forwarding is disabled",
            "desc": "The X11Forwarding parameter provides the ability to tunnel X11 traffic\nthrough the connection to enable remote graphic connections.",
            "descriptions": {
                "default": "The X11Forwarding parameter provides the ability to tunnel X11 traffic\nthrough the connection to enable remote graphic connections.",
                "rationale": "Disable X11 forwarding unless there is an operational\nrequirement to use X11 applications directly. There is a small risk that the\nremote X11 servers of users who are logged in via SSH with X11 forwarding could\nbe compromised by other users on the X11 server. Note that even if X11\nforwarding is disabled, users can always install their own forwarders.",
                "check": "Run the following command and verify that output matches:\n\n```\n# sshd -T | grep x11forwarding\n\nX11Forwarding no\n```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nX11Forwarding no\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "CM-7 (1)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "9.2"
                ],
                "cis_rid": "5.2.6",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.6\" do\n  title \"Ensure SSH X11 forwarding is disabled\"\n  desc  \"The X11Forwarding parameter provides the ability to tunnel X11 traffic\nthrough the connection to enable remote graphic connections.\"\n  desc  \"rationale\", \"Disable X11 forwarding unless there is an operational\nrequirement to use X11 applications directly. There is a small risk that the\nremote X11 servers of users who are logged in via SSH with X11 forwarding could\nbe compromised by other users on the X11 server. Note that even if X11\nforwarding is disabled, users can always install their own forwarders.\"\n  desc  \"check\", \"\n    Run the following command and verify that output matches:\n\n    ```\n    # sshd -T | grep x11forwarding\n\n    X11Forwarding no\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    X11Forwarding no\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"CM-7 (1)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"9.2\"]\n  tag cis_rid: \"5.2.6\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('X11Forwarding') { should cmp 'no' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.6.rb",
                "line": 3
            },
            "id": "C-5.2.6"
        },
        {
            "title": "Ensure permissions on /etc/motd are configured",
            "desc": "The contents of the `/etc/motd` file are displayed to users after\nlogin and function as a message of the day for authenticated users.",
            "descriptions": {
                "default": "The contents of the `/etc/motd` file are displayed to users after\nlogin and function as a message of the day for authenticated users.",
                "rationale": "If the `/etc/motd` file does not have the correct\nownership it could be modified by unauthorized users with incorrect or\nmisleading information.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` :\n\n    ```\n    # stat /etc/motd\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set permissions on `/etc/motd` :\n\n```\n# chown root:root /etc/motd\n```\n\n```\n# chmod u-x,go-wx /etc/motd\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.8.1.4"
            },
            "code": "control \"C-1.8.1.4\" do\n  title \"Ensure permissions on /etc/motd are configured\"\n  desc  \"The contents of the `/etc/motd` file are displayed to users after\nlogin and function as a message of the day for authenticated users.\"\n  desc  \"rationale\", \"If the `/etc/motd` file does not have the correct\nownership it could be modified by unauthorized users with incorrect or\nmisleading information.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` :\n\n    ```\n    # stat /etc/motd\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set permissions on `/etc/motd` :\n\n    ```\n    # chown root:root /etc/motd\n    ```\n\n    ```\n    # chmod u-x,go-wx /etc/motd\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.8.1.4\"\n\n  describe file('/etc/motd') do\n    it { should exist }\n    it { should be_owned_by 'root' }\n    it { should_not be_more_permissive_than('0644') }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.8.1.4.rb",
                "line": 3
            },
            "id": "C-1.8.1.4"
        },
        {
            "title": "Ensure XD/NX support is enabled",
            "desc": "Recent processors in the x86 family support the ability to prevent\ncode execution on a per memory page basis. Generically and on AMD processors,\nthis ability is called No Execute (NX), while on Intel processors it is called\nExecute Disable (XD). This ability can help prevent exploitation of buffer\noverflow vulnerabilities and should be activated whenever possible. Extra steps\nmust be taken to ensure that this protection is enabled, particularly on 32-bit\nx86 systems. Other processors, such as Itanium and POWER, have included such\nsupport since inception and the standard kernel for those platforms supports\nthe feature.",
            "descriptions": {
                "default": "Recent processors in the x86 family support the ability to prevent\ncode execution on a per memory page basis. Generically and on AMD processors,\nthis ability is called No Execute (NX), while on Intel processors it is called\nExecute Disable (XD). This ability can help prevent exploitation of buffer\noverflow vulnerabilities and should be activated whenever possible. Extra steps\nmust be taken to ensure that this protection is enabled, particularly on 32-bit\nx86 systems. Other processors, such as Itanium and POWER, have included such\nsupport since inception and the standard kernel for those platforms supports\nthe feature.",
                "rationale": "Enabling any feature that can protect against buffer\noverflow attacks enhances the security of the system.",
                "check": "Run the following command and verify your kernel has identified and\nactivated NX/XD protection.\n\n    ```\n    # journalctl | grep 'protection: active'\n\n    kernel: NX (Execute Disable) protection: active\n    ```\n\n    OR\n\n    on systems without journalctl\n\n    ```\n    # [[ -n $(grep noexec[0-9]*=off /proc/cmdline) || -z $(grep -E -i '\n(pae|nx) ' /proc/cpuinfo) || -n $(grep '\\sNX\\s.*\\sprotection:\\s'\n/var/log/dmesg | grep -v active) ]] && echo \"NX Protection is not active\"\n    ```\n\n    Nothing should be returned",
                "fix": "On 32 bit systems install a kernel with PAE support, no installation is\nrequired on 64 bit systems:\n\n    If necessary configure your bootloader to load the new kernel and reboot\nthe system.\n\n    You may need to enable NX or XD support in your bios."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SI-16",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "8.3",
                    "Rev_7"
                ],
                "cis_rid": "1.6.1"
            },
            "code": "control \"C-1.6.1\" do\n  title \"Ensure XD/NX support is enabled\"\n  desc  \"Recent processors in the x86 family support the ability to prevent\ncode execution on a per memory page basis. Generically and on AMD processors,\nthis ability is called No Execute (NX), while on Intel processors it is called\nExecute Disable (XD). This ability can help prevent exploitation of buffer\noverflow vulnerabilities and should be activated whenever possible. Extra steps\nmust be taken to ensure that this protection is enabled, particularly on 32-bit\nx86 systems. Other processors, such as Itanium and POWER, have included such\nsupport since inception and the standard kernel for those platforms supports\nthe feature.\"\n  desc  \"rationale\", \"Enabling any feature that can protect against buffer\noverflow attacks enhances the security of the system.\"\n  desc  \"check\", \"\n    Run the following command and verify your kernel has identified and\nactivated NX/XD protection.\n\n    ```\n    # journalctl | grep 'protection: active'\n\n    kernel: NX (Execute Disable) protection: active\n    ```\n\n    OR\n\n    on systems without journalctl\n\n    ```\n    # [[ -n $(grep noexec[0-9]*=off /proc/cmdline) || -z $(grep -E -i '\n(pae|nx) ' /proc/cpuinfo) || -n $(grep '\\\\sNX\\\\s.*\\\\sprotection:\\\\s'\n/var/log/dmesg | grep -v active) ]] && echo \\\"NX Protection is not active\\\"\n    ```\n\n    Nothing should be returned\n  \"\n  desc \"fix\", \"\n    On 32 bit systems install a kernel with PAE support, no installation is\nrequired on 64 bit systems:\n\n    If necessary configure your bootloader to load the new kernel and reboot\nthe system.\n\n    You may need to enable NX or XD support in your bios.\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SI-16\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"8.3\", \"Rev_7\"]\n  tag cis_rid: \"1.6.1\"\n\n  describe command(\"journalctl | grep 'protection: active'\").stdout.strip.split(\"\\n\") do\n    its('length') { should be > 0 }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.6.1.rb",
                "line": 3
            },
            "id": "C-1.6.1"
        },
        {
            "title": "Ensure auditd is installed",
            "desc": "auditd is the userspace component to the Linux Auditing System. It's\nresponsible for writing audit records to the disk",
            "descriptions": {
                "default": "auditd is the userspace component to the Linux Auditing System. It's\nresponsible for writing audit records to the disk",
                "rationale": "The capturing of system events provides system\nadministrators with information to allow them to determine if unauthorized\naccess to their system is occurring.",
                "check": "Run the following command and verify auditd is installed:\n\n```\n# dpkg -s auditd audispd-plugins\n```",
                "fix": "Run the following command to Install auditd\n\n```\n# apt install auditd audispd-plugins\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-12",
                    "AU-3"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "6.2",
                    "6.3"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.1.1"
            },
            "code": "control \"C-4.1.1.1\" do\n  title \"Ensure auditd is installed\"\n  desc  \"auditd is the userspace component to the Linux Auditing System. It's\nresponsible for writing audit records to the disk\"\n  desc  \"rationale\", \"The capturing of system events provides system\nadministrators with information to allow them to determine if unauthorized\naccess to their system is occurring.\"\n  desc  \"check\", \"\n    Run the following command and verify auditd is installed:\n\n    ```\n    # dpkg -s auditd audispd-plugins\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to Install auditd\n\n    ```\n    # apt install auditd audispd-plugins\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-12\", \"AU-3\"]\n  tag cis_level: 2\n  tag cis_controls: [\"6.2\", \"6.3\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.1.1\"\n\n  describe package('auditd') do\n    it { should be_installed }\n  end\n  \n  describe package('audispd-plugins') do\n    it { should be_installed }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.1.1.rb",
                "line": 3
            },
            "id": "C-4.1.1.1"
        },
        {
            "title": "Ensure changes to system administration scope (sudoers) is collected",
            "desc": "Monitor scope changes for system administrations. If the system has\nbeen properly configured to force system administrators to log in as themselves\nfirst and then use the `sudo` command to execute privileged commands, it is\npossible to monitor changes in scope. The file `/etc/sudoers` will be written\nto when the file or its attributes have changed. The audit records will be\ntagged with the identifier \"scope.\"",
            "descriptions": {
                "default": "Monitor scope changes for system administrations. If the system has\nbeen properly configured to force system administrators to log in as themselves\nfirst and then use the `sudo` command to execute privileged commands, it is\npossible to monitor changes in scope. The file `/etc/sudoers` will be written\nto when the file or its attributes have changed. The audit records will be\ntagged with the identifier \"scope.\"",
                "rationale": "Changes in the `/etc/sudoers` file can indicate that an\nunauthorized change has been made to scope of system administrator activity.",
                "check": "Run the following commands:\n\n```\n# grep scope /etc/audit/rules.d/*.rules\n\n# auditctl -l | grep scope\n```\n\nVerify output of both matches:\n\n```\n-w /etc/sudoers -p wa -k scope\n-w /etc/sudoers.d/ -p wa -k scope\n```",
                "fix": "Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/scope.rules`\n\n    and add the following lines:\n\n    ```\n    -w /etc/sudoers -p wa -k scope\n    -w /etc/sudoers.d/ -p wa -k scope\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AC-2 (4)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "4.8"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.14"
            },
            "code": "control \"C-4.1.14\" do\n  title \"Ensure changes to system administration scope (sudoers) is collected\"\n  desc  \"Monitor scope changes for system administrations. If the system has\nbeen properly configured to force system administrators to log in as themselves\nfirst and then use the `sudo` command to execute privileged commands, it is\npossible to monitor changes in scope. The file `/etc/sudoers` will be written\nto when the file or its attributes have changed. The audit records will be\ntagged with the identifier \\\"scope.\\\"\"\n  desc  \"rationale\", \"Changes in the `/etc/sudoers` file can indicate that an\nunauthorized change has been made to scope of system administrator activity.\"\n  desc  \"check\", \"\n    Run the following commands:\n\n    ```\n    # grep scope /etc/audit/rules.d/*.rules\n\n    # auditctl -l | grep scope\n    ```\n\n    Verify output of both matches:\n\n    ```\n    -w /etc/sudoers -p wa -k scope\n    -w /etc/sudoers.d/ -p wa -k scope\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/scope.rules`\n\n    and add the following lines:\n\n    ```\n    -w /etc/sudoers -p wa -k scope\n    -w /etc/sudoers.d/ -p wa -k scope\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AC-2 (4)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"4.8\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.14\"\n\n  files = [\n    '/etc/sudoers',\n    '/etc/sudoers.d'\n  ]\n\n  files.each do |file|\n    describe auditd.file(file).where { key == \"scope\" } do\n      its('permissions') { should include ['w', 'a'] }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.14.rb",
                "line": 3
            },
            "id": "C-4.1.14"
        },
        {
            "title": "Ensure users' home directories permissions are 750 or more restrictive",
            "desc": "While the system administrator can establish secure permissions for\nusers' home directories, the users can easily override these.",
            "descriptions": {
                "default": "While the system administrator can establish secure permissions for\nusers' home directories, the users can easily override these.",
                "rationale": "Group or world-writable user home directories may enable\nmalicious users to steal or modify other users' data or to gain another user's\nsystem privileges.",
                "check": "Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\"'\"$(which nologin)\"'\" & do\n     if [ ! -d \"$dir\" ]; then\n     echo \"The home directory ($dir) of user $user does not exist.\"\n     else\n     dirperm=\"$(ls -ld \"$dir\" | cut -f1 -d\" \")\"\n     if [ \"$(echo \"$dirperm\" | cut -c6)\" != \"-\" ]; then\n     echo \"Group Write permission set on the home directory \\\"$dir\\\" of\nuser $user\"\n     fi\n     if [ \"$(echo \"$dirperm\" | cut -c8)\" != \"-\" ]; then\n     echo \"Other Read permission set on the home directory \\\"$dir\\\" of\nuser $user\"\n     fi\n     if [ \"$(echo \"$dirperm\" | cut -c9)\" != \"-\" ]; then\n     echo \"Other Write permission set on the home directory \\\"$dir\\\" of\nuser $user\"\n     fi\n     if [ \"$(echo \"$dirperm\" | cut -c10)\" != \"-\" ]; then\n     echo \"Other Execute permission set on the home directory \\\"$dir\\\" of\nuser $user\"\n     fi\n     fi\n    done\n    ```",
                "fix": "Making global modifications to user home directories without\nalerting the user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser file permissions and determine the action to be taken in accordance with\nsite policy."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.8"
            },
            "code": "control \"C-6.2.8\" do\n  title \"Ensure users' home directories permissions are 750 or more restrictive\"\n  desc  \"While the system administrator can establish secure permissions for\nusers' home directories, the users can easily override these.\"\n  desc  \"rationale\", \"Group or world-writable user home directories may enable\nmalicious users to steal or modify other users' data or to gain another user's\nsystem privileges.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\\\"'\\\"$(which nologin)\\\"'\\\" & do\n     if [ ! -d \\\"$dir\\\" ]; then\n     echo \\\"The home directory ($dir) of user $user does not exist.\\\"\n     else\n     dirperm=\\\"$(ls -ld \\\"$dir\\\" | cut -f1 -d\\\" \\\")\\\"\n     if [ \\\"$(echo \\\"$dirperm\\\" | cut -c6)\\\" != \\\"-\\\" ]; then\n     echo \\\"Group Write permission set on the home directory \\\\\\\"$dir\\\\\\\" of\nuser $user\\\"\n     fi\n     if [ \\\"$(echo \\\"$dirperm\\\" | cut -c8)\\\" != \\\"-\\\" ]; then\n     echo \\\"Other Read permission set on the home directory \\\\\\\"$dir\\\\\\\" of\nuser $user\\\"\n     fi\n     if [ \\\"$(echo \\\"$dirperm\\\" | cut -c9)\\\" != \\\"-\\\" ]; then\n     echo \\\"Other Write permission set on the home directory \\\\\\\"$dir\\\\\\\" of\nuser $user\\\"\n     fi\n     if [ \\\"$(echo \\\"$dirperm\\\" | cut -c10)\\\" != \\\"-\\\" ]; then\n     echo \\\"Other Execute permission set on the home directory \\\\\\\"$dir\\\\\\\" of\nuser $user\\\"\n     fi\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"Making global modifications to user home directories without\nalerting the user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser file permissions and determine the action to be taken in accordance with\nsite policy.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.8\"\n\n  nologin = command(\"which nologin\").stdout.strip\n  \n  passwd.where { user != 'halt' && user != 'sync' && user != 'shutdown' && shell != nologin }.entries.each do |user|\n    describe file(user.home) do\n      it { should_not be_more_permissive_than('0750') }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.8.rb",
                "line": 3
            },
            "id": "C-6.2.8"
        },
        {
            "title": "Ensure nosuid option set on /var/tmp partition",
            "desc": "The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.",
            "descriptions": {
                "default": "The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.",
                "rationale": "Since the `/var/tmp` filesystem is only intended for\ntemporary file storage, set this option to ensure that users cannot create\n`setuid` files in `/var/tmp` .",
                "check": "Verify that the `nosuid` option is set if a `/var/tmp` partition exists.\n\nRun the following command and verify that nothing is returned:\n\n```\n# mount | grep -E '\\s/var/tmp\\s' | grep -v nosuid\n```",
                "fix": "Edit the `/etc/fstab` file and add `nosuid` to the fourth field (mounting\noptions) for the `/var/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/var/tmp` :\n    ```\n    # mount -o remount,nosuid /var/tmp\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.9"
            },
            "code": "control \"C-1.1.9\" do\n  title \"Ensure nosuid option set on /var/tmp partition\"\n  desc  \"The `nosuid` mount option specifies that the filesystem cannot contain\n`setuid` files.\"\n  desc  \"rationale\", \"Since the `/var/tmp` filesystem is only intended for\ntemporary file storage, set this option to ensure that users cannot create\n`setuid` files in `/var/tmp` .\"\n  desc  \"check\", \"\n    Verify that the `nosuid` option is set if a `/var/tmp` partition exists.\n\n    Run the following command and verify that nothing is returned:\n\n    ```\n    # mount | grep -E '\\\\s/var/tmp\\\\s' | grep -v nosuid\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/fstab` file and add `nosuid` to the fourth field (mounting\noptions) for the `/var/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/var/tmp` :\n    ```\n    # mount -o remount,nosuid /var/tmp\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.9\"\n\n  describe mount('/var/tmp') do\n    its('options') { should include 'nosuid' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.9.rb",
                "line": 3
            },
            "id": "C-1.1.9"
        },
        {
            "title": "Disable IPv6",
            "desc": "Although IPv6 has many advantages over IPv4, not all organizations\nhave IPv6 or dual stack configurations implemented.",
            "descriptions": {
                "default": "Although IPv6 has many advantages over IPv4, not all organizations\nhave IPv6 or dual stack configurations implemented.",
                "rationale": "If IPv6 or dual stack is not to be used, it is\nrecommended that IPv6 be disabled to reduce the attack surface of the system.",
                "check": "Depending or your distribution, run the appropriate following command and\nverify no lines should be returned.\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v \"ipv6.disable=1\"\n    ```",
                "fix": "Edit `/etc/default/grub` and add `ipv6.disable=1` to the\n`GRUB_CMDLINE_LINUX` parameters:\n\n    ```\n    GRUB_CMDLINE_LINUX=\"ipv6.disable=1\"\n    ```\n\n    Run the following command to update the `grub2` configuration:\n\n    ```\n    # update-grub\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "RA-5",
                    "CM-6",
                    "CM-8",
                    "SC-7(5)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "3",
                    "11",
                    "9.1",
                    "9.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "3.7"
            },
            "code": "control \"C-3.7\" do\n  title \"Disable IPv6\"\n  desc  \"Although IPv6 has many advantages over IPv4, not all organizations\nhave IPv6 or dual stack configurations implemented.\"\n  desc  \"rationale\", \"If IPv6 or dual stack is not to be used, it is\nrecommended that IPv6 be disabled to reduce the attack surface of the system.\"\n  desc  \"check\", \"\n    Depending or your distribution, run the appropriate following command and\nverify no lines should be returned.\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v \\\"ipv6.disable=1\\\"\n    ```\n  \"\n  desc \"fix\", \"\n    Edit `/etc/default/grub` and add `ipv6.disable=1` to the\n`GRUB_CMDLINE_LINUX` parameters:\n\n    ```\n    GRUB_CMDLINE_LINUX=\\\"ipv6.disable=1\\\"\n    ```\n\n    Run the following command to update the `grub2` configuration:\n\n    ```\n    # update-grub\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"RA-5\", \"CM-6\", \"CM-8\", \"SC-7(5)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"3\", \"11\", \"9.1\", \"9.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"3.7\"\n\n  describe command('grep \"^\\\\s*linux\" /boot/grub/grub.cfg | grep -v \"ipv6.disable=1\"') do\n    its('stdout') { should be_empty }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.7.rb",
                "line": 3
            },
            "id": "C-3.7"
        },
        {
            "title": "Ensure SSH access is limited",
            "desc": "There are several options available to limit which users and group can\naccess the system via SSH. It is recommended that at least one of the following\noptions be leveraged:\n\n    `AllowUsers`\n\n    The `AllowUsers` variable gives the system administrator the option of\nallowing specific users to `ssh` into the system. The list consists of space\nseparated user names. Numeric user IDs are not recognized with this variable.\nIf a system administrator wants to restrict user access further by only\nallowing the allowed users to log in from a particular host, the entry can be\nspecified in the form of user@host.\n\n    `AllowGroups`\n\n    The `AllowGroups` variable gives the system administrator the option of\nallowing specific groups of users to `ssh` into the system. The list consists\nof space separated group names. Numeric group IDs are not recognized with this\nvariable.\n\n    `DenyUsers`\n\n    The `DenyUsers` variable gives the system administrator the option of\ndenying specific users to `ssh` into the system. The list consists of space\nseparated user names. Numeric user IDs are not recognized with this variable.\nIf a system administrator wants to restrict user access further by specifically\ndenying a user's access from a particular host, the entry can be specified in\nthe form of user@host.\n\n    `DenyGroups`\n\n    The `DenyGroups` variable gives the system administrator the option of\ndenying specific groups of users to `ssh` into the system. The list consists of\nspace separated group names. Numeric group IDs are not recognized with this\nvariable.",
            "descriptions": {
                "default": "There are several options available to limit which users and group can\naccess the system via SSH. It is recommended that at least one of the following\noptions be leveraged:\n\n    `AllowUsers`\n\n    The `AllowUsers` variable gives the system administrator the option of\nallowing specific users to `ssh` into the system. The list consists of space\nseparated user names. Numeric user IDs are not recognized with this variable.\nIf a system administrator wants to restrict user access further by only\nallowing the allowed users to log in from a particular host, the entry can be\nspecified in the form of user@host.\n\n    `AllowGroups`\n\n    The `AllowGroups` variable gives the system administrator the option of\nallowing specific groups of users to `ssh` into the system. The list consists\nof space separated group names. Numeric group IDs are not recognized with this\nvariable.\n\n    `DenyUsers`\n\n    The `DenyUsers` variable gives the system administrator the option of\ndenying specific users to `ssh` into the system. The list consists of space\nseparated user names. Numeric user IDs are not recognized with this variable.\nIf a system administrator wants to restrict user access further by specifically\ndenying a user's access from a particular host, the entry can be specified in\nthe form of user@host.\n\n    `DenyGroups`\n\n    The `DenyGroups` variable gives the system administrator the option of\ndenying specific groups of users to `ssh` into the system. The list consists of\nspace separated group names. Numeric group IDs are not recognized with this\nvariable.",
                "rationale": "Restricting which users can remotely access the system\nvia SSH will help ensure that only authorized users access the system.",
                "check": "Run the following commands and verify that output matches for at least one:\n\n```\n# sshd -T | grep allowusers\n\nAllowUsers\n```\n\n```\n# sshd -T | grep allowgroups\n\nAllowGroups\n```\n\n```\n# sshd -T | grep denyusers\n\nDenyUsers\n```\n\n```\n# sshd -T | grep denygroups\n\nDenyGroups\n```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set one or more of the parameter as\nfollows:\n\n    ```\n    AllowUsers\n    ```\n\n    ```\n    AllowGroups\n    ```\n\n    ```\n    DenyUsers\n    ```\n\n    ```\n    DenyGroups\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-6 (9)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.3"
                ],
                "cis_rid": "5.2.18",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.18\" do\n  title \"Ensure SSH access is limited\"\n  desc  \"There are several options available to limit which users and group can\naccess the system via SSH. It is recommended that at least one of the following\noptions be leveraged:\n\n    `AllowUsers`\n\n    The `AllowUsers` variable gives the system administrator the option of\nallowing specific users to `ssh` into the system. The list consists of space\nseparated user names. Numeric user IDs are not recognized with this variable.\nIf a system administrator wants to restrict user access further by only\nallowing the allowed users to log in from a particular host, the entry can be\nspecified in the form of user@host.\n\n    `AllowGroups`\n\n    The `AllowGroups` variable gives the system administrator the option of\nallowing specific groups of users to `ssh` into the system. The list consists\nof space separated group names. Numeric group IDs are not recognized with this\nvariable.\n\n    `DenyUsers`\n\n    The `DenyUsers` variable gives the system administrator the option of\ndenying specific users to `ssh` into the system. The list consists of space\nseparated user names. Numeric user IDs are not recognized with this variable.\nIf a system administrator wants to restrict user access further by specifically\ndenying a user's access from a particular host, the entry can be specified in\nthe form of user@host.\n\n    `DenyGroups`\n\n    The `DenyGroups` variable gives the system administrator the option of\ndenying specific groups of users to `ssh` into the system. The list consists of\nspace separated group names. Numeric group IDs are not recognized with this\nvariable.\n  \"\n  desc  \"rationale\", \"Restricting which users can remotely access the system\nvia SSH will help ensure that only authorized users access the system.\"\n  desc  \"check\", \"\n    Run the following commands and verify that output matches for at least one:\n\n    ```\n    # sshd -T | grep allowusers\n\n    AllowUsers\n    ```\n\n    ```\n    # sshd -T | grep allowgroups\n\n    AllowGroups\n    ```\n\n    ```\n    # sshd -T | grep denyusers\n\n    DenyUsers\n    ```\n\n    ```\n    # sshd -T | grep denygroups\n\n    DenyGroups\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set one or more of the parameter as\nfollows:\n\n    ```\n    AllowUsers\n    ```\n\n    ```\n    AllowGroups\n    ```\n\n    ```\n    DenyUsers\n    ```\n\n    ```\n    DenyGroups\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-6 (9)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.3\"]\n  tag cis_rid: \"5.2.18\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n\n  describe.one do\n    describe sshd_config do\n      its('AllowUsers') { should_not be_empty }\n    end\n    describe sshd_config do\n      its('AllowGroups') { should_not be_empty }\n    end\n    describe sshd_config do\n      its('DenyUsers') { should_not be_empty }\n    end\n    describe sshd_config do\n      its('DenyGroups') { should_not be_empty }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.18.rb",
                "line": 3
            },
            "id": "C-5.2.18"
        },
        {
            "title": "Ensure no duplicate UIDs exist",
            "desc": "Although the `useradd` program will not let you create a duplicate\nUser ID (UID), it is possible for an administrator to manually edit the\n`/etc/passwd` file and change the UID field.",
            "descriptions": {
                "default": "Although the `useradd` program will not let you create a duplicate\nUser ID (UID), it is possible for an administrator to manually edit the\n`/etc/passwd` file and change the UID field.",
                "rationale": "Users must be assigned unique UIDs for accountability and\nto ensure appropriate access protections.",
                "check": "Run the following script and verify no results are returned:\n\n```\n#!/bin/bash\n\nawk -F: '{print $3}' /etc/passwd | sort -n | uniq -c | while read -r uid; do\n [ -z \"$uid\" ] & then\n users=$(awk -F: '($3 == n) { print $1 }' n=\"$2\" /etc/passwd | xargs)\n echo \"Duplicate UID \\\"$2\\\": \\\"$users\\\"\"\n fi\ndone\n```",
                "fix": "Based on the results of the audit script, establish unique UIDs\nand review all files owned by the shared UIDs to determine which UID they are\nsupposed to belong to."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-2"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.16"
            },
            "code": "control \"C-6.2.16\" do\n  title \"Ensure no duplicate UIDs exist\"\n  desc  \"Although the `useradd` program will not let you create a duplicate\nUser ID (UID), it is possible for an administrator to manually edit the\n`/etc/passwd` file and change the UID field.\"\n  desc  \"rationale\", \"Users must be assigned unique UIDs for accountability and\nto ensure appropriate access protections.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    awk -F: '{print $3}' /etc/passwd | sort -n | uniq -c | while read -r uid; do\n     [ -z \\\"$uid\\\" ] & then\n     users=$(awk -F: '($3 == n) { print $1 }' n=\\\"$2\\\" /etc/passwd | xargs)\n     echo \\\"Duplicate UID \\\\\\\"$2\\\\\\\": \\\\\\\"$users\\\\\\\"\\\"\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"Based on the results of the audit script, establish unique UIDs\nand review all files owned by the shared UIDs to determine which UID they are\nsupposed to belong to.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-2\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.16\"\n\n  passwd.entries.each do |user|\n    describe passwd.uids(user.uid) do\n      its('count') { should eq 1 }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.16.rb",
                "line": 3
            },
            "id": "C-6.2.16"
        },
        {
            "title": "Ensure DCCP is disabled",
            "desc": "The Datagram Congestion Control Protocol (DCCP) is a transport layer\nprotocol that supports streaming media and telephony. DCCP provides a way to\ngain access to congestion control, without having to do it at the application\nlayer, but does not provide in-sequence delivery.",
            "descriptions": {
                "default": "The Datagram Congestion Control Protocol (DCCP) is a transport layer\nprotocol that supports streaming media and telephony. DCCP provides a way to\ngain access to congestion control, without having to do it at the application\nlayer, but does not provide in-sequence delivery.",
                "rationale": "If the protocol is not required, it is recommended that\nthe drivers not be installed to reduce the potential attack surface.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe -n -v dccp\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep dccp\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/dccp.conf`\n\nand add the following line:\n\n```\ninstall dccp /bin/true\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "3.4.1"
            },
            "code": "control \"C-3.4.1\" do\n  title \"Ensure DCCP is disabled\"\n  desc  \"The Datagram Congestion Control Protocol (DCCP) is a transport layer\nprotocol that supports streaming media and telephony. DCCP provides a way to\ngain access to congestion control, without having to do it at the application\nlayer, but does not provide in-sequence delivery.\"\n  desc  \"rationale\", \"If the protocol is not required, it is recommended that\nthe drivers not be installed to reduce the potential attack surface.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe -n -v dccp\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep dccp\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/dccp.conf`\n\n    and add the following line:\n\n    ```\n    install dccp /bin/true\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"3.4.1\"\n\n\n  describe kernel_module('dccp') do\n    it { should_not be_loaded }\n    it { should_not be_disabled }\n    it { should_not be_blacklisted }\n  end\nend",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.4.1.rb",
                "line": 3
            },
            "id": "C-3.4.1"
        },
        {
            "title": "Ensure ufw service is enabled",
            "desc": "UncomplicatedFirewall (ufw) is a frontend for iptables. ufw provides a\nframework for managing netfilter, as well as a command-line and available\ngraphical user interface for manipulating the firewall.\n\n    Ensure that the ufw service is enabled to protect your system.",
            "descriptions": {
                "default": "UncomplicatedFirewall (ufw) is a frontend for iptables. ufw provides a\nframework for managing netfilter, as well as a command-line and available\ngraphical user interface for manipulating the firewall.\n\n    Ensure that the ufw service is enabled to protect your system.",
                "rationale": "The ufw service must be enabled and running in order for\nufw to protect the system",
                "check": "Run the following command to verify that ufw is enabled:\n\n```\n# systemctl is-enabled ufw\n\nenabled\n```\n\nRun the following command to verify that ufw is running:\n\n```\n# ufw status | grep Status\n\nStatus: active\n```",
                "fix": "Run the following command to enable ufw:\n\n```\n# ufw enable\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.2.1"
            },
            "code": "control \"C-3.5.2.1\" do\n  title \"Ensure ufw service is enabled\"\n  desc  \"UncomplicatedFirewall (ufw) is a frontend for iptables. ufw provides a\nframework for managing netfilter, as well as a command-line and available\ngraphical user interface for manipulating the firewall.\n\n    Ensure that the ufw service is enabled to protect your system.\n  \"\n  desc  \"rationale\", \"The ufw service must be enabled and running in order for\nufw to protect the system\"\n  desc  \"check\", \"\n    Run the following command to verify that ufw is enabled:\n\n    ```\n    # systemctl is-enabled ufw\n\n    enabled\n    ```\n\n    Run the following command to verify that ufw is running:\n\n    ```\n    # ufw status | grep Status\n\n    Status: active\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to enable ufw:\n\n    ```\n    # ufw enable\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.2.1\"\n\n\n  ufw_status = command('ufw status').stdout.strip.lines.first\n  value = ufw_status.split(':')[1].strip\n\n  describe 'UFW status' do\n    subject { value }\n    it { should cmp 'active' }\n  end\n\n  describe service('ufw') do\n    it { should be_running }\n    it { should be_enabled }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.2.1.rb",
                "line": 3
            },
            "id": "C-3.5.2.1"
        },
        {
            "title": "Ensure noexec option set on removable media partitions",
            "desc": "The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.",
            "descriptions": {
                "default": "The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.",
                "rationale": "Setting this option on a file system prevents users from\nexecuting programs from the removable media. This deters users from being able\nto introduce potentially malicious software on the system.",
                "check": "Run the following command and verify that the `noexec` option is set on all\nremovable media partitions.\n\n    ```\n    # mount\n    ```",
                "fix": "Edit the `/etc/fstab` file and add `noexec` to the fourth field\n(mounting options) of all removable media partitions. Look for entries that\nhave mount points that contain words such as floppy or cdrom. See the\n`fstab(5)` manual page for more information."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-2 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "2.6",
                    "Rev_7"
                ],
                "cis_rid": "1.1.20"
            },
            "code": "control \"C-1.1.20\" do\n  title \"Ensure noexec option set on removable media partitions\"\n  desc  \"The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.\"\n  desc  \"rationale\", \"Setting this option on a file system prevents users from\nexecuting programs from the removable media. This deters users from being able\nto introduce potentially malicious software on the system.\"\n  desc  \"check\", \"\n    Run the following command and verify that the `noexec` option is set on all\nremovable media partitions.\n\n    ```\n    # mount\n    ```\n  \"\n  desc \"fix\", \"Edit the `/etc/fstab` file and add `noexec` to the fourth field\n(mounting options) of all removable media partitions. Look for entries that\nhave mount points that contain words such as floppy or cdrom. See the\n`fstab(5)` manual page for more information.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-2 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"2.6\", \"Rev_7\"]\n  tag cis_rid: \"1.1.20\"\n\n  mounts = command('mount').stdout.strip.split(\"\\n\").\n      map do |d|\n    split_mounts = d.split(%r{\\s+})\n    options = split_mounts[-1].match(%r{\\((.*)\\)$}).captures.first.split(',')\n    dev_file = file(split_mounts[0])\n    dev_link = dev_file.symlink? ? dev_file.link_path : dev_file.path\n    {'dev'=>split_mounts[0], 'link'=>dev_link, 'mount'=>split_mounts[2], 'options'=>options}\n  end\n\n  dev_mounts = mounts.\n      select { |mnt| mnt['dev'].start_with? '/' and !mnt['dev'].start_with? '//' }.\n      map do |mnt|\n    # https://unix.stackexchange.com/a/308724\n    partition = ['/sys/class/block', String(mnt['link']).sub(%r{^/dev/}, ''), 'partition'].join('/')\n    if file(partition).exist?\n      # root_dev = command('basename \"$(readlink -f \"/sys/class/block/sda1/..\")\"').stdout.strip\n      root_dev = mount('/').device()\n    else\n      mnt['root_dev'] = mnt['link']\n    end\n    mnt\n  end\n\n  removable_mounts = dev_mounts.select do |mnt|\n    removable = ['/sys/block', String(mnt['root_dev']).sub(%r{^/dev/}, ''), 'removable'].join('/')\n    #file(removable).content.strip == '1'\n    file(removable).file.stat.length > 0\n  end\n\n  if removable_mounts.empty?\n    describe \"Removable mounted devices\" do\n      subject { removable_mounts }\n      it { should be_empty }\n    end\n  else\n    removable_mounts.each do |mnt|\n      describe mount(mnt) do\n        it { should be_mounted }\n        its('options') { should include 'noexec' }\n      end\n    end\n  end\n\n  #/bin/mount | /bin/grep -P 'on[\\\\s]+/dev/(floppy|cdrom|corder|mmcblk)'\"\n  #\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.20.rb",
                "line": 3
            },
            "id": "C-1.1.20"
        },
        {
            "title": "Ensure nodev option set on /home partition",
            "desc": "The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.",
            "descriptions": {
                "default": "The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.",
                "rationale": "Since the user partitions are not intended to support\ndevices, set this option to ensure that users cannot attempt to create block or\ncharacter special devices.",
                "check": "Verify that the `nodev` option is set if a `/home` partition exists.\n\nRun the following command and verify that nothing is returned:\n\n```\n# mount | grep -E '\\s/home\\s' | grep -v nodev\n```",
                "fix": "Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting\noptions) for the `/home` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    ```\n    # mount -o remount,nodev /home\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.14"
            },
            "code": "control \"C-1.1.14\" do\n  title \"Ensure nodev option set on /home partition\"\n  desc  \"The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.\"\n  desc  \"rationale\", \"Since the user partitions are not intended to support\ndevices, set this option to ensure that users cannot attempt to create block or\ncharacter special devices.\"\n  desc  \"check\", \"\n    Verify that the `nodev` option is set if a `/home` partition exists.\n\n    Run the following command and verify that nothing is returned:\n\n    ```\n    # mount | grep -E '\\\\s/home\\\\s' | grep -v nodev\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting\noptions) for the `/home` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    ```\n    # mount -o remount,nodev /home\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.14\"\n\n  describe mount('/home') do\n    its('options') { should include 'nodev' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.14.rb",
                "line": 3
            },
            "id": "C-1.1.14"
        },
        {
            "title": "Ensure HTTP server is not enabled",
            "desc": "HTTP or web servers provide the ability to host web site content.",
            "descriptions": {
                "default": "HTTP or web servers provide the ability to host web site content.",
                "rationale": "Unless there is a need to run the system as a web server,\nit is recommended that the package be deleted to reduce the potential attack\nsurface.",
                "check": "Run the following command to verify `apache` is not enabled:\n\n```\n# systemctl is-enabled apache2\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run the following command to disable `apache`:\n\n```\n# systemctl --now disable apache2\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.10"
            },
            "code": "control \"C-2.2.10\" do\n  title \"Ensure HTTP server is not enabled\"\n  desc  \"HTTP or web servers provide the ability to host web site content.\"\n  desc  \"rationale\", \"Unless there is a need to run the system as a web server,\nit is recommended that the package be deleted to reduce the potential attack\nsurface.\"\n  desc  \"check\", \"\n    Run the following command to verify `apache` is not enabled:\n\n    ```\n    # systemctl is-enabled apache2\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following command to disable `apache`:\n\n    ```\n    # systemctl --now disable apache2\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.10\"\n\n  if package('apache2').installed? || package('nginx').installed?\n    describe service('apache2') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n    describe service('nginx') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n  else\n    impact 0.0\n    describe \"An HTTP Server package is not installed\" do\n      skip \"An HTTP Server package is not installed.\"\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.10.rb",
                "line": 3
            },
            "id": "C-2.2.10"
        },
        {
            "title": "Ensure permissions on /etc/ssh/sshd_config are configured",
            "desc": "The `/etc/ssh/sshd_config` file contains configuration specifications\nfor `sshd`. The command below sets the owner and group of the file to root.",
            "descriptions": {
                "default": "The `/etc/ssh/sshd_config` file contains configuration specifications\nfor `sshd`. The command below sets the owner and group of the file to root.",
                "rationale": "The `/etc/ssh/sshd_config` file needs to be protected\nfrom unauthorized changes by non-privileged users.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other`:\n\n    ```\n    # stat /etc/ssh/sshd_config\n\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set ownership and permissions on\n`/etc/ssh/sshd_config`:\n\n    ```\n    # chown root:root /etc/ssh/sshd_config\n    ```\n\n    ```\n    # chmod og-rwx /etc/ssh/sshd_config\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_rid": "5.2.1",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.1\" do\n  title \"Ensure permissions on /etc/ssh/sshd_config are configured\"\n  desc  \"The `/etc/ssh/sshd_config` file contains configuration specifications\nfor `sshd`. The command below sets the owner and group of the file to root.\"\n  desc  \"rationale\", \"The `/etc/ssh/sshd_config` file needs to be protected\nfrom unauthorized changes by non-privileged users.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other`:\n\n    ```\n    # stat /etc/ssh/sshd_config\n\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set ownership and permissions on\n`/etc/ssh/sshd_config`:\n\n    ```\n    # chown root:root /etc/ssh/sshd_config\n    ```\n\n    ```\n    # chmod og-rwx /etc/ssh/sshd_config\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_rid: \"5.2.1\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe file('/etc/ssh/sshd_config') do\n    it { should be_file }\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n    it { should_not be_more_permissive_than('0600') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.1.rb",
                "line": 3
            },
            "id": "C-5.2.1"
        },
        {
            "title": "Ensure remote login warning banner is configured properly",
            "desc": "The contents of the `/etc/issue.net` file are displayed to users prior\nto login for remote connections from configured services.\n\n    Unix-based systems have typically displayed information about the OS\nrelease and patch level upon logging in to the system. This information can be\nuseful to developers who are developing software for a particular OS platform.\nIf `mingetty(8)` supports the following options, they display operating system\ninformation: `\\m` - machine architecture `` - operating system release `\\s` - operating system name `\\v` - operating\nsystem version",
            "descriptions": {
                "default": "The contents of the `/etc/issue.net` file are displayed to users prior\nto login for remote connections from configured services.\n\n    Unix-based systems have typically displayed information about the OS\nrelease and patch level upon logging in to the system. This information can be\nuseful to developers who are developing software for a particular OS platform.\nIf `mingetty(8)` supports the following options, they display operating system\ninformation: `\\m` - machine architecture `` - operating system release `\\s` - operating system name `\\v` - operating\nsystem version",
                "rationale": "Warning messages inform users who are attempting to login\nto the system of their legal status regarding the system and must include the\nname of the organization that owns the system and any monitoring policies that\nare in place. Displaying OS and patch level information in login banners also\nhas the side effect of providing detailed system information to attackers\nattempting to target specific exploits of a system. Authorized users can easily\nget this information by running the \" `uname -a` \" command once they have\nlogged in.",
                "check": "Run the following command and verify that the contents match site policy:\n\n    ```\n    # cat /etc/issue.net\n    ```\n\n    Run the following command and verify no results are returned:\n\n    ```\n    # grep -E -i \"(\\\\\\v|\\\\|\\\\\\m|\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e\n's/\"//g'))\" /etc/issue.net\n    ```",
                "fix": "Edit the `/etc/issue.net` file with the appropriate contents according to\nyour site policy, remove any instances of `\\m` , `` , `\\s` , `\\v` or references to the `OS platform`\n\n    ```\n    # echo \"Authorized uses only. All activity may be monitored and\nreported.\" > /etc/issue.net\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.8.1.3"
            },
            "code": "control \"C-1.8.1.3\" do\n  title \"Ensure remote login warning banner is configured properly\"\n  desc  \"The contents of the `/etc/issue.net` file are displayed to users prior\nto login for remote connections from configured services.\n\n    Unix-based systems have typically displayed information about the OS\nrelease and patch level upon logging in to the system. This information can be\nuseful to developers who are developing software for a particular OS platform.\nIf `mingetty(8)` supports the following options, they display operating system\ninformation: `\\\\m` - machine architecture `\\\n` - operating system release `\\\\s` - operating system name `\\\\v` - operating\nsystem version\n  \"\n  desc  \"rationale\", \"Warning messages inform users who are attempting to login\nto the system of their legal status regarding the system and must include the\nname of the organization that owns the system and any monitoring policies that\nare in place. Displaying OS and patch level information in login banners also\nhas the side effect of providing detailed system information to attackers\nattempting to target specific exploits of a system. Authorized users can easily\nget this information by running the \\\" `uname -a` \\\" command once they have\nlogged in.\"\n  desc  \"check\", \"\n    Run the following command and verify that the contents match site policy:\n\n    ```\n    # cat /etc/issue.net\n    ```\n\n    Run the following command and verify no results are returned:\n\n    ```\n    # grep -E -i \\\"(\\\\\\\\\\\\v|\\\\\\\\\\\n|\\\\\\\\\\\\m|\\\\\\\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e\n's/\\\"//g'))\\\" /etc/issue.net\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/issue.net` file with the appropriate contents according to\nyour site policy, remove any instances of `\\\\m` , `\\\n` , `\\\\s` , `\\\\v` or references to the `OS platform`\n\n    ```\n    # echo \\\"Authorized uses only. All activity may be monitored and\nreported.\\\" > /etc/issue.net\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.8.1.3\"\n\n  banner_message_text_cli = input('banner_message_text_cli')\n  banner_message_text_cli_limited = input('banner_message_text_cli_limited')\n\n  clean_banner = banner_message_text_cli.gsub(%r{[\\r\\n\\s]}, '')\n  clean_banner_limited = banner_message_text_cli_limited.gsub(%r{[\\r\\n\\s]}, '')\n  banner_file = file(\"/etc/issue\")\n  banner_missing = !banner_file.exist?\n\n  describe \"The banner text is not set because /etc/issue does not exist\" do\n    subject { banner_missing }\n    it { should be false }\n  end if banner_missing\n\n  banner_message = banner_file.content.gsub(%r{[\\r\\n\\s]}, '')\n  describe.one do\n    describe \"The banner text should match the standard banner\" do\n      subject { banner_message }\n      it { should cmp clean_banner }\n    end\n    describe \"The banner text should match the limited banner\" do\n      subject { banner_message }\n      it{should cmp clean_banner_limited }\n    end\n  end if !banner_missing\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.8.1.3.rb",
                "line": 3
            },
            "id": "C-1.8.1.3"
        },
        {
            "title": "Ensure mounting of hfs filesystems is disabled",
            "desc": "The `hfs` filesystem type is a hierarchical filesystem that allows you\nto mount Mac OS filesystems.",
            "descriptions": {
                "default": "The `hfs` filesystem type is a hierarchical filesystem that allows you\nto mount Mac OS filesystems.",
                "rationale": "Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe -n -v hfs\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep hfs\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/hfs.conf`\n\nand add the following line:\n\n```\ninstall hfs /bin/true\n```\n\nRun the following command to unload the `hfs` module:\n\n```\n# rmmod hfs\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.1.4"
            },
            "code": "control \"C-1.1.1.4\" do\n  title \"Ensure mounting of hfs filesystems is disabled\"\n  desc  \"The `hfs` filesystem type is a hierarchical filesystem that allows you\nto mount Mac OS filesystems.\"\n  desc  \"rationale\", \"Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe -n -v hfs\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep hfs\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/hfs.conf`\n\n    and add the following line:\n\n    ```\n    install hfs /bin/true\n    ```\n\n    Run the following command to unload the `hfs` module:\n\n    ```\n    # rmmod hfs\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.1.4\"\n\n  describe kernel_module('hfs') do\n    it { should_not be_loaded }\n    it { should be_disabled }\n    it { should be_blacklisted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.1.4.rb",
                "line": 3
            },
            "id": "C-1.1.1.4"
        },
        {
            "title": "Ensure NFS and RPC are not enabled",
            "desc": "The Network File System (NFS) is one of the first and most widely\ndistributed file systems in the UNIX environment. It provides the ability for\nsystems to mount file systems of other servers through the network.",
            "descriptions": {
                "default": "The Network File System (NFS) is one of the first and most widely\ndistributed file systems in the UNIX environment. It provides the ability for\nsystems to mount file systems of other servers through the network.",
                "rationale": "If the system does not export NFS shares or act as an NFS\nclient, it is recommended that these services be disabled to reduce the remote\nattack surface.",
                "check": "Run the following command to verify `nfs` is not enabled:\n\n```\n# systemctl is-enabled nfs-server\n\ndisabled\n```\n\nVerify result is not \"enabled\".\n\nRun the following command to verify `rpcbind` is not enabled:\n\n```\n# systemctl is-enabled rpcbind\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run the following commands to disable `nfs` and `rpcbind`:\n\n```\n# systemctl --now disable nfs-server\n\n# systemctl --now disable rpcbind\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.7"
            },
            "code": "control \"C-2.2.7\" do\n  title \"Ensure NFS and RPC are not enabled\"\n  desc  \"The Network File System (NFS) is one of the first and most widely\ndistributed file systems in the UNIX environment. It provides the ability for\nsystems to mount file systems of other servers through the network.\"\n  desc  \"rationale\", \"If the system does not export NFS shares or act as an NFS\nclient, it is recommended that these services be disabled to reduce the remote\nattack surface.\"\n  desc  \"check\", \"\n    Run the following command to verify `nfs` is not enabled:\n\n    ```\n    # systemctl is-enabled nfs-server\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n\n    Run the following command to verify `rpcbind` is not enabled:\n\n    ```\n    # systemctl is-enabled rpcbind\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following commands to disable `nfs` and `rpcbind`:\n\n    ```\n    # systemctl --now disable nfs-server\n\n    # systemctl --now disable rpcbind\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.7\"\n\n  if package('nfs-kernel-server').installed? || package('nfs-ganesha').installed?\n      describe service('nfs-kernel-server') do\n        it { should_not be_enabled }\n        it { should_not be_running }\n      end\n      describe service('nfs-ganesha') do\n        it { should_not be_enabled }\n        it { should_not be_running }\n      end\n    describe service('rpcbind') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n  else\n    impact 0.0\n    describe \"An NFS and RPC Server packages are not installed\" do\n      skip \"An NFS and RPC Server packages are not installed, this control is Not Applicable.\"\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.7.rb",
                "line": 3
            },
            "id": "C-2.2.7"
        },
        {
            "title": "Ensure permissions on /etc/cron.monthly are configured",
            "desc": "The `/etc/cron.monthly` directory contains system cron jobs that need\nto run on a monthly basis. The files in this directory cannot be manipulated by\nthe `crontab` command, but are instead edited by system administrators using a\ntext editor. The commands below restrict read/write and search access to user\nand group root, preventing regular users from accessing this directory.",
            "descriptions": {
                "default": "The `/etc/cron.monthly` directory contains system cron jobs that need\nto run on a monthly basis. The files in this directory cannot be manipulated by\nthe `crontab` command, but are instead edited by system administrators using a\ntext editor. The commands below restrict read/write and search access to user\nand group root, preventing regular users from accessing this directory.",
                "rationale": "Granting write access to this directory for\nnon-privileged users could provide them the means for gaining unauthorized\nelevated privileges. Granting read access to this directory could give an\nunprivileged user insight in how to gain elevated privileges or circumvent\nauditing controls.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/cron.monthly\n\n    Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set ownership and permissions on\n`/etc/cron.monthly` :\n\n    ```\n    # chown root:root /etc/cron.monthly\n    ```\n\n    ```\n    # chmod og-rwx /etc/cron.monthly\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "5.1.6"
            },
            "code": "control \"C-5.1.6\" do\n  title \"Ensure permissions on /etc/cron.monthly are configured\"\n  desc  \"The `/etc/cron.monthly` directory contains system cron jobs that need\nto run on a monthly basis. The files in this directory cannot be manipulated by\nthe `crontab` command, but are instead edited by system administrators using a\ntext editor. The commands below restrict read/write and search access to user\nand group root, preventing regular users from accessing this directory.\"\n  desc  \"rationale\", \"Granting write access to this directory for\nnon-privileged users could provide them the means for gaining unauthorized\nelevated privileges. Granting read access to this directory could give an\nunprivileged user insight in how to gain elevated privileges or circumvent\nauditing controls.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/cron.monthly\n\n    Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set ownership and permissions on\n`/etc/cron.monthly` :\n\n    ```\n    # chown root:root /etc/cron.monthly\n    ```\n\n    ```\n    # chmod og-rwx /etc/cron.monthly\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"5.1.6\"\n\n  describe file('/etc/cron.monthly') do \n    its('owner') { should cmp 'root' }\n    its('group') { should cmp 'root' }\n    it { should be_directory }\n    it { should_not be_more_permissive_than('0700') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.1.6.rb",
                "line": 3
            },
            "id": "C-5.1.6"
        },
        {
            "title": "Ensure permissions on bootloader config are configured",
            "desc": "The grub configuration file contains information on boot settings and\npasswords for unlocking boot options.\n     The grub configuration is usually `grub.cfg` stored in `/boot/grub/`.",
            "descriptions": {
                "default": "The grub configuration file contains information on boot settings and\npasswords for unlocking boot options.\n     The grub configuration is usually `grub.cfg` stored in `/boot/grub/`.",
                "rationale": "Setting the permissions to read and write for root only\nprevents non-root users from seeing the boot parameters or changing them.\nNon-root users who read the boot parameters may be able to identify weaknesses\nin security upon boot and be able to exploit them.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /boot/grub/grub.cfg\n\n    Access: (0400/-r--------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set permissions on your grub configuration:\n\n```\n# chown root:root /boot/grub/grub.cfg\n```\n\n```\n# chmod og-rwx /boot/grub/grub.cfg\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.5.1"
            },
            "code": "control \"C-1.5.1\" do\n  title \"Ensure permissions on bootloader config are configured\"\n  desc  \"The grub configuration file contains information on boot settings and\npasswords for unlocking boot options.\n     The grub configuration is usually `grub.cfg` stored in `/boot/grub/`.\n  \"\n  desc  \"rationale\", \"Setting the permissions to read and write for root only\nprevents non-root users from seeing the boot parameters or changing them.\nNon-root users who read the boot parameters may be able to identify weaknesses\nin security upon boot and be able to exploit them.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /boot/grub/grub.cfg\n\n    Access: (0400/-r--------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set permissions on your grub configuration:\n\n    ```\n    # chown root:root /boot/grub/grub.cfg\n    ```\n\n    ```\n    # chmod og-rwx /boot/grub/grub.cfg\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.5.1\"\n\n  describe file('/boot/grub/grub.cfg') do\n    its ('uid') { should cmp 0 }\n    its ('gid') { should cmp 0 }\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n    it { should_not be_grouped_into 'users' }\n    its ('mode') { should cmp '0400' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.5.1.rb",
                "line": 3
            },
            "id": "C-1.5.1"
        },
        {
            "title": "Ensure audit log storage size is configured",
            "desc": "Configure the maximum size of the audit log file. Once the log reaches\nthe maximum size, it will be rotated and a new log file will be started.",
            "descriptions": {
                "default": "Configure the maximum size of the audit log file. Once the log reaches\nthe maximum size, it will be rotated and a new log file will be started.",
                "rationale": "It is important that an appropriate size is determined\nfor log files so that they do not impact the system and audit data is not lost.",
                "check": "Run the following command and ensure output is in compliance with site\npolicy:\n\n    ```\n    # grep max_log_file /etc/audit/auditd.conf\n\n    max_log_file =\n    ```",
                "fix": "Set the following parameter in `/etc/audit/auditd.conf` in accordance with\nsite policy:\n\n    ```\n    max_log_file =\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "6.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.2.1"
            },
            "code": "control \"C-4.1.2.1\" do\n  title \"Ensure audit log storage size is configured\"\n  desc  \"Configure the maximum size of the audit log file. Once the log reaches\nthe maximum size, it will be rotated and a new log file will be started.\"\n  desc  \"rationale\", \"It is important that an appropriate size is determined\nfor log files so that they do not impact the system and audit data is not lost.\"\n  desc  \"check\", \"\n    Run the following command and ensure output is in compliance with site\npolicy:\n\n    ```\n    # grep max_log_file /etc/audit/auditd.conf\n\n    max_log_file =\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameter in `/etc/audit/auditd.conf` in accordance with\nsite policy:\n\n    ```\n    max_log_file =\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"6.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.2.1\"\n  describe auditd_conf do\n    its('max_log_file') { should_not be_empty }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.2.1.rb",
                "line": 3
            },
            "id": "C-4.1.2.1"
        },
        {
            "title": "Ensure file deletion events by users are collected",
            "desc": "Monitor the use of system calls associated with the deletion or\nrenaming of files and file attributes. This configuration statement sets up\nmonitoring for the `unlink` (remove a file), `unlinkat` (remove a file\nattribute), `rename` (rename a file) and `renameat` (rename a file attribute)\nsystem calls and tags them with the identifier \"delete\".\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.",
            "descriptions": {
                "default": "Monitor the use of system calls associated with the deletion or\nrenaming of files and file attributes. This configuration statement sets up\nmonitoring for the `unlink` (remove a file), `unlinkat` (remove a file\nattribute), `rename` (rename a file) and `renameat` (rename a file attribute)\nsystem calls and tags them with the identifier \"delete\".\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.",
                "rationale": "Monitoring these calls from non-privileged users could\nprovide a system administrator with evidence that inappropriate removal of\nfiles and file attributes associated with protected files is occurring. While\nthis audit option will look at all events, system administrators will want to\nlook for specific privileged files that are being deleted or altered.",
                "check": "On a 32 bit system run the following commands:\n\n    ```\n    # grep delete /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    ```\n\n    ```\n    # auditctl -l | grep delete\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S unlink,rename,unlinkat,renameat -F auid>=1000\n-F auid!=-1 -F key=delete\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep delete /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    ```\n\n    ```\n    # auditctl -l | grep delete\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S rename,unlink,unlinkat,renameat -F auid>=5100\n-F auid!=-1 -F key=delete\n    -a always,exit -F arch=b32 -S unlink,rename,unlinkat,renameat -F auid>=1000\n-F auid!=-1 -F key=delete\n    ```",
                "fix": "For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/audit.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/delete.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "SC-1"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "13"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.13"
            },
            "code": "control \"C-4.1.13\" do\n  title \"Ensure file deletion events by users are collected\"\n  desc  \"Monitor the use of system calls associated with the deletion or\nrenaming of files and file attributes. This configuration statement sets up\nmonitoring for the `unlink` (remove a file), `unlinkat` (remove a file\nattribute), `rename` (rename a file) and `renameat` (rename a file attribute)\nsystem calls and tags them with the identifier \\\"delete\\\".\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.\n  \"\n  desc  \"rationale\", \"Monitoring these calls from non-privileged users could\nprovide a system administrator with evidence that inappropriate removal of\nfiles and file attributes associated with protected files is occurring. While\nthis audit option will look at all events, system administrators will want to\nlook for specific privileged files that are being deleted or altered.\"\n  desc  \"check\", \"\n    On a 32 bit system run the following commands:\n\n    ```\n    # grep delete /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    ```\n\n    ```\n    # auditctl -l | grep delete\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S unlink,rename,unlinkat,renameat -F auid>=1000\n-F auid!=-1 -F key=delete\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep delete /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    ```\n\n    ```\n    # auditctl -l | grep delete\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S rename,unlink,unlinkat,renameat -F auid>=5100\n-F auid!=-1 -F key=delete\n    -a always,exit -F arch=b32 -S unlink,rename,unlinkat,renameat -F auid>=1000\n-F auid!=-1 -F key=delete\n    ```\n  \"\n  desc  \"fix\", \"\n    For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/audit.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/delete.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    -a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F\nauid>=1000 -F auid!=4294967295 -k delete\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"SC-1\"]\n  tag cis_level: 2\n  tag cis_controls: [\"13\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.13\"\n\n\n  arches = ['b32']\n  if os.arch.match?(/64/)\n    arches.push('b64')\n  end\n\n  syscalls = [\n    'unlink',\n    'unlinkat',\n    'rename',\n    'renameat'\n  ]\n\n  syscalls.each do |syscall|\n    arches.each do |a|\n      describe auditd.syscall(syscall).where { arch == a && key == 'delete'  } do\n        its('action.uniq') { should eq ['always'] }\n        its('list.uniq') { should eq ['exit'] }\n        its('fields.flatten.uniq') {  should include \"auid>=#{login_defs.UID_MIN}\" }\n      end\n\n      # the rule states that `auid!=4294967295` but this comes back as `auid!=-1` when queries via `auditctl -l`\n      # this check will allow either.\n      describe.one do\n        describe auditd.syscall(syscall).where { arch == a && key == 'delete'  } do\n          its('fields.flatten.uniq') {  should include \"auid!=-1\" }\n        end\n        describe auditd.syscall(syscall).where { arch == a && key == 'delete'  } do\n          its('fields.flatten.uniq') {  should include \"auid!=4294967295\" }\n        end\n      end\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.13.rb",
                "line": 3
            },
            "id": "C-4.1.13"
        },
        {
            "title": "Ensure password expiration is 365 days or less",
            "desc": "The `PASS_MAX_DAYS` parameter in `/etc/login.defs` allows an\nadministrator to force passwords to expire once they reach a defined age. It is\nrecommended that the `PASS_MAX_DAYS` parameter be set to less than or equal to\n365 days.",
            "descriptions": {
                "default": "The `PASS_MAX_DAYS` parameter in `/etc/login.defs` allows an\nadministrator to force passwords to expire once they reach a defined age. It is\nrecommended that the `PASS_MAX_DAYS` parameter be set to less than or equal to\n365 days.",
                "rationale": "The window of opportunity for an attacker to leverage\ncompromised credentials or successfully compromise credentials via an online\nbrute force attack is limited by the age of the password. Therefore, reducing\nthe maximum age of a password also reduces an attacker's window of opportunity.",
                "check": "Run the following command and verify `PASS_MAX_DAYS` conforms to site\npolicy (no more than 365 days):\n\n    ```\n    # grep PASS_MAX_DAYS /etc/login.defs\n\n    PASS_MAX_DAYS 365\n    ```\n\n    Run the following command and Review list of users and PASS_MAX_DAYS to\nverify that all users' PASS_MAX_DAYS conforms to site policy (no more than 365\ndays):\n\n    ```\n    # grep -E '^[^:]+:[^!*]' /etc/shadow | cut -d: -f1,5\n\n    :\n\n    ```",
                "fix": "Set the `PASS_MAX_DAYS` parameter to conform to site policy in\n`/etc/login.defs` :\n\n    ```\n    PASS_MAX_DAYS 365\n    ```\n\n    Modify user parameters for all users with a password set to match:\n\n    ```\n    # chage --maxdays 365\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "IA-5 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.4",
                    "Rev_7"
                ],
                "cis_rid": "5.4.1.1"
            },
            "code": "control \"C-5.4.1.1\" do\n  title \"Ensure password expiration is 365 days or less\"\n  desc  \"The `PASS_MAX_DAYS` parameter in `/etc/login.defs` allows an\nadministrator to force passwords to expire once they reach a defined age. It is\nrecommended that the `PASS_MAX_DAYS` parameter be set to less than or equal to\n365 days.\"\n  desc  \"rationale\", \"The window of opportunity for an attacker to leverage\ncompromised credentials or successfully compromise credentials via an online\nbrute force attack is limited by the age of the password. Therefore, reducing\nthe maximum age of a password also reduces an attacker's window of opportunity.\"\n  desc  \"check\", \"\n    Run the following command and verify `PASS_MAX_DAYS` conforms to site\npolicy (no more than 365 days):\n\n    ```\n    # grep PASS_MAX_DAYS /etc/login.defs\n\n    PASS_MAX_DAYS 365\n    ```\n\n    Run the following command and Review list of users and PASS_MAX_DAYS to\nverify that all users' PASS_MAX_DAYS conforms to site policy (no more than 365\ndays):\n\n    ```\n    # grep -E '^[^:]+:[^!*]' /etc/shadow | cut -d: -f1,5\n\n    :\n\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the `PASS_MAX_DAYS` parameter to conform to site policy in\n`/etc/login.defs` :\n\n    ```\n    PASS_MAX_DAYS 365\n    ```\n\n    Modify user parameters for all users with a password set to match:\n\n    ```\n    # chage --maxdays 365\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"IA-5 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.4\", \"Rev_7\"]\n  tag cis_rid: \"5.4.1.1\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.4.1.1.rb",
                "line": 3
            },
            "id": "C-5.4.1.1"
        },
        {
            "title": "Ensure no users have .netrc files",
            "desc": "The `.netrc` file contains data for logging into a remote host for\nfile transfers via FTP.",
            "descriptions": {
                "default": "The `.netrc` file contains data for logging into a remote host for\nfile transfers via FTP.",
                "rationale": "The `.netrc` file presents a significant security risk\nsince it stores passwords in unencrypted form. Even if FTP is disabled, user\naccounts may have brought over `.netrc` files from other systems which could\npose a risk to those systems.",
                "check": "Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\"'\"$(which nologin)\"'\" & do\n     if [ ! -d \"$dir\" ]; then\n     echo \"The home directory \\\"$dir\\\" of user \\\"$user\\\" does not\nexist.\"\n     else\n     if [ ! -h \"$dir/.netrc\" ] & then\n     echo \".netrc file \\\"$dir/.netrc\\\" exists\"\n     fi\n     fi\n    done\n    ```",
                "fix": "Making global modifications to users' files without alerting\nthe user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser `.netrc` files and determine the action to be taken in accordance with\nsite policy."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-28"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.12"
            },
            "code": "control \"C-6.2.12\" do\n  title \"Ensure no users have .netrc files\"\n  desc  \"The `.netrc` file contains data for logging into a remote host for\nfile transfers via FTP.\"\n  desc  \"rationale\", \"The `.netrc` file presents a significant security risk\nsince it stores passwords in unencrypted form. Even if FTP is disabled, user\naccounts may have brought over `.netrc` files from other systems which could\npose a risk to those systems.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\\\"'\\\"$(which nologin)\\\"'\\\" & do\n     if [ ! -d \\\"$dir\\\" ]; then\n     echo \\\"The home directory \\\\\\\"$dir\\\\\\\" of user \\\\\\\"$user\\\\\\\" does not\nexist.\\\"\n     else\n     if [ ! -h \\\"$dir/.netrc\\\" ] & then\n     echo \\\".netrc file \\\\\\\"$dir/.netrc\\\\\\\" exists\\\"\n     fi\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"Making global modifications to users' files without alerting\nthe user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser `.netrc` files and determine the action to be taken in accordance with\nsite policy.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-28\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.12\"\n\n  nologin = command(\"which nologin\").stdout.strip\n  \n  passwd.where { user != 'halt' && user != 'sync' && user != 'shutdown' && shell != nologin }.entries.each do |user|\n    describe file(\"#{user.home}/.netrc\") do\n      it { should_not exist }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.12.rb",
                "line": 3
            },
            "id": "C-6.2.12"
        },
        {
            "title": "Ensure password hashing algorithm is SHA-512",
            "desc": "The commands below change password encryption from `md5` to `sha512`\n(a much stronger hashing algorithm). All existing accounts will need to perform\na password change to upgrade the stored hashes to the new algorithm.",
            "descriptions": {
                "default": "The commands below change password encryption from `md5` to `sha512`\n(a much stronger hashing algorithm). All existing accounts will need to perform\na password change to upgrade the stored hashes to the new algorithm.",
                "rationale": "The SHA-512 algorithm provides much stronger hashing than MD5, thus\nproviding additional protection to the system by increasing the level of effort\nfor an attacker to successfully determine passwords.\n\n    Note that these change only apply to accounts configured on the local\nsystem.",
                "check": "Run the following commands and ensure the sha512 option is included in all\nresults:\n\n    ```\n    # grep -E\n'^\\s*password\\s+(\\S+\\s+)+pam_unix\\.so\\s+(\\S+\\s+)*sha512\\s*(\\S+\\s*)*(\\s+#.*)?$'\n/etc/pam.d/common-password\n    ```\n\n    Output should be similar to:\n\n    ```\n    password [success=1 default=ignore] pam_unix.so obscure sha512\n    ```",
                "fix": "Edit the `/etc/pam.d/common-password` file to include the `sha512` option\nfor `pam_unix.so` as shown:\n\n    ```\n    password [success=1 default=ignore] pam_unix.so sha512\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-28",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4",
                    "Rev_7"
                ],
                "cis_rid": "5.3.4"
            },
            "code": "control \"C-5.3.4\" do\n  title \"Ensure password hashing algorithm is SHA-512\"\n  desc  \"The commands below change password encryption from `md5` to `sha512`\n(a much stronger hashing algorithm). All existing accounts will need to perform\na password change to upgrade the stored hashes to the new algorithm.\"\n  desc  \"rationale\", \"\n    The SHA-512 algorithm provides much stronger hashing than MD5, thus\nproviding additional protection to the system by increasing the level of effort\nfor an attacker to successfully determine passwords.\n\n    Note that these change only apply to accounts configured on the local\nsystem.\n  \"\n  desc  \"check\", \"\n    Run the following commands and ensure the sha512 option is included in all\nresults:\n\n    ```\n    # grep -E\n'^\\\\s*password\\\\s+(\\\\S+\\\\s+)+pam_unix\\\\.so\\\\s+(\\\\S+\\\\s+)*sha512\\\\s*(\\\\S+\\\\s*)*(\\\\s+#.*)?$'\n/etc/pam.d/common-password\n    ```\n\n    Output should be similar to:\n\n    ```\n    password [success=1 default=ignore] pam_unix.so obscure sha512\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/pam.d/common-password` file to include the `sha512` option\nfor `pam_unix.so` as shown:\n\n    ```\n    password [success=1 default=ignore] pam_unix.so sha512\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-28\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\", \"Rev_7\"]\n  tag cis_rid: \"5.3.4\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.3.4.rb",
                "line": 3
            },
            "id": "C-5.3.4"
        },
        {
            "title": "Ensure noexec option set on /var/tmp partition",
            "desc": "The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.",
            "descriptions": {
                "default": "The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.",
                "rationale": "Since the `/var/tmp` filesystem is only intended for\ntemporary file storage, set this option to ensure that users cannot run\nexecutable binaries from `/var/tmp` .",
                "check": "Verify that the `noexec` option is set if a `/var/tmp` partition exists.\n\nRun the following command and verify that nothing is returned:\n\n```\n# mount | grep -E '\\s/var/tmp\\s' | grep -v noexec\n```",
                "fix": "Edit the `/etc/fstab` file and add `noexec` to the fourth field (mounting\noptions) for the `/var/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/var/tmp` :\n\n    ```\n    # mount -o remount,noexec /var/tmp\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-2 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "2.6",
                    "Rev_7"
                ],
                "cis_rid": "1.1.10"
            },
            "code": "control \"C-1.1.10\" do\n  title \"Ensure noexec option set on /var/tmp partition\"\n  desc  \"The `noexec` mount option specifies that the filesystem cannot contain\nexecutable binaries.\"\n  desc  \"rationale\", \"Since the `/var/tmp` filesystem is only intended for\ntemporary file storage, set this option to ensure that users cannot run\nexecutable binaries from `/var/tmp` .\"\n  desc  \"check\", \"\n    Verify that the `noexec` option is set if a `/var/tmp` partition exists.\n\n    Run the following command and verify that nothing is returned:\n\n    ```\n    # mount | grep -E '\\\\s/var/tmp\\\\s' | grep -v noexec\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/fstab` file and add `noexec` to the fourth field (mounting\noptions) for the `/var/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/var/tmp` :\n\n    ```\n    # mount -o remount,noexec /var/tmp\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-2 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"2.6\", \"Rev_7\"]\n  tag cis_rid: \"1.1.10\"\n\n  describe mount('/var/tmp') do\n    its('options') { should include 'noexec' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.10.rb",
                "line": 3
            },
            "id": "C-1.1.10"
        },
        {
            "title": "Ensure ntp is configured",
            "desc": "`ntp` is a daemon which implements the Network Time Protocol (NTP). It\nis designed to synchronize system clocks across a variety of systems and use a\nsource that is highly accurate. More information on NTP can be found at\n[http://www.ntp.org](http://www.ntp.org/). `ntp` can be configured to be a\nclient and/or a server.\n\n    This recommendation only applies if ntp is in use on the system.",
            "descriptions": {
                "default": "`ntp` is a daemon which implements the Network Time Protocol (NTP). It\nis designed to synchronize system clocks across a variety of systems and use a\nsource that is highly accurate. More information on NTP can be found at\n[http://www.ntp.org](http://www.ntp.org/). `ntp` can be configured to be a\nclient and/or a server.\n\n    This recommendation only applies if ntp is in use on the system.",
                "rationale": "If ntp is in use on the system proper configuration is\nvital to ensuring time synchronization is working properly.",
                "check": "Run the following command and verify output matches:\n\n    ```\n    # grep \"^restrict\" /etc/ntp.conf\n    restrict -4 default kod nomodify notrap nopeer noquery\n    restrict -6 default kod nomodify notrap nopeer noquery\n    ```\n\n    The `-4` in the first line is optional and options after `default` can\nappear in any order. Additional restriction lines may exist.\n\n    Run the following command and verify remote server is configured properly:\n\n    ```\n    # grep -E \"^(server|pool)\" /etc/ntp.conf\n    server\n    ```\n\n    Multiple servers may be configured.\n\n    Verify that `ntp` is configured to run as the `ntp` user by running one of\nthe following commands as appropriate for your distribution and verifying\noutput matches:\n\n    ```\n    # grep \"^OPTIONS\" /etc/sysconfig/ntpd\n    OPTIONS=\"-u ntp:ntp\"\n    # grep \"^NTPD_OPTIONS\" /etc/sysconfig/ntp\n    OPTIONS=\"-u ntp:ntp\"\n    ```\n\n    Additional options may be present.\n\n    ```\n    # grep \"RUNASUSER=ntp\" /etc/init.d/ntp\n    RUNASUSER=ntp\n    ```",
                "fix": "Add or edit restrict lines in `/etc/ntp.conf` to match the following:\n\n    ```\n    restrict -4 default kod nomodify notrap nopeer noquery\n    restrict -6 default kod nomodify notrap nopeer noquery\n    ```\n\n    Add or edit server or pool lines to `/etc/ntp.conf` as appropriate:\n\n    ```\n    server\n    ```\n\n    Configure `ntp` to run as the `ntp` user by adding or editing one of the\nfollowing files as appropriate for your distribution:\n    `/etc/sysconfig/ntpd` :\n\n    ```\n    OPTIONS=\"-u ntp:ntp\"\n    ```\n\n    `/etc/sysconfig/ntp` :\n\n    ```\n    NTPD_OPTIONS=\"-u ntp:ntp\"\n    ```\n\n    `/etc/init.d/ntp`:\n\n    ```\n    RUNASUSER=ntp\n    ```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-8 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.1",
                    "Rev_7"
                ],
                "cis_rid": "2.2.1.4"
            },
            "code": "control \"C-2.2.1.4\" do\n  title \"Ensure ntp is configured\"\n  desc  \"`ntp` is a daemon which implements the Network Time Protocol (NTP). It\nis designed to synchronize system clocks across a variety of systems and use a\nsource that is highly accurate. More information on NTP can be found at\n[http://www.ntp.org](http://www.ntp.org/). `ntp` can be configured to be a\nclient and/or a server.\n\n    This recommendation only applies if ntp is in use on the system.\n  \"\n  desc  \"rationale\", \"If ntp is in use on the system proper configuration is\nvital to ensuring time synchronization is working properly.\"\n  desc  \"check\", \"\n    Run the following command and verify output matches:\n\n    ```\n    # grep \\\"^restrict\\\" /etc/ntp.conf\n    restrict -4 default kod nomodify notrap nopeer noquery\n    restrict -6 default kod nomodify notrap nopeer noquery\n    ```\n\n    The `-4` in the first line is optional and options after `default` can\nappear in any order. Additional restriction lines may exist.\n\n    Run the following command and verify remote server is configured properly:\n\n    ```\n    # grep -E \\\"^(server|pool)\\\" /etc/ntp.conf\n    server\n    ```\n\n    Multiple servers may be configured.\n\n    Verify that `ntp` is configured to run as the `ntp` user by running one of\nthe following commands as appropriate for your distribution and verifying\noutput matches:\n\n    ```\n    # grep \\\"^OPTIONS\\\" /etc/sysconfig/ntpd\n    OPTIONS=\\\"-u ntp:ntp\\\"\n    # grep \\\"^NTPD_OPTIONS\\\" /etc/sysconfig/ntp\n    OPTIONS=\\\"-u ntp:ntp\\\"\n    ```\n\n    Additional options may be present.\n\n    ```\n    # grep \\\"RUNASUSER=ntp\\\" /etc/init.d/ntp\n    RUNASUSER=ntp\n    ```\n  \"\n  desc  \"fix\", \"\n    Add or edit restrict lines in `/etc/ntp.conf` to match the following:\n\n    ```\n    restrict -4 default kod nomodify notrap nopeer noquery\n    restrict -6 default kod nomodify notrap nopeer noquery\n    ```\n\n    Add or edit server or pool lines to `/etc/ntp.conf` as appropriate:\n\n    ```\n    server\n    ```\n\n    Configure `ntp` to run as the `ntp` user by adding or editing one of the\nfollowing files as appropriate for your distribution:\n    `/etc/sysconfig/ntpd` :\n\n    ```\n    OPTIONS=\\\"-u ntp:ntp\\\"\n    ```\n\n    `/etc/sysconfig/ntp` :\n\n    ```\n    NTPD_OPTIONS=\\\"-u ntp:ntp\\\"\n    ```\n\n    `/etc/init.d/ntp`:\n\n    ```\n    RUNASUSER=ntp\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-8 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.1\", \"Rev_7\"]\n  tag cis_rid: \"2.2.1.4\"\n\n  #its('server') { should_not eq nil } || its('pool') { should_not eq nil }\n\n  if package('ntp').installed?\n    describe service('ntp') do\n      it { should be_enabled }\n      it { should be_running }\n    end\n\n    describe processes('ntpd') do\n      it { should exist }\n      its('users') { should include 'ntp'}\n    end\n\n    ntp_conf.restrict.each do |res|\n      describe res do\n        next unless res.include?('-4')\n        it { should include 'default'}\n        it { should include 'kod'}\n        it { should include 'nomodify'}\n        it { should include 'notrap'}\n        it { should include 'nopeer'}\n        it { should include 'noquery'}\n      end\n    end\n\n    ntp_conf.restrict.each do |res|\n      describe res do\n        next unless res.include?('-6')\n        it { should include 'default'}\n        it { should include 'kod'}\n        it { should include 'nomodify'}\n        it { should include 'notrap'}\n        it { should include 'nopeer'}\n        it { should include 'noquery'}\n      end\n    end\n\n    describe.one do\n      describe ntp_conf('/etc/ntp.conf') do\n        its('server') { should_not eq nil }\n      end\n      describe ntp_conf('/etc/ntp.conf') do\n        its('pool') { should_not eq nil }\n      end\n    end\n\n  else\n    impact 0.0\n    describe \"The NTP package is not installed\" do\n      skip \"The NTP package is not installed, this control is Not Applicable.\"\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.1.4.rb",
                "line": 3
            },
            "id": "C-2.2.1.4"
        },
        {
            "title": "Ensure firewall rules exist for all open ports",
            "desc": "Any ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.",
            "descriptions": {
                "default": "Any ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.",
                "rationale": "Without a firewall rule configured for open ports default\nfirewall policy will drop all packets to these ports.",
                "check": "Run the following command to determine open ports:\n\n    ```\n    # ss -4tuln\n    ```\n\n    ```\n    Netid State Recv-Q Send-Q Local Address:Port Peer Address:Port\n    udp UNCONN 0 0 127.0.0.53%lo:53 0.0.0.0:*\n    udp UNCONN 0 0 10.105.106.117%enp1s0:68 0.0.0.0:*\n    tcp LISTEN 0 128 127.0.0.53%lo:53 0.0.0.0:*\n    tcp LISTEN 0 128 0.0.0.0:22 0.0.0.0:*\n    ```\n\n    Run the following command to determine firewall rules:\n\n    ```\n    # ufw status\n    ```\n\n    ```\n    Status: active\n\n     To Action From\n     -- ------ ----\n    [ 1] Anywhere on lo ALLOW IN Anywhere\n    [ 2] Anywhere ALLOW OUT Anywhere on lo (out)\n    [ 3] Anywhere DENY IN 127.0.0.0/8\n    [ 4] 22/tcp ALLOW IN Anywhere\n    [ 5] Anywhere ALLOW OUT Anywhere on enp1s0 (out)\n    [ 6] Anywhere ALLOW OUT Anywhere on all (out)\n    [ 7] Anywhere (v6) on lo ALLOW IN Anywhere (v6)\n    [ 8] Anywhere (v6) ALLOW OUT Anywhere (v6) on lo (out)\n    [ 9] Anywhere (v6) DENY IN ::1\n    [10] 22/tcp (v6) ALLOW IN Anywhere (v6)\n    [11] Anywhere (v6) ALLOW OUT Anywhere (v6) on all (out)\n    ```\n\n    Verify all open ports listening on non-localhost addresses have at least\none firewall rule.\n\n    Lines identified by indexes 4 and 10 are firewall rules for new connections\non tcp port 22.",
                "fix": "For each port identified in the audit which does not have a firewall rule\nestablish a proper rule for accepting inbound connections:\n\n    ```\n    # ufw allow in\n\n    \t/\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.2.5"
            },
            "code": "control \"C-3.5.2.5\" do\n  title \"Ensure firewall rules exist for all open ports\"\n  desc  \"Any ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.\"\n  desc  \"rationale\", \"Without a firewall rule configured for open ports default\nfirewall policy will drop all packets to these ports.\"\n  desc  \"check\", \"\n    Run the following command to determine open ports:\n\n    ```\n    # ss -4tuln\n    ```\n\n    ```\n    Netid State Recv-Q Send-Q Local Address:Port Peer Address:Port\n    udp UNCONN 0 0 127.0.0.53%lo:53 0.0.0.0:*\n    udp UNCONN 0 0 10.105.106.117%enp1s0:68 0.0.0.0:*\n    tcp LISTEN 0 128 127.0.0.53%lo:53 0.0.0.0:*\n    tcp LISTEN 0 128 0.0.0.0:22 0.0.0.0:*\n    ```\n\n    Run the following command to determine firewall rules:\n\n    ```\n    # ufw status\n    ```\n\n    ```\n    Status: active\n\n     To Action From\n     -- ------ ----\n    [ 1] Anywhere on lo ALLOW IN Anywhere\n    [ 2] Anywhere ALLOW OUT Anywhere on lo (out)\n    [ 3] Anywhere DENY IN 127.0.0.0/8\n    [ 4] 22/tcp ALLOW IN Anywhere\n    [ 5] Anywhere ALLOW OUT Anywhere on enp1s0 (out)\n    [ 6] Anywhere ALLOW OUT Anywhere on all (out)\n    [ 7] Anywhere (v6) on lo ALLOW IN Anywhere (v6)\n    [ 8] Anywhere (v6) ALLOW OUT Anywhere (v6) on lo (out)\n    [ 9] Anywhere (v6) DENY IN ::1\n    [10] 22/tcp (v6) ALLOW IN Anywhere (v6)\n    [11] Anywhere (v6) ALLOW OUT Anywhere (v6) on all (out)\n    ```\n\n    Verify all open ports listening on non-localhost addresses have at least\none firewall rule.\n\n    Lines identified by indexes 4 and 10 are firewall rules for new connections\non tcp port 22.\n  \"\n  desc  \"fix\", \"\n    For each port identified in the audit which does not have a firewall rule\nestablish a proper rule for accepting inbound connections:\n\n    ```\n    # ufw allow in\n\n    \\t/\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.2.5\"\n\n\n  ufw_status = command('ss -4tuln && echo && echo && ufw status').stdout.strip\n\n  if service('ufw').running? && service('ufw').enabled?\n    describe \"File '#{ufw_status}' \\n Manually verification required.\\nVAny ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.\" do\n      skip \"File '#{ufw_status}' \\n Manually verification required.\\nAny ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.\"\n    end\n  else\n    describe service('ufw') do\n      it { should be_running }\n      it { should be_enabled }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.2.5.rb",
                "line": 3
            },
            "id": "C-3.5.2.5"
        },
        {
            "title": "Ensure rsh client is not installed",
            "desc": "The `rsh` package contains the client commands for the rsh services.",
            "descriptions": {
                "default": "The `rsh` package contains the client commands for the rsh services.",
                "rationale": "These legacy clients contain numerous security exposures\nand have been replaced with the more secure SSH package. Even if the server is\nremoved, it is best to ensure the clients are also removed to prevent users\nfrom inadvertently attempting to use these commands and therefore exposing\ntheir credentials. Note that removing the `rsh` package removes the clients for\n`rsh` , `rcp` and `rlogin` .",
                "check": "Verify `rsh` is not installed. Use the following command to provide the\nneeded information:\n\n    ```\n    dpkg -s rsh-client\n    ```",
                "fix": "Uninstall `rsh`:\n\n```\napt remove rsh-client\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "IA-2 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.5",
                    "Rev_7"
                ],
                "cis_rid": "2.3.2"
            },
            "code": "control \"C-2.3.2\" do\n  title \"Ensure rsh client is not installed\"\n  desc  \"The `rsh` package contains the client commands for the rsh services.\"\n  desc  \"rationale\", \"These legacy clients contain numerous security exposures\nand have been replaced with the more secure SSH package. Even if the server is\nremoved, it is best to ensure the clients are also removed to prevent users\nfrom inadvertently attempting to use these commands and therefore exposing\ntheir credentials. Note that removing the `rsh` package removes the clients for\n`rsh` , `rcp` and `rlogin` .\"\n  desc  \"check\", \"\n    Verify `rsh` is not installed. Use the following command to provide the\nneeded information:\n\n    ```\n    dpkg -s rsh-client\n    ```\n  \"\n  desc \"fix\", \"\n    Uninstall `rsh`:\n\n    ```\n    apt remove rsh-client\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"IA-2 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.5\", \"Rev_7\"]\n  tag cis_rid: \"2.3.2\"\n\n  describe package('rsh-client') do\n    it { should_not be_installed }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.3.2.rb",
                "line": 3
            },
            "id": "C-2.3.2"
        },
        {
            "title": "Ensure permissions on /etc/crontab are configured",
            "desc": "The `/etc/crontab` file is used by `cron` to control its own jobs. The\ncommands in this item make sure that root is the user and group owner of the\nfile and that only the owner can access the file.",
            "descriptions": {
                "default": "The `/etc/crontab` file is used by `cron` to control its own jobs. The\ncommands in this item make sure that root is the user and group owner of the\nfile and that only the owner can access the file.",
                "rationale": "This file contains information on what system jobs are\nrun by cron. Write access to these files could provide unprivileged users with\nthe ability to elevate their privileges. Read access to these files could\nprovide users with the ability to gain insight on system jobs that run on the\nsystem and could provide them a way to gain unauthorized privileged access.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/crontab\n\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set ownership and permissions on\n`/etc/crontab` :\n\n    ```\n    # chown root:root /etc/crontab\n    ```\n\n    ```\n    # chmod og-rwx /etc/crontab\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "5.1.2"
            },
            "code": "control \"C-5.1.2\" do\n  title \"Ensure permissions on /etc/crontab are configured\"\n  desc  \"The `/etc/crontab` file is used by `cron` to control its own jobs. The\ncommands in this item make sure that root is the user and group owner of the\nfile and that only the owner can access the file.\"\n  desc  \"rationale\", \"This file contains information on what system jobs are\nrun by cron. Write access to these files could provide unprivileged users with\nthe ability to elevate their privileges. Read access to these files could\nprovide users with the ability to gain insight on system jobs that run on the\nsystem and could provide them a way to gain unauthorized privileged access.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/crontab\n\n    Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set ownership and permissions on\n`/etc/crontab` :\n\n    ```\n    # chown root:root /etc/crontab\n    ```\n\n    ```\n    # chmod og-rwx /etc/crontab\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"5.1.2\"\n\n  describe file('/etc/crontab') do \n    its('owner') { should cmp 'root' }\n    its('group') { should cmp 'root' }\n    it { should_not be_more_permissive_than('0600') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.1.2.rb",
                "line": 3
            },
            "id": "C-5.1.2"
        },
        {
            "title": "Ensure Avahi Server is not enabled",
            "desc": "Avahi is a free zeroconf implementation, including a system for\nmulticast DNS/DNS-SD service discovery. Avahi allows programs to publish and\ndiscover services and hosts running on a local network with no specific\nconfiguration. For example, a user can plug a computer into a network and Avahi\nautomatically finds printers to print to, files to look at and people to talk\nto, as well as network services running on the machine.",
            "descriptions": {
                "default": "Avahi is a free zeroconf implementation, including a system for\nmulticast DNS/DNS-SD service discovery. Avahi allows programs to publish and\ndiscover services and hosts running on a local network with no specific\nconfiguration. For example, a user can plug a computer into a network and Avahi\nautomatically finds printers to print to, files to look at and people to talk\nto, as well as network services running on the machine.",
                "rationale": "Automatic discovery of network services is not normally\nrequired for system functionality. It is recommended to disable the service to\nreduce the potential attack surface.",
                "check": "Run the following command to verify `avahi-daemon` is not enabled:\n\n```\n# systemctl is-enabled avahi-daemon\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run the following command to disable `avahi-daemon`:\n\n```\n# systemctl --now disable avahi-daemon\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.3"
            },
            "code": "control \"C-2.2.3\" do\n  title \"Ensure Avahi Server is not enabled\"\n  desc  \"Avahi is a free zeroconf implementation, including a system for\nmulticast DNS/DNS-SD service discovery. Avahi allows programs to publish and\ndiscover services and hosts running on a local network with no specific\nconfiguration. For example, a user can plug a computer into a network and Avahi\nautomatically finds printers to print to, files to look at and people to talk\nto, as well as network services running on the machine.\"\n  desc  \"rationale\", \"Automatic discovery of network services is not normally\nrequired for system functionality. It is recommended to disable the service to\nreduce the potential attack surface.\"\n  desc  \"check\", \"\n    Run the following command to verify `avahi-daemon` is not enabled:\n\n    ```\n    # systemctl is-enabled avahi-daemon\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following command to disable `avahi-daemon`:\n\n    ```\n    # systemctl --now disable avahi-daemon\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.3\"\n\n  if package('avahi-daemon').installed?\n    describe service('avahi-daemon') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n  else\n    impact 0.0\n    describe \"The Avahi Server package is not installed\" do\n      skip \"The Avahi Server package is not installed, this control is Not Applicable.\"\n    end\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.3.rb",
                "line": 3
            },
            "id": "C-2.2.3"
        },
        {
            "title": "Ensure firewall rules exist for all open ports",
            "desc": "Any ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.",
            "descriptions": {
                "default": "Any ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.",
                "rationale": "Without a firewall rule configured for open ports default\nfirewall policy will drop all packets to these ports.",
                "check": "Run the following command to determine open ports:\n\n    ```\n    # ss -4tuln\n\n    Netid State Recv-Q Send-Q Local Address:Port Peer Address:Port\n    udp UNCONN 0 0 *:68 *:*\n    udp UNCONN 0 0 *:123 *:*\n    tcp LISTEN 0 128 *:22 *:*\n    ```\n\n    Run the following command to determine firewall rules:\n\n    ```\n    # iptables -L INPUT -v -n\n    Chain INPUT (policy DROP 0 packets, 0 bytes)\n     pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all -- lo * 0.0.0.0/0 0.0.0.0/0\n     0 0 DROP all -- * * 127.0.0.0/8 0.0.0.0/0\n     0 0 ACCEPT tcp -- * * 0.0.0.0/0 0.0.0.0/0 tcp dpt:22 state NEW\n\n    ```\n\n    Verify all open ports listening on non-localhost addresses have at least\none firewall rule.\n\n    The last line identified by the \"tcp dpt:22 state NEW\" identifies it as a\nfirewall rule for new connections on tcp port 22.",
                "fix": "For each port identified in the audit which does not have a firewall rule\nestablish a proper rule for accepting inbound connections:\n\n    ```\n    # iptables -A INPUT -p\n\n    \t --dport\n\n    \t -m state --state NEW -j ACCEPT\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.4.1.4"
            },
            "code": "control \"C-3.5.4.1.4\" do\n  title \"Ensure firewall rules exist for all open ports\"\n  desc  \"Any ports that have been opened on non-loopback addresses need\nfirewall rules to govern traffic.\"\n  desc  \"rationale\", \"Without a firewall rule configured for open ports default\nfirewall policy will drop all packets to these ports.\"\n  desc  \"check\", \"\n    Run the following command to determine open ports:\n\n    ```\n    # ss -4tuln\n\n    Netid State Recv-Q Send-Q Local Address:Port Peer Address:Port\n    udp UNCONN 0 0 *:68 *:*\n    udp UNCONN 0 0 *:123 *:*\n    tcp LISTEN 0 128 *:22 *:*\n    ```\n\n    Run the following command to determine firewall rules:\n\n    ```\n    # iptables -L INPUT -v -n\n    Chain INPUT (policy DROP 0 packets, 0 bytes)\n     pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all -- lo * 0.0.0.0/0 0.0.0.0/0\n     0 0 DROP all -- * * 127.0.0.0/8 0.0.0.0/0\n     0 0 ACCEPT tcp -- * * 0.0.0.0/0 0.0.0.0/0 tcp dpt:22 state NEW\n\n    ```\n\n    Verify all open ports listening on non-localhost addresses have at least\none firewall rule.\n\n    The last line identified by the \\\"tcp dpt:22 state NEW\\\" identifies it as a\nfirewall rule for new connections on tcp port 22.\n  \"\n  desc  \"fix\", \"\n    For each port identified in the audit which does not have a firewall rule\nestablish a proper rule for accepting inbound connections:\n\n    ```\n    # iptables -A INPUT -p\n\n    \\t --dport\n\n    \\t -m state --state NEW -j ACCEPT\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.4.1.4\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.4.1.4.rb",
                "line": 3
            },
            "id": "C-3.5.4.1.4"
        },
        {
            "title": "Ensure loopback traffic is configured",
            "desc": "Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network",
            "descriptions": {
                "default": "Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network",
                "rationale": "Loopback traffic is generated between processes on\nmachine and is typically critical to operation of the system. The loopback\ninterface is the only place that loopback network traffic should be seen, all\nother interfaces should ignore traffic on this network as an anti-spoofing\nmeasure.",
                "check": "Run the following commands to verify that the loopback interface is\nconfigured:\n\n    ```\n    # nft list ruleset | awk '/hook input/,/}/' | grep 'iif \"lo\" accept'\n\n    iif \"lo\" accept\n    ```\n\n    ```\n    # nft list ruleset | awk '/hook input/,/}/' | grep 'ip sddr'\n\n    ip saddr 127.0.0.0/8 counter packets 0 bytes 0 drop\n    ```\n\n    ```\n    # nft list ruleset | awk '/hook input/,/}/' | grep 'ip6 saddr'\n\n    ip6 saddr ::1 counter packets 0 bytes 0 drop\n    ```",
                "fix": "Run the following commands to implement the loopback rules:\n\n```\n# nft add rule inet filter input iif lo accept\n```\n\n```\n# nft create rule inet filter input ip saddr 127.0.0.0/8 counter drop\n```\n\n```\n# nft add rule inet filter input ip6 saddr ::1 counter drop\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.3.4"
            },
            "code": "control \"C-3.5.3.4\" do\n  title \"Ensure loopback traffic is configured\"\n  desc  \"Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network\"\n  desc  \"rationale\", \"Loopback traffic is generated between processes on\nmachine and is typically critical to operation of the system. The loopback\ninterface is the only place that loopback network traffic should be seen, all\nother interfaces should ignore traffic on this network as an anti-spoofing\nmeasure.\"\n  desc  \"check\", \"\n    Run the following commands to verify that the loopback interface is\nconfigured:\n\n    ```\n    # nft list ruleset | awk '/hook input/,/}/' | grep 'iif \\\"lo\\\" accept'\n\n    iif \\\"lo\\\" accept\n    ```\n\n    ```\n    # nft list ruleset | awk '/hook input/,/}/' | grep 'ip sddr'\n\n    ip saddr 127.0.0.0/8 counter packets 0 bytes 0 drop\n    ```\n\n    ```\n    # nft list ruleset | awk '/hook input/,/}/' | grep 'ip6 saddr'\n\n    ip6 saddr ::1 counter packets 0 bytes 0 drop\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to implement the loopback rules:\n\n    ```\n    # nft add rule inet filter input iif lo accept\n    ```\n\n    ```\n    # nft create rule inet filter input ip saddr 127.0.0.0/8 counter drop\n    ```\n\n    ```\n    # nft add rule inet filter input ip6 saddr ::1 counter drop\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.3.4\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.3.4.rb",
                "line": 3
            },
            "id": "C-3.5.3.4"
        },
        {
            "title": "Ensure address space layout randomization (ASLR) is enabled",
            "desc": "Address space layout randomization (ASLR) is an exploit mitigation\ntechnique which randomly arranges the address space of key data areas of a\nprocess.",
            "descriptions": {
                "default": "Address space layout randomization (ASLR) is an exploit mitigation\ntechnique which randomly arranges the address space of key data areas of a\nprocess.",
                "rationale": "Randomly placing virtual memory regions will make it\ndifficult to write memory page exploits as the memory placement will be\nconsistently shifting.",
                "check": "Run the following commands and verify output matches:\n\n```\n# sysctl kernel.randomize_va_space\n\nkernel.randomize_va_space = 2\n```\n\n```\n# grep \"kernel\\.randomize_va_space\" /etc/sysctl.conf /etc/sysctl.d/*\n\nkernel.randomize_va_space = 2\n```",
                "fix": "Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    kernel.randomize_va_space = 2\n    ```\n\n    Run the following command to set the active kernel parameter:\n\n    ```\n    # sysctl -w kernel.randomize_va_space=2\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SI-16",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "8.3",
                    "Rev_7"
                ],
                "cis_rid": "1.6.2"
            },
            "code": "control \"C-1.6.2\" do\n  title \"Ensure address space layout randomization (ASLR) is enabled\"\n  desc  \"Address space layout randomization (ASLR) is an exploit mitigation\ntechnique which randomly arranges the address space of key data areas of a\nprocess.\"\n  desc  \"rationale\", \"Randomly placing virtual memory regions will make it\ndifficult to write memory page exploits as the memory placement will be\nconsistently shifting.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl kernel.randomize_va_space\n\n    kernel.randomize_va_space = 2\n    ```\n\n    ```\n    # grep \\\"kernel\\\\.randomize_va_space\\\" /etc/sysctl.conf /etc/sysctl.d/*\n\n    kernel.randomize_va_space = 2\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameter in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    kernel.randomize_va_space = 2\n    ```\n\n    Run the following command to set the active kernel parameter:\n\n    ```\n    # sysctl -w kernel.randomize_va_space=2\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SI-16\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"8.3\", \"Rev_7\"]\n  tag cis_rid: \"1.6.2\"\n\n  describe kernel_parameter('kernel.randomize_va_space') do\n    its('value') { should cmp 2 }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.6.2.rb",
                "line": 3
            },
            "id": "C-1.6.2"
        },
        {
            "title": "Ensure auditd service is enabled",
            "desc": "Enable and start the `auditd` daemon to record system events.",
            "descriptions": {
                "default": "Enable and start the `auditd` daemon to record system events.",
                "rationale": "The capturing of system events provides system\nadministrators with information to allow them to determine if unauthorized\naccess to their system is occurring.",
                "check": "Run the following command to verify `auditd` is enabled:\n\n```\n# systemctl is-enabled auditd\n\nenabled\n```\n\nVerify result is \"enabled\".",
                "fix": "Run the following command to enable `auditd` :\n\n```\n# systemctl --now enable auditd\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-12",
                    "AU-3"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "6.2",
                    "6.3"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.1.2"
            },
            "code": "control \"C-4.1.1.2\" do\n  title \"Ensure auditd service is enabled\"\n  desc  \"Enable and start the `auditd` daemon to record system events.\"\n  desc  \"rationale\", \"The capturing of system events provides system\nadministrators with information to allow them to determine if unauthorized\naccess to their system is occurring.\"\n  desc  \"check\", \"\n    Run the following command to verify `auditd` is enabled:\n\n    ```\n    # systemctl is-enabled auditd\n\n    enabled\n    ```\n\n    Verify result is \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following command to enable `auditd` :\n\n    ```\n    # systemctl --now enable auditd\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-12\", \"AU-3\"]\n  tag cis_level: 2\n  tag cis_controls: [\"6.2\", \"6.3\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.1.2\"\n\n  describe service('auditd') do\n    it { should be_enabled }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.1.2.rb",
                "line": 3
            },
            "id": "C-4.1.1.2"
        },
        {
            "title": "Ensure IPv6 outbound and established connections are configured",
            "desc": "Configure the firewall rules for new outbound, and established IPv6\nconnections.",
            "descriptions": {
                "default": "Configure the firewall rules for new outbound, and established IPv6\nconnections.",
                "rationale": "If rules are not in place for new outbound, and\nestablished connections all packets will be dropped by the default policy\npreventing network usage.",
                "check": "Run the following command and verify all rules for new outbound, and\nestablished connections match site policy:\n\n    ```\n    # ip6tables -L -v -n\n    ```\n\n    OR\n\n    If IPv6 is disabled:\n\n    Run the following command and verify that no lines are returned.\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1\n    ```\n\n    OR\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v ipv6.disable=1\n    ```",
                "fix": "Configure iptables in accordance with site policy. The following commands\nwill implement a policy to allow all outbound connections and all established\nconnections:\n\n    ```\n    # ip6tables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # ip6tables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # ip6tables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # ip6tables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n    # ip6tables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n    # ip6tables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "CM-8",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "9.1",
                    "Rev_7"
                ],
                "cis_rid": "3.5.4.2.3"
            },
            "code": "control \"C-3.5.4.2.3\" do\n  title \"Ensure IPv6 outbound and established connections are configured\"\n  desc  \"Configure the firewall rules for new outbound, and established IPv6\nconnections.\"\n  desc  \"rationale\", \"If rules are not in place for new outbound, and\nestablished connections all packets will be dropped by the default policy\npreventing network usage.\"\n  desc  \"check\", \"\n    Run the following command and verify all rules for new outbound, and\nestablished connections match site policy:\n\n    ```\n    # ip6tables -L -v -n\n    ```\n\n    OR\n\n    If IPv6 is disabled:\n\n    Run the following command and verify that no lines are returned.\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1\n    ```\n\n    OR\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v ipv6.disable=1\n    ```\n  \"\n  desc \"fix\", \"\n    Configure iptables in accordance with site policy. The following commands\nwill implement a policy to allow all outbound connections and all established\nconnections:\n\n    ```\n    # ip6tables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # ip6tables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # ip6tables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n    # ip6tables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n    # ip6tables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n    # ip6tables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"CM-8\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"9.1\", \"Rev_7\"]\n  tag cis_rid: \"3.5.4.2.3\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.4.2.3.rb",
                "line": 3
            },
            "id": "C-3.5.4.2.3"
        },
        {
            "title": "Ensure SNMP Server is not enabled",
            "desc": "The Simple Network Management Protocol (SNMP) server is used to listen\nfor SNMP commands from an SNMP management system, execute the commands or\ncollect the information and then send results back to the requesting system.",
            "descriptions": {
                "default": "The Simple Network Management Protocol (SNMP) server is used to listen\nfor SNMP commands from an SNMP management system, execute the commands or\ncollect the information and then send results back to the requesting system.",
                "rationale": "The SNMP server can communicate using SNMP v1, which\ntransmits data in the clear and does not require authentication to execute\ncommands. Unless absolutely necessary, it is recommended that the SNMP service\nnot be used. If SNMP is required the server should be configured to disallow\nSNMP v1.",
                "check": "Run the following command to verify `snmpd` is not enabled:\n\n```\n# systemctl is-enabled snmpd\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run the following command to disable `snmpd`:\n\n```\n# systemctl --now disable snmpd\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.14"
            },
            "code": "control \"C-2.2.14\" do\n  title \"Ensure SNMP Server is not enabled\"\n  desc  \"The Simple Network Management Protocol (SNMP) server is used to listen\nfor SNMP commands from an SNMP management system, execute the commands or\ncollect the information and then send results back to the requesting system.\"\n  desc  \"rationale\", \"The SNMP server can communicate using SNMP v1, which\ntransmits data in the clear and does not require authentication to execute\ncommands. Unless absolutely necessary, it is recommended that the SNMP service\nnot be used. If SNMP is required the server should be configured to disallow\nSNMP v1.\"\n  desc  \"check\", \"\n    Run the following command to verify `snmpd` is not enabled:\n\n    ```\n    # systemctl is-enabled snmpd\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following command to disable `snmpd`:\n\n    ```\n    # systemctl --now disable snmpd\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.14\"\n\n  if package('snmpd').installed?\n    describe service('snmpd') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n  else\n    impact 0.0\n    describe \"The SNMP Server package is not installed\" do\n      skip \"The SNMP Server package is not installed.\"\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.14.rb",
                "line": 3
            },
            "id": "C-2.2.14"
        },
        {
            "title": "Ensure SSH LogLevel is appropriate",
            "desc": "`INFO` level is the basic level that only records login activity of\nSSH users. In many situations, such as Incident Response, it is important to\ndetermine when a particular user was active on a system. The logout record can\neliminate those users who disconnected, which helps narrow the field.\n\n    `VERBOSE` level specifies that login and logout activity as well as the key\nfingerprint for any SSH key used for login will be logged. This information is\nimportant for SSH key management, especially in legacy environments.",
            "descriptions": {
                "default": "`INFO` level is the basic level that only records login activity of\nSSH users. In many situations, such as Incident Response, it is important to\ndetermine when a particular user was active on a system. The logout record can\neliminate those users who disconnected, which helps narrow the field.\n\n    `VERBOSE` level specifies that login and logout activity as well as the key\nfingerprint for any SSH key used for login will be logged. This information is\nimportant for SSH key management, especially in legacy environments.",
                "rationale": "SSH provides several logging levels with varying amounts\nof verbosity. `DEBUG` is specifically **not** recommended other than strictly\nfor debugging SSH communications since it provides so much data that it is\ndifficult to identify important security information.",
                "check": "Run the following command and verify that output matches:\n\n```\n# sshd -T | grep loglevel\n```\n\n```\nLogLevel VERBOSE\n```\n\nOR\n\n```\nloglevel INFO\n```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nLogLevel VERBOSE\n```\n\nOR\n\n```\nLogLevel INFO\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AU-12",
                    "AU-3"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.2",
                    "6.3"
                ],
                "cis_rid": "5.2.5",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.5\" do\n  title \"Ensure SSH LogLevel is appropriate\"\n  desc  \"`INFO` level is the basic level that only records login activity of\nSSH users. In many situations, such as Incident Response, it is important to\ndetermine when a particular user was active on a system. The logout record can\neliminate those users who disconnected, which helps narrow the field.\n\n    `VERBOSE` level specifies that login and logout activity as well as the key\nfingerprint for any SSH key used for login will be logged. This information is\nimportant for SSH key management, especially in legacy environments.\n  \"\n  desc  \"rationale\", \"SSH provides several logging levels with varying amounts\nof verbosity. `DEBUG` is specifically **not** recommended other than strictly\nfor debugging SSH communications since it provides so much data that it is\ndifficult to identify important security information.\"\n  desc  \"check\", \"\n    Run the following command and verify that output matches:\n\n    ```\n    # sshd -T | grep loglevel\n    ```\n\n    ```\n    LogLevel VERBOSE\n    ```\n\n    OR\n\n    ```\n    loglevel INFO\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    LogLevel VERBOSE\n    ```\n\n    OR\n\n    ```\n    LogLevel INFO\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AU-12\", \"AU-3\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.2\", \"6.3\"]\n  tag cis_rid: \"5.2.5\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('LogLevel') { should match(/^VERBOSE|INFO$/) }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.5.rb",
                "line": 3
            },
            "id": "C-5.2.5"
        },
        {
            "title": "Ensure all users last password change date is in the past",
            "desc": "All users should have a password change date in the past.",
            "descriptions": {
                "default": "All users should have a password change date in the past.",
                "rationale": "If a users recorded password change date is in the future\nthen they could bypass any set password expiration.",
                "check": "Run the following command and verify nothing is returned\n\n    ```\n    # awk -F: '{print $1}' /etc/shadow | while read -r usr; do [[ $(date\n--date=\"$(chage --list \"$usr\" | grep '^Last password change' | cut -d:\n-f2)\" +%s) > $(date +%s) ]] & done\n    ```",
                "fix": "Investigate any users with a password change date in the future\nand correct them. Locking the account, expiring the password, or resetting the\npassword manually may be appropriate."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "IA-5 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.4",
                    "Rev_7"
                ],
                "cis_rid": "5.4.1.5"
            },
            "code": "control \"C-5.4.1.5\" do\n  title \"Ensure all users last password change date is in the past\"\n  desc  \"All users should have a password change date in the past.\"\n  desc  \"rationale\", \"If a users recorded password change date is in the future\nthen they could bypass any set password expiration.\"\n  desc  \"check\", \"\n    Run the following command and verify nothing is returned\n\n    ```\n    # awk -F: '{print $1}' /etc/shadow | while read -r usr; do [[ $(date\n--date=\\\"$(chage --list \\\"$usr\\\" | grep '^Last password change' | cut -d:\n-f2)\\\" +%s) > $(date +%s) ]] & done\n    ```\n  \"\n  desc \"fix\", \"Investigate any users with a password change date in the future\nand correct them. Locking the account, expiring the password, or resetting the\npassword manually may be appropriate.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"IA-5 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.4\", \"Rev_7\"]\n  tag cis_rid: \"5.4.1.5\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.4.1.5.rb",
                "line": 3
            },
            "id": "C-5.4.1.5"
        },
        {
            "title": "Ensure the audit configuration is immutable",
            "desc": "Set system audit so that audit rules cannot be modified with\n`auditctl` . Setting the flag \"-e 2\" forces audit to be put in immutable\nmode. Audit changes can only be made on system reboot.",
            "descriptions": {
                "default": "Set system audit so that audit rules cannot be modified with\n`auditctl` . Setting the flag \"-e 2\" forces audit to be put in immutable\nmode. Audit changes can only be made on system reboot.",
                "rationale": "In immutable mode, unauthorized users cannot execute\nchanges to the audit system to potentially hide malicious activity and then put\nthe audit rules back. Users would most likely notice a system reboot and that\ncould alert administrators of an attempt to make unauthorized audit changes.",
                "check": "Run the following command and verify output matches:\n\n```\n# grep \"^\\s*[^#]\" /etc/audit/audit.rules | tail -1\n\n-e 2\n```",
                "fix": "Edit or create the file `/etc/audit/rules.d/99-finalize.rules` and add the\nline\n\n    ```\n    -e 2\n    ```\n\n    at the end of the file"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-12",
                    "AU-3"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "6.2",
                    "6.3"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.17"
            },
            "code": "control \"C-4.1.17\" do\n  title \"Ensure the audit configuration is immutable\"\n  desc  \"Set system audit so that audit rules cannot be modified with\n`auditctl` . Setting the flag \\\"-e 2\\\" forces audit to be put in immutable\nmode. Audit changes can only be made on system reboot.\"\n  desc  \"rationale\", \"In immutable mode, unauthorized users cannot execute\nchanges to the audit system to potentially hide malicious activity and then put\nthe audit rules back. Users would most likely notice a system reboot and that\ncould alert administrators of an attempt to make unauthorized audit changes.\"\n  desc  \"check\", \"\n    Run the following command and verify output matches:\n\n    ```\n    # grep \\\"^\\\\s*[^#]\\\" /etc/audit/audit.rules | tail -1\n\n    -e 2\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create the file `/etc/audit/rules.d/99-finalize.rules` and add the\nline\n\n    ```\n    -e 2\n    ```\n\n    at the end of the file\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-12\", \"AU-3\"]\n  tag cis_level: 2\n  tag cis_controls: [\"6.2\", \"6.3\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.17\"\n\n  last_line = command(\"grep \\\"^\\\\s*[^#]\\\" /etc/audit/audit.rules | tail -1\")\n  describe last_line do\n    its('stdout.strip') { should cmp \"-e 2\" }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.17.rb",
                "line": 3
            },
            "id": "C-4.1.17"
        },
        {
            "title": "Ensure TIPC is disabled",
            "desc": "The Transparent Inter-Process Communication (TIPC) protocol is\ndesigned to provide communication between cluster nodes.",
            "descriptions": {
                "default": "The Transparent Inter-Process Communication (TIPC) protocol is\ndesigned to provide communication between cluster nodes.",
                "rationale": "If the protocol is not being used, it is recommended that\nkernel module not be loaded, disabling the service to reduce the potential\nattack surface.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe -n -v tipc\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep tipc\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/tipc.conf`\n\nand add the following line:\n\n```\ninstall tipc /bin/true\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "3.4.4"
            },
            "code": "control \"C-3.4.4\" do\n  title \"Ensure TIPC is disabled\"\n  desc  \"The Transparent Inter-Process Communication (TIPC) protocol is\ndesigned to provide communication between cluster nodes.\"\n  desc  \"rationale\", \"If the protocol is not being used, it is recommended that\nkernel module not be loaded, disabling the service to reduce the potential\nattack surface.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe -n -v tipc\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep tipc\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/tipc.conf`\n\n    and add the following line:\n\n    ```\n    install tipc /bin/true\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"3.4.4\"\n\n  describe kernel_module('tipc') do\n    it { should_not be_loaded }\n    it { should_not be_disabled }\n    it { should_not be_blacklisted }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.4.4.rb",
                "line": 3
            },
            "id": "C-3.4.4"
        },
        {
            "title": "Ensure users' .netrc Files are not group or world accessible",
            "desc": "While the system administrator can establish secure permissions for\nusers' `.netrc` files, the users can easily override these.",
            "descriptions": {
                "default": "While the system administrator can establish secure permissions for\nusers' `.netrc` files, the users can easily override these.",
                "rationale": "`.netrc `files may contain unencrypted passwords that may\nbe used to attack other systems.",
                "check": "Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\"'\"$(which nologin)\"'\" & do\n     if [ ! -d \"$dir\" ]; then\n     echo \"The home directory \\\"$dir\\\" of user \\\"$user\\\" does not\nexist.\"\n     else\n     for file in $dir/.netrc; do\n     if [ ! -h \"$file\" ] & then\n     fileperm=\"$(ls -ld \"$file\" | cut -f1 -d\" \")\"\n     if [ \"$(echo \"$fileperm\" | cut -c5)\" != \"-\" ]; then\n     echo \"Group Read set on \\\"$file\\\"\"\n     fi\n     if [ \"$(echo \"$fileperm\" | cut -c6)\" != \"-\" ]; then\n     echo \"Group Write set on \\\"$file\\\"\"\n     fi\n     if [ \"$(echo \"$fileperm\" | cut -c7)\" != \"-\" ]; then\n     echo \"Group Execute set on \\\"$file\\\"\"\n     fi\n     if [ \"$(echo \"$fileperm\" | cut -c8)\" != \"-\" ]; then\n     echo \"Other Read set on \\\"$file\\\"\"\n     fi\n     if [ \"$(echo \"$fileperm\" | cut -c9)\" != \"-\" ]; then\n     echo \"Other Write set on \\\"$file\\\"\"\n     fi\n     if [ \"$(echo \"$fileperm\" | cut -c10)\" != \"-\" ]; then\n     echo \"Other Execute set on \\\"$file\\\"\"\n     fi\n     fi\n     done\n     fi\n    done\n    ```",
                "fix": "Making global modifications to users' files without alerting\nthe user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser `.netrc` file permissions and determine the action to be taken in\naccordance with site policy."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.13"
            },
            "code": "control \"C-6.2.13\" do\n  title \"Ensure users' .netrc Files are not group or world accessible\"\n  desc  \"While the system administrator can establish secure permissions for\nusers' `.netrc` files, the users can easily override these.\"\n  desc  \"rationale\", \"`.netrc `files may contain unencrypted passwords that may\nbe used to attack other systems.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(root|halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\\\"'\\\"$(which nologin)\\\"'\\\" & do\n     if [ ! -d \\\"$dir\\\" ]; then\n     echo \\\"The home directory \\\\\\\"$dir\\\\\\\" of user \\\\\\\"$user\\\\\\\" does not\nexist.\\\"\n     else\n     for file in $dir/.netrc; do\n     if [ ! -h \\\"$file\\\" ] & then\n     fileperm=\\\"$(ls -ld \\\"$file\\\" | cut -f1 -d\\\" \\\")\\\"\n     if [ \\\"$(echo \\\"$fileperm\\\" | cut -c5)\\\" != \\\"-\\\" ]; then\n     echo \\\"Group Read set on \\\\\\\"$file\\\\\\\"\\\"\n     fi\n     if [ \\\"$(echo \\\"$fileperm\\\" | cut -c6)\\\" != \\\"-\\\" ]; then\n     echo \\\"Group Write set on \\\\\\\"$file\\\\\\\"\\\"\n     fi\n     if [ \\\"$(echo \\\"$fileperm\\\" | cut -c7)\\\" != \\\"-\\\" ]; then\n     echo \\\"Group Execute set on \\\\\\\"$file\\\\\\\"\\\"\n     fi\n     if [ \\\"$(echo \\\"$fileperm\\\" | cut -c8)\\\" != \\\"-\\\" ]; then\n     echo \\\"Other Read set on \\\\\\\"$file\\\\\\\"\\\"\n     fi\n     if [ \\\"$(echo \\\"$fileperm\\\" | cut -c9)\\\" != \\\"-\\\" ]; then\n     echo \\\"Other Write set on \\\\\\\"$file\\\\\\\"\\\"\n     fi\n     if [ \\\"$(echo \\\"$fileperm\\\" | cut -c10)\\\" != \\\"-\\\" ]; then\n     echo \\\"Other Execute set on \\\\\\\"$file\\\\\\\"\\\"\n     fi\n     fi\n     done\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"Making global modifications to users' files without alerting\nthe user community can result in unexpected outages and unhappy users.\nTherefore, it is recommended that a monitoring policy be established to report\nuser `.netrc` file permissions and determine the action to be taken in\naccordance with site policy.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.13\"\n  nologin = command(\"which nologin\").stdout.strip\n  \n  passwd.where { user != 'halt' && user != 'sync' && user != 'shutdown' && shell != nologin }.entries.each do |user|\n    describe.one do\n      describe file(\"#{user.home}/.netrc\") do\n        it { should_not exist }\n      end\n      describe file(\"#{user.home}/.netrc\") do\n        it { should_not be_more_permissive_than('0600') }\n      end\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.13.rb",
                "line": 3
            },
            "id": "C-6.2.13"
        },
        {
            "title": "Ensure separate partition exists for /var/log",
            "desc": "The `/var/log` directory is used by system services to store log data\n.",
            "descriptions": {
                "default": "The `/var/log` directory is used by system services to store log data\n.",
                "rationale": "There are two important reasons to ensure that system\nlogs are stored on a separate partition: protection against resource exhaustion\n(since logs can grow quite large) and protection of audit data.",
                "check": "Run the following command and verify output shows `/var/log` is mounted:\n```\n# mount | grep /var/log\n/dev/xvdh1 on /var/log type ext4 (rw,relatime,data=ordered)\n```",
                "fix": "For new installations, during installation create a custom partition setup\nand specify a separate partition for `/var/log` .\n\n    For systems that were previously installed, create a new partition and\nconfigure `/etc/fstab` as appropriate."
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-4",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "6.4",
                    "Rev_7"
                ],
                "cis_rid": "1.1.11"
            },
            "code": "control \"C-1.1.11\" do\n  title \"Ensure separate partition exists for /var/log\"\n  desc  \"The `/var/log` directory is used by system services to store log data\n.\"\n  desc  \"rationale\", \"There are two important reasons to ensure that system\nlogs are stored on a separate partition: protection against resource exhaustion\n(since logs can grow quite large) and protection of audit data.\"\n  desc  \"check\", \"\n    Run the following command and verify output shows `/var/log` is mounted:\n    ```\n    # mount | grep /var/log\n    /dev/xvdh1 on /var/log type ext4 (rw,relatime,data=ordered)\n    ```\n  \"\n  desc  \"fix\", \"\n    For new installations, during installation create a custom partition setup\nand specify a separate partition for `/var/log` .\n\n    For systems that were previously installed, create a new partition and\nconfigure `/etc/fstab` as appropriate.\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-4\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"6.4\", \"Rev_7\"]\n  tag cis_rid: \"1.1.11\"\n\n  describe mount('/var/log') do\n    it { should be_mounted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.11.rb",
                "line": 3
            },
            "id": "C-1.1.11"
        },
        {
            "title": "Ensure outbound connections are configured",
            "desc": "Configure the firewall rules for new outbound connections.",
            "descriptions": {
                "default": "Configure the firewall rules for new outbound connections.",
                "rationale": "If rules are not in place for new outbound connections\nall packets will be dropped by the default policy preventing network usage.",
                "check": "Run the following command and verify all rules for new outbound connections\nmatch site policy:\n\n    ```\n    # ufw status numbered\n    ```",
                "fix": "Configure ufw in accordance with site policy. The following commands will\nimplement a policy to allow all outbound connections on all interfaces:\n\n    ```\n    # ufw allow out on all\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.2.4"
            },
            "code": "control \"C-3.5.2.4\" do\n  title \"Ensure outbound connections are configured\"\n  desc  \"Configure the firewall rules for new outbound connections.\"\n  desc  \"rationale\", \"If rules are not in place for new outbound connections\nall packets will be dropped by the default policy preventing network usage.\"\n  desc  \"check\", \"\n    Run the following command and verify all rules for new outbound connections\nmatch site policy:\n\n    ```\n    # ufw status numbered\n    ```\n  \"\n  desc \"fix\", \"\n    Configure ufw in accordance with site policy. The following commands will\nimplement a policy to allow all outbound connections on all interfaces:\n\n    ```\n    # ufw allow out on all\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.2.4\"\n\n  ufw_status = command('ufw status numbered').stdout.strip\n\n  if service('ufw').running? && service('ufw').enabled?\n    describe \"File '#{ufw_status}' \\n Manually verification required.\\nVerify all rules for new outbound connections\nmatch site policy\" do\n      skip \"File '#{ufw_status}' \\n Manually verification required.\\nVerify all rules for new outbound connections\nmatch site policy\"\n    end\n  else\n    describe service('ufw') do\n      it { should be_running }\n      it { should be_enabled }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.2.4.rb",
                "line": 3
            },
            "id": "C-3.5.2.4"
        },
        {
            "title": "Ensure talk client is not installed",
            "desc": "The `talk` software makes it possible for users to send and receive\nmessages across systems through a terminal session. The `talk` client, which\nallows initialization of talk sessions, is installed by default.",
            "descriptions": {
                "default": "The `talk` software makes it possible for users to send and receive\nmessages across systems through a terminal session. The `talk` client, which\nallows initialization of talk sessions, is installed by default.",
                "rationale": "The software presents a security risk as it uses\nunencrypted protocols for communication.",
                "check": "Verify `talk` is not installed. The following command may provide the\nneeded information:\n\n    ```\n    dpkg -s talk\n    ```",
                "fix": "Uninstall `talk`:\n\n```\napt remove talk\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-2 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "2.6",
                    "Rev_7"
                ],
                "cis_rid": "2.3.3"
            },
            "code": "control \"C-2.3.3\" do\n  title \"Ensure talk client is not installed\"\n  desc  \"The `talk` software makes it possible for users to send and receive\nmessages across systems through a terminal session. The `talk` client, which\nallows initialization of talk sessions, is installed by default.\"\n  desc  \"rationale\", \"The software presents a security risk as it uses\nunencrypted protocols for communication.\"\n  desc  \"check\", \"\n    Verify `talk` is not installed. The following command may provide the\nneeded information:\n\n    ```\n    dpkg -s talk\n    ```\n  \"\n  desc \"fix\", \"\n    Uninstall `talk`:\n\n    ```\n    apt remove talk\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-2 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"2.6\", \"Rev_7\"]\n  tag cis_rid: \"2.3.3\"\n\n  describe package('talk') do\n    it { should_not be_installed }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.3.3.rb",
                "line": 3
            },
            "id": "C-2.3.3"
        },
        {
            "title": "Ensure X Window System is not installed",
            "desc": "The X Window System provides a Graphical User Interface (GUI) where\nusers can have multiple windows in which to run programs and various add on.\nThe X Windows system is typically used on workstations where users login, but\nnot on servers where users typically do not login.",
            "descriptions": {
                "default": "The X Window System provides a Graphical User Interface (GUI) where\nusers can have multiple windows in which to run programs and various add on.\nThe X Windows system is typically used on workstations where users login, but\nnot on servers where users typically do not login.",
                "rationale": "Unless your organization specifically requires graphical\nlogin access via X Windows, remove it to reduce the potential attack surface.",
                "check": "Verify X Windows System is not installed:\n\n```\ndpkg -l xserver-xorg*\n```",
                "fix": "Remove the X Windows System packages:\n\n```\napt purge xserver-xorg*\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-2 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "2.6",
                    "Rev_7"
                ],
                "cis_rid": "2.2.2"
            },
            "code": "control \"C-2.2.2\" do\n  title \"Ensure X Window System is not installed\"\n  desc  \"The X Window System provides a Graphical User Interface (GUI) where\nusers can have multiple windows in which to run programs and various add on.\nThe X Windows system is typically used on workstations where users login, but\nnot on servers where users typically do not login.\"\n  desc  \"rationale\", \"Unless your organization specifically requires graphical\nlogin access via X Windows, remove it to reduce the potential attack surface.\"\n  desc  \"check\", \"\n    Verify X Windows System is not installed:\n\n    ```\n    dpkg -l xserver-xorg*\n    ```\n  \"\n  desc \"fix\", \"\n    Remove the X Windows System packages:\n\n    ```\n    apt purge xserver-xorg*\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-2 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"2.6\", \"Rev_7\"]\n  tag cis_rid: \"2.2.2\"\n\n  describe package('xserver-xorg') do\n    it { should_not be_installed }\n  end\n\n  describe package('xserver-xorg-core') do\n    it { should_not be_installed }\n  end\n\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.2.rb",
                "line": 3
            },
            "id": "C-2.2.2"
        },
        {
            "title": "Ensure permissions on /etc/cron.hourly are configured",
            "desc": "This directory contains system `cron` jobs that need to run on an\nhourly basis. The files in this directory cannot be manipulated by the\n`crontab` command, but are instead edited by system administrators using a text\neditor. The commands below restrict read/write and search access to user and\ngroup root, preventing regular users from accessing this directory.",
            "descriptions": {
                "default": "This directory contains system `cron` jobs that need to run on an\nhourly basis. The files in this directory cannot be manipulated by the\n`crontab` command, but are instead edited by system administrators using a text\neditor. The commands below restrict read/write and search access to user and\ngroup root, preventing regular users from accessing this directory.",
                "rationale": "Granting write access to this directory for\nnon-privileged users could provide them the means for gaining unauthorized\nelevated privileges. Granting read access to this directory could give an\nunprivileged user insight in how to gain elevated privileges or circumvent\nauditing controls.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/cron.hourly\n\n    Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set ownership and permissions on\n`/etc/cron.hourly` :\n\n    ```\n    # chown root:root /etc/cron.hourly\n    ```\n\n    ```\n    # chmod og-rwx /etc/cron.hourly\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "5.1.3"
            },
            "code": "control \"C-5.1.3\" do\n  title \"Ensure permissions on /etc/cron.hourly are configured\"\n  desc  \"This directory contains system `cron` jobs that need to run on an\nhourly basis. The files in this directory cannot be manipulated by the\n`crontab` command, but are instead edited by system administrators using a text\neditor. The commands below restrict read/write and search access to user and\ngroup root, preventing regular users from accessing this directory.\"\n  desc  \"rationale\", \"Granting write access to this directory for\nnon-privileged users could provide them the means for gaining unauthorized\nelevated privileges. Granting read access to this directory could give an\nunprivileged user insight in how to gain elevated privileges or circumvent\nauditing controls.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/cron.hourly\n\n    Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set ownership and permissions on\n`/etc/cron.hourly` :\n\n    ```\n    # chown root:root /etc/cron.hourly\n    ```\n\n    ```\n    # chmod og-rwx /etc/cron.hourly\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"5.1.3\"\n\n  describe file('/etc/cron.hourly') do \n    its('owner') { should cmp 'root' }\n    its('group') { should cmp 'root' }\n    it { should be_directory }\n    it { should_not be_more_permissive_than('0700') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.1.3.rb",
                "line": 3
            },
            "id": "C-5.1.3"
        },
        {
            "title": "Ensure mounting of cramfs filesystems is disabled",
            "desc": "The `cramfs` filesystem type is a compressed read-only Linux\nfilesystem embedded in small footprint systems. A `cramfs` image can be used\nwithout having to first decompress the image.",
            "descriptions": {
                "default": "The `cramfs` filesystem type is a compressed read-only Linux\nfilesystem embedded in small footprint systems. A `cramfs` image can be used\nwithout having to first decompress the image.",
                "rationale": "Removing support for unneeded filesystem types reduces\nthe local attack surface of the server. If this filesystem type is not needed,\ndisable it.",
                "check": "Run the following commands and verify the output is as indicated:\n```\n# modprobe -n -v cramfs | grep -v mtd\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep cramfs\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/cramfs.conf`\n\nand add the following line:\n\n```\ninstall cramfs /bin/true\n```\n\nRun the following command to unload the `cramfs` module:\n\n```\n# rmmod cramfs\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.1.1"
            },
            "code": "control \"C-1.1.1.1\" do\n  title \"Ensure mounting of cramfs filesystems is disabled\"\n  desc  \"The `cramfs` filesystem type is a compressed read-only Linux\nfilesystem embedded in small footprint systems. A `cramfs` image can be used\nwithout having to first decompress the image.\"\n  desc  \"rationale\", \"Removing support for unneeded filesystem types reduces\nthe local attack surface of the server. If this filesystem type is not needed,\ndisable it.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n    ```\n    # modprobe -n -v cramfs | grep -v mtd\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep cramfs\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/cramfs.conf`\n\n    and add the following line:\n\n    ```\n    install cramfs /bin/true\n    ```\n\n    Run the following command to unload the `cramfs` module:\n\n    ```\n    # rmmod cramfs\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.1.1\"\n\n  describe kernel_module('cramfs') do\n    it { should_not be_loaded }\n    it { should be_disabled }\n    it { should be_blacklisted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.1.1.rb",
                "line": 3
            },
            "id": "C-1.1.1.1"
        },
        {
            "title": "Ensure outbound and established connections are configured",
            "desc": "Configure the firewall rules for new outbound, and established\nconnections",
            "descriptions": {
                "default": "Configure the firewall rules for new outbound, and established\nconnections",
                "rationale": "If rules are not in place for new outbound, and\nestablished connections all packets will be dropped by the default policy\npreventing network usage.",
                "check": "Run the following commands and verify all rules for established incoming\nconnections match site policy: site policy:\n\n    ```\n    # nft list ruleset | awk '/hook input/,/}/' | grep -E 'ip protocol\n(tcp|udp|icmp) ct state'\n    ```\n\n    Output should be similar to:\n\n    ```\n    ip protocol tcp ct state established accept\n    ip protocol udp ct state established accept\n    ip protocol icmp ct state established accept\n    ```\n\n    Run the folllowing command and verify all rules for new and established\noutbound connections match site policy\n\n    ```\n    # nft list ruleset | awk '/hook output/,/}/' | grep -E 'ip protocol\n(tcp|udp|icmp) ct state'\n    ```\n\n    Output should be similar to:\n\n    ```\n    ip protocol tcp ct state established,related,new accept\n    ip protocol udp ct state established,related,new accept\n    ip protocol icmp ct state established,related,new accept\n    ```",
                "fix": "Configure nftables in accordance with site policy. The following commands\nwill implement a policy to allow all outbound connections and all established\nconnections:\n\n    ```\n    # nft add rule inet filter input ip protocol tcp ct state established accept\n\n    # nft add rule inet filter input ip protocol udp ct state established accept\n\n    # nft add rule inet filter input ip protocol icmp ct state established\naccept\n\n    # nft add rule inet filter output ip protocol tcp ct state\nnew,related,established accept\n\n    # nft add rule inet filter output ip protocol udp ct state\nnew,related,established accept\n\n    # nft add rule inet filter output ip protocol icmp ct state\nnew,related,established accept\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.3.5"
            },
            "code": "control \"C-3.5.3.5\" do\n  title \"Ensure outbound and established connections are configured\"\n  desc  \"Configure the firewall rules for new outbound, and established\nconnections\"\n  desc  \"rationale\", \"If rules are not in place for new outbound, and\nestablished connections all packets will be dropped by the default policy\npreventing network usage.\"\n  desc  \"check\", \"\n    Run the following commands and verify all rules for established incoming\nconnections match site policy: site policy:\n\n    ```\n    # nft list ruleset | awk '/hook input/,/}/' | grep -E 'ip protocol\n(tcp|udp|icmp) ct state'\n    ```\n\n    Output should be similar to:\n\n    ```\n    ip protocol tcp ct state established accept\n    ip protocol udp ct state established accept\n    ip protocol icmp ct state established accept\n    ```\n\n    Run the folllowing command and verify all rules for new and established\noutbound connections match site policy\n\n    ```\n    # nft list ruleset | awk '/hook output/,/}/' | grep -E 'ip protocol\n(tcp|udp|icmp) ct state'\n    ```\n\n    Output should be similar to:\n\n    ```\n    ip protocol tcp ct state established,related,new accept\n    ip protocol udp ct state established,related,new accept\n    ip protocol icmp ct state established,related,new accept\n    ```\n  \"\n  desc \"fix\", \"\n    Configure nftables in accordance with site policy. The following commands\nwill implement a policy to allow all outbound connections and all established\nconnections:\n\n    ```\n    # nft add rule inet filter input ip protocol tcp ct state established accept\n\n    # nft add rule inet filter input ip protocol udp ct state established accept\n\n    # nft add rule inet filter input ip protocol icmp ct state established\naccept\n\n    # nft add rule inet filter output ip protocol tcp ct state\nnew,related,established accept\n\n    # nft add rule inet filter output ip protocol udp ct state\nnew,related,established accept\n\n    # nft add rule inet filter output ip protocol icmp ct state\nnew,related,established accept\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.3.5\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.3.5.rb",
                "line": 3
            },
            "id": "C-3.5.3.5"
        },
        {
            "title": "Ensure interactive boot is not enabled",
            "desc": "Interactive boot allows console users to interactively select which\nservices start on boot. Not all distributions support this capability.\n\n    The `PROMPT_FOR_CONFIRM` option provides console users the ability to\ninteractively boot the system and select which services to start on boot .",
            "descriptions": {
                "default": "Interactive boot allows console users to interactively select which\nservices start on boot. Not all distributions support this capability.\n\n    The `PROMPT_FOR_CONFIRM` option provides console users the ability to\ninteractively boot the system and select which services to start on boot .",
                "rationale": "Turn off the `PROMPT_FOR_CONFIRM` option on the console\nto prevent console users from potentially overriding established security\nsettings.",
                "check": "If interactive boot is available verify it is disabled on your system. On\nsome distributions this is configured via the `PROMPT_FOR_CONFIRM` option in\n`/etc/sysconfig/boot` :\n\n    ```\n    # grep \"^PROMPT_FOR_CONFIRM=\" /etc/sysconfig/boot\n\n    PROMPT_FOR_CONFIRM=\"no\"\n    ```",
                "fix": "If interactive boot is available disable it."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.5.4"
            },
            "code": "control \"C-1.5.4\" do\n  title \"Ensure interactive boot is not enabled\"\n  desc  \"Interactive boot allows console users to interactively select which\nservices start on boot. Not all distributions support this capability.\n\n    The `PROMPT_FOR_CONFIRM` option provides console users the ability to\ninteractively boot the system and select which services to start on boot .\n  \"\n  desc  \"rationale\", \"Turn off the `PROMPT_FOR_CONFIRM` option on the console\nto prevent console users from potentially overriding established security\nsettings.\"\n  desc  \"check\", \"\n    If interactive boot is available verify it is disabled on your system. On\nsome distributions this is configured via the `PROMPT_FOR_CONFIRM` option in\n`/etc/sysconfig/boot` :\n\n    ```\n    # grep \\\"^PROMPT_FOR_CONFIRM=\\\" /etc/sysconfig/boot\n\n    PROMPT_FOR_CONFIRM=\\\"no\\\"\n    ```\n  \"\n  desc \"fix\", \"If interactive boot is available disable it.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.5.4\"\n\n  describe file('/etc/sysconfig/boot') do\n    its('content') { should match '^\\\\s*PROMPT_FOR_CONFIRM\\\\s*=\\\\s*no' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.5.4.rb",
                "line": 3
            },
            "id": "C-1.5.4"
        },
        {
            "title": "Ensure auditing for processes that start prior to auditd is enabled",
            "desc": "Configure `grub` so that processes that are capable of being audited\ncan be audited even if they start up prior to `auditd` startup.",
            "descriptions": {
                "default": "Configure `grub` so that processes that are capable of being audited\ncan be audited even if they start up prior to `auditd` startup.",
                "rationale": "Audit events need to be captured on processes that start\nup prior to `auditd` , so that potential malicious activity cannot go\nundetected.",
                "check": "Run the following command and verify that each linux line has the `audit=1`\nparameter set:\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v \"audit=1\" | grep -v\n'/boot/memtest86+.bin'\n    ```\n\n    Nothing should be returned",
                "fix": "Edit `/etc/default/grub` and add audit=1 to GRUB_CMDLINE_LINUX:\n\n```\nGRUB_CMDLINE_LINUX=\"audit=1\"\n```\n\nRun the following command to update the `grub2` configuration:\n\n```\n# update-grub\n```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AU-12",
                    "AU-3"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "6.2",
                    "6.3"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.1.3"
            },
            "code": "control \"C-4.1.1.3\" do\n  title \"Ensure auditing for processes that start prior to auditd is enabled\"\n  desc  \"Configure `grub` so that processes that are capable of being audited\ncan be audited even if they start up prior to `auditd` startup.\"\n  desc  \"rationale\", \"Audit events need to be captured on processes that start\nup prior to `auditd` , so that potential malicious activity cannot go\nundetected.\"\n  desc  \"check\", \"\n    Run the following command and verify that each linux line has the `audit=1`\nparameter set:\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v \\\"audit=1\\\" | grep -v\n'/boot/memtest86+.bin'\n    ```\n\n    Nothing should be returned\n  \"\n  desc \"fix\", \"\n    Edit `/etc/default/grub` and add audit=1 to GRUB_CMDLINE_LINUX:\n\n    ```\n    GRUB_CMDLINE_LINUX=\\\"audit=1\\\"\n    ```\n\n    Run the following command to update the `grub2` configuration:\n\n    ```\n    # update-grub\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AU-12\", \"AU-3\"]\n  tag cis_level: 2\n  tag cis_controls: [\"6.2\", \"6.3\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.1.3\"\n  describe command(\"grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v \\\"audit=1\\\" | grep -v '/boot/memtest86+.bin'\").stdout do\n    it { should be_empty }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.1.3.rb",
                "line": 3
            },
            "id": "C-4.1.1.3"
        },
        {
            "title": "Ensure prelink is disabled",
            "desc": "`prelink `is a program that modifies ELF shared libraries and ELF\ndynamically linked binaries in such a way that the time needed for the dynamic\nlinker to perform relocations at startup significantly decreases.",
            "descriptions": {
                "default": "`prelink `is a program that modifies ELF shared libraries and ELF\ndynamically linked binaries in such a way that the time needed for the dynamic\nlinker to perform relocations at startup significantly decreases.",
                "rationale": "The prelinking feature can interfere with the operation\nof AIDE, because it changes binaries. Prelinking can also increase the\nvulnerability of the system if a malicious user is able to compromise a common\nlibrary such as libc.",
                "check": "Verify `prelink` is not installed:\n\n```\n# dpkg -s prelink\n```",
                "fix": "Run the following command to restore binaries to normal:\n\n    ```\n    # prelink -ua\n    ```\n    Uninstall `prelink` using the appropriate package manager or manual\ninstallation:\n\n    ```\n    # apt purge prelink\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-2",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.9",
                    "Rev_7"
                ],
                "cis_rid": "1.6.3"
            },
            "code": "control \"C-1.6.3\" do\n  title \"Ensure prelink is disabled\"\n  desc  \"`prelink `is a program that modifies ELF shared libraries and ELF\ndynamically linked binaries in such a way that the time needed for the dynamic\nlinker to perform relocations at startup significantly decreases.\"\n  desc  \"rationale\", \"The prelinking feature can interfere with the operation\nof AIDE, because it changes binaries. Prelinking can also increase the\nvulnerability of the system if a malicious user is able to compromise a common\nlibrary such as libc.\"\n  desc  \"check\", \"\n    Verify `prelink` is not installed:\n\n    ```\n    # dpkg -s prelink\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to restore binaries to normal:\n\n    ```\n    # prelink -ua\n    ```\n    Uninstall `prelink` using the appropriate package manager or manual\ninstallation:\n\n    ```\n    # apt purge prelink\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-2\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.9\", \"Rev_7\"]\n  tag cis_rid: \"1.6.3\"\n\n  describe package('prelink') do\n    it { should_not be_installed }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.6.3.rb",
                "line": 3
            },
            "id": "C-1.6.3"
        },
        {
            "title": "Ensure IPv6 loopback traffic is configured",
            "desc": "Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network (::1).",
            "descriptions": {
                "default": "Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network (::1).",
                "rationale": "Loopback traffic is generated between processes on\nmachine and is typically critical to operation of the system. The loopback\ninterface is the only place that loopback network (::1) traffic should be seen,\nall other interfaces should ignore traffic on this network as an anti-spoofing\nmeasure.",
                "check": "Run the following commands and verify output includes the listed rules in\norder (packet and byte counts may differ):\n\n    ```\n    # ip6tables -L INPUT -v -n\n    Chain INPUT (policy DROP 0 packets, 0 bytes)\n    pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all lo * ::/0 ::/0\n     0 0 DROP all * * ::1 ::/0\n\n    # ip6tables -L OUTPUT -v -n\n    Chain OUTPUT (policy DROP 0 packets, 0 bytes)\n    pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all * lo ::/0 ::/0\n    ```\n\n    OR\n\n    If IPv6 is disabled:\n\n    Run the following command and verify that no lines are returned.\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1\n    ```\n\n    OR\n\n    ```\n    # grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v ipv6.disable=1\n    ```",
                "fix": "Run the following commands to implement the loopback rules:\n\n```\n# ip6tables -A INPUT -i lo -j ACCEPT\n# ip6tables -A OUTPUT -o lo -j ACCEPT\n# ip6tables -A INPUT -s ::1 -j DROP\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.4.2.2"
            },
            "code": "control \"C-3.5.4.2.2\" do\n  title \"Ensure IPv6 loopback traffic is configured\"\n  desc  \"Configure the loopback interface to accept traffic. Configure all\nother interfaces to deny traffic to the loopback network (::1).\"\n  desc  \"rationale\", \"Loopback traffic is generated between processes on\nmachine and is typically critical to operation of the system. The loopback\ninterface is the only place that loopback network (::1) traffic should be seen,\nall other interfaces should ignore traffic on this network as an anti-spoofing\nmeasure.\"\n  desc  \"check\", \"\n    Run the following commands and verify output includes the listed rules in\norder (packet and byte counts may differ):\n\n    ```\n    # ip6tables -L INPUT -v -n\n    Chain INPUT (policy DROP 0 packets, 0 bytes)\n    pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all lo * ::/0 ::/0\n     0 0 DROP all * * ::1 ::/0\n\n    # ip6tables -L OUTPUT -v -n\n    Chain OUTPUT (policy DROP 0 packets, 0 bytes)\n    pkts bytes target prot opt in out source destination\n     0 0 ACCEPT all * lo ::/0 ::/0\n    ```\n\n    OR\n\n    If IPv6 is disabled:\n\n    Run the following command and verify that no lines are returned.\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub2/grub.cfg | grep -v ipv6.disable=1\n    ```\n\n    OR\n\n    ```\n    # grep \\\"^\\\\s*linux\\\" /boot/grub/grub.cfg | grep -v ipv6.disable=1\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to implement the loopback rules:\n\n    ```\n    # ip6tables -A INPUT -i lo -j ACCEPT\n    # ip6tables -A OUTPUT -o lo -j ACCEPT\n    # ip6tables -A INPUT -s ::1 -j DROP\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.4.2.2\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.4.2.2.rb",
                "line": 3
            },
            "id": "C-3.5.4.2.2"
        },
        {
            "title": "Ensure permissions on /etc/issue.net are configured",
            "desc": "The contents of the `/etc/issue.net` file are displayed to users prior\nto login for remote connections from configured services.",
            "descriptions": {
                "default": "The contents of the `/etc/issue.net` file are displayed to users prior\nto login for remote connections from configured services.",
                "rationale": "If the `/etc/issue.net` file does not have the correct\nownership it could be modified by unauthorized users with incorrect or\nmisleading information.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` :\n\n    ```\n    # stat /etc/issue.net\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set permissions on `/etc/issue.net` :\n\n```\n# chown root:root /etc/issue.net\n```\n\n```\n# chmod u-x,go-wx /etc/issue.net\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.8.1.6"
            },
            "code": "control \"C-1.8.1.6\" do\n  title \"Ensure permissions on /etc/issue.net are configured\"\n  desc  \"The contents of the `/etc/issue.net` file are displayed to users prior\nto login for remote connections from configured services.\"\n  desc  \"rationale\", \"If the `/etc/issue.net` file does not have the correct\nownership it could be modified by unauthorized users with incorrect or\nmisleading information.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` :\n\n    ```\n    # stat /etc/issue.net\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set permissions on `/etc/issue.net` :\n\n    ```\n    # chown root:root /etc/issue.net\n    ```\n\n    ```\n    # chmod u-x,go-wx /etc/issue.net\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.8.1.6\"\n\n  describe file('/etc/issue.net') do\n    it { should exist }\n    it { should be_owned_by 'root' }\n    it { should_not be_more_permissive_than('0644') }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.8.1.6.rb",
                "line": 3
            },
            "id": "C-1.8.1.6"
        },
        {
            "title": "Ensure mail transfer agent is configured for local-only mode",
            "desc": "Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to\nlisten for incoming mail and transfer the messages to the appropriate user or\nmail server. If the system is not intended to be a mail server, it is\nrecommended that the MTA be configured to only process local mail.",
            "descriptions": {
                "default": "Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to\nlisten for incoming mail and transfer the messages to the appropriate user or\nmail server. If the system is not intended to be a mail server, it is\nrecommended that the MTA be configured to only process local mail.",
                "rationale": "The software for all Mail Transfer Agents is complex and\nmost have a long history of security issues. While it is important to ensure\nthat the system can process local mail messages, it is not necessary to have\nthe MTA's daemon listening on a port unless the server is intended to be a mail\nserver that receives and processes mail from other systems.",
                "check": "Run the following command to verify that the MTA is not listening on any\nnon-loopback address ( `127.0.0.1` or `::1` )\n\n    Nothing should be returned\n\n    ```\n    # ss -lntu | grep -E ':25\\s' | grep -E -v '\\s(127.0.0.1|::1):25\\s'\n    ```",
                "fix": "Edit `/etc/postfix/main.cf` and add the following line to the RECEIVING\nMAIL section. If the line already exists, change it to look like the line below:\n\n    ```\n    inet_interfaces = loopback-only\n    ```\n\n    Restart postfix:\n\n    ```\n    # systemctl restart postfix\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.15"
            },
            "code": "control \"C-2.2.15\" do\n  title \"Ensure mail transfer agent is configured for local-only mode\"\n  desc  \"Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to\nlisten for incoming mail and transfer the messages to the appropriate user or\nmail server. If the system is not intended to be a mail server, it is\nrecommended that the MTA be configured to only process local mail.\"\n  desc  \"rationale\", \"The software for all Mail Transfer Agents is complex and\nmost have a long history of security issues. While it is important to ensure\nthat the system can process local mail messages, it is not necessary to have\nthe MTA's daemon listening on a port unless the server is intended to be a mail\nserver that receives and processes mail from other systems.\"\n  desc  \"check\", \"\n    Run the following command to verify that the MTA is not listening on any\nnon-loopback address ( `127.0.0.1` or `::1` )\n\n    Nothing should be returned\n\n    ```\n    # ss -lntu | grep -E ':25\\\\s' | grep -E -v '\\\\s(127.0.0.1|::1):25\\\\s'\n    ```\n  \"\n  desc \"fix\", \"\n    Edit `/etc/postfix/main.cf` and add the following line to the RECEIVING\nMAIL section. If the line already exists, change it to look like the line below:\n\n    ```\n    inet_interfaces = loopback-only\n    ```\n\n    Restart postfix:\n\n    ```\n    # systemctl restart postfix\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.15\"\n\n  describe.one do\n    describe port(25) do\n      it { should be_listening }\n      its('protocols') { should include 'tcp' }\n      its('addresses') { should include '127.0.0.1' }\n    end\n    describe port(25) do\n      it { should_not be_listening }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.15.rb",
                "line": 3
            },
            "id": "C-2.2.15"
        },
        {
            "title": "Ensure SSH Protocol is not set to 1",
            "desc": "Older versions of SSH support two different and incompatible\nprotocols: SSH1 and SSH2. SSH1 was the original protocol and was subject to\nsecurity issues. SSH2 is more advanced and secure.",
            "descriptions": {
                "default": "Older versions of SSH support two different and incompatible\nprotocols: SSH1 and SSH2. SSH1 was the original protocol and was subject to\nsecurity issues. SSH2 is more advanced and secure.",
                "rationale": "SSH v1 suffers from insecurities that do not affect SSH\nv2.",
                "check": "Run the following command:\n\n```\n# sshd -T | grep -Ei '^\\s*protocol\\s+(1|1\\s*,\\s*2|2\\s*,\\s*1)\\s*'\n```\n\nNothing should be returned",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nProtocol 2\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-8",
                    "IA-2 (1)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.4",
                    "4.5"
                ],
                "cis_rid": "5.2.4",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.4\" do\n  title \"Ensure SSH Protocol is not set to 1\"\n  desc  \"Older versions of SSH support two different and incompatible\nprotocols: SSH1 and SSH2. SSH1 was the original protocol and was subject to\nsecurity issues. SSH2 is more advanced and secure.\"\n  desc  \"rationale\", \"SSH v1 suffers from insecurities that do not affect SSH\nv2.\"\n  desc  \"check\", \"\n    Run the following command:\n\n    ```\n    # sshd -T | grep -Ei '^\\\\s*protocol\\\\s+(1|1\\\\s*,\\\\s*2|2\\\\s*,\\\\s*1)\\\\s*'\n    ```\n\n    Nothing should be returned\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    Protocol 2\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-8\", \"IA-2 (1)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.4\", \"4.5\"]\n  tag cis_rid: \"5.2.4\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('Protocol') { should cmp 2 }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.4.rb",
                "line": 3
            },
            "id": "C-5.2.4"
        },
        {
            "title": "Ensure inactive password lock is 30 days or less",
            "desc": "User accounts that have been inactive for over a given period of time\ncan be automatically disabled. It is recommended that accounts that are\ninactive for 30 days after password expiration be disabled.",
            "descriptions": {
                "default": "User accounts that have been inactive for over a given period of time\ncan be automatically disabled. It is recommended that accounts that are\ninactive for 30 days after password expiration be disabled.",
                "rationale": "Inactive accounts pose a threat to system security since\nthe users are not logging in to notice failed login attempts or other\nanomalies.",
                "check": "Run the following command and verify `INACTIVE` conforms to sire policy (no\nmore than 30 days):\n\n    ```\n    # useradd -D | grep INACTIVE\n\n    INACTIVE=30\n    ```\n\n    Verify all users with a password have Password inactive no more than 30\ndays after password expires:\n    Run the following command and Review list of users and INACTIVE to verify\nthat all users' INACTIVE conforms to site policy (no more than 30 days):\n\n    ```\n    # grep -E ^[^:]+:[^\\!*] /etc/shadow | cut -d: -f1,7\n\n    :\n    ```",
                "fix": "Run the following command to set the default password inactivity period to\n30 days:\n\n    ```\n    # useradd -D -f 30\n    ```\n\n    Modify user parameters for all users with a password set to match:\n\n    ```\n    # chage --inactive 30\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "IA-5 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.4",
                    "Rev_7"
                ],
                "cis_rid": "5.4.1.4"
            },
            "code": "control \"C-5.4.1.4\" do\n  title \"Ensure inactive password lock is 30 days or less\"\n  desc  \"User accounts that have been inactive for over a given period of time\ncan be automatically disabled. It is recommended that accounts that are\ninactive for 30 days after password expiration be disabled.\"\n  desc  \"rationale\", \"Inactive accounts pose a threat to system security since\nthe users are not logging in to notice failed login attempts or other\nanomalies.\"\n  desc  \"check\", \"\n    Run the following command and verify `INACTIVE` conforms to sire policy (no\nmore than 30 days):\n\n    ```\n    # useradd -D | grep INACTIVE\n\n    INACTIVE=30\n    ```\n\n    Verify all users with a password have Password inactive no more than 30\ndays after password expires:\n    Run the following command and Review list of users and INACTIVE to verify\nthat all users' INACTIVE conforms to site policy (no more than 30 days):\n\n    ```\n    # grep -E ^[^:]+:[^\\\\!*] /etc/shadow | cut -d: -f1,7\n\n    :\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to set the default password inactivity period to\n30 days:\n\n    ```\n    # useradd -D -f 30\n    ```\n\n    Modify user parameters for all users with a password set to match:\n\n    ```\n    # chage --inactive 30\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"IA-5 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.4\", \"Rev_7\"]\n  tag cis_rid: \"5.4.1.4\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.4.1.4.rb",
                "line": 3
            },
            "id": "C-5.4.1.4"
        },
        {
            "title": "Ensure kernel module loading and unloading is collected",
            "desc": "Monitor the loading and unloading of kernel modules. The programs\n`insmod` (install a kernel module), `rmmod` (remove a kernel module), and\n`modprobe` (a more sophisticated program to load and unload modules, as well as\nsome other features) control loading and unloading of modules. The\n`init_module` (load a module) and `delete_module` (delete a module) system\ncalls control loading and unloading of modules. Any execution of the loading\nand unloading module programs and system calls will trigger an audit record\nwith an identifier of \"modules\".",
            "descriptions": {
                "default": "Monitor the loading and unloading of kernel modules. The programs\n`insmod` (install a kernel module), `rmmod` (remove a kernel module), and\n`modprobe` (a more sophisticated program to load and unload modules, as well as\nsome other features) control loading and unloading of modules. The\n`init_module` (load a module) and `delete_module` (delete a module) system\ncalls control loading and unloading of modules. Any execution of the loading\nand unloading module programs and system calls will trigger an audit record\nwith an identifier of \"modules\".",
                "rationale": "Monitoring the use of `insmod` , `rmmod` and `modprobe`\ncould provide system administrators with evidence that an unauthorized user\nloaded or unloaded a kernel module, possibly compromising the security of the\nsystem. Monitoring of the `init_module` and `delete_module` system calls would\nreflect an unauthorized user attempting to use a different program to load and\nunload modules.",
                "check": "On a 32 bit system run the following commands:\n\n```\n# grep modules /etc/audit/rules.d/*.rules\n```\n\nVerify output matches:\n\n```\n-w /sbin/insmod -p x -k modules\n-w /sbin/rmmod -p x -k modules\n-w /sbin/modprobe -p x -k modules\n-a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n```\n\n```\n# auditctl -l | grep modules\n```\n\nVerify output matches:\n\n```\n-w /sbin/insmod -p x -k modules\n-w /sbin/rmmod -p x -k modules\n-w /sbin/modprobe -p x -k modules\n-a always,exit -F arch=b32 -S init_module,delete_module -F key=modules\n```\n\nOn a 64 bit system run the following commands:\n\n```\n# grep modules /etc/audit/rules.d/*.rules\n```\n\nVerify output matches:\n\n```\n-w /sbin/insmod -p x -k modules\n-w /sbin/rmmod -p x -k modules\n-w /sbin/modprobe -p x -k modules\n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n```\n\n```\n# auditctl -l | grep modules\n```\n\nVerify output matches:\n\n```\n-w /sbin/insmod -p x -k modules\n-w /sbin/rmmod -p x -k modules\n-w /sbin/modprobe -p x -k modules\n-a always,exit -F arch=b64 -S init_module,delete_module -F key=modules\n```",
                "fix": "For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/modules.rules`\n\n    and add the following lines:\n    ```\n    -w /sbin/insmod -p x -k modules\n    -w /sbin/rmmod -p x -k modules\n    -w /sbin/modprobe -p x -k modules\n    -a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/modules.rules`\n\n    and add the following lines:\n\n    ```\n    -w /sbin/insmod -p x -k modules\n    -w /sbin/rmmod -p x -k modules\n    -w /sbin/modprobe -p x -k modules\n    -a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.1"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.16"
            },
            "code": "control \"C-4.1.16\" do\n  title \"Ensure kernel module loading and unloading is collected\"\n  desc  \"Monitor the loading and unloading of kernel modules. The programs\n`insmod` (install a kernel module), `rmmod` (remove a kernel module), and\n`modprobe` (a more sophisticated program to load and unload modules, as well as\nsome other features) control loading and unloading of modules. The\n`init_module` (load a module) and `delete_module` (delete a module) system\ncalls control loading and unloading of modules. Any execution of the loading\nand unloading module programs and system calls will trigger an audit record\nwith an identifier of \\\"modules\\\".\"\n  desc  \"rationale\", \"Monitoring the use of `insmod` , `rmmod` and `modprobe`\ncould provide system administrators with evidence that an unauthorized user\nloaded or unloaded a kernel module, possibly compromising the security of the\nsystem. Monitoring of the `init_module` and `delete_module` system calls would\nreflect an unauthorized user attempting to use a different program to load and\nunload modules.\"\n  desc  \"check\", \"\n    On a 32 bit system run the following commands:\n\n    ```\n    # grep modules /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -w /sbin/insmod -p x -k modules\n    -w /sbin/rmmod -p x -k modules\n    -w /sbin/modprobe -p x -k modules\n    -a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n    ```\n\n    ```\n    # auditctl -l | grep modules\n    ```\n\n    Verify output matches:\n\n    ```\n    -w /sbin/insmod -p x -k modules\n    -w /sbin/rmmod -p x -k modules\n    -w /sbin/modprobe -p x -k modules\n    -a always,exit -F arch=b32 -S init_module,delete_module -F key=modules\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep modules /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -w /sbin/insmod -p x -k modules\n    -w /sbin/rmmod -p x -k modules\n    -w /sbin/modprobe -p x -k modules\n    -a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n    ```\n\n    ```\n    # auditctl -l | grep modules\n    ```\n\n    Verify output matches:\n\n    ```\n    -w /sbin/insmod -p x -k modules\n    -w /sbin/rmmod -p x -k modules\n    -w /sbin/modprobe -p x -k modules\n    -a always,exit -F arch=b64 -S init_module,delete_module -F key=modules\n    ```\n  \"\n  desc  \"fix\", \"\n    For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/modules.rules`\n\n    and add the following lines:\n    ```\n    -w /sbin/insmod -p x -k modules\n    -w /sbin/rmmod -p x -k modules\n    -w /sbin/modprobe -p x -k modules\n    -a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/modules.rules`\n\n    and add the following lines:\n\n    ```\n    -w /sbin/insmod -p x -k modules\n    -w /sbin/rmmod -p x -k modules\n    -w /sbin/modprobe -p x -k modules\n    -a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.1\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.16\"\n\n  files = [\n    '/sbin/insmod',\n    '/sbin/rmmod',\n    '/sbin/modprobe'\n  ]\n\n  files.each do |file|\n    describe auditd.file(file).where { key == \"modules\" } do\n      its('permissions.uniq') { should include ['x'] }\n    end\n  end\n\n\n  arches = ['b32']\n  if os.arch.match?(/64/)\n    arches.push('b64')\n  end\n\n  syscalls = [\n    'init_module',\n    'delete_module'\n  ]\n\n  syscalls.each do |syscall|\n    arches.each do |a|\n      describe auditd.syscall(syscall).where { arch == a && key == 'modules'  } do\n        its('action.uniq') { should eq ['always'] }\n        its('list.uniq') { should eq ['exit'] }\n      end\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.16.rb",
                "line": 3
            },
            "id": "C-4.1.16"
        },
        {
            "title": "Ensure nodev option set on /var/tmp partition",
            "desc": "The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.",
            "descriptions": {
                "default": "The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.",
                "rationale": "Since the `/var/tmp` filesystem is not intended to\nsupport devices, set this option to ensure that users cannot attempt to create\nblock or character special devices in `/var/tmp` .",
                "check": "Verify that the `nodev` option is set if a `/var/tmp` partition exists.\n\nRun the following command and verify that nothing is returned:\n\n```\n# mount | grep -E '\\s/var/tmp\\s' | grep -v nodev\n```",
                "fix": "Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting\noptions) for the `/var/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/var/tmp` :\n\n    ```\n    # mount -o remount,nodev /var/tmp\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.8"
            },
            "code": "control \"C-1.1.8\" do\n  title \"Ensure nodev option set on /var/tmp partition\"\n  desc  \"The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.\"\n  desc  \"rationale\", \"Since the `/var/tmp` filesystem is not intended to\nsupport devices, set this option to ensure that users cannot attempt to create\nblock or character special devices in `/var/tmp` .\"\n  desc  \"check\", \"\n    Verify that the `nodev` option is set if a `/var/tmp` partition exists.\n\n    Run the following command and verify that nothing is returned:\n\n    ```\n    # mount | grep -E '\\\\s/var/tmp\\\\s' | grep -v nodev\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting\noptions) for the `/var/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/var/tmp` :\n\n    ```\n    # mount -o remount,nodev /var/tmp\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.8\"\n\n  describe mount('/var/tmp') do\n    its('options') { should include 'nodev' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.8.rb",
                "line": 3
            },
            "id": "C-1.1.8"
        },
        {
            "title": "Ensure users own their home directories",
            "desc": "The user home directory is space defined for the particular user to\nset local environment variables and to store personal files.",
            "descriptions": {
                "default": "The user home directory is space defined for the particular user to\nset local environment variables and to store personal files.",
                "rationale": "Since the user is accountable for files stored in the\nuser home directory, the user must be the owner of the directory.",
                "check": "Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\"'\"$(which nologin)\"'\" & do\n     if [ ! -d \"$dir\" ]; then\n     echo \"The home directory \\\"$dir\\\" of user $user does not exist.\"\n     else\n     owner=$(stat -L -c \"%U\" \"$dir\")\n     if [ \"$owner\" != \"$user\" ]; then\n     echo \"The home directory \\\"$dir\\\" of user $user is owned by $owner.\"\n     fi\n     fi\n    done\n    ```",
                "fix": "Change the ownership of any home directories that are not owned\nby the defined user to the correct user."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.9"
            },
            "code": "control \"C-6.2.9\" do\n  title \"Ensure users own their home directories\"\n  desc  \"The user home directory is space defined for the particular user to\nset local environment variables and to store personal files.\"\n  desc  \"rationale\", \"Since the user is accountable for files stored in the\nuser home directory, the user must be the owner of the directory.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    grep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\\\"'\\\"$(which nologin)\\\"'\\\" & do\n     if [ ! -d \\\"$dir\\\" ]; then\n     echo \\\"The home directory \\\\\\\"$dir\\\\\\\" of user $user does not exist.\\\"\n     else\n     owner=$(stat -L -c \\\"%U\\\" \\\"$dir\\\")\n     if [ \\\"$owner\\\" != \\\"$user\\\" ]; then\n     echo \\\"The home directory \\\\\\\"$dir\\\\\\\" of user $user is owned by $owner.\\\"\n     fi\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"Change the ownership of any home directories that are not owned\nby the defined user to the correct user.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.9\"\n\n  nologin = command(\"which nologin\").stdout.strip\n  \n  passwd.where { user != 'halt' && user != 'sync' && user != 'shutdown' && shell != nologin }.entries.each do |user|\n    describe file(user.home) do\n      its('owner') { should eq user.user }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.9.rb",
                "line": 3
            },
            "id": "C-6.2.9"
        },
        {
            "title": "Ensure wireless interfaces are disabled",
            "desc": "Wireless networking is used when wired networks are unavailable.\nUbuntu contains a wireless tool kit to allow system administrators to configure\nand use wireless networks.",
            "descriptions": {
                "default": "Wireless networking is used when wired networks are unavailable.\nUbuntu contains a wireless tool kit to allow system administrators to configure\nand use wireless networks.",
                "rationale": "If wireless is not to be used, wireless devices can be\ndisabled to reduce the potential attack surface.",
                "check": "Run the following command to verify no wireless interfaces are active on\nthe system:\n\n    ```\n    # nmcli radio all\n    ```\n\n    Output should be similar to:\n\n    ```\n    WIFI-HW WIFI WWAN-HW WWAN\n    enabled disabled enabled disabled\n    ```",
                "fix": "Run the following command to disable any wireless interfaces:\n\n    ```\n    # nmcli radio all off\n    ```\n\n    Disable any wireless interfaces in your network configuration.less\ninterfaces in your network configuration."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7",
                    "CM-7",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "15.4",
                    "15.5",
                    "Rev_7"
                ],
                "cis_rid": "3.6"
            },
            "code": "control \"C-3.6\" do\n  title \"Ensure wireless interfaces are disabled\"\n  desc  \"Wireless networking is used when wired networks are unavailable.\nUbuntu contains a wireless tool kit to allow system administrators to configure\nand use wireless networks.\"\n  desc  \"rationale\", \"If wireless is not to be used, wireless devices can be\ndisabled to reduce the potential attack surface.\"\n  desc  \"check\", \"\n    Run the following command to verify no wireless interfaces are active on\nthe system:\n\n    ```\n    # nmcli radio all\n    ```\n\n    Output should be similar to:\n\n    ```\n    WIFI-HW WIFI WWAN-HW WWAN\n    enabled disabled enabled disabled\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to disable any wireless interfaces:\n\n    ```\n    # nmcli radio all off\n    ```\n\n    Disable any wireless interfaces in your network configuration.less\ninterfaces in your network configuration.\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7\", \"CM-7\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"15.4\", \"15.5\", \"Rev_7\"]\n  tag cis_rid: \"3.6\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.6.rb",
                "line": 3
            },
            "id": "C-3.6"
        },
        {
            "title": "Ensure SSH warning banner is configured",
            "desc": "The `Banner` parameter specifies a file whose contents must be sent to\nthe remote user before authentication is permitted. By default, no banner is\ndisplayed.",
            "descriptions": {
                "default": "The `Banner` parameter specifies a file whose contents must be sent to\nthe remote user before authentication is permitted. By default, no banner is\ndisplayed.",
                "rationale": "Banners are used to warn connecting users of the\nparticular site's policy regarding connection. Presenting a warning message\nprior to the normal user login may assist the prosecution of trespassers on the\ncomputer system.",
                "check": "Run the following command and verify that output matches:\n\n```\n# sshd -T | grep banner\n\nBanner /etc/issue.net\n```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nBanner /etc/issue.net\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_rid": "5.2.19",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.19\" do\n  title \"Ensure SSH warning banner is configured\"\n  desc  \"The `Banner` parameter specifies a file whose contents must be sent to\nthe remote user before authentication is permitted. By default, no banner is\ndisplayed.\"\n  desc  \"rationale\", \"Banners are used to warn connecting users of the\nparticular site's policy regarding connection. Presenting a warning message\nprior to the normal user login may assist the prosecution of trespassers on the\ncomputer system.\"\n  desc  \"check\", \"\n    Run the following command and verify that output matches:\n\n    ```\n    # sshd -T | grep banner\n\n    Banner /etc/issue.net\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    Banner /etc/issue.net\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_rid: \"5.2.19\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('Banner') { should cmp '/etc/issue.net' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.19.rb",
                "line": 3
            },
            "id": "C-5.2.19"
        },
        {
            "title": "Ensure no duplicate GIDs exist",
            "desc": "Although the `groupadd` program will not let you create a duplicate\nGroup ID (GID), it is possible for an administrator to manually edit the\n`/etc/group` file and change the GID field.",
            "descriptions": {
                "default": "Although the `groupadd` program will not let you create a duplicate\nGroup ID (GID), it is possible for an administrator to manually edit the\n`/etc/group` file and change the GID field.",
                "rationale": "User groups must be assigned unique GIDs for\naccountability and to ensure appropriate access protections.",
                "check": "Run the following script and verify no results are returned:\n\n```\n#!/bin/bash\n\ncut -d: -f3 /etc/group | sort | uniq -d | while read x ; do\n echo \"Duplicate GID ($x) in /etc/group\"\ndone\n```",
                "fix": "Based on the results of the audit script, establish unique GIDs\nand review all files owned by the shared GID to determine which group they are\nsupposed to belong to."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-2"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.17"
            },
            "code": "control \"C-6.2.17\" do\n  title \"Ensure no duplicate GIDs exist\"\n  desc  \"Although the `groupadd` program will not let you create a duplicate\nGroup ID (GID), it is possible for an administrator to manually edit the\n`/etc/group` file and change the GID field.\"\n  desc  \"rationale\", \"User groups must be assigned unique GIDs for\naccountability and to ensure appropriate access protections.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    cut -d: -f3 /etc/group | sort | uniq -d | while read x ; do\n     echo \\\"Duplicate GID ($x) in /etc/group\\\"\n    done\n    ```\n  \"\n  desc \"fix\", \"Based on the results of the audit script, establish unique GIDs\nand review all files owned by the shared GID to determine which group they are\nsupposed to belong to.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-2\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.17\"\n\n  groups.entries.each do |user|\n    describe groups.gids(user.gid) do\n      its('count') { should eq 1 }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.17.rb",
                "line": 3
            },
            "id": "C-6.2.17"
        },
        {
            "title": "Ensure time synchronization is in use",
            "desc": "System time should be synchronized between all systems in an\nenvironment. This is typically done by establishing an authoritative time\nserver or set of servers and having all systems synchronize their clocks to\nthem.",
            "descriptions": {
                "default": "System time should be synchronized between all systems in an\nenvironment. This is typically done by establishing an authoritative time\nserver or set of servers and having all systems synchronize their clocks to\nthem.",
                "rationale": "Time synchronization is important to support time\nsensitive security mechanisms like Kerberos and also ensures log files have\nconsistent time records across the enterprise, which aids in forensic\ninvestigations.",
                "check": "On physical systems or virtual systems where host based time\nsynchronization is not available verify that timesyncd, chrony, or NTP is\ninstalled. Use one of the following commands to determine the needed\ninformation:\n\n    If systemd-timesyncd is used:\n\n    ```\n    # systemctl is-enabled systemd-timesyncd\n    ```\n\n    If chrony is used:\n\n    ```\n    # dpkg -s chrony\n    ```\n\n    If ntp is used:\n\n    ```\n    # dpkg -s ntp\n    ```\n\n    On virtual systems where host based time synchronization is available\nconsult your virtualization software documentation and verify that host based\nsynchronization is in use.",
                "fix": "On systems where host based time synchronization is not available,\nconfigure systemd-timesyncd. If \"full featured\" and/or encrypted time\nsynchronization is required, install chrony or NTP.\n\n    To install chrony:\n\n    ```\n    # atp install chrony\n    ```\n\n    To install ntp:\n\n    ```\n    # apt install ntp\n    ```\n\n    On virtual systems where host based time synchronization is available\nconsult your virtualization software documentation and setup host based\nsynchronization."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-8 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.1",
                    "Rev_7"
                ],
                "cis_rid": "2.2.1.1"
            },
            "code": "control \"C-2.2.1.1\" do\n  title \"Ensure time synchronization is in use\"\n  desc  \"System time should be synchronized between all systems in an\nenvironment. This is typically done by establishing an authoritative time\nserver or set of servers and having all systems synchronize their clocks to\nthem.\"\n  desc  \"rationale\", \"Time synchronization is important to support time\nsensitive security mechanisms like Kerberos and also ensures log files have\nconsistent time records across the enterprise, which aids in forensic\ninvestigations.\"\n  desc  \"check\", \"\n    On physical systems or virtual systems where host based time\nsynchronization is not available verify that timesyncd, chrony, or NTP is\ninstalled. Use one of the following commands to determine the needed\ninformation:\n\n    If systemd-timesyncd is used:\n\n    ```\n    # systemctl is-enabled systemd-timesyncd\n    ```\n\n    If chrony is used:\n\n    ```\n    # dpkg -s chrony\n    ```\n\n    If ntp is used:\n\n    ```\n    # dpkg -s ntp\n    ```\n\n    On virtual systems where host based time synchronization is available\nconsult your virtualization software documentation and verify that host based\nsynchronization is in use.\n  \"\n  desc \"fix\", \"\n    On systems where host based time synchronization is not available,\nconfigure systemd-timesyncd. If \\\"full featured\\\" and/or encrypted time\nsynchronization is required, install chrony or NTP.\n\n    To install chrony:\n\n    ```\n    # atp install chrony\n    ```\n\n    To install ntp:\n\n    ```\n    # apt install ntp\n    ```\n\n    On virtual systems where host based time synchronization is available\nconsult your virtualization software documentation and setup host based\nsynchronization.\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-8 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.1\", \"Rev_7\"]\n  tag cis_rid: \"2.2.1.1\"\n\n  describe.one do\n    describe service('systemd-timesyncd') do\n      it { should be_installed }\n      it { should be_enabled }\n      it { should be_running }\n    end\n    describe service('chrony') do\n      it { should be_installed }\n      it { should be_enabled }\n      it { should be_running }\n    end\n    describe service('ntp') do\n      it { should be_installed }\n      it { should be_enabled }\n      it { should be_running }\n    end\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.1.1.rb",
                "line": 3
            },
            "id": "C-2.2.1.1"
        },
        {
            "title": "Ensure AIDE is installed",
            "desc": "AIDE takes a snapshot of filesystem state including modification\ntimes, permissions, and file hashes which can then be used to compare against\nthe current state of the filesystem to detect modifications to the system.",
            "descriptions": {
                "default": "AIDE takes a snapshot of filesystem state including modification\ntimes, permissions, and file hashes which can then be used to compare against\nthe current state of the filesystem to detect modifications to the system.",
                "rationale": "By monitoring the filesystem state compromised files can\nbe detected to prevent or limit the exposure of accidental or malicious\nmisconfigurations or modified binaries.",
                "check": "Verify AIDE is installed:\n\n```\n# dpkg -s aide\n```",
                "fix": "Install AIDE using the appropriate package manager or manual installation:\n\n    ```\n    # apt install aide aide-common\n    ```\n\n    Configure AIDE as appropriate for your environment. Consult the AIDE\ndocumentation for options.\n\n    Initialize AIDE:\n\n    ```\n    # aideinit\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-2",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.9",
                    "Rev_7"
                ],
                "cis_rid": "1.4.1"
            },
            "code": "control \"C-1.4.1\" do\n  title \"Ensure AIDE is installed\"\n  desc  \"AIDE takes a snapshot of filesystem state including modification\ntimes, permissions, and file hashes which can then be used to compare against\nthe current state of the filesystem to detect modifications to the system.\"\n  desc  \"rationale\", \"By monitoring the filesystem state compromised files can\nbe detected to prevent or limit the exposure of accidental or malicious\nmisconfigurations or modified binaries.\"\n  desc  \"check\", \"\n    Verify AIDE is installed:\n\n    ```\n    # dpkg -s aide\n    ```\n  \"\n  desc \"fix\", \"\n    Install AIDE using the appropriate package manager or manual installation:\n\n    ```\n    # apt install aide aide-common\n    ```\n\n    Configure AIDE as appropriate for your environment. Consult the AIDE\ndocumentation for options.\n\n    Initialize AIDE:\n\n    ```\n    # aideinit\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-2\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.9\", \"Rev_7\"]\n  tag cis_rid: \"1.4.1\"\n\n  describe package('aide') do\n    it { should be_installed }\n  end\n\n  describe package('aide-common') do\n    it { should be_installed }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.4.1.rb",
                "line": 3
            },
            "id": "C-1.4.1"
        },
        {
            "title": "Ensure sticky bit is set on all world-writable directories",
            "desc": "Setting the sticky bit on world writable directories prevents users\nfrom deleting or renaming files in that directory that are not owned by them.",
            "descriptions": {
                "default": "Setting the sticky bit on world writable directories prevents users\nfrom deleting or renaming files in that directory that are not owned by them.",
                "rationale": "This feature prevents the ability to delete or rename\nfiles in world writable directories (such as `/tmp` ) that are owned by another\nuser.",
                "check": "Run the following command to verify no world writable directories exist\nwithout the sticky bit set:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) 2>/dev/null\n    ```\n\n    No output should be returned.",
                "fix": "Run the following command to set the sticky bit on all world writable\ndirectories:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) 2>/dev/null | xargs -I '{}'\nchmod a+t '{}'\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_rid": "1.1.21"
            },
            "code": "control \"C-1.1.21\" do\n  title \"Ensure sticky bit is set on all world-writable directories\"\n  desc  \"Setting the sticky bit on world writable directories prevents users\nfrom deleting or renaming files in that directory that are not owned by them.\"\n  desc  \"rationale\", \"This feature prevents the ability to delete or rename\nfiles in world writable directories (such as `/tmp` ) that are owned by another\nuser.\"\n  desc  \"check\", \"\n    Run the following command to verify no world writable directories exist\nwithout the sticky bit set:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -type d \\\\( -perm -0002 -a ! -perm -1000 \\\\) 2>/dev/null\n    ```\n\n    No output should be returned.\n  \"\n  desc  \"fix\", \"\n    Run the following command to set the sticky bit on all world writable\ndirectories:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -type d \\\\( -perm -0002 -a ! -perm -1000 \\\\) 2>/dev/null | xargs -I '{}'\nchmod a+t '{}'\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_rid: \"1.1.21\"\n\n  command(\"df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type d \\\\( -perm -0002 -a ! -perm -1000 \\\\) 2>/dev/null\").stdout.strip.split(\"\\n\").each do |entry|\n    describe.one do\n      describe directory(entry) do\n        it { should be_sticky }\n      end\n      describe directory(entry) do\n        it { should_not be_writable.by('others') }\n      end\n    end\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.21.rb",
                "line": 3
            },
            "id": "C-1.1.21"
        },
        {
            "title": "Ensure password creation requirements are configured",
            "desc": "The `pam_pwquality.so` module checks the strength of passwords. It\nperforms checks such as making sure a password is not a dictionary word, it is\na certain length, contains a mix of characters (e.g. alphabet, numeric, other)\nand more. The following are definitions of the `pam_pwquality.so` options.\n\n    The following options are set in the `/etc/security/pwquality.conf` file:\n\n    Password Length:\n\n    - `minlen = 14` - password must be 14 characters or more\n\n    Password complexity:\n\n    - `minclass = 4` - The minimum number of required classes of characters for\nthe new password (digits, uppercase, lowercase, others)\n\n    **OR**\n\n    - `dcredit = -1` - provide at least one digit\n    - `ucredit = -1` - provide at least one uppercase character\n    - `ocredit = -1` - provide at least one special character\n    - `lcredit = -1` - provide at least one lowercase character\n\n    The following is st in the `/etc/pam.d/common-password` file\n\n    - `retry=3` - Allow 3 tries before sending back a failure.\n\n    The settings shown above are one possible policy. Alter these values to\nconform to your own organization's password policies.",
            "descriptions": {
                "default": "The `pam_pwquality.so` module checks the strength of passwords. It\nperforms checks such as making sure a password is not a dictionary word, it is\na certain length, contains a mix of characters (e.g. alphabet, numeric, other)\nand more. The following are definitions of the `pam_pwquality.so` options.\n\n    The following options are set in the `/etc/security/pwquality.conf` file:\n\n    Password Length:\n\n    - `minlen = 14` - password must be 14 characters or more\n\n    Password complexity:\n\n    - `minclass = 4` - The minimum number of required classes of characters for\nthe new password (digits, uppercase, lowercase, others)\n\n    **OR**\n\n    - `dcredit = -1` - provide at least one digit\n    - `ucredit = -1` - provide at least one uppercase character\n    - `ocredit = -1` - provide at least one special character\n    - `lcredit = -1` - provide at least one lowercase character\n\n    The following is st in the `/etc/pam.d/common-password` file\n\n    - `retry=3` - Allow 3 tries before sending back a failure.\n\n    The settings shown above are one possible policy. Alter these values to\nconform to your own organization's password policies.",
                "rationale": "Strong passwords protect systems from being hacked\nthrough brute force methods.",
                "check": "Verify password creation requirements conform to organization policy.\n\n    Run the following command to verify the minimum password length is 14 or\nmore characters.\n\n    ```\n    # grep '^\\s*minlen\\s*' /etc/security/pwquality.conf\n\n    minlen = 14\n    ```\n\n    Run one of the following commands to verify the required password\ncomplexity:\n\n    ```\n    # grep '^\\s*minclass\\s*' /etc/security/pwquality.conf\n\n    minclass = 4\n    ```\n\n    **OR**\n\n    ```\n    # grep -E '^\\s*[duol]credit\\s*' /etc/security/pwquality.conf\n\n    dcredit = -1\n    ucredit = -1\n    lcredit = -1\n    ocredit = -1\n    ```\n\n    Run the following command to verify the number of attempts allowed before\nsending back a failure are no more than 3\n\n    ```\n    # grep -E\n'^\\s*password\\s+(requisite|required)\\s+pam_pwquality\\.so\\s+(\\S+\\s+)*retry=[1-3]\\s*(\\s+\\S+\\s*)*(\\s+#.*)?$'\n/etc/pam.d/common-password\n\n    password requisite pam_pwquality.so retry=3\n    ```",
                "fix": "Run the following command to install the pam_pwquality module:\n\n    ```\n    apt install libpam-pwquality\n    ```\n\n    Edit the file `/etc/security/pwquality.conf` and add or modify the\nfollowing line for password length to conform to site policy\n    ```\n    minlen = 14\n    ```\n\n    Edit the file /etc/security/pwquality.conf and add or modify the following\nline for password complexity to conform to site policy\n\n    ```\n    minclass = 4\n    ```\n\n    **OR**\n\n    ```\n    dcredit = -1\n    ucredit = -1\n    ocredit = -1\n    lcredit = -1\n    ```\n\n    Edit the `/etc/pam.d/common-password` file to include the appropriate\noptions for `pam_pwquality.so` and to conform to site policy:\n\n    ```\n    password requisite pam_pwquality.so retry=3\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "IA-5 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.4",
                    "Rev_7"
                ],
                "cis_rid": "5.3.1"
            },
            "code": "control \"C-5.3.1\" do\n  title \"Ensure password creation requirements are configured\"\n  desc  \"The `pam_pwquality.so` module checks the strength of passwords. It\nperforms checks such as making sure a password is not a dictionary word, it is\na certain length, contains a mix of characters (e.g. alphabet, numeric, other)\nand more. The following are definitions of the `pam_pwquality.so` options.\n\n    The following options are set in the `/etc/security/pwquality.conf` file:\n\n    Password Length:\n\n    - `minlen = 14` - password must be 14 characters or more\n\n    Password complexity:\n\n    - `minclass = 4` - The minimum number of required classes of characters for\nthe new password (digits, uppercase, lowercase, others)\n\n    **OR**\n\n    - `dcredit = -1` - provide at least one digit\n    - `ucredit = -1` - provide at least one uppercase character\n    - `ocredit = -1` - provide at least one special character\n    - `lcredit = -1` - provide at least one lowercase character\n\n    The following is st in the `/etc/pam.d/common-password` file\n\n    - `retry=3` - Allow 3 tries before sending back a failure.\n\n    The settings shown above are one possible policy. Alter these values to\nconform to your own organization's password policies.\n  \"\n  desc  \"rationale\", \"Strong passwords protect systems from being hacked\nthrough brute force methods.\"\n  desc  \"check\", \"\n    Verify password creation requirements conform to organization policy.\n\n    Run the following command to verify the minimum password length is 14 or\nmore characters.\n\n    ```\n    # grep '^\\\\s*minlen\\\\s*' /etc/security/pwquality.conf\n\n    minlen = 14\n    ```\n\n    Run one of the following commands to verify the required password\ncomplexity:\n\n    ```\n    # grep '^\\\\s*minclass\\\\s*' /etc/security/pwquality.conf\n\n    minclass = 4\n    ```\n\n    **OR**\n\n    ```\n    # grep -E '^\\\\s*[duol]credit\\\\s*' /etc/security/pwquality.conf\n\n    dcredit = -1\n    ucredit = -1\n    lcredit = -1\n    ocredit = -1\n    ```\n\n    Run the following command to verify the number of attempts allowed before\nsending back a failure are no more than 3\n\n    ```\n    # grep -E\n'^\\\\s*password\\\\s+(requisite|required)\\\\s+pam_pwquality\\\\.so\\\\s+(\\\\S+\\\\s+)*retry=[1-3]\\\\s*(\\\\s+\\\\S+\\\\s*)*(\\\\s+#.*)?$'\n/etc/pam.d/common-password\n\n    password requisite pam_pwquality.so retry=3\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to install the pam_pwquality module:\n\n    ```\n    apt install libpam-pwquality\n    ```\n\n    Edit the file `/etc/security/pwquality.conf` and add or modify the\nfollowing line for password length to conform to site policy\n    ```\n    minlen = 14\n    ```\n\n    Edit the file /etc/security/pwquality.conf and add or modify the following\nline for password complexity to conform to site policy\n\n    ```\n    minclass = 4\n    ```\n\n    **OR**\n\n    ```\n    dcredit = -1\n    ucredit = -1\n    ocredit = -1\n    lcredit = -1\n    ```\n\n    Edit the `/etc/pam.d/common-password` file to include the appropriate\noptions for `pam_pwquality.so` and to conform to site policy:\n\n    ```\n    password requisite pam_pwquality.so retry=3\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"IA-5 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.4\", \"Rev_7\"]\n  tag cis_rid: \"5.3.1\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.3.1.rb",
                "line": 3
            },
            "id": "C-5.3.1"
        },
        {
            "title": "Ensure nodev option set on /dev/shm partition",
            "desc": "The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.",
            "descriptions": {
                "default": "The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.",
                "rationale": "Since the `/dev/shm` filesystem is not intended to\nsupport devices, set this option to ensure that users cannot attempt to create\nspecial devices in `/dev/shm` partitions.",
                "check": "Verify that the `nodev` option is set if a `/dev/shm` partition exists.\n\nRun the following command and verify that nothing is returned:\n\n```\n# mount | grep -E '\\s/dev/shm\\s' | grep -v nodev\n```",
                "fix": "Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting\noptions) for the `/dev/shm` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/dev/shm` :\n\n    ```\n    # mount -o remount,nodev /dev/shm\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.15"
            },
            "code": "control \"C-1.1.15\" do\n  title \"Ensure nodev option set on /dev/shm partition\"\n  desc  \"The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.\"\n  desc  \"rationale\", \"Since the `/dev/shm` filesystem is not intended to\nsupport devices, set this option to ensure that users cannot attempt to create\nspecial devices in `/dev/shm` partitions.\"\n  desc  \"check\", \"\n    Verify that the `nodev` option is set if a `/dev/shm` partition exists.\n\n    Run the following command and verify that nothing is returned:\n\n    ```\n    # mount | grep -E '\\\\s/dev/shm\\\\s' | grep -v nodev\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting\noptions) for the `/dev/shm` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/dev/shm` :\n\n    ```\n    # mount -o remount,nodev /dev/shm\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.15\"\n\n  describe mount('/dev/shm') do\n    its('options') { should include 'nodev' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.15.rb",
                "line": 3
            },
            "id": "C-1.1.15"
        },
        {
            "title": "Ensure xinetd is not installed",
            "desc": "The eXtended InterNET Daemon (`xinetd`) is an open source super daemon\nthat replaced the original `inetd` daemon. The `xinetd` daemon listens for well\nknown services and dispatches the appropriate daemon to properly respond to\nservice requests.",
            "descriptions": {
                "default": "The eXtended InterNET Daemon (`xinetd`) is an open source super daemon\nthat replaced the original `inetd` daemon. The `xinetd` daemon listens for well\nknown services and dispatches the appropriate daemon to properly respond to\nservice requests.",
                "rationale": "If there are no `xinetd` services required, it is\nrecommended that the package be removed.",
                "check": "Run the following command to verify `xinetd` is not installed:\n\n    ```\n    # dpkg -s xinetd\n    ```\n\n    Verify result is:\n\n    ```\n    dpkg-query: package 'xinetd' is not installed and no information is\navailable\n    Use dpkg --info (= dpkg-deb --info) to examine archive files,\n    and dpkg --contents (= dpkg-deb --contents) to list their contents.\n    ```",
                "fix": "Run the following commands to remove `xinetd`:\n\n```\n# apt purge xinetd\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.1.1"
            },
            "code": "control \"C-2.1.1\" do\n  title \"Ensure xinetd is not installed\"\n  desc  \"The eXtended InterNET Daemon (`xinetd`) is an open source super daemon\nthat replaced the original `inetd` daemon. The `xinetd` daemon listens for well\nknown services and dispatches the appropriate daemon to properly respond to\nservice requests.\"\n  desc  \"rationale\", \"If there are no `xinetd` services required, it is\nrecommended that the package be removed.\"\n  desc  \"check\", \"\n    Run the following command to verify `xinetd` is not installed:\n\n    ```\n    # dpkg -s xinetd\n    ```\n\n    Verify result is:\n\n    ```\n    dpkg-query: package 'xinetd' is not installed and no information is\navailable\n    Use dpkg --info (= dpkg-deb --info) to examine archive files,\n    and dpkg --contents (= dpkg-deb --contents) to list their contents.\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to remove `xinetd`:\n\n    ```\n    # apt purge xinetd\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.1.1\"\n\n  describe package(\"xinetd\") do\n    it { should_not be_installed }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.1.1.rb",
                "line": 3
            },
            "id": "C-2.1.1"
        },
        {
            "title": "Ensure email services are not enabled",
            "desc": "`dovecot` is an open source mail submission and transport server for\nLinux based systems.",
            "descriptions": {
                "default": "`dovecot` is an open source mail submission and transport server for\nLinux based systems.",
                "rationale": "Unless mail transport services are to be provided by this\nsystem, it is recommended that the service be disabled or deleted to reduce the\npotential attack surface.",
                "check": "Run one of the following commands to verify `dovecot` is not enabled:\n\n```\n# systemctl is-enabled dovecot\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run one of the following commands to disable `dovecot` :\n\n```\n# systemctl --now disable dovecot\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.11"
            },
            "code": "control \"C-2.2.11\" do\n  title \"Ensure email services are not enabled\"\n  desc  \"`dovecot` is an open source mail submission and transport server for\nLinux based systems.\"\n  desc  \"rationale\", \"Unless mail transport services are to be provided by this\nsystem, it is recommended that the service be disabled or deleted to reduce the\npotential attack surface.\"\n  desc  \"check\", \"\n    Run one of the following commands to verify `dovecot` is not enabled:\n\n    ```\n    # systemctl is-enabled dovecot\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run one of the following commands to disable `dovecot` :\n\n    ```\n    # systemctl --now disable dovecot\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.11\"\n\n  if package('dovecot-core').installed? || package('sendmail').installed? || package('postfix').installed?\n    describe service('dovecot') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n    describe service('sendmail') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n    describe service('postfix') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n  else\n    impact 0.0\n    describe \"An Email Server package is not installed\" do\n      skip \"An Email Server package is not installed.\"\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.11.rb",
                "line": 3
            },
            "id": "C-2.2.11"
        },
        {
            "title": "Ensure local login warning banner is configured properly",
            "desc": "The contents of the `/etc/issue` file are displayed to users prior to\nlogin for local terminals.\n\n    Unix-based systems have typically displayed information about the OS\nrelease and patch level upon logging in to the system. This information can be\nuseful to developers who are developing software for a particular OS platform.\nIf `mingetty(8)` supports the following options, they display operating system\ninformation: `\\m` - machine architecture `` - operating system release `\\s` - operating system name `\\v` - operating\nsystem version - or the operating system's name",
            "descriptions": {
                "default": "The contents of the `/etc/issue` file are displayed to users prior to\nlogin for local terminals.\n\n    Unix-based systems have typically displayed information about the OS\nrelease and patch level upon logging in to the system. This information can be\nuseful to developers who are developing software for a particular OS platform.\nIf `mingetty(8)` supports the following options, they display operating system\ninformation: `\\m` - machine architecture `` - operating system release `\\s` - operating system name `\\v` - operating\nsystem version - or the operating system's name",
                "rationale": "Warning messages inform users who are attempting to login\nto the system of their legal status regarding the system and must include the\nname of the organization that owns the system and any monitoring policies that\nare in place. Displaying OS and patch level information in login banners also\nhas the side effect of providing detailed system information to attackers\nattempting to target specific exploits of a system. Authorized users can easily\nget this information by running the \" `uname -a` \" command once they have\nlogged in.",
                "check": "Run the following command and verify that the contents match site policy:\n\n    ```\n    # cat /etc/issue\n    ```\n\n    Run the following command and verify no results are returned:\n\n    ```\n    # grep -E -i \"(\\\\\\v|\\\\|\\\\\\m|\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e\n's/\"//g'))\" /etc/issue\n    ```",
                "fix": "Edit the `/etc/issue` file with the appropriate contents according to your\nsite policy, remove any instances of `\\m` , `` , `\\s` , `\\v` or references to the `OS platform`\n\n    ```\n    # echo \"Authorized uses only. All activity may be monitored and\nreported.\" > /etc/issue\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.8.1.2"
            },
            "code": "control \"C-1.8.1.2\" do\n  title \"Ensure local login warning banner is configured properly\"\n  desc  \"The contents of the `/etc/issue` file are displayed to users prior to\nlogin for local terminals.\n\n    Unix-based systems have typically displayed information about the OS\nrelease and patch level upon logging in to the system. This information can be\nuseful to developers who are developing software for a particular OS platform.\nIf `mingetty(8)` supports the following options, they display operating system\ninformation: `\\\\m` - machine architecture `\\\n` - operating system release `\\\\s` - operating system name `\\\\v` - operating\nsystem version - or the operating system's name\n  \"\n  desc  \"rationale\", \"Warning messages inform users who are attempting to login\nto the system of their legal status regarding the system and must include the\nname of the organization that owns the system and any monitoring policies that\nare in place. Displaying OS and patch level information in login banners also\nhas the side effect of providing detailed system information to attackers\nattempting to target specific exploits of a system. Authorized users can easily\nget this information by running the \\\" `uname -a` \\\" command once they have\nlogged in.\"\n  desc  \"check\", \"\n    Run the following command and verify that the contents match site policy:\n\n    ```\n    # cat /etc/issue\n    ```\n\n    Run the following command and verify no results are returned:\n\n    ```\n    # grep -E -i \\\"(\\\\\\\\\\\\v|\\\\\\\\\\\n|\\\\\\\\\\\\m|\\\\\\\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e\n's/\\\"//g'))\\\" /etc/issue\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/issue` file with the appropriate contents according to your\nsite policy, remove any instances of `\\\\m` , `\\\n` , `\\\\s` , `\\\\v` or references to the `OS platform`\n\n    ```\n    # echo \\\"Authorized uses only. All activity may be monitored and\nreported.\\\" > /etc/issue\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.8.1.2\"\n\n  banner_message_text_cli = input('banner_message_text_cli')\n  banner_message_text_cli_limited = input('banner_message_text_cli_limited')\n\n  clean_banner = banner_message_text_cli.gsub(%r{[\\r\\n\\s]}, '')\n  clean_banner_limited = banner_message_text_cli_limited.gsub(%r{[\\r\\n\\s]}, '')\n  banner_file = file(\"/etc/issue\")\n  banner_missing = !banner_file.exist?\n\n  describe 'The banner text is not set because /etc/issue does not exist' do\n    subject { banner_missing }\n    it { should be false }\n  end if banner_missing\n\n  banner_message = banner_file.content.gsub(%r{[\\r\\n\\s]}, '')\n  describe.one do\n    describe 'The banner text should match the standard banner' do\n      subject { banner_message }\n      it { should cmp clean_banner }\n    end\n    describe 'The banner text should match the limited banner' do\n      subject { banner_message }\n      it{should cmp clean_banner_limited }\n    end\n  end if !banner_missing\n\n\nbanner_text = file('/etc/issue').content.gsub(%r{[\\r\\n\\s]}, '')\n\ndescribe \"Banner text\" do\n  subject { banner_text }\n  it { should eq attribute('banner_text').gsub(%r{[\\r\\n\\s]}, '') }\nend\n\n  end",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.8.1.2.rb",
                "line": 3
            },
            "id": "C-1.8.1.2"
        },
        {
            "title": "Ensure default deny firewall policy",
            "desc": "A default deny all policy on connections ensures that any unconfigured\nnetwork usage will be rejected.",
            "descriptions": {
                "default": "A default deny all policy on connections ensures that any unconfigured\nnetwork usage will be rejected.",
                "rationale": "With a default accept policy the firewall will accept any\npacket that is not configured to be denied. It is easier to white list\nacceptable usage than to black list unacceptable usage.",
                "check": "Run the following command and verify that the policy for the `INPUT` ,\n`OUTPUT` , and `FORWARD` chains is `DROP` or `REJECT` :\n\n    ```\n    # iptables -L\n    Chain INPUT (policy DROP)\n    Chain FORWARD (policy DROP)\n    Chain OUTPUT (policy DROP)\n    ```",
                "fix": "Run the following commands to implement a default DROP policy:\n\n```\n# iptables -P INPUT DROP\n# iptables -P OUTPUT DROP\n# iptables -P FORWARD DROP\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.4.1.1"
            },
            "code": "control \"C-3.5.4.1.1\" do\n  title \"Ensure default deny firewall policy\"\n  desc  \"A default deny all policy on connections ensures that any unconfigured\nnetwork usage will be rejected.\"\n  desc  \"rationale\", \"With a default accept policy the firewall will accept any\npacket that is not configured to be denied. It is easier to white list\nacceptable usage than to black list unacceptable usage.\"\n  desc  \"check\", \"\n    Run the following command and verify that the policy for the `INPUT` ,\n`OUTPUT` , and `FORWARD` chains is `DROP` or `REJECT` :\n\n    ```\n    # iptables -L\n    Chain INPUT (policy DROP)\n    Chain FORWARD (policy DROP)\n    Chain OUTPUT (policy DROP)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to implement a default DROP policy:\n\n    ```\n    # iptables -P INPUT DROP\n    # iptables -P OUTPUT DROP\n    # iptables -P FORWARD DROP\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.4.1.1\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.4.1.1.rb",
                "line": 3
            },
            "id": "C-3.5.4.1.1"
        },
        {
            "title": "Ensure mounting of hfsplus filesystems is disabled",
            "desc": "The `hfsplus` filesystem type is a hierarchical filesystem designed to\nreplace `hfs` that allows you to mount Mac OS filesystems.",
            "descriptions": {
                "default": "The `hfsplus` filesystem type is a hierarchical filesystem designed to\nreplace `hfs` that allows you to mount Mac OS filesystems.",
                "rationale": "Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.",
                "check": "Run the following commands and verify the output is as indicated:\n\n```\n# modprobe -n -v hfsplus\n\ninstall /bin/true\n```\n\n```\n# lsmod | grep hfsplus\n\n```",
                "fix": "Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\nExample: `vi /etc/modprobe.d/hfsplus.conf`\n\nand add the following line:\n\n```\ninstall hfsplus /bin/true\n```\n\nRun the following command to unload the `hfsplus` module:\n\n```\n# rmmod hfsplus\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.1.5"
            },
            "code": "control \"C-1.1.1.5\" do\n  title \"Ensure mounting of hfsplus filesystems is disabled\"\n  desc  \"The `hfsplus` filesystem type is a hierarchical filesystem designed to\nreplace `hfs` that allows you to mount Mac OS filesystems.\"\n  desc  \"rationale\", \"Removing support for unneeded filesystem types reduces\nthe local attack surface of the system. If this filesystem type is not needed,\ndisable it.\"\n  desc  \"check\", \"\n    Run the following commands and verify the output is as indicated:\n\n    ```\n    # modprobe -n -v hfsplus\n\n    install /bin/true\n    ```\n\n    ```\n    # lsmod | grep hfsplus\n\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/modprobe.d/` directory ending in .conf\n\n    Example: `vi /etc/modprobe.d/hfsplus.conf`\n\n    and add the following line:\n\n    ```\n    install hfsplus /bin/true\n    ```\n\n    Run the following command to unload the `hfsplus` module:\n\n    ```\n    # rmmod hfsplus\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.1.5\"\n\n  describe kernel_module('hfsplus') do\n    it { should_not be_loaded }\n    it { should be_disabled }\n    it { should be_blacklisted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.1.5.rb",
                "line": 3
            },
            "id": "C-1.1.1.5"
        },
        {
            "title": "Ensure permissions on /etc/cron.d are configured",
            "desc": "The `/etc/cron.d` directory contains system `cron` jobs that need to\nrun in a similar manner to the hourly, daily weekly and monthly jobs from\n`/etc/crontab` , but require more granular control as to when they run. The\nfiles in this directory cannot be manipulated by the `crontab` command, but are\ninstead edited by system administrators using a text editor. The commands below\nrestrict read/write and search access to user and group root, preventing\nregular users from accessing this directory.",
            "descriptions": {
                "default": "The `/etc/cron.d` directory contains system `cron` jobs that need to\nrun in a similar manner to the hourly, daily weekly and monthly jobs from\n`/etc/crontab` , but require more granular control as to when they run. The\nfiles in this directory cannot be manipulated by the `crontab` command, but are\ninstead edited by system administrators using a text editor. The commands below\nrestrict read/write and search access to user and group root, preventing\nregular users from accessing this directory.",
                "rationale": "Granting write access to this directory for\nnon-privileged users could provide them the means for gaining unauthorized\nelevated privileges. Granting read access to this directory could give an\nunprivileged user insight in how to gain elevated privileges or circumvent\nauditing controls.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/cron.d\n\n    Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set ownership and permissions on\n`/etc/cron.d` :\n\n    ```\n    # chown root:root /etc/cron.d\n    ```\n\n    ```\n    # chmod og-rwx /etc/cron.d\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "5.1.7"
            },
            "code": "control \"C-5.1.7\" do\n  title \"Ensure permissions on /etc/cron.d are configured\"\n  desc  \"The `/etc/cron.d` directory contains system `cron` jobs that need to\nrun in a similar manner to the hourly, daily weekly and monthly jobs from\n`/etc/crontab` , but require more granular control as to when they run. The\nfiles in this directory cannot be manipulated by the `crontab` command, but are\ninstead edited by system administrators using a text editor. The commands below\nrestrict read/write and search access to user and group root, preventing\nregular users from accessing this directory.\"\n  desc  \"rationale\", \"Granting write access to this directory for\nnon-privileged users could provide them the means for gaining unauthorized\nelevated privileges. Granting read access to this directory could give an\nunprivileged user insight in how to gain elevated privileges or circumvent\nauditing controls.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` does not grant permissions to `group` or `other` :\n\n    ```\n    # stat /etc/cron.d\n\n    Access: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set ownership and permissions on\n`/etc/cron.d` :\n\n    ```\n    # chown root:root /etc/cron.d\n    ```\n\n    ```\n    # chmod og-rwx /etc/cron.d\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"5.1.7\"\n\n  describe file('/etc/cron.d') do \n    its('owner') { should cmp 'root' }\n    its('group') { should cmp 'root' }\n    it { should be_directory }\n    it { should_not be_more_permissive_than('0700') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.1.7.rb",
                "line": 3
            },
            "id": "C-5.1.7"
        },
        {
            "title": "Ensure LDAP server is not enabled",
            "desc": "The Lightweight Directory Access Protocol (LDAP) was introduced as a\nreplacement for NIS/YP. It is a service that provides a method for looking up\ninformation from a central database.",
            "descriptions": {
                "default": "The Lightweight Directory Access Protocol (LDAP) was introduced as a\nreplacement for NIS/YP. It is a service that provides a method for looking up\ninformation from a central database.",
                "rationale": "If the system will not need to act as an LDAP server, it\nis recommended that the software be disabled to reduce the potential attack\nsurface.",
                "check": "Run the following command to verify `slapd` is not enabled:\n\n```\n# systemctl is-enabled slapd\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run one of the following commands to disable `slapd`:\n\n```\n# systemctl --now disable slapd\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.6"
            },
            "code": "control \"C-2.2.6\" do\n  title \"Ensure LDAP server is not enabled\"\n  desc  \"The Lightweight Directory Access Protocol (LDAP) was introduced as a\nreplacement for NIS/YP. It is a service that provides a method for looking up\ninformation from a central database.\"\n  desc  \"rationale\", \"If the system will not need to act as an LDAP server, it\nis recommended that the software be disabled to reduce the potential attack\nsurface.\"\n  desc  \"check\", \"\n    Run the following command to verify `slapd` is not enabled:\n\n    ```\n    # systemctl is-enabled slapd\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run one of the following commands to disable `slapd`:\n\n    ```\n    # systemctl --now disable slapd\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.6\"\n\n  if package('slapd').installed?\n    describe service('slapd') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n  else\n    impact 0.0\n    describe \"The Lightweight Directory Access Protocol (LDAP) Server package is not installed\" do\n      skip \"The Lightweight Directory Access Protocol (LDAP) Server package is not installed, this control is Not Applicable.\"\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.6.rb",
                "line": 3
            },
            "id": "C-2.2.6"
        },
        {
            "title": "Ensure iptables are flushed",
            "desc": "nftables is a replacement for iptables, ip6tables, ebtables and\narptables",
            "descriptions": {
                "default": "nftables is a replacement for iptables, ip6tables, ebtables and\narptables",
                "rationale": "It is possible to mix iptables and nftables. However,\nthis increases complexity and also the chance to introduce errors. For\nsimplicity flush out all iptables rules, and ensure it is not loaded",
                "check": "Run the following commands to ensure no iptables rules exist\n\nFor iptables:\n\n```\n# iptables -L\n```\n\nNo rules shoulb be returned\n\nFor ip6tables:\n\n```\n# ip6tables -L\n```\n\nNo rules should be returned",
                "fix": "Run the following commands to flush iptables:\n\nFor iptables:\n\n```\n# iptables -F\n```\n\nFor ip6tables\n\n```\n# ip6tables -F\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.5.3.1"
            },
            "code": "control \"C-3.5.3.1\" do\n  title \"Ensure iptables are flushed\"\n  desc  \"nftables is a replacement for iptables, ip6tables, ebtables and\narptables\"\n  desc  \"rationale\", \"It is possible to mix iptables and nftables. However,\nthis increases complexity and also the chance to introduce errors. For\nsimplicity flush out all iptables rules, and ensure it is not loaded\"\n  desc  \"check\", \"\n    Run the following commands to ensure no iptables rules exist\n\n    For iptables:\n\n    ```\n    # iptables -L\n    ```\n\n    No rules shoulb be returned\n\n    For ip6tables:\n\n    ```\n    # ip6tables -L\n    ```\n\n    No rules should be returned\n  \"\n  desc  \"fix\", \"\n    Run the following commands to flush iptables:\n\n    For iptables:\n\n    ```\n    # iptables -F\n    ```\n\n    For ip6tables\n\n    ```\n    # ip6tables -F\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.5.3.1\"\n\n  iptables_rules = [\"-P INPUT ACCEPT\", \"-P FORWARD ACCEPT\", \"-P OUTPUT ACCEPT\"]\n\n  describe service('iptables') do\n    it { should_not be_enabled }\n    it { should_not be_running }\n  end\n\n  describe  \"IPTables rules shall be flushed and only default \" do\n    iptables.retrieve_rules.each do |rule|\n      subject { rule }\n      it { should be_in iptables_rules }\n    end\n  end\n\n  describe \"IPTables is running\" do\n    subject { service('iptables').running? }\n    it { should_not eq true }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.5.3.1.rb",
                "line": 3
            },
            "id": "C-3.5.3.1"
        },
        {
            "title": "Ensure successful file system mounts are collected",
            "desc": "Monitor the use of the `mount` system call. The `mount` (and `umount`\n) system call controls the mounting and unmounting of file systems. The\nparameters below configure the system to create an audit record when the mount\nsystem call is used by a non-privileged user\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.",
            "descriptions": {
                "default": "Monitor the use of the `mount` system call. The `mount` (and `umount`\n) system call controls the mounting and unmounting of file systems. The\nparameters below configure the system to create an audit record when the mount\nsystem call is used by a non-privileged user\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.",
                "rationale": "It is highly unusual for a non privileged user to `mount`\nfile systems to the system. While tracking `mount` commands gives the system\nadministrator evidence that external media may have been mounted (based on a\nreview of the source of the mount and confirming it's an external media type),\nit does not conclusively indicate that data was exported to the media. System\nadministrators who wish to determine if data were exported, would also have to\ntrack successful `open` , `creat` and `truncate` system calls requiring write\naccess to a file under the mount point of the external media file system. This\ncould give a fair indication that a write occurred. The only way to truly prove\nit, would be to track successful writes to the external media. Tracking write\nsystem calls could quickly fill up the audit log and is not recommended.\nRecommendations on configuration options to track data export to media is\nbeyond the scope of this document.",
                "check": "On a 32 bit system run the following commands:\n\n    ```\n    # grep mounts /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    ```\n\n    ```\n    # auditctl -l | grep mounts\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=-1 -F key=mounts\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep mounts /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    ```\n\n    ```\n    # auditctl -l | grep mounts\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=-1 -F key=mounts\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=-1 -F key=mounts\n    ```",
                "fix": "For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/audit.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/mounts.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.1"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.12"
            },
            "code": "control \"C-4.1.12\" do\n  title \"Ensure successful file system mounts are collected\"\n  desc  \"Monitor the use of the `mount` system call. The `mount` (and `umount`\n) system call controls the mounting and unmounting of file systems. The\nparameters below configure the system to create an audit record when the mount\nsystem call is used by a non-privileged user\n\n    **Note:** Systems may have been customized to change the default UID_MIN.\nTo confirm the UID_MIN for your system, run the following command:\n\n    ```\n    # awk '/^\\\\s*UID_MIN/{print $2}' /etc/login.defs\n    ```\n\n    If your systems' UID_MIN is not 1000, replace audit>=1000 with audit>= in\nthe Audit and Remediation procedures.\n  \"\n  desc  \"rationale\", \"It is highly unusual for a non privileged user to `mount`\nfile systems to the system. While tracking `mount` commands gives the system\nadministrator evidence that external media may have been mounted (based on a\nreview of the source of the mount and confirming it's an external media type),\nit does not conclusively indicate that data was exported to the media. System\nadministrators who wish to determine if data were exported, would also have to\ntrack successful `open` , `creat` and `truncate` system calls requiring write\naccess to a file under the mount point of the external media file system. This\ncould give a fair indication that a write occurred. The only way to truly prove\nit, would be to track successful writes to the external media. Tracking write\nsystem calls could quickly fill up the audit log and is not recommended.\nRecommendations on configuration options to track data export to media is\nbeyond the scope of this document.\"\n  desc  \"check\", \"\n    On a 32 bit system run the following commands:\n\n    ```\n    # grep mounts /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    ```\n\n    ```\n    # auditctl -l | grep mounts\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=-1 -F key=mounts\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep mounts /etc/audit/rules.d/*.rules\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    ```\n\n    ```\n    # auditctl -l | grep mounts\n    ```\n\n    Verify output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=-1 -F key=mounts\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=-1 -F key=mounts\n    ```\n  \"\n  desc  \"fix\", \"\n    For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/audit.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/mounts.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    -a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k\nmounts\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.1\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.12\"\n\n\n  arches = ['b32']\n  if os.arch.match?(/64/)\n    arches.push('b64')\n  end\n\n  syscall = 'mount'\n  arches.each do |a|\n    describe auditd.syscall(syscall).where { arch == a && key == 'mounts'  } do\n      its('action.uniq') { should eq ['always'] }\n      its('list.uniq') { should eq ['exit'] }\n    end\n\n    # the rule states that `auid!=4294967295` but this comes back as `auid!=-1` when queries via `auditctl -l`\n    # this check will allow either.\n    describe.one do\n      describe auditd.syscall(syscall).where { arch == a && key == 'mounts'  } do\n        its('fields.flatten.uniq') {  should include \"auid!=-1\" }\n      end\n      describe auditd.syscall(syscall).where { arch == a && key == 'mounts'  } do\n        its('fields.flatten.uniq') {  should include \"auid!=4294967295\" }\n      end\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.12.rb",
                "line": 3
            },
            "id": "C-4.1.12"
        },
        {
            "title": "Ensure events that modify user/group information are collected",
            "desc": "Record events affecting the `group` , `passwd` (user IDs), `shadow`\nand `gshadow` (passwords) or `/etc/security/opasswd` (old passwords, based on\nremember parameter in the PAM configuration) files. The parameters in this\nsection will watch the files to see if they have been opened for write or have\nhad attribute changes (e.g. permissions) and tag them with the identifier\n\"identity\" in the audit log file.",
            "descriptions": {
                "default": "Record events affecting the `group` , `passwd` (user IDs), `shadow`\nand `gshadow` (passwords) or `/etc/security/opasswd` (old passwords, based on\nremember parameter in the PAM configuration) files. The parameters in this\nsection will watch the files to see if they have been opened for write or have\nhad attribute changes (e.g. permissions) and tag them with the identifier\n\"identity\" in the audit log file.",
                "rationale": "Unexpected changes to these files could be an indication\nthat the system has been compromised and that an unauthorized user is\nattempting to hide their activities or compromise additional accounts.",
                "check": "Run the following commands:\n\n```\n# grep identity /etc/audit/rules.d/*.rules\n```\n\nVerify the output matches:\n\n```\n-w /etc/group -p wa -k identity\n-w /etc/passwd -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\n```\n\n```\n# auditctl -l | grep identity\n```\n\nVerify the output matches:\n\n```\n-w /etc/group -p wa -k identity\n-w /etc/passwd -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\n```",
                "fix": "Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/identity.rules`\n\n    and add the following lines:\n\n    ```\n    -w /etc/group -p wa -k identity\n    -w /etc/passwd -p wa -k identity\n    -w /etc/gshadow -p wa -k identity\n    -w /etc/shadow -p wa -k identity\n    -w /etc/security/opasswd -p wa -k identity\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AC-2 (4)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "4.8"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.4"
            },
            "code": "control \"C-4.1.4\" do\n  title \"Ensure events that modify user/group information are collected\"\n  desc  \"Record events affecting the `group` , `passwd` (user IDs), `shadow`\nand `gshadow` (passwords) or `/etc/security/opasswd` (old passwords, based on\nremember parameter in the PAM configuration) files. The parameters in this\nsection will watch the files to see if they have been opened for write or have\nhad attribute changes (e.g. permissions) and tag them with the identifier\n\\\"identity\\\" in the audit log file.\"\n  desc  \"rationale\", \"Unexpected changes to these files could be an indication\nthat the system has been compromised and that an unauthorized user is\nattempting to hide their activities or compromise additional accounts.\"\n  desc  \"check\", \"\n    Run the following commands:\n\n    ```\n    # grep identity /etc/audit/rules.d/*.rules\n    ```\n\n    Verify the output matches:\n\n    ```\n    -w /etc/group -p wa -k identity\n    -w /etc/passwd -p wa -k identity\n    -w /etc/gshadow -p wa -k identity\n    -w /etc/shadow -p wa -k identity\n    -w /etc/security/opasswd -p wa -k identity\n    ```\n\n    ```\n    # auditctl -l | grep identity\n    ```\n\n    Verify the output matches:\n\n    ```\n    -w /etc/group -p wa -k identity\n    -w /etc/passwd -p wa -k identity\n    -w /etc/gshadow -p wa -k identity\n    -w /etc/shadow -p wa -k identity\n    -w /etc/security/opasswd -p wa -k identity\n    ```\n  \"\n  desc \"fix\", \"\n    Edit or create a file in the `/etc/audit/rules.d/` directory ending in\n`.rules`\n\n    Example: `vi /etc/audit/rules.d/identity.rules`\n\n    and add the following lines:\n\n    ```\n    -w /etc/group -p wa -k identity\n    -w /etc/passwd -p wa -k identity\n    -w /etc/gshadow -p wa -k identity\n    -w /etc/shadow -p wa -k identity\n    -w /etc/security/opasswd -p wa -k identity\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AC-2 (4)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"4.8\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.4\"\n\n  files = [\n    '/etc/group',\n    '/etc/passwd',\n    '/etc/gshadow',\n    '/etc/shadow',\n    '/etc/security/opasswd'\n  ]\n\n  files.each do |file|\n    describe auditd.file(file).where { key == \"identity\" } do\n      its('permissions') { should include ['w', 'a'] }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.4.rb",
                "line": 3
            },
            "id": "C-4.1.4"
        },
        {
            "title": "Ensure broadcast ICMP requests are ignored",
            "desc": "Setting `net.ipv4.icmp_echo_ignore_broadcasts` to 1 will cause the\nsystem to ignore all ICMP echo and timestamp requests to broadcast and\nmulticast addresses.",
            "descriptions": {
                "default": "Setting `net.ipv4.icmp_echo_ignore_broadcasts` to 1 will cause the\nsystem to ignore all ICMP echo and timestamp requests to broadcast and\nmulticast addresses.",
                "rationale": "Accepting ICMP echo and timestamp requests with broadcast\nor multicast destinations for your network could be used to trick your host\ninto starting (or participating) in a Smurf attack. A Smurf attack relies on an\nattacker sending large amounts of ICMP broadcast messages with a spoofed source\naddress. All hosts receiving this message and responding would send echo-reply\nmessages back to the spoofed address, which is probably not routable. If many\nhosts respond to the packets, the amount of traffic on the network could be\nsignificantly multiplied.",
                "check": "Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.icmp_echo_ignore_broadcasts\n\n    net.ipv4.icmp_echo_ignore_broadcasts = 1\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.icmp_echo_ignore_broadcasts\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.icmp_echo_ignore_broadcasts = 1\n    ```",
                "fix": "Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.icmp_echo_ignore_broadcasts = 1\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1\n    ```\n\n    ```\n    # sysctl -w net.ipv4.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.2.5"
            },
            "code": "control \"C-3.2.5\" do\n  title \"Ensure broadcast ICMP requests are ignored\"\n  desc  \"Setting `net.ipv4.icmp_echo_ignore_broadcasts` to 1 will cause the\nsystem to ignore all ICMP echo and timestamp requests to broadcast and\nmulticast addresses.\"\n  desc  \"rationale\", \"Accepting ICMP echo and timestamp requests with broadcast\nor multicast destinations for your network could be used to trick your host\ninto starting (or participating) in a Smurf attack. A Smurf attack relies on an\nattacker sending large amounts of ICMP broadcast messages with a spoofed source\naddress. All hosts receiving this message and responding would send echo-reply\nmessages back to the spoofed address, which is probably not routable. If many\nhosts respond to the packets, the amount of traffic on the network could be\nsignificantly multiplied.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.icmp_echo_ignore_broadcasts\n\n    net.ipv4.icmp_echo_ignore_broadcasts = 1\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.icmp_echo_ignore_broadcasts\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.icmp_echo_ignore_broadcasts = 1\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.icmp_echo_ignore_broadcasts = 1\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1\n    ```\n\n    ```\n    # sysctl -w net.ipv4.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.2.5\"\n\n  describe kernel_parameter('net.ipv4.icmp_echo_ignore_broadcasts') do\n    its('value') { should cmp '1' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.2.5.rb",
                "line": 3
            },
            "id": "C-3.2.5"
        },
        {
            "title": "Ensure IP forwarding is disabled",
            "desc": "The `net.ipv4.ip_forward` and `net.ipv6.conf.all.forwarding` flags are\nused to tell the system whether it can forward packets or not.",
            "descriptions": {
                "default": "The `net.ipv4.ip_forward` and `net.ipv6.conf.all.forwarding` flags are\nused to tell the system whether it can forward packets or not.",
                "rationale": "Setting the flags to 0 ensures that a system with\nmultiple interfaces (for example, a hard proxy), will never be able to forward\npackets, and therefore, never serve as a router.",
                "check": "Run the following command and verify output matches:\n\n    ```\n    # sysctl net.ipv4.ip_forward\n\n    net.ipv4.ip_forward = 0\n    ```\n\n    ```\n    # grep -E -s \"^\\s*net\\.ipv4\\.ip_forward\\s*=\\s*1\" /etc/sysctl.conf\n/etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf\n\n    No value should be returned\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.all.forwarding\n\n    net.ipv6.conf.all.forwarding = 0\n    ```\n\n    ```\n    # grep -E -s \"^\\s*net\\.ipv6\\.conf\\.all\\.forwarding\\s*=\\s*1\"\n/etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf\n/run/sysctl.d/*.conf\n\n    No value should be returned\n    ```",
                "fix": "Run the following commands to restore the default parameters and set the\nactive kernel parameters:\n\n    ```\n    # grep -Els \"^\\s*net\\.ipv4\\.ip_forward\\s*=\\s*1\" /etc/sysctl.conf\n/etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf | while read\nfilename; do sed -ri\n\"s/^\\s*(net\\.ipv4\\.ip_forward\\s*)(=)(\\s*\\S+\\b).*$/# *REMOVED* \\1/\"\n$filename; done; sysctl -w net.ipv4.ip_forward=0; sysctl -w\nnet.ipv4.route.flush=1\n    ```\n\n    ```\n    # grep -Els \"^\\s*net\\.ipv6\\.conf\\.all\\.forwarding\\s*=\\s*1\"\n/etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf\n/run/sysctl.d/*.conf | while read filename; do sed -ri\n\"s/^\\s*(net\\.ipv6\\.conf\\.all\\.forwarding\\s*)(=)(\\s*\\S+\\b).*$/#\n*REMOVED* \\1/\" $filename; done; sysctl -w net.ipv6.conf.all.forwarding=0;\nsysctl -w net.ipv6.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.1.2"
            },
            "code": "control \"C-3.1.2\" do\n  title \"Ensure IP forwarding is disabled\"\n  desc  \"The `net.ipv4.ip_forward` and `net.ipv6.conf.all.forwarding` flags are\nused to tell the system whether it can forward packets or not.\"\n  desc  \"rationale\", \"Setting the flags to 0 ensures that a system with\nmultiple interfaces (for example, a hard proxy), will never be able to forward\npackets, and therefore, never serve as a router.\"\n  desc  \"check\", \"\n    Run the following command and verify output matches:\n\n    ```\n    # sysctl net.ipv4.ip_forward\n\n    net.ipv4.ip_forward = 0\n    ```\n\n    ```\n    # grep -E -s \\\"^\\\\s*net\\\\.ipv4\\\\.ip_forward\\\\s*=\\\\s*1\\\" /etc/sysctl.conf\n/etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf\n\n    No value should be returned\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.all.forwarding\n\n    net.ipv6.conf.all.forwarding = 0\n    ```\n\n    ```\n    # grep -E -s \\\"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.forwarding\\\\s*=\\\\s*1\\\"\n/etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf\n/run/sysctl.d/*.conf\n\n    No value should be returned\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to restore the default parameters and set the\nactive kernel parameters:\n\n    ```\n    # grep -Els \\\"^\\\\s*net\\\\.ipv4\\\\.ip_forward\\\\s*=\\\\s*1\\\" /etc/sysctl.conf\n/etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf | while read\nfilename; do sed -ri\n\\\"s/^\\\\s*(net\\\\.ipv4\\\\.ip_forward\\\\s*)(=)(\\\\s*\\\\S+\\\\b).*$/# *REMOVED* \\\\1/\\\"\n$filename; done; sysctl -w net.ipv4.ip_forward=0; sysctl -w\nnet.ipv4.route.flush=1\n    ```\n\n    ```\n    # grep -Els \\\"^\\\\s*net\\\\.ipv6\\\\.conf\\\\.all\\\\.forwarding\\\\s*=\\\\s*1\\\"\n/etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf\n/run/sysctl.d/*.conf | while read filename; do sed -ri\n\\\"s/^\\\\s*(net\\\\.ipv6\\\\.conf\\\\.all\\\\.forwarding\\\\s*)(=)(\\\\s*\\\\S+\\\\b).*$/#\n*REMOVED* \\\\1/\\\" $filename; done; sysctl -w net.ipv6.conf.all.forwarding=0;\nsysctl -w net.ipv6.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.1.2\"\n\n  describe kernel_parameter('net.ipv4.ip_forward') do\n    its('value') { should cmp '0' }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.all.forwarding') do\n    its('value') { should cmp '0' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.1.2.rb",
                "line": 3
            },
            "id": "C-3.1.2"
        },
        {
            "title": "Ensure permissions on all logfiles are configured",
            "desc": "Log files stored in /var/log/ contain logged information from many\nservices on the system, or on log hosts others as well.",
            "descriptions": {
                "default": "Log files stored in /var/log/ contain logged information from many\nservices on the system, or on log hosts others as well.",
                "rationale": "It is important to ensure that log files have the correct\npermissions to ensure that sensitive data is archived and protected.",
                "check": "Run the following command and verify that other has no permissions on any\nfiles and group does not have write or execute permissions on any files:\n\n    ```\n    # find /var/log -type f -ls\n    ```",
                "fix": "Run the following commands to set permissions on all existing log files:\n\n    ```\n    find /var/log -type f -exec chmod g-wx,o-rwx \"{}\" + -o -type d -exec\nchmod g-w,o-rwx \"{}\" +\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-1",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "13",
                    "Rev_7"
                ],
                "cis_rid": "4.2.3"
            },
            "code": "control \"C-4.2.3\" do\n  title \"Ensure permissions on all logfiles are configured\"\n  desc  \"Log files stored in /var/log/ contain logged information from many\nservices on the system, or on log hosts others as well.\"\n  desc  \"rationale\", \"It is important to ensure that log files have the correct\npermissions to ensure that sensitive data is archived and protected.\"\n  desc  \"check\", \"\n    Run the following command and verify that other has no permissions on any\nfiles and group does not have write or execute permissions on any files:\n\n    ```\n    # find /var/log -type f -ls\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set permissions on all existing log files:\n\n    ```\n    find /var/log -type f -exec chmod g-wx,o-rwx \\\"{}\\\" + -o -type d -exec\nchmod g-w,o-rwx \\\"{}\\\" +\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-1\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"13\", \"Rev_7\"]\n  tag cis_rid: \"4.2.3\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.2.3.rb",
                "line": 3
            },
            "id": "C-4.2.3"
        },
        {
            "title": "Ensure SSH PermitUserEnvironment is disabled",
            "desc": "The `PermitUserEnvironment` option allows users to present environment\noptions to the `ssh` daemon.",
            "descriptions": {
                "default": "The `PermitUserEnvironment` option allows users to present environment\noptions to the `ssh` daemon.",
                "rationale": "Permitting users the ability to set environment variables\nthrough the SSH daemon could potentially allow users to bypass security\ncontrols (e.g. setting an execution path that has `ssh` executing trojan'd\nprograms)",
                "check": "Run the following command and verify that output matches:\n\n```\n# sshd -T | grep permituserenvironment\n\nPermitUserEnvironment no\n```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nPermitUserEnvironment no\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_rid": "5.2.12",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.12\" do\n  title \"Ensure SSH PermitUserEnvironment is disabled\"\n  desc  \"The `PermitUserEnvironment` option allows users to present environment\noptions to the `ssh` daemon.\"\n  desc  \"rationale\", \"Permitting users the ability to set environment variables\nthrough the SSH daemon could potentially allow users to bypass security\ncontrols (e.g. setting an execution path that has `ssh` executing trojan'd\nprograms)\"\n  desc  \"check\", \"\n    Run the following command and verify that output matches:\n\n    ```\n    # sshd -T | grep permituserenvironment\n\n    PermitUserEnvironment no\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    PermitUserEnvironment no\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_rid: \"5.2.12\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('PermitUserEnvironment') { should cmp 'no' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.12.rb",
                "line": 3
            },
            "id": "C-5.2.12"
        },
        {
            "title": "Ensure rsyslog is configured to send logs to a remote log host",
            "desc": "The `rsyslog` utility supports the ability to send logs it gathers to\na remote log host running `syslogd(8)` or to receive messages from remote\nhosts, reducing administrative overhead.",
            "descriptions": {
                "default": "The `rsyslog` utility supports the ability to send logs it gathers to\na remote log host running `syslogd(8)` or to receive messages from remote\nhosts, reducing administrative overhead.",
                "rationale": "Storing log data on a remote host protects log integrity\nfrom local attacks. If an attacker gains root access on the local system, they\ncould tamper with or remove log data that is stored on the local system",
                "check": "Review the `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf` files and verify\nthat logs are sent to a central host.\n\n    ```\n    # grep -E \"^[^#](\\s*\\S+\\s*)\\s*action\\(\" /etc/rsyslog.conf\n/etc/rsyslog.d/*.conf | grep \"target=\"\n    ```\n\n    Output should include `target=`\n\n    **OR**\n\n    ```\n    # grep -E \"^[^#]\\s*\\S+\\.\\*\\s+@\" /etc/rsyslog.conf\n/etc/rsyslog.d/*.conf\n    ```\n\n    Output should include either the FQDN or the IP of the remote loghost",
                "fix": "Edit the `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf` files and add one\nof the following lines:\n\n    Newer syntax:\n\n    ```\n     action(type=\"omfwd\" target=\"\" port=\"\n\n    \t\" protocol=\"tcp\"\n     action.resumeRetryCount=\"\"\n     queue.type=\"linkList\" queue.size=\")\n    ```\n\n    **Example:**\n\n    ```\n    *.* action(type=\"omfwd\" target=\"192.168.2.100\" port\"514\"\nprotocol=\"tcp\"\n     action.resumeRetryCount=\"100\"\n     queue.type=\"linkList\" queue.size=\"1000\")\n    ```\n\n    Older syntax:\n\n    ```\n    *.* @@\n    ```\n\n    **Example:**\n\n    ```\n    *.* @@192.168.2.100\n    ```\n\n    Run the following command to reload the `rsyslog` configuration:\n\n    ```\n    # systemctl reload rsyslog\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SI-4 (2)",
                    "SI-4 (2)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.6",
                    "6.8",
                    "Rev_7"
                ],
                "cis_rid": "4.2.1.5"
            },
            "code": "control \"C-4.2.1.5\" do\n  title \"Ensure rsyslog is configured to send logs to a remote log host\"\n  desc  \"The `rsyslog` utility supports the ability to send logs it gathers to\na remote log host running `syslogd(8)` or to receive messages from remote\nhosts, reducing administrative overhead.\"\n  desc  \"rationale\", \"Storing log data on a remote host protects log integrity\nfrom local attacks. If an attacker gains root access on the local system, they\ncould tamper with or remove log data that is stored on the local system\"\n  desc  \"check\", \"\n    Review the `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf` files and verify\nthat logs are sent to a central host.\n\n    ```\n    # grep -E \\\"^[^#](\\\\s*\\\\S+\\\\s*)\\\\s*action\\\\(\\\" /etc/rsyslog.conf\n/etc/rsyslog.d/*.conf | grep \\\"target=\\\"\n    ```\n\n    Output should include `target=`\n\n    **OR**\n\n    ```\n    # grep -E \\\"^[^#]\\\\s*\\\\S+\\\\.\\\\*\\\\s+@\\\" /etc/rsyslog.conf\n/etc/rsyslog.d/*.conf\n    ```\n\n    Output should include either the FQDN or the IP of the remote loghost\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf` files and add one\nof the following lines:\n\n    Newer syntax:\n\n    ```\n     action(type=\\\"omfwd\\\" target=\\\"\\\" port=\\\"\n\n    \\t\\\" protocol=\\\"tcp\\\"\n     action.resumeRetryCount=\\\"\\\"\n     queue.type=\\\"linkList\\\" queue.size=\\\")\n    ```\n\n    **Example:**\n\n    ```\n    *.* action(type=\\\"omfwd\\\" target=\\\"192.168.2.100\\\" port\\\"514\\\"\nprotocol=\\\"tcp\\\"\n     action.resumeRetryCount=\\\"100\\\"\n     queue.type=\\\"linkList\\\" queue.size=\\\"1000\\\")\n    ```\n\n    Older syntax:\n\n    ```\n    *.* @@\n    ```\n\n    **Example:**\n\n    ```\n    *.* @@192.168.2.100\n    ```\n\n    Run the following command to reload the `rsyslog` configuration:\n\n    ```\n    # systemctl reload rsyslog\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SI-4 (2)\", \"SI-4 (2)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.6\", \"6.8\", \"Rev_7\"]\n  tag cis_rid: \"4.2.1.5\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.2.1.5.rb",
                "line": 3
            },
            "id": "C-4.2.1.5"
        },
        {
            "title": "Ensure no legacy \"+\" entries exist in /etc/passwd",
            "desc": "The character + in various files used to be markers for systems to\ninsert data from NIS maps at a certain point in a system configuration file.\nThese entries are no longer required on most systems, but may exist in files\nthat have been imported from other platforms.",
            "descriptions": {
                "default": "The character + in various files used to be markers for systems to\ninsert data from NIS maps at a certain point in a system configuration file.\nThese entries are no longer required on most systems, but may exist in files\nthat have been imported from other platforms.",
                "rationale": "These entries may provide an avenue for attackers to gain\nprivileged access on the system.",
                "check": "Run the following command and verify that no output is returned:\n\n```\n# grep '^\\+:' /etc/passwd\n```",
                "fix": "Remove any legacy '+' entries from `/etc/passwd` if they exist."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-2"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.2"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.2"
            },
            "code": "control \"C-6.2.2\" do\n  title \"Ensure no legacy \\\"+\\\" entries exist in /etc/passwd\"\n  desc  \"The character + in various files used to be markers for systems to\ninsert data from NIS maps at a certain point in a system configuration file.\nThese entries are no longer required on most systems, but may exist in files\nthat have been imported from other platforms.\"\n  desc  \"rationale\", \"These entries may provide an avenue for attackers to gain\nprivileged access on the system.\"\n  desc  \"check\", \"\n    Run the following command and verify that no output is returned:\n\n    ```\n    # grep '^\\\\+:' /etc/passwd\n    ```\n  \"\n  desc \"fix\", \"Remove any legacy '+' entries from `/etc/passwd` if they exist.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-2\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.2\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.2\"\n\n  describe command(\"grep '^\\\\+:' /etc/passwd\").stdout.strip do\n    it { should be_empty }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.2.rb",
                "line": 3
            },
            "id": "C-6.2.2"
        },
        {
            "title": "Ensure nodev option set on /tmp partition",
            "desc": "The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.",
            "descriptions": {
                "default": "The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.",
                "rationale": "Since the `/tmp` filesystem is not intended to support\ndevices, set this option to ensure that users cannot attempt to create block or\ncharacter special devices in `/tmp` .",
                "check": "Verify that the `nodev` option is set if a `/tmp` partition exists\n\nRun the following command and verify that nothing is returned:\n\n```\n# mount | grep -E '\\s/tmp\\s' | grep -v nodev\n```",
                "fix": "Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting\noptions) for the `/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/tmp` :\n\n    ```\n    # mount -o remount,nodev /tmp\n    ```\n\n    **OR** If systemd `tmp.mount` is configured:\n\n    Edit `/etc/systemd/system/local-fs.target.wants/tmp.mount` to add `nodev`\nto the `/tmp` mount options:\n\n    ```\n    [Mount]\n    Options=mode=1777,strictatime,noexec,nodev,nosuid\n    ```\n\n    Run the following command to remount `/tmp` :\n\n    ```\n    # mount -o remount,nodev /tmp\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.3"
            },
            "code": "control \"C-1.1.3\" do\n  title \"Ensure nodev option set on /tmp partition\"\n  desc  \"The `nodev` mount option specifies that the filesystem cannot contain\nspecial devices.\"\n  desc  \"rationale\", \"Since the `/tmp` filesystem is not intended to support\ndevices, set this option to ensure that users cannot attempt to create block or\ncharacter special devices in `/tmp` .\"\n  desc  \"check\", \"\n    Verify that the `nodev` option is set if a `/tmp` partition exists\n\n    Run the following command and verify that nothing is returned:\n\n    ```\n    # mount | grep -E '\\\\s/tmp\\\\s' | grep -v nodev\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/fstab` file and add `nodev` to the fourth field (mounting\noptions) for the `/tmp` partition. See the `fstab(5)` manual page for more\ninformation.\n\n    Run the following command to remount `/tmp` :\n\n    ```\n    # mount -o remount,nodev /tmp\n    ```\n\n    **OR** If systemd `tmp.mount` is configured:\n\n    Edit `/etc/systemd/system/local-fs.target.wants/tmp.mount` to add `nodev`\nto the `/tmp` mount options:\n\n    ```\n    [Mount]\n    Options=mode=1777,strictatime,noexec,nodev,nosuid\n    ```\n\n    Run the following command to remount `/tmp` :\n\n    ```\n    # mount -o remount,nodev /tmp\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.3\"\n\n  describe mount('/tmp') do\n    its('options') { should include 'nodev' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.3.rb",
                "line": 3
            },
            "id": "C-1.1.3"
        },
        {
            "title": "Ensure permissions on /etc/group are configured",
            "desc": "The `/etc/group` file contains a list of all the valid groups defined\nin the system. The command below allows read/write access for root and read\naccess for everyone else.",
            "descriptions": {
                "default": "The `/etc/group` file contains a list of all the valid groups defined\nin the system. The command below allows read/write access for root and read\naccess for everyone else.",
                "rationale": "The `/etc/group` file needs to be protected from\nunauthorized changes by non-privileged users, but needs to be readable as this\ninformation is used with many non-privileged programs.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` :\n\n    ```\n    # stat /etc/group\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following command to set permissions on `/etc/group` :\n\n```\n# chown root:root /etc/group\n\n# chmod 644 /etc/group\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-28"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.5"
            },
            "code": "control \"C-6.1.5\" do\n  title \"Ensure permissions on /etc/group are configured\"\n  desc  \"The `/etc/group` file contains a list of all the valid groups defined\nin the system. The command below allows read/write access for root and read\naccess for everyone else.\"\n  desc  \"rationale\", \"The `/etc/group` file needs to be protected from\nunauthorized changes by non-privileged users, but needs to be readable as this\ninformation is used with many non-privileged programs.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` :\n\n    ```\n    # stat /etc/group\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to set permissions on `/etc/group` :\n\n    ```\n    # chown root:root /etc/group\n\n    # chmod 644 /etc/group\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-28\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.5\"\n\n  describe file('/etc/group') do\n    it { should_not be_more_permissive_than('0644') }\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.5.rb",
                "line": 3
            },
            "id": "C-6.1.5"
        },
        {
            "title": "Ensure journald is configured to compress large log files",
            "desc": "The journald system includes the capability of compressing overly\nlarge files to avoid filling up the system with logs or making the logs\nunmanageably large.",
            "descriptions": {
                "default": "The journald system includes the capability of compressing overly\nlarge files to avoid filling up the system with logs or making the logs\nunmanageably large.",
                "rationale": "Uncompressed large files may unexpectedly fill a\nfilesystem leading to resource unavailability. Compressing logs prior to write\ncan prevent sudden, unexpected filesystem impacts.",
                "check": "Review `/etc/systemd/journald.conf` and verify that large files will be\ncompressed:\n\n    ```\n    # grep -E -i \"^\\s*Compress\" /etc/systemd/journald.conf\n\n    Compress=yes\n    ```",
                "fix": "Edit the `/etc/systemd/journald.conf` file and add the following line:\n\n```\nCompress=yes\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-4",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.4",
                    "Rev_7"
                ],
                "cis_rid": "4.2.2.2"
            },
            "code": "control \"C-4.2.2.2\" do\n  title \"Ensure journald is configured to compress large log files\"\n  desc  \"The journald system includes the capability of compressing overly\nlarge files to avoid filling up the system with logs or making the logs\nunmanageably large.\"\n  desc  \"rationale\", \"Uncompressed large files may unexpectedly fill a\nfilesystem leading to resource unavailability. Compressing logs prior to write\ncan prevent sudden, unexpected filesystem impacts.\"\n  desc  \"check\", \"\n    Review `/etc/systemd/journald.conf` and verify that large files will be\ncompressed:\n\n    ```\n    # grep -E -i \\\"^\\\\s*Compress\\\" /etc/systemd/journald.conf\n\n    Compress=yes\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/systemd/journald.conf` file and add the following line:\n\n    ```\n    Compress=yes\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-4\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.4\", \"Rev_7\"]\n  tag cis_rid: \"4.2.2.2\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.2.2.2.rb",
                "line": 3
            },
            "id": "C-4.2.2.2"
        },
        {
            "title": "Ensure default user shell timeout is 900 seconds or less",
            "desc": "The default `TMOUT` determines the shell timeout for users. The TMOUT\nvalue is measured in seconds.",
            "descriptions": {
                "default": "The default `TMOUT` determines the shell timeout for users. The TMOUT\nvalue is measured in seconds.",
                "rationale": "Having no timeout value associated with a shell could\nallow an unauthorized user access to another user's shell session (e.g. user\nwalks away from their computer and doesn't lock the screen). Setting a timeout\nvalue at least reduces the risk of this happening.",
                "check": "Run the following commands and verify all TMOUT lines returned are 900 or\nless and at least one exists in each file.\n\n    ```\n    # grep -E -i\n\"^\\s*(\\S+\\s+)*TMOUT=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9])\\s*(\\S+\\s*)*(\\s+#.*)?$\"\n/etc/bash.bashrc\n\n    readonly TMOUT=900 ; export TMOUT\n    ```\n\n    ```\n    # grep -E -i\n\"^\\s*(\\S+\\s+)*TMOUT=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9])\\s*(\\S+\\s*)*(\\s+#.*)?$\"\n/etc/profile /etc/profile.d/*.sh\n\n    readonly TMOUT=900 ; export TMOUT\n    ```",
                "fix": "Edit the `/etc/bashrc`, `/etc/profile` and `/etc/profile.d/*.sh` files (and\nthe appropriate files for any other shell supported on your system) and add or\nedit any TMOUT parameters in accordance with site policy:\n\n    ```\n    readonly TMOUT=900 ; export TMOUT\n    ```\n\n    **Note:** setting the value to `readonly` prevents unwanted modification\nduring runtime."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-11",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.11",
                    "Rev_7"
                ],
                "cis_rid": "5.4.5"
            },
            "code": "control \"C-5.4.5\" do\n  title \"Ensure default user shell timeout is 900 seconds or less\"\n  desc  \"The default `TMOUT` determines the shell timeout for users. The TMOUT\nvalue is measured in seconds.\"\n  desc  \"rationale\", \"Having no timeout value associated with a shell could\nallow an unauthorized user access to another user's shell session (e.g. user\nwalks away from their computer and doesn't lock the screen). Setting a timeout\nvalue at least reduces the risk of this happening.\"\n  desc  \"check\", \"\n    Run the following commands and verify all TMOUT lines returned are 900 or\nless and at least one exists in each file.\n\n    ```\n    # grep -E -i\n\\\"^\\\\s*(\\\\S+\\\\s+)*TMOUT=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9])\\\\s*(\\\\S+\\\\s*)*(\\\\s+#.*)?$\\\"\n/etc/bash.bashrc\n\n    readonly TMOUT=900 ; export TMOUT\n    ```\n\n    ```\n    # grep -E -i\n\\\"^\\\\s*(\\\\S+\\\\s+)*TMOUT=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9])\\\\s*(\\\\S+\\\\s*)*(\\\\s+#.*)?$\\\"\n/etc/profile /etc/profile.d/*.sh\n\n    readonly TMOUT=900 ; export TMOUT\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/bashrc`, `/etc/profile` and `/etc/profile.d/*.sh` files (and\nthe appropriate files for any other shell supported on your system) and add or\nedit any TMOUT parameters in accordance with site policy:\n\n    ```\n    readonly TMOUT=900 ; export TMOUT\n    ```\n\n    **Note:** setting the value to `readonly` prevents unwanted modification\nduring runtime.\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-11\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.11\", \"Rev_7\"]\n  tag cis_rid: \"5.4.5\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.4.5.rb",
                "line": 3
            },
            "id": "C-5.4.5"
        },
        {
            "title": "Ensure permissions on /etc/hosts.allow are configured",
            "desc": "The `/etc/hosts.allow` file contains networking information that is\nused by many applications and therefore must be readable for these applications\nto operate.",
            "descriptions": {
                "default": "The `/etc/hosts.allow` file contains networking information that is\nused by many applications and therefore must be readable for these applications\nto operate.",
                "rationale": "It is critical to ensure that the `/etc/hosts.allow` file\nis protected from unauthorized write access. Although it is protected by\ndefault, the file permissions could be changed either inadvertently or through\nmalicious actions.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644`:\n\n    ```\n    # stat /etc/hosts.allow\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set permissions on `/etc/hosts.allow`:\n\n```\n# chown root:root /etc/hosts.allow\n# chmod 644 /etc/hosts.allow\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.3.4"
            },
            "code": "control \"C-3.3.4\" do\n  title \"Ensure permissions on /etc/hosts.allow are configured\"\n  desc  \"The `/etc/hosts.allow` file contains networking information that is\nused by many applications and therefore must be readable for these applications\nto operate.\"\n  desc  \"rationale\", \"It is critical to ensure that the `/etc/hosts.allow` file\nis protected from unauthorized write access. Although it is protected by\ndefault, the file permissions could be changed either inadvertently or through\nmalicious actions.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644`:\n\n    ```\n    # stat /etc/hosts.allow\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set permissions on `/etc/hosts.allow`:\n\n    ```\n    # chown root:root /etc/hosts.allow\n    # chmod 644 /etc/hosts.allow\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.3.4\"\n\n  describe file('/etc/hosts.allow') do\n    it { should be_owned_by 'root' }\n    it { should_not be_more_permissive_than('0644') }\n    it { should be_more_permissive_than('0000') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.3.4.rb",
                "line": 3
            },
            "id": "C-3.3.4"
        },
        {
            "title": "Ensure all AppArmor Profiles are enforcing",
            "desc": "AppArmor profiles define what resources applications are able to\naccess.",
            "descriptions": {
                "default": "AppArmor profiles define what resources applications are able to\naccess.",
                "rationale": "Security configuration requirements vary from site to\nsite. Some sites may mandate a policy that is stricter than the default policy,\nwhich is perfectly acceptable. This item is intended to ensure that any\npolicies that exist on the system are activated.",
                "check": "Run the following command and verify that profiles are loaded, no profiles\nare in complain mode, and no processes are unconfined:\n\n    ```\n    # apparmor_status\n    apparmor module is loaded.\n    17 profiles are loaded.\n    17 profiles are in enforce mode.\n     /bin/ping\n     /sbin/klogd\n     /sbin/syslog-ng\n     /sbin/syslogd\n     /usr/lib/PolicyKit/polkit-explicit-grant-helper\n     /usr/lib/PolicyKit/polkit-grant-helper\n     /usr/lib/PolicyKit/polkit-grant-helper-pam\n     /usr/lib/PolicyKit/polkit-read-auth-helper\n     /usr/lib/PolicyKit/polkit-resolve-exe-helper\n     /usr/lib/PolicyKit/polkit-revoke-helper\n     /usr/lib/PolicyKit/polkitd\n     /usr/sbin/avahi-daemon\n     /usr/sbin/identd\n     /usr/sbin/mdnsd\n     /usr/sbin/nscd\n     /usr/sbin/ntpd\n     /usr/sbin/traceroute\n    0 profiles are in complain mode.\n    1 processes have profiles defined.\n    1 processes are in enforce mode :\n     /usr/sbin/nscd (3979)\n    0 processes are in complain mode.\n    0 processes are unconfined but have a profile defined.\n    ```",
                "fix": "Run the following command to set all profiles to enforce mode:\n\n    ```\n    # aa-enforce /etc/apparmor.d/*\n    ```\n\n    Any unconfined processes may need to have a profile created or activated\nfor them and then be restarted."
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-3 (3)",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "14.6",
                    "Rev_7"
                ],
                "cis_rid": "1.7.1.4"
            },
            "code": "control \"C-1.7.1.4\" do\n  title \"Ensure all AppArmor Profiles are enforcing\"\n  desc  \"AppArmor profiles define what resources applications are able to\naccess.\"\n  desc  \"rationale\", \"Security configuration requirements vary from site to\nsite. Some sites may mandate a policy that is stricter than the default policy,\nwhich is perfectly acceptable. This item is intended to ensure that any\npolicies that exist on the system are activated.\"\n  desc  \"check\", \"\n    Run the following command and verify that profiles are loaded, no profiles\nare in complain mode, and no processes are unconfined:\n\n    ```\n    # apparmor_status\n    apparmor module is loaded.\n    17 profiles are loaded.\n    17 profiles are in enforce mode.\n     /bin/ping\n     /sbin/klogd\n     /sbin/syslog-ng\n     /sbin/syslogd\n     /usr/lib/PolicyKit/polkit-explicit-grant-helper\n     /usr/lib/PolicyKit/polkit-grant-helper\n     /usr/lib/PolicyKit/polkit-grant-helper-pam\n     /usr/lib/PolicyKit/polkit-read-auth-helper\n     /usr/lib/PolicyKit/polkit-resolve-exe-helper\n     /usr/lib/PolicyKit/polkit-revoke-helper\n     /usr/lib/PolicyKit/polkitd\n     /usr/sbin/avahi-daemon\n     /usr/sbin/identd\n     /usr/sbin/mdnsd\n     /usr/sbin/nscd\n     /usr/sbin/ntpd\n     /usr/sbin/traceroute\n    0 profiles are in complain mode.\n    1 processes have profiles defined.\n    1 processes are in enforce mode :\n     /usr/sbin/nscd (3979)\n    0 processes are in complain mode.\n    0 processes are unconfined but have a profile defined.\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to set all profiles to enforce mode:\n\n    ```\n    # aa-enforce /etc/apparmor.d/*\n    ```\n\n    Any unconfined processes may need to have a profile created or activated\nfor them and then be restarted.\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-3 (3)\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"14.6\", \"Rev_7\"]\n  tag cis_rid: \"1.7.1.4\"\n\n  num_loaded_profiles = inspec.command('apparmor_status | grep \"profiles are loaded.\" | cut -f 1 -d \" \"').stdout.to_i\n  num_enforced_profiles = inspec.command('apparmor_status | grep \"profiles are in enforce mode.\" | cut -f 1 -d \" \"').stdout.to_i\n  num_complain_profiles = inspec.command('apparmor_status | grep \"profiles are in complain mode.\" | cut -f 1 -d \" \"').stdout.to_i\n  num_enforced_and_complain_profiles = num_enforced_profiles + num_complain_profiles\n\n  describe \"AppArmor profiles #{num_loaded_profiles} are loaded\" do\n    it \"and in enforce (found: #{num_enforced_profiles}) and none are in complain mode (found: #{num_complain_profiles})\" do\n      expect(num_loaded_profiles).to eq(num_enforced_profiles)\n    end\n  end\n\n  num_unconfigured_but_defined= inspec.command('apparmor_status | grep \"are unconfined but have a profile defined.\" | cut -f 1 -d \" \"').stdout.to_i\n  describe \"#{num_unconfigured_but_defined} AppArmor Processes\" do\n    it \"have profiles defined, but are unconfigured\" do\n      expect(num_unconfigured_but_defined).to eq(0)\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.7.1.4.rb",
                "line": 3
            },
            "id": "C-1.7.1.4"
        },
        {
            "title": "Ensure source routed packets are not accepted",
            "desc": "In networking, source routing allows a sender to partially or fully\nspecify the route packets take through a network. In contrast, non-source\nrouted packets travel a path determined by routers in the network. In some\ncases, systems may not be routable or reachable from some locations (e.g.\nprivate addresses vs. Internet routable), and so source routed packets would\nneed to be used.",
            "descriptions": {
                "default": "In networking, source routing allows a sender to partially or fully\nspecify the route packets take through a network. In contrast, non-source\nrouted packets travel a path determined by routers in the network. In some\ncases, systems may not be routable or reachable from some locations (e.g.\nprivate addresses vs. Internet routable), and so source routed packets would\nneed to be used.",
                "rationale": "Setting `net.ipv4.conf.all.accept_source_route,\nnet.ipv4.conf.default.accept_source_route,\nnet.ipv6.conf.all.accept_source_route and\nnet.ipv6.conf.default.accept_source_route` to 0 disables the system from\naccepting source routed packets. Assume this system was capable of routing\npackets to Internet routable addresses on one interface and private addresses\non another interface. Assume that the private addresses were not routable to\nthe Internet routable addresses and vice versa. Under normal routing\ncircumstances, an attacker from the Internet routable addresses could not use\nthe system as a way to reach the private address systems. If, however, source\nrouted packets were allowed, they could be used to gain access to the private\naddress systems as the route could be specified, rather than rely on routing\nprotocols that did not allow this routing.",
                "check": "Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.accept_source_route\n\n    net.ipv4.conf.all.accept_source_route = 0\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.accept_source_route\n\n    net.ipv4.conf.default.accept_source_route = 0\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.all\\.accept_source_route\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.accept_source_route= 0\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.default\\.accept_source_route\"\n/etc/sysctl.conf /etc/sysctl.d/*\n\n    net.ipv4.conf.default.accept_source_route= 0\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.all.accept_source_route\n\n    net.ipv6.conf.all.accept_source_route = 0\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.default.accept_source_route\n\n    net.ipv6.conf.default.accept_source_route = 0\n    ```\n\n    ```\n    # grep \"net\\.ipv6\\.conf\\.all\\.accept_source_route\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.accept_source_route= 0\n    ```\n\n    ```\n    # grep \"net\\.ipv6\\.conf\\.default\\.accept_source_route\"\n/etc/sysctl.conf /etc/sysctl.d/*\n\n    net.ipv6.conf.default.accept_source_route= 0\n    ```",
                "fix": "Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.accept_source_route = 0\n    net.ipv4.conf.default.accept_source_route = 0\n    net.ipv6.conf.all.accept_source_route = 0\n    net.ipv6.conf.default.accept_source_route = 0\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.conf.all.accept_source_route=0\n    # sysctl -w net.ipv4.conf.default.accept_source_route=0\n    # sysctl -w net.ipv6.conf.all.accept_source_route=0\n    # sysctl -w net.ipv6.conf.default.accept_source_route=0\n    # sysctl -w net.ipv4.route.flush=1\n    # sysctl -w net.ipv6.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.2.1"
            },
            "code": "control \"C-3.2.1\" do\n  title \"Ensure source routed packets are not accepted\"\n  desc  \"In networking, source routing allows a sender to partially or fully\nspecify the route packets take through a network. In contrast, non-source\nrouted packets travel a path determined by routers in the network. In some\ncases, systems may not be routable or reachable from some locations (e.g.\nprivate addresses vs. Internet routable), and so source routed packets would\nneed to be used.\"\n  desc  \"rationale\", \"Setting `net.ipv4.conf.all.accept_source_route,\nnet.ipv4.conf.default.accept_source_route,\nnet.ipv6.conf.all.accept_source_route and\nnet.ipv6.conf.default.accept_source_route` to 0 disables the system from\naccepting source routed packets. Assume this system was capable of routing\npackets to Internet routable addresses on one interface and private addresses\non another interface. Assume that the private addresses were not routable to\nthe Internet routable addresses and vice versa. Under normal routing\ncircumstances, an attacker from the Internet routable addresses could not use\nthe system as a way to reach the private address systems. If, however, source\nrouted packets were allowed, they could be used to gain access to the private\naddress systems as the route could be specified, rather than rely on routing\nprotocols that did not allow this routing.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.accept_source_route\n\n    net.ipv4.conf.all.accept_source_route = 0\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.accept_source_route\n\n    net.ipv4.conf.default.accept_source_route = 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.all\\\\.accept_source_route\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.accept_source_route= 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.default\\\\.accept_source_route\\\"\n/etc/sysctl.conf /etc/sysctl.d/*\n\n    net.ipv4.conf.default.accept_source_route= 0\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.all.accept_source_route\n\n    net.ipv6.conf.all.accept_source_route = 0\n    ```\n\n    ```\n    # sysctl net.ipv6.conf.default.accept_source_route\n\n    net.ipv6.conf.default.accept_source_route = 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv6\\\\.conf\\\\.all\\\\.accept_source_route\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.accept_source_route= 0\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv6\\\\.conf\\\\.default\\\\.accept_source_route\\\"\n/etc/sysctl.conf /etc/sysctl.d/*\n\n    net.ipv6.conf.default.accept_source_route= 0\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.accept_source_route = 0\n    net.ipv4.conf.default.accept_source_route = 0\n    net.ipv6.conf.all.accept_source_route = 0\n    net.ipv6.conf.default.accept_source_route = 0\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.conf.all.accept_source_route=0\n    # sysctl -w net.ipv4.conf.default.accept_source_route=0\n    # sysctl -w net.ipv6.conf.all.accept_source_route=0\n    # sysctl -w net.ipv6.conf.default.accept_source_route=0\n    # sysctl -w net.ipv4.route.flush=1\n    # sysctl -w net.ipv6.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.2.1\"\n\n  describe kernel_parameter('net.ipv4.conf.all.accept_source_route') do\n    its('value') { should cmp '0' }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.accept_source_route') do\n    its('value') { should cmp '0' }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.all.accept_source_route') do\n    its('value') { should cmp '0' }\n  end\n\n  describe kernel_parameter('net.ipv6.conf.default.accept_source_route') do\n    its('value') { should cmp '0' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.2.1.rb",
                "line": 3
            },
            "id": "C-3.2.1"
        },
        {
            "title": "Audit system file permissions",
            "desc": "The Ubuntu package manager has a number of useful options. One of\nthese, the `--verify` option, can be used to verify that system packages are\ncorrectly installed. The `--verify` option can be used to verify a particular\npackage or to verify all system packages. If no output is returned, the package\nis installed correctly. The following table describes the meaning of output\nfrom the verify option:\n\n    ```\n    Code Meaning\n    S File size differs.\n    M File mode differs (includes permissions and file type).\n    5 The MD5 checksum differs.\n    D The major and minor version numbers differ on a device file.\n    L A mismatch occurs in a link.\n    U The file ownership differs.\n    G The file group owner differs.\n    T The file time (mtime) differs.\n    ```\n\n    The `dpkg -S` command can be used to determine which package a particular\nfile belongs to. For example the following command determines which package the\n`/bin/bash` file belongs to:\n\n    ```\n    # dpkg -S /bin/bash\n\n    bash: /bin/bash\n    ```\n\n    To verify the settings for the package that controls the `/bin/bash` file,\nrun the following:\n\n    ```\n    # dpkg --verify bash\n\n    ??5?????? c /etc/bash.bashrc\n    ```",
            "descriptions": {
                "default": "The Ubuntu package manager has a number of useful options. One of\nthese, the `--verify` option, can be used to verify that system packages are\ncorrectly installed. The `--verify` option can be used to verify a particular\npackage or to verify all system packages. If no output is returned, the package\nis installed correctly. The following table describes the meaning of output\nfrom the verify option:\n\n    ```\n    Code Meaning\n    S File size differs.\n    M File mode differs (includes permissions and file type).\n    5 The MD5 checksum differs.\n    D The major and minor version numbers differ on a device file.\n    L A mismatch occurs in a link.\n    U The file ownership differs.\n    G The file group owner differs.\n    T The file time (mtime) differs.\n    ```\n\n    The `dpkg -S` command can be used to determine which package a particular\nfile belongs to. For example the following command determines which package the\n`/bin/bash` file belongs to:\n\n    ```\n    # dpkg -S /bin/bash\n\n    bash: /bin/bash\n    ```\n\n    To verify the settings for the package that controls the `/bin/bash` file,\nrun the following:\n\n    ```\n    # dpkg --verify bash\n\n    ??5?????? c /etc/bash.bashrc\n    ```",
                "rationale": "It is important to confirm that packaged system files and\ndirectories are maintained with the permissions they were intended to have from\nthe OS vendor.",
                "check": "Run the following command to review all installed packages. Note that this\nmay be very time consuming and may be best scheduled via the `cron` utility. It\nis recommended that the output of this command be redirected to a file that can\nbe reviewed later.\n\n    ```\n    # dpkg --verify\n\n    ```",
                "fix": "Correct any discrepancies found and rerun the audit until\noutput is clean or risk is mitigated or accepted."
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.1"
            },
            "code": "control \"C-6.1.1\" do\n  title \"Audit system file permissions\"\n  desc  \"The Ubuntu package manager has a number of useful options. One of\nthese, the `--verify` option, can be used to verify that system packages are\ncorrectly installed. The `--verify` option can be used to verify a particular\npackage or to verify all system packages. If no output is returned, the package\nis installed correctly. The following table describes the meaning of output\nfrom the verify option:\n\n    ```\n    Code Meaning\n    S File size differs.\n    M File mode differs (includes permissions and file type).\n    5 The MD5 checksum differs.\n    D The major and minor version numbers differ on a device file.\n    L A mismatch occurs in a link.\n    U The file ownership differs.\n    G The file group owner differs.\n    T The file time (mtime) differs.\n    ```\n\n    The `dpkg -S` command can be used to determine which package a particular\nfile belongs to. For example the following command determines which package the\n`/bin/bash` file belongs to:\n\n    ```\n    # dpkg -S /bin/bash\n\n    bash: /bin/bash\n    ```\n\n    To verify the settings for the package that controls the `/bin/bash` file,\nrun the following:\n\n    ```\n    # dpkg --verify bash\n\n    ??5?????? c /etc/bash.bashrc\n    ```\n  \"\n  desc  \"rationale\", \"It is important to confirm that packaged system files and\ndirectories are maintained with the permissions they were intended to have from\nthe OS vendor.\"\n  desc  \"check\", \"\n    Run the following command to review all installed packages. Note that this\nmay be very time consuming and may be best scheduled via the `cron` utility. It\nis recommended that the output of this command be redirected to a file that can\nbe reviewed later.\n\n    ```\n    # dpkg --verify\n\n    ```\n  \"\n  desc \"fix\", \"Correct any discrepancies found and rerun the audit until\noutput is clean or risk is mitigated or accepted.\"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.1\"\n\n  cmd = 'dpkg --verify'\n  describe command('dpkg --verify') do\n    skip \"This control must be reviewed manually. Run `#{cmd}` and review the results.\"\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.1.rb",
                "line": 3
            },
            "id": "C-6.1.1"
        },
        {
            "title": "Ensure SSH MaxStartups is configured",
            "desc": "The `MaxStartups` parameter specifies the maximum number of concurrent\nunauthenticated connections to the SSH daemon.",
            "descriptions": {
                "default": "The `MaxStartups` parameter specifies the maximum number of concurrent\nunauthenticated connections to the SSH daemon.",
                "rationale": "To protect a system from denial of service due to a large\nnumber of pending authentication connection attempts, use the rate limiting\nfunction of MaxStartups to protect availability of sshd logins and prevent\noverwhelming the daemon.",
                "check": "Run the following command and verify that output `MaxStartups` is\n`10:30:60` or matches site policy:\n\n    ```\n    # sshd -T | grep -i maxstartups\n\n    # MaxStartups 10:30:60\n    ```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nmaxstartups 10:30:60\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_rid": "5.2.22",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.22\" do\n  title \"Ensure SSH MaxStartups is configured\"\n  desc  \"The `MaxStartups` parameter specifies the maximum number of concurrent\nunauthenticated connections to the SSH daemon.\"\n  desc  \"rationale\", \"To protect a system from denial of service due to a large\nnumber of pending authentication connection attempts, use the rate limiting\nfunction of MaxStartups to protect availability of sshd logins and prevent\noverwhelming the daemon.\"\n  desc  \"check\", \"\n    Run the following command and verify that output `MaxStartups` is\n`10:30:60` or matches site policy:\n\n    ```\n    # sshd -T | grep -i maxstartups\n\n    # MaxStartups 10:30:60\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    maxstartups 10:30:60\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_rid: \"5.2.22\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('MaxStartups') { should cmp '10:30:60' }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.22.rb",
                "line": 3
            },
            "id": "C-5.2.22"
        },
        {
            "title": "Ensure no duplicate user names exist",
            "desc": "Although the `useradd` program will not let you create a duplicate\nuser name, it is possible for an administrator to manually edit the\n`/etc/passwd` file and change the user name.",
            "descriptions": {
                "default": "Although the `useradd` program will not let you create a duplicate\nuser name, it is possible for an administrator to manually edit the\n`/etc/passwd` file and change the user name.",
                "rationale": "If a user is assigned a duplicate user name, it will\ncreate and have access to files with the first UID for that username in\n`/etc/passwd` . For example, if \"test4\" has a UID of 1000 and a subsequent\n\"test4\" entry has a UID of 2000, logging in as \"test4\" will use UID 1000.\nEffectively, the UID is shared, which is a security problem.",
                "check": "Run the following script and verify no results are returned:\n\n```\n#!/bin/bash\n\ncut -d: -f1 /etc/passwd | sort | uniq -d | while read -r usr; do\n echo \"Duplicate login name \\\"$usr\\\" in /etc/passwd\"\ndone\n```",
                "fix": "Based on the results of the audit script, establish unique user\nnames for the users. File ownerships will automatically reflect the change as\nlong as the users have unique UIDs."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-2"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.18"
            },
            "code": "control \"C-6.2.18\" do\n  title \"Ensure no duplicate user names exist\"\n  desc  \"Although the `useradd` program will not let you create a duplicate\nuser name, it is possible for an administrator to manually edit the\n`/etc/passwd` file and change the user name.\"\n  desc  \"rationale\", \"If a user is assigned a duplicate user name, it will\ncreate and have access to files with the first UID for that username in\n`/etc/passwd` . For example, if \\\"test4\\\" has a UID of 1000 and a subsequent\n\\\"test4\\\" entry has a UID of 2000, logging in as \\\"test4\\\" will use UID 1000.\nEffectively, the UID is shared, which is a security problem.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    cut -d: -f1 /etc/passwd | sort | uniq -d | while read -r usr; do\n     echo \\\"Duplicate login name \\\\\\\"$usr\\\\\\\" in /etc/passwd\\\"\n    done\n    ```\n  \"\n  desc \"fix\", \"Based on the results of the audit script, establish unique user\nnames for the users. File ownerships will automatically reflect the change as\nlong as the users have unique UIDs.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-2\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.18\"\n\n  passwd.entries.each do |u|\n    describe passwd.where { user == u.user } do\n      its('count') { should eq 1 }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.18.rb",
                "line": 3
            },
            "id": "C-6.2.18"
        },
        {
            "title": "Ensure rsyslog is installed",
            "desc": "The `rsyslog` software is a recommended replacement to the original\n`syslogd` daemon which provide improvements over `syslogd`, such as\nconnection-oriented (i.e. TCP) transmission of logs, the option to log to\ndatabase formats, and the encryption of log data en route to a central logging\nserver.",
            "descriptions": {
                "default": "The `rsyslog` software is a recommended replacement to the original\n`syslogd` daemon which provide improvements over `syslogd`, such as\nconnection-oriented (i.e. TCP) transmission of logs, the option to log to\ndatabase formats, and the encryption of log data en route to a central logging\nserver.",
                "rationale": "The security enhancements of `rsyslog` such as\nconnection-oriented (i.e. TCP) transmission of logs, the option to log to\ndatabase formats, and the encryption of log data en route to a central logging\nserver) justify installing and configuring the package.",
                "check": "Verify either rsyslog or syslog-ng is installed. Use the following command\nto provide the needed information:\n\n    ```\n    # dpkg -s rsyslog\n    ```",
                "fix": "Install rsyslog:\n\n```\n# apt install rsyslog\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-12",
                    "AU-3",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.2",
                    "6.3",
                    "Rev_7"
                ],
                "cis_rid": "4.2.1.1"
            },
            "code": "control \"C-4.2.1.1\" do\n  title \"Ensure rsyslog is installed\"\n  desc  \"The `rsyslog` software is a recommended replacement to the original\n`syslogd` daemon which provide improvements over `syslogd`, such as\nconnection-oriented (i.e. TCP) transmission of logs, the option to log to\ndatabase formats, and the encryption of log data en route to a central logging\nserver.\"\n  desc  \"rationale\", \"The security enhancements of `rsyslog` such as\nconnection-oriented (i.e. TCP) transmission of logs, the option to log to\ndatabase formats, and the encryption of log data en route to a central logging\nserver) justify installing and configuring the package.\"\n  desc  \"check\", \"\n    Verify either rsyslog or syslog-ng is installed. Use the following command\nto provide the needed information:\n\n    ```\n    # dpkg -s rsyslog\n    ```\n  \"\n  desc \"fix\", \"\n    Install rsyslog:\n\n    ```\n    # apt install rsyslog\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-12\", \"AU-3\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.2\", \"6.3\", \"Rev_7\"]\n  tag cis_rid: \"4.2.1.1\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.2.1.1.rb",
                "line": 3
            },
            "id": "C-4.2.1.1"
        },
        {
            "title": "Ensure SSH Idle Timeout Interval is configured",
            "desc": "The two options `ClientAliveInterval` and `ClientAliveCountMax`\ncontrol the timeout of ssh sessions. When the `ClientAliveInterval` variable is\nset, ssh sessions that have no activity for the specified length of time are\nterminated. When the `ClientAliveCountMax` variable is set, `sshd` will send\nclient alive messages at every `ClientAliveInterval` interval. When the number\nof consecutive client alive messages are sent with no response from the client,\nthe `ssh` session is terminated. For example, if the `ClientAliveInterval` is\nset to 15 seconds and the `ClientAliveCountMax` is set to 3, the client `ssh`\nsession will be terminated after 45 seconds of idle time.",
            "descriptions": {
                "default": "The two options `ClientAliveInterval` and `ClientAliveCountMax`\ncontrol the timeout of ssh sessions. When the `ClientAliveInterval` variable is\nset, ssh sessions that have no activity for the specified length of time are\nterminated. When the `ClientAliveCountMax` variable is set, `sshd` will send\nclient alive messages at every `ClientAliveInterval` interval. When the number\nof consecutive client alive messages are sent with no response from the client,\nthe `ssh` session is terminated. For example, if the `ClientAliveInterval` is\nset to 15 seconds and the `ClientAliveCountMax` is set to 3, the client `ssh`\nsession will be terminated after 45 seconds of idle time.",
                "rationale": "Having no timeout value associated with a connection could allow an\nunauthorized user access to another user's `ssh` session (e.g. user walks away\nfrom their computer and doesn't lock the screen). Setting a timeout value at\nleast reduces the risk of this happening..\n\n    While the recommended setting is 300 seconds (5 minutes), set this timeout\nvalue based on site policy. The recommended setting for `ClientAliveCountMax`\nis 0. In this case, the client session will be terminated after 5 minutes of\nidle time and no keepalive messages will be sent.",
                "check": "Run the following commands and verify `ClientAliveInterval` is between 1\nand 300 and `ClientAliveCountMax` is 3 or less:\n\n    ```\n    # sshd -T | grep clientaliveinterval\n\n    ClientAliveInterval 300\n    ```\n\n    ```\n    # sshd -T | grep clientalivecountmax\n\n    ClientAliveCountMax 0\n    ```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameters according to\nsite policy:\n\n    ```\n    ClientAliveInterval 300\n\n    ClientAliveCountMax 0\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-11"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.11"
                ],
                "cis_rid": "5.2.16",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.16\" do\n  title \"Ensure SSH Idle Timeout Interval is configured\"\n  desc  \"The two options `ClientAliveInterval` and `ClientAliveCountMax`\ncontrol the timeout of ssh sessions. When the `ClientAliveInterval` variable is\nset, ssh sessions that have no activity for the specified length of time are\nterminated. When the `ClientAliveCountMax` variable is set, `sshd` will send\nclient alive messages at every `ClientAliveInterval` interval. When the number\nof consecutive client alive messages are sent with no response from the client,\nthe `ssh` session is terminated. For example, if the `ClientAliveInterval` is\nset to 15 seconds and the `ClientAliveCountMax` is set to 3, the client `ssh`\nsession will be terminated after 45 seconds of idle time.\"\n  desc  \"rationale\", \"\n    Having no timeout value associated with a connection could allow an\nunauthorized user access to another user's `ssh` session (e.g. user walks away\nfrom their computer and doesn't lock the screen). Setting a timeout value at\nleast reduces the risk of this happening..\n\n    While the recommended setting is 300 seconds (5 minutes), set this timeout\nvalue based on site policy. The recommended setting for `ClientAliveCountMax`\nis 0. In this case, the client session will be terminated after 5 minutes of\nidle time and no keepalive messages will be sent.\n  \"\n  desc  \"check\", \"\n    Run the following commands and verify `ClientAliveInterval` is between 1\nand 300 and `ClientAliveCountMax` is 3 or less:\n\n    ```\n    # sshd -T | grep clientaliveinterval\n\n    ClientAliveInterval 300\n    ```\n\n    ```\n    # sshd -T | grep clientalivecountmax\n\n    ClientAliveCountMax 0\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameters according to\nsite policy:\n\n    ```\n    ClientAliveInterval 300\n\n    ClientAliveCountMax 0\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-11\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.11\"]\n  tag cis_rid: \"5.2.16\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('ClientAliveInterval') { should cmp >= 1 }\n    its('ClientAliveInterval') { should cmp <= 300 }\n    its('ClientAliveCountMax') { should cmp <= 3 }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.16.rb",
                "line": 3
            },
            "id": "C-5.2.16"
        },
        {
            "title": "Ensure separate partition exists for /var/tmp",
            "desc": "The `/var/tmp` directory is a world-writable directory used for\ntemporary storage by all users and some applications.",
            "descriptions": {
                "default": "The `/var/tmp` directory is a world-writable directory used for\ntemporary storage by all users and some applications.",
                "rationale": "Since the `/var/tmp` directory is intended to be\nworld-writable, there is a risk of resource exhaustion if it is not bound to a\nseparate partition. In addition, making `/var/tmp` its own file system allows\nan administrator to set the `noexec` option on the mount, making `/var/tmp`\nuseless for an attacker to install executable code. It would also prevent an\nattacker from establishing a hardlink to a system `setuid` program and wait for\nit to be updated. Once the program was updated, the hardlink would be broken\nand the attacker would have his own copy of the program. If the program\nhappened to have a security vulnerability, the attacker could continue to\nexploit the known flaw.",
                "check": "Run the following command and verify output shows `/var/tmp` is mounted:\n```\n# mount | grep /var/tmp\n on /var/tmp type ext4 (rw,nosuid,nodev,noexec,relatime)\n```",
                "fix": "For new installations, during installation create a custom partition setup\nand specify a separate partition for `/var/tmp` .\n\n    For systems that were previously installed, create a new partition and\nconfigure `/etc/fstab` as appropriate."
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.7"
            },
            "code": "control \"C-1.1.7\" do\n  title \"Ensure separate partition exists for /var/tmp\"\n  desc  \"The `/var/tmp` directory is a world-writable directory used for\ntemporary storage by all users and some applications.\"\n  desc  \"rationale\", \"Since the `/var/tmp` directory is intended to be\nworld-writable, there is a risk of resource exhaustion if it is not bound to a\nseparate partition. In addition, making `/var/tmp` its own file system allows\nan administrator to set the `noexec` option on the mount, making `/var/tmp`\nuseless for an attacker to install executable code. It would also prevent an\nattacker from establishing a hardlink to a system `setuid` program and wait for\nit to be updated. Once the program was updated, the hardlink would be broken\nand the attacker would have his own copy of the program. If the program\nhappened to have a security vulnerability, the attacker could continue to\nexploit the known flaw.\"\n  desc  \"check\", \"\n    Run the following command and verify output shows `/var/tmp` is mounted:\n    ```\n    # mount | grep /var/tmp\n     on /var/tmp type ext4 (rw,nosuid,nodev,noexec,relatime)\n    ```\n  \"\n  desc  \"fix\", \"\n    For new installations, during installation create a custom partition setup\nand specify a separate partition for `/var/tmp` .\n\n    For systems that were previously installed, create a new partition and\nconfigure `/etc/fstab` as appropriate.\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.7\"\n\n  describe mount('/var/tmp') do\n    it { should be_mounted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.7.rb",
                "line": 3
            },
            "id": "C-1.1.7"
        },
        {
            "title": "Ensure root is the only UID 0 account",
            "desc": "Any account with UID 0 has superuser privileges on the system.",
            "descriptions": {
                "default": "Any account with UID 0 has superuser privileges on the system.",
                "rationale": "This access must be limited to only the default `root`\naccount and only from the system console. Administrative access must be through\nan unprivileged account using an approved mechanism as noted in Item 5.6 Ensure\naccess to the su command is restricted.",
                "check": "Run the following command and verify that only \"root\" is returned:\n\n```\n# awk -F: '($3 == 0) { print $1 }' /etc/passwd\n\nroot\n```",
                "fix": "Remove any users other than `root` with UID `0` or assign them\na new UID if appropriate."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-2"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.6"
            },
            "code": "control \"C-6.2.6\" do\n  title \"Ensure root is the only UID 0 account\"\n  desc  \"Any account with UID 0 has superuser privileges on the system.\"\n  desc  \"rationale\", \"This access must be limited to only the default `root`\naccount and only from the system console. Administrative access must be through\nan unprivileged account using an approved mechanism as noted in Item 5.6 Ensure\naccess to the su command is restricted.\"\n  desc  \"check\", \"\n    Run the following command and verify that only \\\"root\\\" is returned:\n\n    ```\n    # awk -F: '($3 == 0) { print $1 }' /etc/passwd\n\n    root\n    ```\n  \"\n  desc \"fix\", \"Remove any users other than `root` with UID `0` or assign them\na new UID if appropriate.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-2\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.6\"\n\n  describe passwd.uids(0) do\n    its('users') { should cmp 'root' }\n    its('count') { should eq 1 }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.6.rb",
                "line": 3
            },
            "id": "C-6.2.6"
        },
        {
            "title": "Ensure no ungrouped files or directories exist",
            "desc": "Sometimes when administrators delete users or groups from the system\nthey neglect to remove all files owned by those users or groups.",
            "descriptions": {
                "default": "Sometimes when administrators delete users or groups from the system\nthey neglect to remove all files owned by those users or groups.",
                "rationale": "A new user who is assigned the deleted user's user ID or\ngroup ID may then end up \"owning\" these files, and thus have more access on\nthe system than was intended.",
                "check": "Run the following command and verify no files are returned:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -nogroup\n    ```\n\n    The command above only searches local filesystems, there may still be\ncompromised items on network mounted partitions. Additionally the `--local`\noption to `df` is not universal to all versions, it can be omitted to search\nall filesystems on a system including network mounted filesystems or the\nfollowing command can be run manually for each partition:\n\n    ```\n    # find\n\n    \t -xdev -nogroup\n    ```",
                "fix": "Locate files that are owned by users or groups not listed in\nthe system configuration files, and reset the ownership of these files to some\nactive user on the system as appropriate."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-8 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "13.2"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.12"
            },
            "code": "control \"C-6.1.12\" do\n  title \"Ensure no ungrouped files or directories exist\"\n  desc  \"Sometimes when administrators delete users or groups from the system\nthey neglect to remove all files owned by those users or groups.\"\n  desc  \"rationale\", \"A new user who is assigned the deleted user's user ID or\ngroup ID may then end up \\\"owning\\\" these files, and thus have more access on\nthe system than was intended.\"\n  desc  \"check\", \"\n    Run the following command and verify no files are returned:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -nogroup\n    ```\n\n    The command above only searches local filesystems, there may still be\ncompromised items on network mounted partitions. Additionally the `--local`\noption to `df` is not universal to all versions, it can be omitted to search\nall filesystems on a system including network mounted filesystems or the\nfollowing command can be run manually for each partition:\n\n    ```\n    # find\n\n    \\t -xdev -nogroup\n    ```\n  \"\n  desc \"fix\", \"Locate files that are owned by users or groups not listed in\nthe system configuration files, and reset the ownership of these files to some\nactive user on the system as appropriate.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-8 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"13.2\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.12\"\n\n  describe command(\"df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -nogroup\") do\n    its('stdout') { should be_empty }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.12.rb",
                "line": 3
            },
            "id": "C-6.1.12"
        },
        {
            "title": "Ensure sudo is installed",
            "desc": "sudo allows a permitted user to execute a command as the superuser or\nanother user, as specified by the security policy. The invoking user's real\n(not effective) user ID is used to determine the user name with which to query\nthe security policy.",
            "descriptions": {
                "default": "sudo allows a permitted user to execute a command as the superuser or\nanother user, as specified by the security policy. The invoking user's real\n(not effective) user ID is used to determine the user name with which to query\nthe security policy.",
                "rationale": "sudo supports a plugin architecture for security policies and input/output\nlogging. Third parties can develop and distribute their own policy and I/O\nlogging plugins to work seamlessly with the sudo front end. The default\nsecurity policy is sudoers, which is configured via the file /etc/sudoers.\n\n    The security policy determines what privileges, if any, a user has to run\nsudo. The policy may require that users authenticate themselves with a password\nor another authentication mechanism. If authentication is required, sudo will\nexit if the user's password is not entered within a configurable time limit.\nThis limit is policy-specific.",
                "check": "Verify that sudo in installed.\n\n    Run the following command and inspect the output to confirm that sudo is\ninstalled:\n\n    ```\n    # dpkg -s sudo\n    ```\n\n    OR\n\n    ```\n    # dpkg -s sudo-ldap\n    ```",
                "fix": "Install sudo using the following command.\n\n```\n# apt install sudo\n```\n\nOR\n\n```\n# apt install sudo-ldap\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-6 (9)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "4.3",
                    "Rev_7"
                ],
                "cis_rid": "1.3.1"
            },
            "code": "control \"C-1.3.1\" do\n  title \"Ensure sudo is installed\"\n  desc  \"sudo allows a permitted user to execute a command as the superuser or\nanother user, as specified by the security policy. The invoking user's real\n(not effective) user ID is used to determine the user name with which to query\nthe security policy.\"\n  desc  \"rationale\", \"\n    sudo supports a plugin architecture for security policies and input/output\nlogging. Third parties can develop and distribute their own policy and I/O\nlogging plugins to work seamlessly with the sudo front end. The default\nsecurity policy is sudoers, which is configured via the file /etc/sudoers.\n\n    The security policy determines what privileges, if any, a user has to run\nsudo. The policy may require that users authenticate themselves with a password\nor another authentication mechanism. If authentication is required, sudo will\nexit if the user's password is not entered within a configurable time limit.\nThis limit is policy-specific.\n  \"\n  desc \"check\", \"\n    Verify that sudo in installed.\n\n    Run the following command and inspect the output to confirm that sudo is\ninstalled:\n\n    ```\n    # dpkg -s sudo\n    ```\n\n    OR\n\n    ```\n    # dpkg -s sudo-ldap\n    ```\n  \"\n  desc \"fix\", \"\n    Install sudo using the following command.\n\n    ```\n    # apt install sudo\n    ```\n\n    OR\n\n    ```\n    # apt install sudo-ldap\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-6 (9)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"4.3\", \"Rev_7\"]\n  tag cis_rid: \"1.3.1\"\n\n  describe package('sudo') do\n    it { should be_installed }\n  end\n\n  describe package('sudo-ldap') do\n    it { should be_installed }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.3.1.rb",
                "line": 3
            },
            "id": "C-1.3.1"
        },
        {
            "title": "Ensure at/cron is restricted to authorized users",
            "desc": "Configure `/etc/cron.allow` and `/etc/at.allow` to allow specific\nusers to use these services. If `/etc/cron.allow` or `/etc/at.allow` do not\nexist, then `/etc/at.deny` and `/etc/cron.deny` are checked. Any user not\nspecifically defined in those files is allowed to use at and cron. By removing\nthe files, only users in `/etc/cron.allow` and `/etc/at.allow` are allowed to\nuse at and cron. Note that even though a given user is not listed in\n`cron.allow` , cron jobs can still be run as that user. The `cron.allow` file\nonly controls administrative access to the crontab command for scheduling and\nmodifying cron jobs.",
            "descriptions": {
                "default": "Configure `/etc/cron.allow` and `/etc/at.allow` to allow specific\nusers to use these services. If `/etc/cron.allow` or `/etc/at.allow` do not\nexist, then `/etc/at.deny` and `/etc/cron.deny` are checked. Any user not\nspecifically defined in those files is allowed to use at and cron. By removing\nthe files, only users in `/etc/cron.allow` and `/etc/at.allow` are allowed to\nuse at and cron. Note that even though a given user is not listed in\n`cron.allow` , cron jobs can still be run as that user. The `cron.allow` file\nonly controls administrative access to the crontab command for scheduling and\nmodifying cron jobs.",
                "rationale": "On many systems, only the system administrator is\nauthorized to schedule `cron` jobs. Using the `cron.allow` file to control who\ncan run `cron` jobs enforces this policy. It is easier to manage an allow list\nthan a deny list. In a deny list, you could potentially add a user ID to the\nsystem and forget to add it to the deny files.",
                "check": "Run the following commands and ensure `/etc/cron.deny` and `/etc/at.deny`\ndo not exist:\n\n    ```\n    # stat /etc/cron.deny\n\n    stat: cannot stat `/etc/cron.deny': No such file or directory\n    ```\n\n    ```\n    # stat /etc/at.deny\n\n    stat: cannot stat` /etc/at.deny': No such file or directory\n    ```\n\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access`, does not grant write or execute to group, and does not grant\npermissions to `other` for both `/etc/cron.allow` and `/etc/at.allow` :\n\n    ```\n    # stat /etc/cron.allow\n\n    Access: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n\n    ```\n    # stat /etc/at.allow\n\n    Access: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to remove `/etc/cron.deny` and `/etc/at.deny`\nand create and set permissions and ownership for `/etc/cron.allow` and\n`/etc/at.allow` :\n\n    ```\n    # rm /etc/cron.deny\n    # rm /etc/at.deny\n\n    # touch /etc/cron.allow\n    # touch /etc/at.allow\n\n    # chmod o-rwx /etc/cron.allow\n    # chmod g-wx /etc/cron.allow\n    # chmod o-rwx /etc/at.allow\n    # chmod g-wx /etc/at.allow\n\n    # chown root:root /etc/cron.allow\n    # chown root:root /etc/at.allow\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-3 (3)"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "5.1.8"
            },
            "code": "control \"C-5.1.8\" do\n  title \"Ensure at/cron is restricted to authorized users\"\n  desc  \"Configure `/etc/cron.allow` and `/etc/at.allow` to allow specific\nusers to use these services. If `/etc/cron.allow` or `/etc/at.allow` do not\nexist, then `/etc/at.deny` and `/etc/cron.deny` are checked. Any user not\nspecifically defined in those files is allowed to use at and cron. By removing\nthe files, only users in `/etc/cron.allow` and `/etc/at.allow` are allowed to\nuse at and cron. Note that even though a given user is not listed in\n`cron.allow` , cron jobs can still be run as that user. The `cron.allow` file\nonly controls administrative access to the crontab command for scheduling and\nmodifying cron jobs.\"\n  desc  \"rationale\", \"On many systems, only the system administrator is\nauthorized to schedule `cron` jobs. Using the `cron.allow` file to control who\ncan run `cron` jobs enforces this policy. It is easier to manage an allow list\nthan a deny list. In a deny list, you could potentially add a user ID to the\nsystem and forget to add it to the deny files.\"\n  desc  \"check\", \"\n    Run the following commands and ensure `/etc/cron.deny` and `/etc/at.deny`\ndo not exist:\n\n    ```\n    # stat /etc/cron.deny\n\n    stat: cannot stat `/etc/cron.deny': No such file or directory\n    ```\n\n    ```\n    # stat /etc/at.deny\n\n    stat: cannot stat` /etc/at.deny': No such file or directory\n    ```\n\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access`, does not grant write or execute to group, and does not grant\npermissions to `other` for both `/etc/cron.allow` and `/etc/at.allow` :\n\n    ```\n    # stat /etc/cron.allow\n\n    Access: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n\n    ```\n    # stat /etc/at.allow\n\n    Access: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to remove `/etc/cron.deny` and `/etc/at.deny`\nand create and set permissions and ownership for `/etc/cron.allow` and\n`/etc/at.allow` :\n\n    ```\n    # rm /etc/cron.deny\n    # rm /etc/at.deny\n\n    # touch /etc/cron.allow\n    # touch /etc/at.allow\n\n    # chmod o-rwx /etc/cron.allow\n    # chmod g-wx /etc/cron.allow\n    # chmod o-rwx /etc/at.allow\n    # chmod g-wx /etc/at.allow\n\n    # chown root:root /etc/cron.allow\n    # chown root:root /etc/at.allow\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-3 (3)\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"5.1.8\"\n\n  describe file('/etc/cron.deny') do \n    it { should_not exist }\n  end\n  \n  describe file('/etc/at.deny') do \n    it { should_not exist }\n  end\n\n  describe file('/etc/cron.allow') do \n    its('owner') { should cmp 'root' }\n    its('group') { should cmp 'root' }\n    it { should_not be_more_permissive_than('0640') }\n  end\n\n  describe file('/etc/at.allow') do \n    its('owner') { should cmp 'root' }\n    its('group') { should cmp 'root' }\n    it { should_not be_more_permissive_than('0640') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.1.8.rb",
                "line": 3
            },
            "id": "C-5.1.8"
        },
        {
            "title": "Ensure FTP Server is not enabled",
            "desc": "The File Transfer Protocol (FTP) provides networked computers with the\nability to transfer files.",
            "descriptions": {
                "default": "The File Transfer Protocol (FTP) provides networked computers with the\nability to transfer files.",
                "rationale": "FTP does not protect the confidentiality of data or\nauthentication credentials. It is recommended SFTP be used if file transfer is\nrequired. Unless there is a need to run the system as a FTP server (for\nexample, to allow anonymous downloads), it is recommended that the package be\ndeleted to reduce the potential attack surface.",
                "check": "Run the following command to verify `vsftpd` is not enabled:\n\n```\n# systemctl is-enabled vsftpd\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run the following command to disable `vsftpd`:\n\n```\n# systemctl --now disable vsftpd\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.9"
            },
            "code": "control \"C-2.2.9\" do\n  title \"Ensure FTP Server is not enabled\"\n  desc  \"The File Transfer Protocol (FTP) provides networked computers with the\nability to transfer files.\"\n  desc  \"rationale\", \"FTP does not protect the confidentiality of data or\nauthentication credentials. It is recommended SFTP be used if file transfer is\nrequired. Unless there is a need to run the system as a FTP server (for\nexample, to allow anonymous downloads), it is recommended that the package be\ndeleted to reduce the potential attack surface.\"\n  desc  \"check\", \"\n    Run the following command to verify `vsftpd` is not enabled:\n\n    ```\n    # systemctl is-enabled vsftpd\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following command to disable `vsftpd`:\n\n    ```\n    # systemctl --now disable vsftpd\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.9\"\n\n  if package('vsftpd').installed? || package('ftpd').installed? || package('gesftpserver').installed? || package('pure-ftpd').installed? || package('proftpd-basic').installed?\n    describe service('vsftpd') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n    describe service('pure-ftpd') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n    describe service('proftpd') do\n      it { should_not be_enabled }\n      it { should_not be_running }\n    end\n    describe package('ftpd') do\n      it { should_not be_installed}\n    end\n    describe package('gesftpserver') do\n      it { should_not be_installed}\n    end\n  else\n    impact 0.0\n    describe \"An FTP Server package is not installed\" do\n      skip \"An FTP Server package is not installed.\"\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.9.rb",
                "line": 3
            },
            "id": "C-2.2.9"
        },
        {
            "title": "Ensure access to the su command is restricted",
            "desc": "The `su` command allows a user to run a command or shell as another\nuser. The program has been superseded by `sudo` , which allows for more\ngranular control over privileged access. Normally, the `su` command can be\nexecuted by any user. By uncommenting the `pam_wheel.so` statement in\n`/etc/pam.d/su` , the `su` command will only allow users in a specific groups\nto execute `su`. This group should be empty to reinforce the use of `sudo` for\nprivileged access.",
            "descriptions": {
                "default": "The `su` command allows a user to run a command or shell as another\nuser. The program has been superseded by `sudo` , which allows for more\ngranular control over privileged access. Normally, the `su` command can be\nexecuted by any user. By uncommenting the `pam_wheel.so` statement in\n`/etc/pam.d/su` , the `su` command will only allow users in a specific groups\nto execute `su`. This group should be empty to reinforce the use of `sudo` for\nprivileged access.",
                "rationale": "Restricting the use of `su` , and using `sudo` in its\nplace, provides system administrators better control of the escalation of user\nprivileges to execute privileged commands. The sudo utility also provides a\nbetter logging and audit mechanism, as it can log each command executed via\n`sudo` , whereas `su` can only record that a user executed the `su` program.",
                "check": "Run the following command and verify the output matches the line:\n\n    ```\n    # grep pam_wheel.so /etc/pam.d/su\n\n    auth required pam_wheel.so use_uid group=\n    ```\n\n    Run the following command and verify that the group specified in ``\ncontains no users:\n\n    ```\n    # grep  /etc/group\n\n    :x::\n    ```\n\n    There should be no users listed after the Group ID field.",
                "fix": "Create an empty group that will be specified for use of the `su` command.\nThe group should be named according to site policy.\n\n    ```\n    groupadd sugroup\n    ```\n\n    Add the following line to the `/etc/pam.d/su` file, specifying the empty\ngroup:\n\n    ```\n    auth required pam_wheel.so use_uid group=sugroup\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "5.6"
            },
            "code": "control \"C-5.6\" do\n  title \"Ensure access to the su command is restricted\"\n  desc  \"The `su` command allows a user to run a command or shell as another\nuser. The program has been superseded by `sudo` , which allows for more\ngranular control over privileged access. Normally, the `su` command can be\nexecuted by any user. By uncommenting the `pam_wheel.so` statement in\n`/etc/pam.d/su` , the `su` command will only allow users in a specific groups\nto execute `su`. This group should be empty to reinforce the use of `sudo` for\nprivileged access.\"\n  desc  \"rationale\", \"Restricting the use of `su` , and using `sudo` in its\nplace, provides system administrators better control of the escalation of user\nprivileges to execute privileged commands. The sudo utility also provides a\nbetter logging and audit mechanism, as it can log each command executed via\n`sudo` , whereas `su` can only record that a user executed the `su` program.\"\n  desc  \"check\", \"\n    Run the following command and verify the output matches the line:\n\n    ```\n    # grep pam_wheel.so /etc/pam.d/su\n\n    auth required pam_wheel.so use_uid group=\n    ```\n\n    Run the following command and verify that the group specified in ``\ncontains no users:\n\n    ```\n    # grep  /etc/group\n\n    :x::\n    ```\n\n    There should be no users listed after the Group ID field.\n  \"\n  desc \"fix\", \"\n    Create an empty group that will be specified for use of the `su` command.\nThe group should be named according to site policy.\n\n    ```\n    groupadd sugroup\n    ```\n\n    Add the following line to the `/etc/pam.d/su` file, specifying the empty\ngroup:\n\n    ```\n    auth required pam_wheel.so use_uid group=sugroup\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"5.6\"\n\n  cmd = command('grep pam_wheel.so /etc/pam.d/su')\n  re = /^\\s*auth\\s*required\\s*pam_wheel.so\\s*use_uid\\s*group=(\\w+)/\n  describe cmd do\n    its('stdout') { should match re }\n  end\n  group_match = cmd.stdout.match(re)\n  if group_match\n    describe group(group_match[1]) do\n      its('members') { should be_empty }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.6.rb",
                "line": 3
            },
            "id": "C-5.6"
        },
        {
            "title": "Ensure package manager repositories are configured",
            "desc": "Systems need to have package manager repositories configured to ensure\nthey receive the latest patches and updates.",
            "descriptions": {
                "default": "Systems need to have package manager repositories configured to ensure\nthey receive the latest patches and updates.",
                "rationale": "If a system's package repositories are misconfigured\nimportant patches may not be identified or a rogue repository could introduce\ncompromised software.",
                "check": "Run the following command and verify package repositories are configured\ncorrectly:\n\n    ```\n    # apt-cache policy\n    ```",
                "fix": "Configure your package manager repositories according to site\npolicy."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SI-2",
                    "SI-2",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "3.4",
                    "3.5",
                    "Rev_7"
                ],
                "cis_rid": "1.2.1"
            },
            "code": "control \"C-1.2.1\" do\n  title \"Ensure package manager repositories are configured\"\n  desc  \"Systems need to have package manager repositories configured to ensure\nthey receive the latest patches and updates.\"\n  desc  \"rationale\", \"If a system's package repositories are misconfigured\nimportant patches may not be identified or a rogue repository could introduce\ncompromised software.\"\n  desc  \"check\", \"\n    Run the following command and verify package repositories are configured\ncorrectly:\n\n    ```\n    # apt-cache policy\n    ```\n  \"\n  desc \"fix\", \"Configure your package manager repositories according to site\npolicy.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SI-2\", \"SI-2\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"3.4\", \"3.5\", \"Rev_7\"]\n  tag cis_rid: \"1.2.1\"\n\n\n\n    describe command('apt-cache policy').stdout.strip.split(\"\\n\") do\n      its('length') { should be > 11 }\n      skip \"Run the following command and verify package repositories are configured\ncorrectly - ```apt-cache policy```. Configure your package manager repositories according to site\npolicy.\"\n    end\n\n\n\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.2.1.rb",
                "line": 3
            },
            "id": "C-1.2.1"
        },
        {
            "title": "Ensure SSH MaxSessions is set to 4 or less",
            "desc": "The `MaxSessions` parameter specifies the maximum number of open\nsessions permitted from a given connection.",
            "descriptions": {
                "default": "The `MaxSessions` parameter specifies the maximum number of open\nsessions permitted from a given connection.",
                "rationale": "To protect a system from denial of service due to a large\nnumber of concurrent sessions, use the rate limiting function of MaxSessions to\nprotect availability of sshd logins and prevent overwhelming the daemon.",
                "check": "Run the following command and verify that output `MaxSessions` is 4 or\nless, or matches site policy:\n\n    ```\n    # sshd -T | grep -i maxsessions\n\n    maxsessions 4\n    ```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nMaxSessions 4\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_rid": "5.2.23",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.23\" do\n  title \"Ensure SSH MaxSessions is set to 4 or less\"\n  desc  \"The `MaxSessions` parameter specifies the maximum number of open\nsessions permitted from a given connection.\"\n  desc  \"rationale\", \"To protect a system from denial of service due to a large\nnumber of concurrent sessions, use the rate limiting function of MaxSessions to\nprotect availability of sshd logins and prevent overwhelming the daemon.\"\n  desc  \"check\", \"\n    Run the following command and verify that output `MaxSessions` is 4 or\nless, or matches site policy:\n\n    ```\n    # sshd -T | grep -i maxsessions\n\n    maxsessions 4\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    MaxSessions 4\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_rid: \"5.2.23\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('MaxSessions') { should cmp <= 4 }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.23.rb",
                "line": 3
            },
            "id": "C-5.2.23"
        },
        {
            "title": "Ensure no duplicate group names exist",
            "desc": "Although the `groupadd` program will not let you create a duplicate\ngroup name, it is possible for an administrator to manually edit the\n`/etc/group` file and change the group name.",
            "descriptions": {
                "default": "Although the `groupadd` program will not let you create a duplicate\ngroup name, it is possible for an administrator to manually edit the\n`/etc/group` file and change the group name.",
                "rationale": "If a group is assigned a duplicate group name, it will\ncreate and have access to files with the first GID for that group in\n`/etc/group` . Effectively, the GID is shared, which is a security problem.",
                "check": "Run the following script and verify no results are returned:\n\n```\n#!/bin/bash\n\ncut -d: -f1 /etc/group | sort | uniq -d | while read -r grp; do\n echo \"Duplicate group name \\\"$grp\\\" exists in /etc/group\"\ndone\n```",
                "fix": "Based on the results of the audit script, establish unique\nnames for the user groups. File group ownerships will automatically reflect the\nchange as long as the groups have unique GIDs."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AC-2"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.19"
            },
            "code": "control \"C-6.2.19\" do\n  title \"Ensure no duplicate group names exist\"\n  desc  \"Although the `groupadd` program will not let you create a duplicate\ngroup name, it is possible for an administrator to manually edit the\n`/etc/group` file and change the group name.\"\n  desc  \"rationale\", \"If a group is assigned a duplicate group name, it will\ncreate and have access to files with the first GID for that group in\n`/etc/group` . Effectively, the GID is shared, which is a security problem.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    cut -d: -f1 /etc/group | sort | uniq -d | while read -r grp; do\n     echo \\\"Duplicate group name \\\\\\\"$grp\\\\\\\" exists in /etc/group\\\"\n    done\n    ```\n  \"\n  desc \"fix\", \"Based on the results of the audit script, establish unique\nnames for the user groups. File group ownerships will automatically reflect the\nchange as long as the groups have unique GIDs.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AC-2\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.19\"\n\n  groups.entries.each do |g|\n    describe groups.where { name == g.name } do\n      its('count') { should eq 1 }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.19.rb",
                "line": 3
            },
            "id": "C-6.2.19"
        },
        {
            "title": "Ensure SSH LoginGraceTime is set to one minute or less",
            "desc": "The `LoginGraceTime` parameter specifies the time allowed for\nsuccessful authentication to the SSH server. The longer the Grace period is the\nmore open unauthenticated connections can exist. Like other session controls in\nthis session the Grace Period should be limited to appropriate organizational\nlimits to ensure the service is available for needed access.",
            "descriptions": {
                "default": "The `LoginGraceTime` parameter specifies the time allowed for\nsuccessful authentication to the SSH server. The longer the Grace period is the\nmore open unauthenticated connections can exist. Like other session controls in\nthis session the Grace Period should be limited to appropriate organizational\nlimits to ensure the service is available for needed access.",
                "rationale": "Setting the `LoginGraceTime` parameter to a low number\nwill minimize the risk of successful brute force attacks to the SSH server. It\nwill also limit the number of concurrent unauthenticated connections While the\nrecommended setting is 60 seconds (1 Minute), set the number based on site\npolicy.",
                "check": "Run the following command and verify that output `LoginGraceTime` is\nbetween 1 and 60:\n\n    ```\n    # sshd -T | grep logingracetime\n\n    LoginGraceTime 60\n    ```",
                "fix": "Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n```\nLoginGraceTime 60\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_rid": "5.2.17",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.17\" do\n  title \"Ensure SSH LoginGraceTime is set to one minute or less\"\n  desc  \"The `LoginGraceTime` parameter specifies the time allowed for\nsuccessful authentication to the SSH server. The longer the Grace period is the\nmore open unauthenticated connections can exist. Like other session controls in\nthis session the Grace Period should be limited to appropriate organizational\nlimits to ensure the service is available for needed access.\"\n  desc  \"rationale\", \"Setting the `LoginGraceTime` parameter to a low number\nwill minimize the risk of successful brute force attacks to the SSH server. It\nwill also limit the number of concurrent unauthenticated connections While the\nrecommended setting is 60 seconds (1 Minute), set the number based on site\npolicy.\"\n  desc  \"check\", \"\n    Run the following command and verify that output `LoginGraceTime` is\nbetween 1 and 60:\n\n    ```\n    # sshd -T | grep logingracetime\n\n    LoginGraceTime 60\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file to set the parameter as follows:\n\n    ```\n    LoginGraceTime 60\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_rid: \"5.2.17\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  describe sshd_config do\n    its('LoginGraceTime') { should cmp >= 1 }\n    its('LoginGraceTime') { should cmp <= 60 }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.17.rb",
                "line": 3
            },
            "id": "C-5.2.17"
        },
        {
            "title": "Ensure root PATH Integrity",
            "desc": "The `root` user can execute any command on the system and could be\nfooled into executing programs unintentionally if the `PATH` is not set\ncorrectly.",
            "descriptions": {
                "default": "The `root` user can execute any command on the system and could be\nfooled into executing programs unintentionally if the `PATH` is not set\ncorrectly.",
                "rationale": "Including the current working directory (.) or other\nwritable directory in `root` 's executable path makes it likely that an\nattacker can gain superuser access by forcing an administrator operating as\n`root` to execute a Trojan horse program.",
                "check": "Run the following script and verify no results are returned:\n\n```\n#!/bin/bash\n\nif echo \"$PATH\" | grep -q \"::\" ; then\n echo \"Empty Directory in PATH (::)\"\nfi\nif echo \"$PATH\" | grep -q \":$\" ; then\n echo \"Trailing : in PATH\"\nfi\nfor x in $(echo \"$PATH\" | tr \":\" \" \") ; do\n if [ -d \"$x\" ] ; then\n ls -ldH \"$x\" | awk '\n $9 == \".\" {print \"PATH contains current working directory (.)\"}\n $3 != \"root\" {print $9, \"is not owned by root\"}\n substr($1,6,1) != \"-\" {print $9, \"is group writable\"}\n substr($1,9,1) != \"-\" {print $9, \"is world writable\"}'\n else\n echo \"$x is not a directory\"\n fi\ndone\n```",
                "fix": "Correct or justify any items discovered in the Audit step."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.7"
            },
            "code": "control \"C-6.2.7\" do\n  title \"Ensure root PATH Integrity\"\n  desc  \"The `root` user can execute any command on the system and could be\nfooled into executing programs unintentionally if the `PATH` is not set\ncorrectly.\"\n  desc  \"rationale\", \"Including the current working directory (.) or other\nwritable directory in `root` 's executable path makes it likely that an\nattacker can gain superuser access by forcing an administrator operating as\n`root` to execute a Trojan horse program.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n\n    if echo \\\"$PATH\\\" | grep -q \\\"::\\\" ; then\n     echo \\\"Empty Directory in PATH (::)\\\"\n    fi\n    if echo \\\"$PATH\\\" | grep -q \\\":$\\\" ; then\n     echo \\\"Trailing : in PATH\\\"\n    fi\n    for x in $(echo \\\"$PATH\\\" | tr \\\":\\\" \\\" \\\") ; do\n     if [ -d \\\"$x\\\" ] ; then\n     ls -ldH \\\"$x\\\" | awk '\n     $9 == \\\".\\\" {print \\\"PATH contains current working directory (.)\\\"}\n     $3 != \\\"root\\\" {print $9, \\\"is not owned by root\\\"}\n     substr($1,6,1) != \\\"-\\\" {print $9, \\\"is group writable\\\"}\n     substr($1,9,1) != \\\"-\\\" {print $9, \\\"is world writable\\\"}'\n     else\n     echo \\\"$x is not a directory\\\"\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"Correct or justify any items discovered in the Audit step.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.7\"\n\n  describe \"root $PATH\" do\n    skip \"This control must be reviewed manually using the documented check.\"\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.7.rb",
                "line": 3
            },
            "id": "C-6.2.7"
        },
        {
            "title": "Ensure separate partition exists for /var",
            "desc": "The `/var` directory is used by daemons and other system services to\ntemporarily store dynamic data. Some directories created by these processes may\nbe world-writable.",
            "descriptions": {
                "default": "The `/var` directory is used by daemons and other system services to\ntemporarily store dynamic data. Some directories created by these processes may\nbe world-writable.",
                "rationale": "Since the `/var` directory may contain world-writable\nfiles and directories, there is a risk of resource exhaustion if it is not\nbound to a separate partition.",
                "check": "Run the following command and verify output shows `/var` is mounted:\n\n```\n# mount | grep -E '\\s/var\\s'\n/dev/xvdg1 on /var type ext4 (rw,relatime,data=ordered)\n```",
                "fix": "For new installations, during installation create a custom partition setup\nand specify a separate partition for `/var` .\n\n    For systems that were previously installed, create a new partition and\nconfigure `/etc/fstab` as appropriate."
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.6"
            },
            "code": "control \"C-1.1.6\" do\n  title \"Ensure separate partition exists for /var\"\n  desc  \"The `/var` directory is used by daemons and other system services to\ntemporarily store dynamic data. Some directories created by these processes may\nbe world-writable.\"\n  desc  \"rationale\", \"Since the `/var` directory may contain world-writable\nfiles and directories, there is a risk of resource exhaustion if it is not\nbound to a separate partition.\"\n  desc  \"check\", \"\n    Run the following command and verify output shows `/var` is mounted:\n\n    ```\n    # mount | grep -E '\\\\s/var\\\\s'\n    /dev/xvdg1 on /var type ext4 (rw,relatime,data=ordered)\n    ```\n  \"\n  desc  \"fix\", \"\n    For new installations, during installation create a custom partition setup\nand specify a separate partition for `/var` .\n\n    For systems that were previously installed, create a new partition and\nconfigure `/etc/fstab` as appropriate.\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.6\"\n\n  describe mount('/var') do\n    it { should be_mounted }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.6.rb",
                "line": 3
            },
            "id": "C-1.1.6"
        },
        {
            "title": "Audit SUID executables",
            "desc": "The owner of a file can set the file's permissions to run with the\nowner's or group's permissions, even if the user running the program is not the\nowner or a member of the group. The most common reason for a SUID program is to\nenable users to perform functions (such as changing their password) that\nrequire root privileges.",
            "descriptions": {
                "default": "The owner of a file can set the file's permissions to run with the\nowner's or group's permissions, even if the user running the program is not the\nowner or a member of the group. The most common reason for a SUID program is to\nenable users to perform functions (such as changing their password) that\nrequire root privileges.",
                "rationale": "There are valid reasons for SUID programs, but it is\nimportant to identify and review such programs to ensure they are legitimate.",
                "check": "Run the following command to list SUID files:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -type f -perm -4000\n    ```\n\n    The command above only searches local filesystems, there may still be\ncompromised items on network mounted partitions. Additionally the `--local`\noption to `df` is not universal to all versions, it can be omitted to search\nall filesystems on a system including network mounted filesystems or the\nfollowing command can be run manually for each partition:\n\n    ```\n    # find\n\n    \t -xdev -type f -perm -4000\n    ```",
                "fix": "Ensure that no rogue SUID programs have been introduced into\nthe system. Review the files returned by the action in the Audit section and\nconfirm the integrity of these binaries."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.13"
            },
            "code": "control \"C-6.1.13\" do\n  title \"Audit SUID executables\"\n  desc  \"The owner of a file can set the file's permissions to run with the\nowner's or group's permissions, even if the user running the program is not the\nowner or a member of the group. The most common reason for a SUID program is to\nenable users to perform functions (such as changing their password) that\nrequire root privileges.\"\n  desc  \"rationale\", \"There are valid reasons for SUID programs, but it is\nimportant to identify and review such programs to ensure they are legitimate.\"\n  desc  \"check\", \"\n    Run the following command to list SUID files:\n\n    ```\n    # df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}'\n-xdev -type f -perm -4000\n    ```\n\n    The command above only searches local filesystems, there may still be\ncompromised items on network mounted partitions. Additionally the `--local`\noption to `df` is not universal to all versions, it can be omitted to search\nall filesystems on a system including network mounted filesystems or the\nfollowing command can be run manually for each partition:\n\n    ```\n    # find\n\n    \\t -xdev -type f -perm -4000\n    ```\n  \"\n  desc \"fix\", \"Ensure that no rogue SUID programs have been introduced into\nthe system. Review the files returned by the action in the Audit section and\nconfirm the integrity of these binaries.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.13\"\n\n  describe command(\"df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -4000\") do\n    skip 'This control must be reviewed manually. Run `df --local -P | awk \\'{if (NR!=1) print $6}\\' | xargs -I \\'{}\\' find \\'{}\\' -xdev -type f -perm -4000` and review the results.'\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.13.rb",
                "line": 3
            },
            "id": "C-6.1.13"
        },
        {
            "title": "Ensure DNS Server is not enabled",
            "desc": "The Domain Name System (DNS) is a hierarchical naming system that maps\nnames to IP addresses for computers, services and other resources connected to\na network.",
            "descriptions": {
                "default": "The Domain Name System (DNS) is a hierarchical naming system that maps\nnames to IP addresses for computers, services and other resources connected to\na network.",
                "rationale": "Unless a system is specifically designated to act as a\nDNS server, it is recommended that the package be deleted to reduce the\npotential attack surface.",
                "check": "Run the following command to verify `DNS server` is not enabled:\n\n```\n# systemctl is-enabled bind9\n\ndisabled\n```\n\nVerify result is not \"enabled\".",
                "fix": "Run the following commands to disable `DNS server`:\n\n```\n# systemctl --now disable bind9\n```"
            },
            "impact": 0.0,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-7 (1)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.2",
                    "Rev_7"
                ],
                "cis_rid": "2.2.8"
            },
            "code": "control \"C-2.2.8\" do\n  title \"Ensure DNS Server is not enabled\"\n  desc  \"The Domain Name System (DNS) is a hierarchical naming system that maps\nnames to IP addresses for computers, services and other resources connected to\na network.\"\n  desc  \"rationale\", \"Unless a system is specifically designated to act as a\nDNS server, it is recommended that the package be deleted to reduce the\npotential attack surface.\"\n  desc  \"check\", \"\n    Run the following command to verify `DNS server` is not enabled:\n\n    ```\n    # systemctl is-enabled bind9\n\n    disabled\n    ```\n\n    Verify result is not \\\"enabled\\\".\n  \"\n  desc  \"fix\", \"\n    Run the following commands to disable `DNS server`:\n\n    ```\n    # systemctl --now disable bind9\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-7 (1)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.2\", \"Rev_7\"]\n  tag cis_rid: \"2.2.8\"\n\n  if package('pdns-server').installed? || package('maradns').installed? || package('bind9').installed?\n      describe service('pdns') do\n        it { should_not be_enabled }\n        it { should_not be_running }\n      end\n      describe service('maradns') do\n        it { should_not be_enabled }\n        it { should_not be_running }\n      end\n      describe service('bind9') do\n        it { should_not be_enabled }\n        it { should_not be_running }\n      end\n  else\n    impact 0.0\n    describe \"A DNS Server package is not installed\" do\n      skip \"A DNS Server package is not installed.\"\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-2.2.8.rb",
                "line": 3
            },
            "id": "C-2.2.8"
        },
        {
            "title": "Ensure TCP Wrappers is installed",
            "desc": "Many Linux distributions provide value-added firewall solutions which\nprovide easy, advanced management of network traffic into and out of the local\nsystem. When these solutions are available and appropriate for an environment\nthey should be used.\n\n    In cases where a value-added firewall is not provided by a distribution,\nTCP Wrappers provides a simple access list and standardized logging method for\nservices capable of supporting it. Services that are called from `inetd` and\n`xinetd` support the use of TCP wrappers. Any service that can support TCP\nwrappers will have the `libwrap.so` library attached to it.",
            "descriptions": {
                "default": "Many Linux distributions provide value-added firewall solutions which\nprovide easy, advanced management of network traffic into and out of the local\nsystem. When these solutions are available and appropriate for an environment\nthey should be used.\n\n    In cases where a value-added firewall is not provided by a distribution,\nTCP Wrappers provides a simple access list and standardized logging method for\nservices capable of supporting it. Services that are called from `inetd` and\n`xinetd` support the use of TCP wrappers. Any service that can support TCP\nwrappers will have the `libwrap.so` library attached to it.",
                "rationale": "TCP Wrappers provide a good simple access list mechanism\nto services that may not have that support built in. It is recommended that all\nservices that can support TCP Wrappers, use it.",
                "check": "Run the following command and verify TCP Wrappers is installed:\n\n```\n# dpkg -s tcpd\n```",
                "fix": "Run the following command to install TCP Wrappers:\n\n```\n# apt install tcpd\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "SC-7(5)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "9.4",
                    "Rev_7"
                ],
                "cis_rid": "3.3.1"
            },
            "code": "control \"C-3.3.1\" do\n  title \"Ensure TCP Wrappers is installed\"\n  desc  \"Many Linux distributions provide value-added firewall solutions which\nprovide easy, advanced management of network traffic into and out of the local\nsystem. When these solutions are available and appropriate for an environment\nthey should be used.\n\n    In cases where a value-added firewall is not provided by a distribution,\nTCP Wrappers provides a simple access list and standardized logging method for\nservices capable of supporting it. Services that are called from `inetd` and\n`xinetd` support the use of TCP wrappers. Any service that can support TCP\nwrappers will have the `libwrap.so` library attached to it.\n  \"\n  desc  \"rationale\", \"TCP Wrappers provide a good simple access list mechanism\nto services that may not have that support built in. It is recommended that all\nservices that can support TCP Wrappers, use it.\"\n  desc  \"check\", \"\n    Run the following command and verify TCP Wrappers is installed:\n\n    ```\n    # dpkg -s tcpd\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following command to install TCP Wrappers:\n\n    ```\n    # apt install tcpd\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"SC-7(5)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"9.4\", \"Rev_7\"]\n  tag cis_rid: \"3.3.1\"\n\n  describe package('tcpd') do\n    it { should be_installed }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.3.1.rb",
                "line": 3
            },
            "id": "C-3.3.1"
        },
        {
            "title": "Ensure suspicious packets are logged",
            "desc": "When enabled, this feature logs packets with un-routable source\naddresses to the kernel log.",
            "descriptions": {
                "default": "When enabled, this feature logs packets with un-routable source\naddresses to the kernel log.",
                "rationale": "Enabling this feature and logging these packets allows an\nadministrator to investigate the possibility that an attacker is sending\nspoofed packets to their system.",
                "check": "Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.log_martians\n\n    net.ipv4.conf.all.log_martians = 1\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.log_martians\n\n    net.ipv4.conf.default.log_martians = 1\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.all\\.log_martians\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.log_martians = 1\n    ```\n\n    ```\n    # grep \"net\\.ipv4\\.conf\\.default\\.log_martians\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.default.log_martians = 1\n    ```",
                "fix": "Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.log_martians = 1\n    net.ipv4.conf.default.log_martians = 1\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.conf.all.log_martians=1\n    # sysctl -w net.ipv4.conf.default.log_martians=1\n    # sysctl -w net.ipv4.route.flush=1\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-12",
                    "AU-3",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.2",
                    "6.3",
                    "Rev_7"
                ],
                "cis_rid": "3.2.4"
            },
            "code": "control \"C-3.2.4\" do\n  title \"Ensure suspicious packets are logged\"\n  desc  \"When enabled, this feature logs packets with un-routable source\naddresses to the kernel log.\"\n  desc  \"rationale\", \"Enabling this feature and logging these packets allows an\nadministrator to investigate the possibility that an attacker is sending\nspoofed packets to their system.\"\n  desc  \"check\", \"\n    Run the following commands and verify output matches:\n\n    ```\n    # sysctl net.ipv4.conf.all.log_martians\n\n    net.ipv4.conf.all.log_martians = 1\n    ```\n\n    ```\n    # sysctl net.ipv4.conf.default.log_martians\n\n    net.ipv4.conf.default.log_martians = 1\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.all\\\\.log_martians\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.all.log_martians = 1\n    ```\n\n    ```\n    # grep \\\"net\\\\.ipv4\\\\.conf\\\\.default\\\\.log_martians\\\" /etc/sysctl.conf\n/etc/sysctl.d/*\n\n    net.ipv4.conf.default.log_martians = 1\n    ```\n  \"\n  desc  \"fix\", \"\n    Set the following parameters in `/etc/sysctl.conf` or a `/etc/sysctl.d/*`\nfile:\n\n    ```\n    net.ipv4.conf.all.log_martians = 1\n    net.ipv4.conf.default.log_martians = 1\n    ```\n\n    Run the following commands to set the active kernel parameters:\n\n    ```\n    # sysctl -w net.ipv4.conf.all.log_martians=1\n    # sysctl -w net.ipv4.conf.default.log_martians=1\n    # sysctl -w net.ipv4.route.flush=1\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-12\", \"AU-3\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.2\", \"6.3\", \"Rev_7\"]\n  tag cis_rid: \"3.2.4\"\n\n  describe kernel_parameter('net.ipv4.conf.all.log_martians') do\n    its('value') { should cmp '1' }\n  end\n\n  describe kernel_parameter('net.ipv4.conf.default.log_martians') do\n    its('value') { should cmp '1' }\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.2.4.rb",
                "line": 3
            },
            "id": "C-3.2.4"
        },
        {
            "title": "Ensure events that modify the system's network environment are\ncollected",
            "desc": "Record changes to network environment files or system calls. The below\nparameters monitor the sethostname (set the systems host name) or setdomainname\n(set the systems domainname) system calls, and write an audit event on system\ncall exit. The other parameters monitor the `/etc/issue` and `/etc/issue.net`\nfiles (messages displayed pre-login), `/etc/hosts` (file containing host names\nand associated IP addresses) and `/etc/network` (directory containing network\ninterface scripts and configurations) files.",
            "descriptions": {
                "default": "Record changes to network environment files or system calls. The below\nparameters monitor the sethostname (set the systems host name) or setdomainname\n(set the systems domainname) system calls, and write an audit event on system\ncall exit. The other parameters monitor the `/etc/issue` and `/etc/issue.net`\nfiles (messages displayed pre-login), `/etc/hosts` (file containing host names\nand associated IP addresses) and `/etc/network` (directory containing network\ninterface scripts and configurations) files.",
                "rationale": "Monitoring `sethostname` and `setdomainname` will\nidentify potential unauthorized changes to host and domainname of a system. The\nchanging of these names could potentially break security parameters that are\nset based on those names. The `/etc/hosts` file is monitored for changes in the\nfile that can indicate an unauthorized intruder is trying to change machine\nassociations with IP addresses and trick users and processes into connecting to\nunintended machines. Monitoring `/etc/issue` and `/etc/issue.net` is important,\nas intruders could put disinformation into those files and trick users into\nproviding information to the intruder. Monitoring `/etc/network` is important\nas it can show if network interfaces or scripts are being modified in a way\nthat can lead to the machine becoming unavailable or compromised. All audit\nrecords will be tagged with the identifier \"system-locale.\"",
                "check": "On a 32 bit system run the following commands:\n\n```\n# grep system-locale /etc/audit/rules.d/*.rules\n```\n\nVerify the output matches:\n\n```\n-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/network -p wa -k system-locale\n```\n\n```\n# auditctl -l | grep system-locale\n```\n\nVerify the output matches:\n\n```\n-a always,exit -F arch=b32 -S sethostname,setdomainname -F key=system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/network -p wa -k system-locale\n```\n\nOn a 64 bit system run the following commands:\n\n```\n# grep system-locale /etc/audit/rules.d/*.rules\n```\n\nVerify the output matches:\n\n```\n-a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale\n-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/network -p wa -k system-locale\n```\n\n```\n# auditctl -l | grep system-locale\n```\n\nVerify the output matches:\n\n```\n-a always,exit -F arch=b64 -S sethostname,setdomainname -F key=system-locale\n-a always,exit -F arch=b32 -S sethostname,setdomainname -F key=system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/network -p wa -k system-locale\n```",
                "fix": "For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/system-locale.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n    -w /etc/issue -p wa -k system-locale\n    -w /etc/issue.net -p wa -k system-locale\n    -w /etc/hosts -p wa -k system-locale\n    -w /etc/network -p wa -k system-locale\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/system-locale.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale\n    -a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n    -w /etc/issue -p wa -k system-locale\n    -w /etc/issue.net -p wa -k system-locale\n    -w /etc/hosts -p wa -k system-locale\n    -w /etc/network -p wa -k system-locale\n    ```"
            },
            "impact": 0.7,
            "refs": [],
            "tags": {
                "severity": "high",
                "nist": [
                    "CM-6 (1)"
                ],
                "cis_level": 2,
                "cis_controls": [
                    "5.5"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.1.5"
            },
            "code": "control \"C-4.1.5\" do\n  title \"Ensure events that modify the system's network environment are\ncollected\"\n  desc  \"Record changes to network environment files or system calls. The below\nparameters monitor the sethostname (set the systems host name) or setdomainname\n(set the systems domainname) system calls, and write an audit event on system\ncall exit. The other parameters monitor the `/etc/issue` and `/etc/issue.net`\nfiles (messages displayed pre-login), `/etc/hosts` (file containing host names\nand associated IP addresses) and `/etc/network` (directory containing network\ninterface scripts and configurations) files.\"\n  desc  \"rationale\", \"Monitoring `sethostname` and `setdomainname` will\nidentify potential unauthorized changes to host and domainname of a system. The\nchanging of these names could potentially break security parameters that are\nset based on those names. The `/etc/hosts` file is monitored for changes in the\nfile that can indicate an unauthorized intruder is trying to change machine\nassociations with IP addresses and trick users and processes into connecting to\nunintended machines. Monitoring `/etc/issue` and `/etc/issue.net` is important,\nas intruders could put disinformation into those files and trick users into\nproviding information to the intruder. Monitoring `/etc/network` is important\nas it can show if network interfaces or scripts are being modified in a way\nthat can lead to the machine becoming unavailable or compromised. All audit\nrecords will be tagged with the identifier \\\"system-locale.\\\"\"\n  desc  \"check\", \"\n    On a 32 bit system run the following commands:\n\n    ```\n    # grep system-locale /etc/audit/rules.d/*.rules\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n    -w /etc/issue -p wa -k system-locale\n    -w /etc/issue.net -p wa -k system-locale\n    -w /etc/hosts -p wa -k system-locale\n    -w /etc/network -p wa -k system-locale\n    ```\n\n    ```\n    # auditctl -l | grep system-locale\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b32 -S sethostname,setdomainname -F key=system-locale\n    -w /etc/issue -p wa -k system-locale\n    -w /etc/issue.net -p wa -k system-locale\n    -w /etc/hosts -p wa -k system-locale\n    -w /etc/network -p wa -k system-locale\n    ```\n\n    On a 64 bit system run the following commands:\n\n    ```\n    # grep system-locale /etc/audit/rules.d/*.rules\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale\n    -a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n    -w /etc/issue -p wa -k system-locale\n    -w /etc/issue.net -p wa -k system-locale\n    -w /etc/hosts -p wa -k system-locale\n    -w /etc/network -p wa -k system-locale\n    ```\n\n    ```\n    # auditctl -l | grep system-locale\n    ```\n\n    Verify the output matches:\n\n    ```\n    -a always,exit -F arch=b64 -S sethostname,setdomainname -F key=system-locale\n    -a always,exit -F arch=b32 -S sethostname,setdomainname -F key=system-locale\n    -w /etc/issue -p wa -k system-locale\n    -w /etc/issue.net -p wa -k system-locale\n    -w /etc/hosts -p wa -k system-locale\n    -w /etc/network -p wa -k system-locale\n    ```\n  \"\n  desc  \"fix\", \"\n    For 32 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/system-locale.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n    -w /etc/issue -p wa -k system-locale\n    -w /etc/issue.net -p wa -k system-locale\n    -w /etc/hosts -p wa -k system-locale\n    -w /etc/network -p wa -k system-locale\n    ```\n\n    For 64 bit systems Edit or create a file in the `/etc/audit/rules.d/`\ndirectory ending in `.rules`\n\n    Example: `vi /etc/audit/rules.d/system-locale.rules`\n\n    and add the following lines:\n\n    ```\n    -a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale\n    -a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale\n    -w /etc/issue -p wa -k system-locale\n    -w /etc/issue.net -p wa -k system-locale\n    -w /etc/hosts -p wa -k system-locale\n    -w /etc/network -p wa -k system-locale\n    ```\n  \"\n  impact 0.7\n  tag severity: \"high\"\n  tag nist: [\"CM-6 (1)\"]\n  tag cis_level: 2\n  tag cis_controls: [\"5.5\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.1.5\"\n\n  files = [\n    '/etc/issue',\n    '/etc/issue.net',\n    '/etc/hosts',\n    '/etc/network'\n  ]\n\n  files.each do |file|\n    describe auditd.file(file).where { key == \"system-locale\" } do\n      its('permissions') { should include ['w', 'a'] }\n    end\n  end\n\n  arches = ['b32']\n  if os.arch.match?(/64/)\n    arches.push('b64')\n  end\n\n  ['sethostname', 'setdomainname'].each do |syscall|\n    arches.each do |a|\n      describe auditd.syscall(syscall).where { arch == a && key == 'system-locale'  } do\n        its('action.uniq') { should eq ['always'] }\n        its('list.uniq') { should eq ['exit'] }\n      end\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.1.5.rb",
                "line": 3
            },
            "id": "C-4.1.5"
        },
        {
            "title": "Ensure AppArmor is installed",
            "desc": "AppArmor provides Mandatory Access Controls.",
            "descriptions": {
                "default": "AppArmor provides Mandatory Access Controls.",
                "rationale": "Without a Mandatory Access Control system installed only\nthe default Discretionary Access Control system will be available.",
                "check": "Verify that AppArmor is installed:\n\n```\n# dpkg -s apparmor apparmor-utils\n```",
                "fix": "Install Apparmor.\n\n```\n# apt install apparmor apparmor-utils\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-3 (3)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6",
                    "Rev_7"
                ],
                "cis_rid": "1.7.1.1"
            },
            "code": "control \"C-1.7.1.1\" do\n  title \"Ensure AppArmor is installed\"\n  desc  \"AppArmor provides Mandatory Access Controls.\"\n  desc  \"rationale\", \"Without a Mandatory Access Control system installed only\nthe default Discretionary Access Control system will be available.\"\n  desc  \"check\", \"\n    Verify that AppArmor is installed:\n\n    ```\n    # dpkg -s apparmor apparmor-utils\n    ```\n  \"\n  desc \"fix\", \"\n    Install Apparmor.\n\n    ```\n    # apt install apparmor apparmor-utils\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-3 (3)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\", \"Rev_7\"]\n  tag cis_rid: \"1.7.1.1\"\n\n  describe package('apparmor') do\n    it { should be_installed }\n  end\n\n  describe package('apparmor-utils') do\n    it { should be_installed }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.7.1.1.rb",
                "line": 3
            },
            "id": "C-1.7.1.1"
        },
        {
            "title": "Ensure only strong Ciphers are used",
            "desc": "This variable limits the ciphers that SSH can use during\ncommunication.",
            "descriptions": {
                "default": "This variable limits the ciphers that SSH can use during\ncommunication.",
                "rationale": "Weak ciphers that are used for authentication to the cryptographic module\ncannot be relied upon to provide confidentiality or integrity, and system data\nmay be compromised\n\n    The DES, Triple DES, and Blowfish ciphers, as used in SSH, have a birthday\nbound of approximately four billion blocks, which makes it easier for remote\nattackers to obtain cleartext data via a birthday attack against a\nlong-duration encrypted session, aka a \"Sweet32\" attack\n\n    The RC4 algorithm, as used in the TLS protocol and SSL protocol, does not\nproperly combine state data with key data during the initialization phase,\nwhich makes it easier for remote attackers to conduct plaintext-recovery\nattacks against the initial bytes of a stream by sniffing network traffic that\noccasionally relies on keys affected by the Invariance Weakness, and then using\na brute-force approach involving LSB values, aka the \"Bar Mitzvah\" issue\n\n    The passwords used during an SSH session encrypted with RC4 can be\nrecovered by an attacker who is able to capture and replay the session\n\n    Error handling in the SSH protocol; Client and Server, when using a block\ncipher algorithm in Cipher Block Chaining (CBC) mode, makes it easier for\nremote attackers to recover certain plaintext data from an arbitrary block of\nciphertext in an SSH session via unknown vectors\n\n    The mm_newkeys_from_blob function in monitor_wrap.c, when an AES-GCM cipher\nis used, does not properly initialize memory for a MAC context data structure,\nwhich allows remote authenticated users to bypass intended ForceCommand and\nlogin-shell restrictions via packet data that provides a crafted callback\naddress",
                "check": "Run the following command and verify that output does not contain any of\nthe listed weak ciphers\n\n    ```\n    # sshd -T | grep ciphers\n    ```\n\n    Weak Ciphers:\n\n    ```\n    3des-cbc\n    aes128-cbc\n    aes192-cbc\n    aes256-cbc\n    arcfour\n    arcfour128\n    arcfour256\n    blowfish-cbc\n    cast128-cbc\n    rijndael-cbc@lysator.liu.se\n    ```",
                "fix": "Edit the `/etc/ssh/sshd_config` file add/modify the `Ciphers` line to\ncontain a comma separated list of the site approved ciphers\n\n    Example:\n\n    ```\n    Ciphers\nchacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-8"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.4"
                ],
                "cis_rid": "5.2.13",
                "cis_scored": true,
                "cis_version": "2.0.1",
                "cis_cdc_version": 7
            },
            "code": "control \"C-5.2.13\" do\n  title \"Ensure only strong Ciphers are used\"\n  desc  \"This variable limits the ciphers that SSH can use during\ncommunication.\"\n  desc  \"rationale\", \"\n    Weak ciphers that are used for authentication to the cryptographic module\ncannot be relied upon to provide confidentiality or integrity, and system data\nmay be compromised\n\n    The DES, Triple DES, and Blowfish ciphers, as used in SSH, have a birthday\nbound of approximately four billion blocks, which makes it easier for remote\nattackers to obtain cleartext data via a birthday attack against a\nlong-duration encrypted session, aka a \\\"Sweet32\\\" attack\n\n    The RC4 algorithm, as used in the TLS protocol and SSL protocol, does not\nproperly combine state data with key data during the initialization phase,\nwhich makes it easier for remote attackers to conduct plaintext-recovery\nattacks against the initial bytes of a stream by sniffing network traffic that\noccasionally relies on keys affected by the Invariance Weakness, and then using\na brute-force approach involving LSB values, aka the \\\"Bar Mitzvah\\\" issue\n\n    The passwords used during an SSH session encrypted with RC4 can be\nrecovered by an attacker who is able to capture and replay the session\n\n    Error handling in the SSH protocol; Client and Server, when using a block\ncipher algorithm in Cipher Block Chaining (CBC) mode, makes it easier for\nremote attackers to recover certain plaintext data from an arbitrary block of\nciphertext in an SSH session via unknown vectors\n\n    The mm_newkeys_from_blob function in monitor_wrap.c, when an AES-GCM cipher\nis used, does not properly initialize memory for a MAC context data structure,\nwhich allows remote authenticated users to bypass intended ForceCommand and\nlogin-shell restrictions via packet data that provides a crafted callback\naddress\n  \"\n  desc  \"check\", \"\n    Run the following command and verify that output does not contain any of\nthe listed weak ciphers\n\n    ```\n    # sshd -T | grep ciphers\n    ```\n\n    Weak Ciphers:\n\n    ```\n    3des-cbc\n    aes128-cbc\n    aes192-cbc\n    aes256-cbc\n    arcfour\n    arcfour128\n    arcfour256\n    blowfish-cbc\n    cast128-cbc\n    rijndael-cbc@lysator.liu.se\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/ssh/sshd_config` file add/modify the `Ciphers` line to\ncontain a comma separated list of the site approved ciphers\n\n    Example:\n\n    ```\n    Ciphers\nchacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-8\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.4\"]\n  tag cis_rid: \"5.2.13\"\n  tag cis_scored: true\n  tag cis_version: \"2.0.1\"\n  tag cis_cdc_version: 7\n  cfg = sshd_config\n  describe cfg do\n    describe 'it should have defined Ciphers' do\n      subject { cfg.Ciphers }\n        it { should_not be_empty }\n    end\n    its('Ciphers') { should_not include(\n      '3des-cbc',\n      'aes128-cbc',\n      'aes192-cbc',\n      'aes256-cbc',\n      'arcfour',\n      'arcfour128',\n      'arcfour256',\n      'blowfish-cbc',\n      'cast128-cbc',\n      'rijndael-cbc@lysator.liu.se') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.2.13.rb",
                "line": 3
            },
            "id": "C-5.2.13"
        },
        {
            "title": "Ensure rsyslog default file permissions configured",
            "desc": "rsyslog will create logfiles that do not already exist on the system.\nThis setting controls what permissions will be applied to these newly created\nfiles.",
            "descriptions": {
                "default": "rsyslog will create logfiles that do not already exist on the system.\nThis setting controls what permissions will be applied to these newly created\nfiles.",
                "rationale": "It is important to ensure that log files have the correct\npermissions to ensure that sensitive data is archived and protected.",
                "check": "Run the following command and verify that `$FileCreateMode` is `0640` or\nmore restrictive:\n\n    ```\n    # grep ^\\$FileCreateMode /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n    ```",
                "fix": "Edit the `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf` files and set\n`$FileCreateMode` to `0640` or more restrictive:\n\n    ```\n    $FileCreateMode 0640\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "4.2.1.4"
            },
            "code": "control \"C-4.2.1.4\" do\n  title \"Ensure rsyslog default file permissions configured\"\n  desc  \"rsyslog will create logfiles that do not already exist on the system.\nThis setting controls what permissions will be applied to these newly created\nfiles.\"\n  desc  \"rationale\", \"It is important to ensure that log files have the correct\npermissions to ensure that sensitive data is archived and protected.\"\n  desc  \"check\", \"\n    Run the following command and verify that `$FileCreateMode` is `0640` or\nmore restrictive:\n\n    ```\n    # grep ^\\\\$FileCreateMode /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/rsyslog.conf` and `/etc/rsyslog.d/*.conf` files and set\n`$FileCreateMode` to `0640` or more restrictive:\n\n    ```\n    $FileCreateMode 0640\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"4.2.1.4\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.2.1.4.rb",
                "line": 3
            },
            "id": "C-4.2.1.4"
        },
        {
            "title": "Ensure /tmp is configured",
            "desc": "The `/tmp` directory is a world-writable directory used for temporary\nstorage by all users and some applications.",
            "descriptions": {
                "default": "The `/tmp` directory is a world-writable directory used for temporary\nstorage by all users and some applications.",
                "rationale": "Making /tmp its own file system allows an administrator to set the noexec\noption on the mount, making /tmp useless for an attacker to install executable\ncode. It would also prevent an attacker from establishing a hardlink to a\nsystem setuid program and wait for it to be updated. Once the program was\nupdated, the hardlink would be broken and the attacker would have his own copy\nof the program. If the program happened to have a security vulnerability, the\nattacker could continue to exploit the known flaw.\n\n    This can be accomplished by either mounting tmpfs to /tmp, or creating a\nseparate partition for /tmp.",
                "check": "Run the following command and verify output shows `/tmp` is mounted:\n\n    ```\n    # mount | grep -E '\\s/tmp\\s'\n\n    tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)\n    ```\n\n    Run the following command and verify that tmpfs has been mounted to, or a\nsystem partition has been created for `/tmp`\n\n    ```\n    # grep -E '\\s/tmp\\s' /etc/fstab | grep -E -v '^\\s*#'\n\n    tmpfs /tmp tmpfs defaults,noexec,nosuid,nodev 0 0\n    ```\n\n    OR\n\n    ```\n    # systemctl is-enabled tmp.mount\n\n    enabled\n    ```",
                "fix": "Configure `/etc/fstab` as appropriate.\n\n    **Example:**\n\n    ```\n    tmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0\n    ```\n\n    OR\n\n    Run the following commands to enable systemd `/tmp` mounting:\n\n    ```\n    systemctl unmask tmp.mount\n    systemctl enable tmp.mount\n    ```\n\n    Edit `/etc/systemd/system/local-fs.target.wants/tmp.mount` to configure the\n`/tmp` mount:\n\n    ```\n    [Mount]\n    What=tmpfs\n    Where=/tmp\n    Type=tmpfs\n    Options=mode=1777,strictatime,noexec,nodev,nosuid\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "1.1.2"
            },
            "code": "control \"C-1.1.2\" do\n  title \"Ensure /tmp is configured\"\n  desc  \"The `/tmp` directory is a world-writable directory used for temporary\nstorage by all users and some applications.\"\n  desc  \"rationale\", \"\n    Making /tmp its own file system allows an administrator to set the noexec\noption on the mount, making /tmp useless for an attacker to install executable\ncode. It would also prevent an attacker from establishing a hardlink to a\nsystem setuid program and wait for it to be updated. Once the program was\nupdated, the hardlink would be broken and the attacker would have his own copy\nof the program. If the program happened to have a security vulnerability, the\nattacker could continue to exploit the known flaw.\n\n    This can be accomplished by either mounting tmpfs to /tmp, or creating a\nseparate partition for /tmp.\n  \"\n  desc  \"check\", \"\n    Run the following command and verify output shows `/tmp` is mounted:\n\n    ```\n    # mount | grep -E '\\\\s/tmp\\\\s'\n\n    tmpfs on /tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)\n    ```\n\n    Run the following command and verify that tmpfs has been mounted to, or a\nsystem partition has been created for `/tmp`\n\n    ```\n    # grep -E '\\\\s/tmp\\\\s' /etc/fstab | grep -E -v '^\\\\s*#'\n\n    tmpfs /tmp tmpfs defaults,noexec,nosuid,nodev 0 0\n    ```\n\n    OR\n\n    ```\n    # systemctl is-enabled tmp.mount\n\n    enabled\n    ```\n  \"\n  desc \"fix\", \"\n    Configure `/etc/fstab` as appropriate.\n\n    **Example:**\n\n    ```\n    tmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime 0 0\n    ```\n\n    OR\n\n    Run the following commands to enable systemd `/tmp` mounting:\n\n    ```\n    systemctl unmask tmp.mount\n    systemctl enable tmp.mount\n    ```\n\n    Edit `/etc/systemd/system/local-fs.target.wants/tmp.mount` to configure the\n`/tmp` mount:\n\n    ```\n    [Mount]\n    What=tmpfs\n    Where=/tmp\n    Type=tmpfs\n    Options=mode=1777,strictatime,noexec,nodev,nosuid\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"1.1.2\"\n\n  describe.one do\n    describe systemd_service('tmp.mount') do\n      it { should be_enabled }\n    end\n    describe etc_fstab.where { mount_point == '/tmp' } do\n      its('count') { should cmp 1 }\n      it 'Should have a device name specified' do\n        expect(subject.device_name[0]).to_not(be_empty)\n      end\n    end\n  end\n\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-1.1.2.rb",
                "line": 3
            },
            "id": "C-1.1.2"
        },
        {
            "title": "Ensure all users' home directories exist",
            "desc": "Users can be defined in `/etc/passwd` without a home directory or with\na home directory that does not actually exist.",
            "descriptions": {
                "default": "Users can be defined in `/etc/passwd` without a home directory or with\na home directory that does not actually exist.",
                "rationale": "If the user's home directory does not exist or is\nunassigned, the user will be placed in \"/\" and will not be able to write any\nfiles or have local environment variables set.",
                "check": "Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n    grep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\"'\"$(which nologin)\"'\" & do\n     if [ ! -d \"$dir\" ]; then\n     echo \"The home directory $dir of user $user does not exist.\"\n     fi\n    done\n    ```",
                "fix": "If any users' home directories do not exist, create them and\nmake sure the respective user owns the directory. Users without an assigned\nhome directory should be removed or assigned a home directory as appropriate."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "CM-6"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.2.3"
            },
            "code": "control \"C-6.2.3\" do\n  title \"Ensure all users' home directories exist\"\n  desc  \"Users can be defined in `/etc/passwd` without a home directory or with\na home directory that does not actually exist.\"\n  desc  \"rationale\", \"If the user's home directory does not exist or is\nunassigned, the user will be placed in \\\"/\\\" and will not be able to write any\nfiles or have local environment variables set.\"\n  desc  \"check\", \"\n    Run the following script and verify no results are returned:\n\n    ```\n    #!/bin/bash\n    grep -E -v '^(halt|sync|shutdown)' /etc/passwd | awk -F: '($7 !=\n\\\"'\\\"$(which nologin)\\\"'\\\" & do\n     if [ ! -d \\\"$dir\\\" ]; then\n     echo \\\"The home directory $dir of user $user does not exist.\\\"\n     fi\n    done\n    ```\n  \"\n  desc \"fix\", \"If any users' home directories do not exist, create them and\nmake sure the respective user owns the directory. Users without an assigned\nhome directory should be removed or assigned a home directory as appropriate.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"CM-6\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.2.3\"\n\n  nologin = command(\"which nologin\").stdout.strip\n\n  passwd.where { user != 'halt' && user != 'sync' && user != 'shutdown' && shell != nologin }.entries.each do |user|\n    describe file(user.home) do\n      it { should exist }\n      it { should be_directory }\n    end\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.2.3.rb",
                "line": 3
            },
            "id": "C-6.2.3"
        },
        {
            "title": "Ensure permissions on /etc/shadow are configured",
            "desc": "The `/etc/shadow` file is used to store the information about user\naccounts that is critical to the security of those accounts, such as the hashed\npassword and other security information.",
            "descriptions": {
                "default": "The `/etc/shadow` file is used to store the information about user\naccounts that is critical to the security of those accounts, such as the hashed\npassword and other security information.",
                "rationale": "If attackers can gain read access to the `/etc/shadow`\nfile, they can easily run a password cracking program against the hashed\npassword to break it. Other security information that is stored in the\n`/etc/shadow` file (such as expiration) could also be useful to subvert the\nuser accounts.",
                "check": "Run the following command and verify verify `Uid` is `0/root,` `Gid` is\n`/shadow,` and `Access` is `640` or more restrictive:\n\n    ```\n    # stat /etc/shadow\n\n    Access: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 42/ shadow)\n    ```",
                "fix": "Run the one following commands to set permissions on `/etc/shadow`:\n\n```\n# chmod o-rwx,g-wx /etc/shadow\n```\n\n```\n# chown root:shadow /etc/shadow\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "SC-28"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "16.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "6.1.4"
            },
            "code": "control \"C-6.1.4\" do\n  title \"Ensure permissions on /etc/shadow are configured\"\n  desc  \"The `/etc/shadow` file is used to store the information about user\naccounts that is critical to the security of those accounts, such as the hashed\npassword and other security information.\"\n  desc  \"rationale\", \"If attackers can gain read access to the `/etc/shadow`\nfile, they can easily run a password cracking program against the hashed\npassword to break it. Other security information that is stored in the\n`/etc/shadow` file (such as expiration) could also be useful to subvert the\nuser accounts.\"\n  desc  \"check\", \"\n    Run the following command and verify verify `Uid` is `0/root,` `Gid` is\n`/shadow,` and `Access` is `640` or more restrictive:\n\n    ```\n    # stat /etc/shadow\n\n    Access: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 42/ shadow)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the one following commands to set permissions on `/etc/shadow`:\n\n    ```\n    # chmod o-rwx,g-wx /etc/shadow\n    ```\n\n    ```\n    # chown root:shadow /etc/shadow\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"SC-28\"]\n  tag cis_level: 1\n  tag cis_controls: [\"16.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"6.1.4\"\n\n  describe file('/etc/shadow') do\n    it { should_not be_more_permissive_than('0640') }\n    it { should be_owned_by 'root' }\n    its('group') { should be_in ['root', 'shadow'] }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-6.1.4.rb",
                "line": 3
            },
            "id": "C-6.1.4"
        },
        {
            "title": "Ensure journald is configured to write logfiles to persistent disk",
            "desc": "Data from journald may be stored in volatile memory or persisted\nlocally on the server. Logs in memory will be lost upon a system reboot. By\npersisting logs to local disk on the server they are protected from loss.",
            "descriptions": {
                "default": "Data from journald may be stored in volatile memory or persisted\nlocally on the server. Logs in memory will be lost upon a system reboot. By\npersisting logs to local disk on the server they are protected from loss.",
                "rationale": "Writing log data to disk will provide the ability to\nforensically reconstruct events which may have impacted the operations or\nsecurity of a system even after a system crash or reboot.",
                "check": "Review `/etc/systemd/journald.conf` and verify that logs are persisted to\ndisk:\n\n    ```\n    # grep -E -i \"^\\s*Storage\" /etc/systemd/journald.conf\n    # Storage=persistent\n    ```",
                "fix": "Edit the `/etc/systemd/journald.conf` file and add the following line:\n\n```\nStorage=persistent\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AU-12",
                    "AU-3",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.2",
                    "6.3",
                    "Rev_7"
                ],
                "cis_rid": "4.2.2.3"
            },
            "code": "control \"C-4.2.2.3\" do\n  title \"Ensure journald is configured to write logfiles to persistent disk\"\n  desc  \"Data from journald may be stored in volatile memory or persisted\nlocally on the server. Logs in memory will be lost upon a system reboot. By\npersisting logs to local disk on the server they are protected from loss.\"\n  desc  \"rationale\", \"Writing log data to disk will provide the ability to\nforensically reconstruct events which may have impacted the operations or\nsecurity of a system even after a system crash or reboot.\"\n  desc  \"check\", \"\n    Review `/etc/systemd/journald.conf` and verify that logs are persisted to\ndisk:\n\n    ```\n    # grep -E -i \\\"^\\\\s*Storage\\\" /etc/systemd/journald.conf\n    # Storage=persistent\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/systemd/journald.conf` file and add the following line:\n\n    ```\n    Storage=persistent\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AU-12\", \"AU-3\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.2\", \"6.3\", \"Rev_7\"]\n  tag cis_rid: \"4.2.2.3\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.2.2.3.rb",
                "line": 3
            },
            "id": "C-4.2.2.3"
        },
        {
            "title": "Ensure default user umask is 027 or more restrictive",
            "desc": "The default `umask` determines the permissions of files created by\nusers. The user creating the file has the discretion of making their files and\ndirectories readable by others via the chmod command. Users who wish to allow\ntheir files and directories to be readable by others by default may choose a\ndifferent default umask by inserting the `umask` command into the standard\nshell configuration files ( `.profile` , `.bashrc` , etc.) in their home\ndirectories.",
            "descriptions": {
                "default": "The default `umask` determines the permissions of files created by\nusers. The user creating the file has the discretion of making their files and\ndirectories readable by others via the chmod command. Users who wish to allow\ntheir files and directories to be readable by others by default may choose a\ndifferent default umask by inserting the `umask` command into the standard\nshell configuration files ( `.profile` , `.bashrc` , etc.) in their home\ndirectories.",
                "rationale": "Setting a very secure default value for `umask` ensures\nthat users make a conscious choice about their file permissions. A default\n`umask` setting of `077` causes files and directories created by users to not\nbe readable by any other user on the system. A `umask` of `027` would make\nfiles and directories readable by users in the same Unix group, while a `umask`\nof `022` would make files readable by every user on the system.",
                "check": "Run the following commands and verify all umask lines returned are 027 or\nmore restrictive.\n\n    ```\n    # grep \"umask\" /etc/bash.bashrc\n\n    umask 027\n    ```\n\n    ```\n    # grep \"umask\" /etc/profile /etc/profile.d/*.sh\n\n    umask 027\n    ```",
                "fix": "Edit the `/etc/bash.bashrc`, `/etc/profile` and `/etc/profile.d/*.sh` files\n(and the appropriate files for any other shell supported on your system) and\nadd or edit any umask parameters as follows:\n\n    ```\n    umask 027\n    ```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "AC-3 (3)",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "14.6",
                    "Rev_7"
                ],
                "cis_rid": "5.4.4"
            },
            "code": "control \"C-5.4.4\" do\n  title \"Ensure default user umask is 027 or more restrictive\"\n  desc  \"The default `umask` determines the permissions of files created by\nusers. The user creating the file has the discretion of making their files and\ndirectories readable by others via the chmod command. Users who wish to allow\ntheir files and directories to be readable by others by default may choose a\ndifferent default umask by inserting the `umask` command into the standard\nshell configuration files ( `.profile` , `.bashrc` , etc.) in their home\ndirectories.\"\n  desc  \"rationale\", \"Setting a very secure default value for `umask` ensures\nthat users make a conscious choice about their file permissions. A default\n`umask` setting of `077` causes files and directories created by users to not\nbe readable by any other user on the system. A `umask` of `027` would make\nfiles and directories readable by users in the same Unix group, while a `umask`\nof `022` would make files readable by every user on the system.\"\n  desc  \"check\", \"\n    Run the following commands and verify all umask lines returned are 027 or\nmore restrictive.\n\n    ```\n    # grep \\\"umask\\\" /etc/bash.bashrc\n\n    umask 027\n    ```\n\n    ```\n    # grep \\\"umask\\\" /etc/profile /etc/profile.d/*.sh\n\n    umask 027\n    ```\n  \"\n  desc \"fix\", \"\n    Edit the `/etc/bash.bashrc`, `/etc/profile` and `/etc/profile.d/*.sh` files\n(and the appropriate files for any other shell supported on your system) and\nadd or edit any umask parameters as follows:\n\n    ```\n    umask 027\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"AC-3 (3)\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"14.6\", \"Rev_7\"]\n  tag cis_rid: \"5.4.4\"\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-5.4.4.rb",
                "line": 3
            },
            "id": "C-5.4.4"
        },
        {
            "title": "Ensure logrotate is configured",
            "desc": "The system includes the capability of rotating log files regularly to\navoid filling up the system with logs or making the logs unmanageably large.\nThe file `/etc/logrotate.d/rsyslog` is the configuration file used to rotate\nlog files created by `rsyslog`.",
            "descriptions": {
                "default": "The system includes the capability of rotating log files regularly to\navoid filling up the system with logs or making the logs unmanageably large.\nThe file `/etc/logrotate.d/rsyslog` is the configuration file used to rotate\nlog files created by `rsyslog`.",
                "rationale": "By keeping the log files smaller and more manageable, a\nsystem administrator can easily archive these files to another system and spend\nless time looking through inordinately large log files.",
                "check": "Review `/etc/logrotate.conf` and `/etc/logrotate.d/rsyslog`\nand verify logs are rotated according to site policy.",
                "fix": "Edit `/etc/logrotate.conf` and `/etc/logrotate.d/rsyslog` to\nensure logs are rotated according to site policy."
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "nist": [
                    "AU-4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "6.4"
                ],
                "cis_cdc_version": "7",
                "cis_rid": "4.3"
            },
            "code": "control \"C-4.3\" do\n  title \"Ensure logrotate is configured\"\n  desc  \"The system includes the capability of rotating log files regularly to\navoid filling up the system with logs or making the logs unmanageably large.\nThe file `/etc/logrotate.d/rsyslog` is the configuration file used to rotate\nlog files created by `rsyslog`.\"\n  desc  \"rationale\", \"By keeping the log files smaller and more manageable, a\nsystem administrator can easily archive these files to another system and spend\nless time looking through inordinately large log files.\"\n  desc  \"check\", \"Review `/etc/logrotate.conf` and `/etc/logrotate.d/rsyslog`\nand verify logs are rotated according to site policy.\"\n  desc  \"fix\", \"Edit `/etc/logrotate.conf` and `/etc/logrotate.d/rsyslog` to\nensure logs are rotated according to site policy.\"\n  impact 0.5\n  tag severity: \"medium\"\n  tag nist: [\"AU-4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"6.4\"]\n  tag cis_cdc_version: \"7\"\n  tag cis_rid: \"4.3\"\n\n  describe \"/etc/logrotate.conf and /etc/logrotate.d/rsyslog\" do\n    skip \"This control must be reviewed manually using the documented check.\"\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-4.3.rb",
                "line": 3
            },
            "id": "C-4.3"
        },
        {
            "title": "Ensure permissions on /etc/hosts.deny are configured",
            "desc": "The `/etc/hosts.deny` file contains network information that is used\nby many system applications and therefore must be readable for these\napplications to operate.",
            "descriptions": {
                "default": "The `/etc/hosts.deny` file contains network information that is used\nby many system applications and therefore must be readable for these\napplications to operate.",
                "rationale": "It is critical to ensure that the `/etc/hosts.deny` file\nis protected from unauthorized write access. Although it is protected by\ndefault, the file permissions could be changed either inadvertently or through\nmalicious actions.",
                "check": "Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` :\n\n    ```\n    # stat /etc/hosts.deny\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```",
                "fix": "Run the following commands to set permissions on `/etc/hosts.deny` :\n\n```\n# chown root:root /etc/hosts.deny\n# chmod 644 /etc/hosts.deny\n```"
            },
            "impact": 0.5,
            "refs": [],
            "tags": {
                "severity": "medium",
                "gtitle": null,
                "gid": null,
                "rid": null,
                "stig_id": null,
                "fix_id": null,
                "cci": null,
                "nist": [
                    "CM-6",
                    "Rev_4"
                ],
                "cis_level": 1,
                "cis_controls": [
                    "5.1",
                    "Rev_7"
                ],
                "cis_rid": "3.3.5"
            },
            "code": "control \"C-3.3.5\" do\n  title \"Ensure permissions on /etc/hosts.deny are configured\"\n  desc  \"The `/etc/hosts.deny` file contains network information that is used\nby many system applications and therefore must be readable for these\napplications to operate.\"\n  desc  \"rationale\", \"It is critical to ensure that the `/etc/hosts.deny` file\nis protected from unauthorized write access. Although it is protected by\ndefault, the file permissions could be changed either inadvertently or through\nmalicious actions.\"\n  desc  \"check\", \"\n    Run the following command and verify `Uid` and `Gid` are both `0/root` and\n`Access` is `644` :\n\n    ```\n    # stat /etc/hosts.deny\n\n    Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n    ```\n  \"\n  desc  \"fix\", \"\n    Run the following commands to set permissions on `/etc/hosts.deny` :\n\n    ```\n    # chown root:root /etc/hosts.deny\n    # chmod 644 /etc/hosts.deny\n    ```\n  \"\n  impact 0.5\n  tag severity: \"medium\"\n  tag gtitle: nil\n  tag gid: nil\n  tag rid: nil\n  tag stig_id: nil\n  tag fix_id: nil\n  tag cci: nil\n  tag nist: [\"CM-6\", \"Rev_4\"]\n  tag cis_level: 1\n  tag cis_controls: [\"5.1\", \"Rev_7\"]\n  tag cis_rid: \"3.3.5\"\n\n  describe file('/etc/hosts.deny') do\n    it { should be_owned_by 'root' }\n    it { should_not be_more_permissive_than('0644') }\n    it { should be_more_permissive_than('0000') }\n  end\nend\n",
            "source_location": {
                "ref": "./controls/ubuntu-18.04-server-cis-3.3.5.rb",
                "line": 3
            },
            "id": "C-3.3.5"
        }
    ],
    "groups": [
        {
            "title": null,
            "controls": [
                "C-1.1.18"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.18.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.2.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.2.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.2.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.2.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.20"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.20.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.14"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.14.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.2.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.2.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.4.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.4.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.10"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.10.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.3.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.3.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.3.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.3.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.1.8"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.1.8.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.2.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.2.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.7.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.7.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.10"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.10.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.9"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.9.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.14"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.14.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.9"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.9.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.3.8"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.3.8.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.2.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.2.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.7.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.7.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.2.1.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.2.1.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.11"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.11.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.2.2.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.2.2.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.8"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.8.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.19"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.19.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.2.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.2.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.21"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.21.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.15"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.15.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.2.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.2.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.4.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.4.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.11"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.11.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.3.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.3.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.3.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.3.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.9"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.9.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.10"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.10.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.12"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.12.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.8.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.8.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.8"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.8.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.2.9"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.2.9.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.3.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.3.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.16"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.16.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.4.2.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.4.2.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.8.1.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.8.1.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.15"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.15.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.14"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.14.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.20"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.20.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.4.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.4.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.3.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.3.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.22"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.22.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.2.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.2.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.4.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.4.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.16"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.16.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.3.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.3.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.8.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.8.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.12"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.12.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.6.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.6.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.2.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.2.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.5.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.5.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.3.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.3.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.4.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.4.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.1.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.1.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.4.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.4.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.11"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.11.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.15"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.15.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.4.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.4.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.23"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.23.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.3.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.3.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.2.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.2.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.17"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.17.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.3.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.3.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.4.2.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.4.2.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.13"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.13.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.3.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.3.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.5.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.5.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.2.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.2.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.1.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.1.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.4.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.4.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.1.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.1.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.4.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.4.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.10"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.10.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.8"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.8.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.11"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.11.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.13"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.13.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.2.8"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.2.8.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.9"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.9.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.3.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.3.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.3.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.3.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.17"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.17.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.8.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.8.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.6.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.6.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.14"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.14.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.8"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.8.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.9"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.9.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.18"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.18.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.16"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.16.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.4.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.4.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.2.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.2.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.20"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.20.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.14"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.14.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.10"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.10.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.8.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.8.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.1.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.1.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.5.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.5.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.2.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.2.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.13"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.13.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.4.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.4.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.12"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.12.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.3.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.3.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.10"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.10.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.2.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.2.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.3.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.3.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.4.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.4.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.3.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.3.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.6.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.6.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.4.2.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.4.2.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.14"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.14.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.4.1.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.4.1.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.17"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.17.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.4.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.4.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.13"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.13.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.11"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.11.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.2.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.2.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.3.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.3.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.3.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.3.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.5.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.5.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.6.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.6.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.4.2.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.4.2.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.8.1.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.8.1.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.15"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.15.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.4.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.4.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.16"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.16.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.8"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.8.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.9"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.9.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.19"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.19.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.17"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.17.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.4.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.4.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.21"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.21.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.3.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.3.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.15"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.15.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.11"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.11.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.8.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.8.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.4.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.4.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.1.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.1.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.1.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.1.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.5.3.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.5.3.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.12"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.12.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.2.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.2.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.2.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.2.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.12"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.12.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.2.1.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.2.1.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.2.2.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.2.2.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.4.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.4.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.3.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.3.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.7.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.7.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.2.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.2.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.22"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.22.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.18"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.18.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.2.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.2.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.16"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.16.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.12"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.12.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.3.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.3.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.1.8"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.1.8.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.9"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.9.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.2.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.2.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.23"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.23.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.19"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.19.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.17"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.17.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.7"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.7.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.6"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.6.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.13"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.13.rb"
        },
        {
            "title": null,
            "controls": [
                "C-2.2.8"
            ],
            "id": "controls/ubuntu-18.04-server-cis-2.2.8.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.3.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.3.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.2.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.2.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.1.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.1.5.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.7.1.1"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.7.1.1.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.2.13"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.2.13.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.2.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.2.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-1.1.2"
            ],
            "id": "controls/ubuntu-18.04-server-cis-1.1.2.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.2.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.2.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-6.1.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-6.1.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.2.2.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.2.2.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-5.4.4"
            ],
            "id": "controls/ubuntu-18.04-server-cis-5.4.4.rb"
        },
        {
            "title": null,
            "controls": [
                "C-4.3"
            ],
            "id": "controls/ubuntu-18.04-server-cis-4.3.rb"
        },
        {
            "title": null,
            "controls": [
                "C-3.3.5"
            ],
            "id": "controls/ubuntu-18.04-server-cis-3.3.5.rb"
        }
    ],
    "sha256": "7f81d8852b902407bbf76366463fdf3966d2a226ece5bd2d0ed3111f1f244b01",
    "status_message": "",
    "status": "loaded",
    "generator": {
        "name": "inspec",
        "version": "4.52.9"
    }
}