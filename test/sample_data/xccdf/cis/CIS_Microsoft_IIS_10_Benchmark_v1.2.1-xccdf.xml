<xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:ae="http://benchmarks.cisecurity.org/ae/0.5" xmlns:cc6="http://cisecurity.org/20-cc/v6.1" xmlns:cc7="http://cisecurity.org/20-cc/v7.0" xmlns:cc8="http://cisecurity.org/20-cc/v8.0" xmlns:ciscf="https://benchmarks.cisecurity.org/ciscf/1.0" xmlns:notes="http://benchmarks.cisecurity.org/notes" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="xccdf_org.cisecurity.benchmarks_benchmark_1.2.1_CIS_Microsoft_IIS_10_Benchmark" style="SCAP_1.2" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 https://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd">
   <xccdf:status date="2023-07-11">interim</xccdf:status>
   <xccdf:title xml:lang="en">CIS Microsoft IIS 10 Benchmark</xccdf:title>
   <xccdf:description xml:lang="en">
      <xhtml:p>This document provides prescriptive guidance for establishing a secure configuration posture for Microsoft Windows IIS 10.</xhtml:p>
      <xhtml:p>
This secure configuration guide is based on       <xhtml:strong>Microsoft Windows IIS 10</xhtml:strong>
 and is intended for all versions of       <xhtml:strong>Microsoft Windows IIS 10</xhtml:strong>
. This secure configuration guide was tested on       <xhtml:strong>Microsoft Windows Server 2022 Datacenter</xhtml:strong>
.    </xhtml:p>
      <xhtml:p>
To obtain the latest version of this secure configuration guide, please visit       <xhtml:a href="https://www.cisecurity.org/cis-benchmarks/">https://www.cisecurity.org/cis-benchmarks/</xhtml:a>
. If you have questions, comments, or have identified ways to improve this guide, please write us at       <xhtml:a href="mailto:feedback@cisecurity.org">feedback@cisecurity.org</xhtml:a>
.    </xhtml:p>
   </xccdf:description>
   <xccdf:notice id="terms-of-use" xml:lang="en">	BACKGROUND.
	The Center for Internet Security ("CIS") provides benchmarks, scoring tools, software, data, information, suggestions, ideas, and other services and materials from the CIS website or elsewhere ("Products") as a public service to Internet users worldwide.	Recommendations contained in the Products ("Recommendations") result from a consensus-building process that involves many security experts and are generally generic in nature.	The Recommendations are intended to provide helpful information to organizations attempting to evaluate or improve the security of their networks, systems, and devices.	Proper use of the Recommendations requires careful analysis and adaptation to specific user requirements.	The Recommendations are not in any way intended to be a "quick fix" for anyone's information security needs.
	NO REPRESENTATIONS, WARRANTIES, OR COVENANTS.
	CIS makes no representations, warranties, or covenants whatsoever as to (i) the positive or negative effect of the Products or the Recommendations on the operation or the security of any particular network, computer system, network device, software, hardware, or any component of any of the foregoing or (ii) the accuracy, reliability, timeliness, or completeness of	the Products or the Recommendations.	CIS is providing the Products and the Recommendations "as is" and "as available" without representations, warranties, or covenants of any kind.	USER AGREEMENTS.
	By using the Products and/or the Recommendations, I and/or my organization ("We") agree and acknowledge that:
	1.	No network, system, device, hardware, software, or component can be made fully secure;
	2.	We are using the Products and the Recommendations solely at our own risk;
	3.	We are not compensating CIS to assume any liabilities associated with our use of the Products or the Recommendations, even risks that result from 		CIS's negligence or failure to perform; 
	4.	We have the sole responsibility to evaluate the risks and benefits of the Products and Recommendations to us and to adapt the Products and the 			Recommendations to our particular circumstances and requirements;
	5.	Neither CIS, nor any CIS Party (defined below) has any responsibility to make any corrections, updates, upgrades, or bug fixes; or to notify us of 		the need for any such corrections, updates, upgrades, or bug fixes; and
	6.	Neither CIS nor any CIS Party has or will have any liability to us whatsoever (whether based in contract, tort, strict liability or otherwise) for 		any direct, indirect, incidental, consequential, or special damages (including without limitation loss of profits, loss of sales, loss of or damage 		to reputation,loss of customers, loss of software, data, information or emails, loss of privacy, loss of use of any computer or other equipment, 	business interruption, wasted management or other staff resources or claims of any kind against us from third parties) arising out of or in any way 	Connected with our use of or our inability to use any of the Products or Recommendations (even if CIS has been advised of the possibility of such 	damages), including without limitation any liability associated with infringement of intellectual property, defects, bugs, errors, omissions, 	viruses, worms, backdoors, Trojan horses or other harmful items.
	GRANT OF LIMITED RIGHTS.
	CIS hereby grants each user the following rights, but only so long as the user complies with all of the terms of these Agreed Terms of Use:
	1.	Except to the extent that we may have received additional authorization pursuant to a written agreement with CIS, each user may download, install and 	use each of the Products on a single computer;
	2.	Each user may print one or more copies of any Product or any component of a Product that is in a .txt, .pdf, .doc, .mcw, or .rtf format, provided 		that all such copies are printed in full and are kept intact, including without limitation the text of this Agreed Terms of Use in its entirety.
	RETENTION OF INTELLECTUAL PROPERTY RIGHTS; LIMITATIONS ON DISTRIBUTION.
	The Products are protected by copyright and other intellectual property laws and by international treaties.	We acknowledge and agree that we are not acquiring title to any intellectual property rights in the Products and that full title and all ownership rights to the Products will remain the exclusive property of CIS or CIS Parties.	CIS reserves all rights not expressly granted to users in the preceding section entitled "Grant of limited rights."
	Subject to the paragraph entitled "Special Rules" (which includes a waiver, granted to some classes of CIS Members, of certain limitations in this paragraph), and except as we may have otherwise agreed in a written agreement with CIS, we agree that we will not (i) decompile, disassemble, reverse engineer, or otherwise attempt to derive the source code for any software Product that is not already in the form of source code; (ii) distribute, redistribute, encumber, sell, rent, lease, lend, sublicense, or otherwise transfer or exploit rights to any Product or any component of a Product; (iii) post any Product or any component of a Product on any website, bulletin board, ftp server, newsgroup, or other similar mechanism or device, without regard to whether such mechanism or device is internal or external, (iv) remove or alter trademark, logo, copyright or other proprietary notices, legends, symbols or labels in any Product or any component of a Product; (v) remove these Agreed Terms of Use from, or alter these Agreed Terms of Use as they appear in, any Product or any component of a Product; (vi) use any Product or any component of a Product with any derivative works based directly on a Product or any component of a Product; (vii) use any Product or any component of a Product with other products or applications that are directly and specifically dependent on such Product or any component for any part of their functionality, or (viii) represent or claim a particular level of compliance with a CIS Benchmark, scoring tool or other Product.	We will not facilitate or otherwise aid other individuals or entities in any of the activities listed in this paragraph.
	We hereby agree to indemnify, defend, and hold CIS and all of its officers, directors, members, contributors, employees, authors, developers, agents, affiliates, licensors, information and service providers, software suppliers, hardware suppliers, and all other persons who aided CIS in the creation, development, or maintenance of the Products or Recommendations ("CIS Parties") harmless from and against any and all liability, losses, costs, and expenses (including attorneys' fees and court costs) incurred by CIS or any CIS Party in connection with any claim arising out of any violation by us of the preceding paragraph, including without limitation CIS's right, at our expense, to assume the exclusive defense and control of any matter subject to this indemnification, and in such case, we agree to cooperate with CIS in its defense of such claim.	We further agree that all CIS Parties are third-party beneficiaries of our undertakings in these Agreed Terms of Use.	SPECIAL RULES.
	CIS has created and will from time to time create, special rules for its members and for other persons and organizations with which CIS has a written contractual relationship.	Those special rules will override and supersede these Agreed Terms of Use with respect to the users who are covered by the special rules.
	CIS hereby grants each CIS Security Consulting or Software Vendor Member and each CIS Organizational User Member, but only so long as such Member remains in good standing with CIS and complies with all of the terms of these Agreed Terms of Use, the right to distribute the Products and Recommendations within such Member's own organization, whether by manual or electronic means.	Each such Member acknowledges and agrees that the foregoing grant is subject to the terms of such Member's membership arrangement with CIS and may, therefore, be modified or terminated by CIS at any time.
	CHOICE OF LAW; JURISDICTION; VENUE.
	We acknowledge and agree that these Agreed Terms of Use will be governed by and construed in accordance with the laws of the State of Maryland, that any action at law or in equity arising out of or relating to these Agreed Terms of Use shall be filed only in the courts located in the State of Maryland, that we hereby consent and submit to the personal jurisdiction of such courts for the purposes of litigating any such action.	If any of these Agreed Terms of Use shall be determined to be unlawful, void, or for any reason unenforceable, then such terms shall be deemed severable and shall not affect the validity and enforceability of any remaining provisions.
	BY USING THE PRODUCTS I(WE) ACKNOWLEDGE THAT WE HAVE READ THESE AGREED TERMS OF USE IN THEIR ENTIRETY, UNDERSTAND THEM, AND I(WE) AGREE TO BE BOUND BY THEM IN ALL RESPECTS.</xccdf:notice>
   <xccdf:platform idref="cpe:/a:microsoft:iis:10"/>
   <xccdf:version>1.2.1</xccdf:version>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_1_-_IIS_10">
      <xccdf:title xml:lang="en">Level 1 - IIS 10</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Items in this profile apply to Microsoft IIS 10 running on Microsoft Windows Server 2016 and intend to:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>be practical and prudent;</xhtml:li>
            <xhtml:li>provide a clear security benefit; and</xhtml:li>
            <xhtml:li>not inhibit the utility of the technology beyond acceptable means.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_L1_Ensure_Web_content_is_on_non-system_partition" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_L1_Ensure_Host_headers_are_on_all_sites" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_L1_Ensure_Directory_browsing_is_set_to_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_L1_Ensure_application_pool_identity_is_configured_for_all_application_pools" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5_L1_Ensure_unique_application_pools_is_set_for_sites" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6_L1_Ensure_application_pool_identity_is_configured_for_anonymous_user_identity" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.7_L1_Ensure_WebDav_feature_is_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_L1_Ensure_global_authorization_rule_is_set_to_restrict_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_L1_Ensure_access_to_sensitive_site_features_is_restricted_to_authenticated_principals_only" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_L1_Ensure_forms_authentication_require_SSL" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_L1_Ensure_cookie_protection_mode_is_configured_for_forms_authentication" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_L1_Ensure_transport_layer_security_for_basic_authentication_is_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_L1_Ensure_passwordFormat_is_not_set_to_clear" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_L1_Ensure_deployment_method_retail_is_set" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_L1_Ensure_IIS_HTTP_detailed_errors_are_hidden_from_displaying_remotely" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_L1_Ensure_cookies_are_set_with_HttpOnly_attribute" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.9_L1_Ensure_MachineKey_validation_method_-_.Net_4.5_is_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.10_L1_Ensure_global_.NET_trust_level_is_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5_L1_Ensure_Double-Encoded_requests_will_be_rejected" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6_L1_Ensure_HTTP_Trace_Method_is_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7_L1_Ensure_Unlisted_File_Extensions_are_not_allowed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.8_L1_Ensure_Handler_is_not_granted_Write_and_ScriptExecute" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.9_L1_Ensure_notListedIsapisAllowed_is_set_to_false" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.10_L1_Ensure_notListedCgisAllowed_is_set_to_false" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11_L1_Ensure_Dynamic_IP_Address_Restrictions_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_L1_Ensure_Default_IIS_web_log_location_is_moved" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2_L1_Ensure_Advanced_IIS_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_L1_Ensure_ETW_Logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1_L1_Ensure_FTP_requests_are_encrypted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_L1_Ensure_FTP_Logon_attempt_restrictions_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_L1_Ensure_SSLv2_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_L1_Ensure_SSLv3_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.4_L1_Ensure_TLS_1.0_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.5_L1_Ensure_TLS_1.1_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_L1_Ensure_TLS_1.2_is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.7_L1_Ensure_NULL_Cipher_Suites_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.8_L1_Ensure_DES_Cipher_Suites_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.9_L1_Ensure_RC4_Cipher_Suites_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.10_L1_Ensure_AES_128128_Cipher_Suite_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.11_L1_Ensure_AES_256256_Cipher_Suite_is_Enabled" selected="true"/>
   </xccdf:Profile>
   <xccdf:Profile id="xccdf_org.cisecurity.benchmarks_profile_Level_2_-_IIS_10">
      <xccdf:title xml:lang="en">Level 2 - IIS 10</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This profile extends the "Level 1 - IIS 10" profile. Items in this profile apply to Microsoft IIS 10.0 running on Microsoft Windows Server 2016 and exhibit one or more of the following characteristics:</xhtml:p>
         <xhtml:ul>
            <xhtml:li>are intended for environments or use cases where security is paramount;</xhtml:li>
            <xhtml:li>acts as defense in depth measure;</xhtml:li>
            <xhtml:li>may negatively inhibit the utility or performance of the technology.</xhtml:li>
         </xhtml:ul>
      </xccdf:description>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.1_L1_Ensure_Web_content_is_on_non-system_partition" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.2_L1_Ensure_Host_headers_are_on_all_sites" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.3_L1_Ensure_Directory_browsing_is_set_to_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.4_L1_Ensure_application_pool_identity_is_configured_for_all_application_pools" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.5_L1_Ensure_unique_application_pools_is_set_for_sites" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.6_L1_Ensure_application_pool_identity_is_configured_for_anonymous_user_identity" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_1.7_L1_Ensure_WebDav_feature_is_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.1_L1_Ensure_global_authorization_rule_is_set_to_restrict_access" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.2_L1_Ensure_access_to_sensitive_site_features_is_restricted_to_authenticated_principals_only" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.3_L1_Ensure_forms_authentication_require_SSL" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.4_L2_Ensure_forms_authentication_is_set_to_use_cookies" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.5_L1_Ensure_cookie_protection_mode_is_configured_for_forms_authentication" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.6_L1_Ensure_transport_layer_security_for_basic_authentication_is_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.7_L1_Ensure_passwordFormat_is_not_set_to_clear" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_2.8_L2_Ensure_credentials_are_not_stored_in_configuration_files" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.1_L1_Ensure_deployment_method_retail_is_set" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.2_L2_Ensure_debug_is_turned_off" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.3_L2_Ensure_custom_error_messages_are_not_off" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.4_L1_Ensure_IIS_HTTP_detailed_errors_are_hidden_from_displaying_remotely" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.5_L2_Ensure_ASP.NET_stack_tracing_is_not_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.6_L2_Ensure_httpcookie_mode_is_configured_for_session_state" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.7_L1_Ensure_cookies_are_set_with_HttpOnly_attribute" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.8_L2_Ensure_MachineKey_validation_method_-_.Net_3.5_is_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.9_L1_Ensure_MachineKey_validation_method_-_.Net_4.5_is_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.10_L1_Ensure_global_.NET_trust_level_is_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.11_L2_Ensure_X-Powered-By_Header_is_removed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_3.12_L2_Ensure_Server_Header_is_removed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.1_L2_Ensure_maxAllowedContentLength_is_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.2_L2_Ensure_maxURL_request_filter_is_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.3_L2_Ensure_MaxQueryString_request_filter_is_configured" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.4_L2_Ensure_non-ASCII_characters_in_URLs_are_not_allowed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.5_L1_Ensure_Double-Encoded_requests_will_be_rejected" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.6_L1_Ensure_HTTP_Trace_Method_is_disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.7_L1_Ensure_Unlisted_File_Extensions_are_not_allowed" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.8_L1_Ensure_Handler_is_not_granted_Write_and_ScriptExecute" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.9_L1_Ensure_notListedIsapisAllowed_is_set_to_false" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.10_L1_Ensure_notListedCgisAllowed_is_set_to_false" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_4.11_L1_Ensure_Dynamic_IP_Address_Restrictions_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.1_L1_Ensure_Default_IIS_web_log_location_is_moved" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.2_L1_Ensure_Advanced_IIS_logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_5.3_L1_Ensure_ETW_Logging_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.1_L1_Ensure_FTP_requests_are_encrypted" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_6.2_L1_Ensure_FTP_Logon_attempt_restrictions_is_enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.1_L2_Ensure_HSTS_Header_is_set" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.2_L1_Ensure_SSLv2_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.3_L1_Ensure_SSLv3_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.4_L1_Ensure_TLS_1.0_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.5_L1_Ensure_TLS_1.1_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.6_L1_Ensure_TLS_1.2_is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.7_L1_Ensure_NULL_Cipher_Suites_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.8_L1_Ensure_DES_Cipher_Suites_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.9_L1_Ensure_RC4_Cipher_Suites_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.10_L1_Ensure_AES_128128_Cipher_Suite_is_Disabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.11_L1_Ensure_AES_256256_Cipher_Suite_is_Enabled" selected="true"/>
      <xccdf:select idref="xccdf_org.cisecurity.benchmarks_rule_7.12_L2_Ensure_TLS_Cipher_Suite_ordering_is_Configured" selected="true"/>
   </xccdf:Profile>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061312_var" operator="pattern match" type="string">
      <title>(L1) Ensure 'Host headers' are on all sites</title>
      <description>This value is used in Rule: (L1) Ensure 'Host headers' are on all sites</description>
      <value>.+</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061313_var" operator="equals" type="boolean">
      <title>(L1) Ensure 'Directory browsing' is set to Disabled</title>
      <description>This value is used in Rule: (L1) Ensure 'Directory browsing' is set to Disabled</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061316_var" operator="pattern match" type="string">
      <title>(L1) Ensure 'application pool identity' is configured for anonymous user identity</title>
      <description>This value is used in Rule: (L1) Ensure 'application pool identity' is configured for anonymous user identity</description>
      <value>^$</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061317_var" operator="less than or equal" type="number">
      <title>(L2) Ensure 'maxURL request filter' is configured</title>
      <description>This value is used in Rule: (L2) Ensure 'maxURL request filter' is configured</description>
      <value>4096</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061318_var" operator="less than or equal" type="number">
      <title>(L2) Ensure 'MaxQueryString request filter' is configured</title>
      <description>This value is used in Rule: (L2) Ensure 'MaxQueryString request filter' is configured</description>
      <value>2048</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061319_var" operator="equals" type="boolean">
      <title>(L2) Ensure non-ASCII characters in URLs are not allowed</title>
      <description>This value is used in Rule: (L2) Ensure non-ASCII characters in URLs are not allowed</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061320_var" operator="equals" type="boolean">
      <title>(L1) Ensure Double-Encoded requests will be rejected</title>
      <description>This value is used in Rule: (L1) Ensure Double-Encoded requests will be rejected</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061322_var" operator="equals" type="boolean">
      <title>(L1) Ensure Unlisted File Extensions are not allowed</title>
      <description>This value is used in Rule: (L1) Ensure Unlisted File Extensions are not allowed</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061314_var" operator="equals" type="string">
      <title>(L1) Ensure 'application pool identity' is configured for all application pools</title>
      <description>This value is used in Rule: (L1) Ensure 'application pool identity' is configured for all application pools</description>
      <value>ApplicationPoolIdentity</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061315_var" operator="equals" type="number">
      <title>(L1) Ensure 'unique application pools' is set for sites</title>
      <description>This value is used in Rule: (L1) Ensure 'unique application pools' is set for sites</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066530_var" operator="equals" type="boolean">
      <title>(L1) Ensure 'forms authentication' require SSL</title>
      <description>This value is used in Rule: (L1) Ensure 'forms authentication' require SSL</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066531_var" operator="equals" type="string">
      <title>(L2) Ensure 'forms authentication' is set to use cookies</title>
      <description>This value is used in Rule: (L2) Ensure 'forms authentication' is set to use cookies</description>
      <value>UseCookies</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066532_var" operator="equals" type="string">
      <title>(L1) Ensure 'cookie protection mode' is configured for forms authentication</title>
      <description>This value is used in Rule: (L1) Ensure 'cookie protection mode' is configured for forms authentication</description>
      <value>All</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066533_var" operator="not equal" type="string">
      <title>(L1) Ensure 'passwordFormat' is not set to clear</title>
      <description>This value is used in Rule: (L1) Ensure 'passwordFormat' is not set to clear</description>
      <value>Clear</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066534_var" operator="not equal" type="string">
      <title>(L2) Ensure 'credentials' are not stored in configuration files</title>
      <description>This value is used in Rule: (L2) Ensure 'credentials' are not stored in configuration files</description>
      <value>Clear</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066535_var" operator="equals" type="boolean">
      <title>(L2) Ensure 'debug' is turned off</title>
      <description>This value is used in Rule: (L2) Ensure 'debug' is turned off</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066536_var" operator="not equal" type="string">
      <title>(L2) Ensure custom error messages are not off</title>
      <description>This value is used in Rule: (L2) Ensure custom error messages are not off</description>
      <value>Off</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066537_var" operator="equals" type="string">
      <title>(L1) Ensure IIS HTTP detailed errors are hidden from displaying remotely</title>
      <description>This value is used in Rule: (L1) Ensure IIS HTTP detailed errors are hidden from displaying remotely</description>
      <value>DetailedLocalOnly</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066538_var" operator="equals" type="boolean">
      <title>(L2) Ensure ASP.NET stack tracing is not enabled</title>
      <description>This value is used in Rule: (L2) Ensure ASP.NET stack tracing is not enabled</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066539_var" operator="equals" type="string">
      <title>(L2) Ensure 'httpcookie' mode is configured for session state</title>
      <description>This value is used in Rule: (L2) Ensure 'httpcookie' mode is configured for session state</description>
      <value>UseCookies</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066540_var" operator="equals" type="boolean">
      <title>(L1) Ensure 'cookies' are set with HttpOnly attribute</title>
      <description>This value is used in Rule: (L1) Ensure 'cookies' are set with HttpOnly attribute</description>
      <value>true</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066541_var" operator="equals" type="string">
      <title>(L2) Ensure 'MachineKey validation method - .Net 3.5' is configured</title>
      <description>This value is used in Rule: (L2) Ensure 'MachineKey validation method - .Net 3.5' is configured</description>
      <value>(AES|SHA)</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066542_var" operator="equals" type="string">
      <title>(L1) Ensure 'MachineKey validation method - .Net 4.5' is configured</title>
      <description>This value is used in Rule: (L1) Ensure 'MachineKey validation method - .Net 4.5' is configured</description>
      <value>(AES|SHA)</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4066543_var" operator="equals" type="string">
      <title>(L1) Ensure global .NET trust level is configured</title>
      <description>This value is used in Rule: (L1) Ensure global .NET trust level is configured</description>
      <value>((?i)Medium|(?i)Low)</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061324_var" operator="equals" type="boolean">
      <title>(L1) Ensure 'notListedIsapisAllowed' is set to false</title>
      <description>This value is used in Rule: (L1) Ensure 'notListedIsapisAllowed' is set to false</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061326_var" operator="equals" type="boolean">
      <title>(L1) Ensure 'notListedCgisAllowed' is set to false</title>
      <description>This value is used in Rule: (L1) Ensure 'notListedCgisAllowed' is set to false</description>
      <value>false</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061321_var1" operator="equals" type="string">
      <title>(L1) Ensure SSLv2 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv2 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061321_var2" operator="equals" type="number">
      <title>(L1) Ensure SSLv2 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv2 is Disabled for the registry value</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061323_var1" operator="equals" type="string">
      <title>(L1) Ensure SSLv2 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv2 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061323_var2" operator="equals" type="number">
      <title>(L1) Ensure SSLv2 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv2 is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061325_var1" operator="equals" type="string">
      <title>(L1) Ensure SSLv2 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv2 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061325_var2" operator="equals" type="number">
      <title>(L1) Ensure SSLv2 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv2 is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061327_var1" operator="equals" type="string">
      <title>(L1) Ensure SSLv2 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv2 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061327_var2" operator="equals" type="number">
      <title>(L1) Ensure SSLv2 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv2 is Disabled for the registry value</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061328_var1" operator="equals" type="string">
      <title>(L1) Ensure SSLv3 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv3 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061328_var2" operator="equals" type="number">
      <title>(L1) Ensure SSLv3 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv3 is Disabled for the registry value</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061329_var1" operator="equals" type="string">
      <title>(L1) Ensure SSLv3 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv3 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061329_var2" operator="equals" type="number">
      <title>(L1) Ensure SSLv3 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv3 is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061330_var1" operator="equals" type="string">
      <title>(L1) Ensure SSLv3 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv3 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061330_var2" operator="equals" type="number">
      <title>(L1) Ensure SSLv3 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv3 is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061331_var1" operator="equals" type="string">
      <title>(L1) Ensure SSLv3 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv3 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061331_var2" operator="equals" type="number">
      <title>(L1) Ensure SSLv3 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure SSLv3 is Disabled for the registry value</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061332_var1" operator="equals" type="string">
      <title>(L1) Ensure TLS 1.0 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.0 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061332_var2" operator="equals" type="number">
      <title>(L1) Ensure TLS 1.0 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.0 is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061333_var1" operator="equals" type="string">
      <title>(L1) Ensure TLS 1.0 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.0 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061333_var2" operator="equals" type="number">
      <title>(L1) Ensure TLS 1.0 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.0 is Disabled for the registry value</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061334_var1" operator="equals" type="string">
      <title>(L1) Ensure TLS 1.0 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.0 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061334_var2" operator="equals" type="number">
      <title>(L1) Ensure TLS 1.0 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.0 is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061335_var1" operator="equals" type="string">
      <title>(L1) Ensure TLS 1.0 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.0 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061335_var2" operator="equals" type="number">
      <title>(L1) Ensure TLS 1.0 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.0 is Disabled for the registry value</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061336_var1" operator="equals" type="string">
      <title>(L1) Ensure TLS 1.1 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.1 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061336_var2" operator="equals" type="number">
      <title>(L1) Ensure TLS 1.1 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.1 is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061337_var1" operator="equals" type="string">
      <title>(L1) Ensure TLS 1.1 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.1 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061337_var2" operator="equals" type="number">
      <title>(L1) Ensure TLS 1.1 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.1 is Disabled for the registry value</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061338_var1" operator="equals" type="string">
      <title>(L1) Ensure TLS 1.1 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.1 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061338_var2" operator="equals" type="number">
      <title>(L1) Ensure TLS 1.1 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.1 is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061339_var1" operator="equals" type="string">
      <title>(L1) Ensure TLS 1.1 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.1 is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061339_var2" operator="equals" type="number">
      <title>(L1) Ensure TLS 1.1 is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.1 is Disabled for the registry value</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061340_var1" operator="equals" type="string">
      <title>(L1) Ensure TLS 1.2 is Enabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.2 is Enabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061340_var2" operator="equals" type="number">
      <title>(L1) Ensure TLS 1.2 is Enabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.2 is Enabled for the registry value</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061341_var1" operator="equals" type="string">
      <title>(L1) Ensure TLS 1.2 is Enabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.2 is Enabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061341_var2" operator="equals" type="number">
      <title>(L1) Ensure TLS 1.2 is Enabled</title>
      <description>This value is used in Rule: (L1) Ensure TLS 1.2 is Enabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061342_var1" operator="equals" type="string">
      <title>(L1) Ensure NULL Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure NULL Cipher Suites is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061342_var2" operator="equals" type="number">
      <title>(L1) Ensure NULL Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure NULL Cipher Suites is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061343_var1" operator="equals" type="string">
      <title>(L1) Ensure DES Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure DES Cipher Suites is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061343_var2" operator="equals" type="number">
      <title>(L1) Ensure DES Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure DES Cipher Suites is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061344_var1" operator="equals" type="string">
      <title>(L1) Ensure RC4 Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure RC4 Cipher Suites is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061344_var2" operator="equals" type="number">
      <title>(L1) Ensure RC4 Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure RC4 Cipher Suites is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061345_var1" operator="equals" type="string">
      <title>(L1) Ensure RC4 Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure RC4 Cipher Suites is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061345_var2" operator="equals" type="number">
      <title>(L1) Ensure RC4 Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure RC4 Cipher Suites is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061346_var1" operator="equals" type="string">
      <title>(L1) Ensure RC4 Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure RC4 Cipher Suites is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061346_var2" operator="equals" type="number">
      <title>(L1) Ensure RC4 Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure RC4 Cipher Suites is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061347_var1" operator="equals" type="string">
      <title>(L1) Ensure RC4 Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure RC4 Cipher Suites is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061347_var2" operator="equals" type="number">
      <title>(L1) Ensure RC4 Cipher Suites is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure RC4 Cipher Suites is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061348_var1" operator="equals" type="string">
      <title>(L1) Ensure AES 128/128 Cipher Suite is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure AES 128/128 Cipher Suite is Disabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061348_var2" operator="equals" type="number">
      <title>(L1) Ensure AES 128/128 Cipher Suite is Disabled</title>
      <description>This value is used in Rule: (L1) Ensure AES 128/128 Cipher Suite is Disabled for the registry value</description>
      <value>0</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061349_var1" operator="equals" type="string">
      <title>(L1) Ensure AES 256/256 Cipher Suite is Enabled</title>
      <description>This value is used in Rule: (L1) Ensure AES 256/256 Cipher Suite is Enabled for the registry data type</description>
      <value>reg_dword</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061349_var2" operator="equals" type="number">
      <title>(L1) Ensure AES 256/256 Cipher Suite is Enabled</title>
      <description>This value is used in Rule: (L1) Ensure AES 256/256 Cipher Suite is Enabled for the registry value</description>
      <value>1</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061350_var1" operator="equals" type="string">
      <title>(L2) Ensure TLS Cipher Suite ordering is Configured</title>
      <description>This value is used in Rule: (L2) Ensure TLS Cipher Suite ordering is Configured for the registry data type</description>
      <value>reg_multi_sz</value>
   </Value>
   <Value id="xccdf_org.cisecurity.benchmarks_value_4061350_var2" operator="equals" type="string">
      <title>(L2) Ensure TLS Cipher Suite ordering is Configured</title>
      <description>This value is used in Rule: (L2) Ensure TLS Cipher Suite ordering is Configured for the registry value</description>
      <value>^TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384|TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256|TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384|TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256|TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384|TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256|TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384|TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256$</value>
   </Value>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_1_Basic_Configurations">
      <xccdf:title xml:lang="en">Basic Configurations</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains basic Web server-level recommendations.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.1_L1_Ensure_Web_content_is_on_non-system_partition" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'Web content' is on non-system partition</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Web resources published through IIS are mapped via Virtual Directories to physical locations on disk. It is recommended to map all Virtual Directories to a non-system disk volume.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Controlled Access Based on the Need to Know" urn="urn:cisecurity.org:controls:7.0:14"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Isolating web content from system files may reduce the probability of web sites/applications exhausting system disk space. It can also reduce the file IO vulnerability in the web site/application from affecting the confidentiality and/or integrity of system files.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://blogs.iis.net/thomad/archive/2008/02/10/moving-the-iis7-inetpub-directory-to-a-different-drive.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Browse to web content in                 <xhtml:span class="inline_block">C:\inetpub\wwwroot\</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>
Copy or cut content onto a dedicated and restricted web folder on a non-system drive such as                 <xhtml:span class="inline_block">D:\webroot\</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>Change mappings for any applications or Virtual Directories to reflect the new location</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>
To change the mapping for the application named               <xhtml:em>app1</xhtml:em>
 which resides under the Default Web Site, open IIS Manager:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Expand the server node</xhtml:li>
                     <xhtml:li>Expand Sites</xhtml:li>
                     <xhtml:li>Expand Default Web Site</xhtml:li>
                     <xhtml:li>
Click on                 <xhtml:em>app1</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>In the Actions pane, select Basic Settings</xhtml:li>
                     <xhtml:li>
In the Physical path text box, put the new location of the application,                 <xhtml:span class="inline_block">D:\wwwroot\app1</xhtml:span>
 in the example above              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Once the configuration is changed all content from the root drive to the new drive including ACLs and empty directories will need to copied.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.2_L1_Ensure_Host_headers_are_on_all_sites" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'Host headers' are on all sites</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Host headers provide the ability to host multiple websites on the same IP address and port. It is recommended that host headers be configured for all sites.</xhtml:p>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 Wildcard host headers are now supported.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Requiring a Host header for all sites may reduce the probability of DNS rebinding attacks successfully compromising or abusing site data or functionality and IP-based scans successfully identifying or interacting with a target application hosted on IIS.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc753195%28WS.10%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://crypto.stanford.edu/dns/dns-rebinding.pdf</xccdf:ident>
         <xccdf:ident system="URL">http://www.sslshopper.com/article-ssl-host-headers-in-iis-7.html</xccdf:ident>
         <xccdf:ident system="URL">http://blogs.iis.net/thomad/archive/2008/01/25/ssl-certificates-on-sites-with-host-headers.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://www.iis.net/learn/get-started/whats-new-in-iis-10/wildcard-host-header-support</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Obtain a listing of all sites by using the following               <xhtml:span class="inline_block">appcmd.exe</xhtml:span>
 command:            </xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure the host header:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config  -section:system.applicationHost/sites /"[name='&lt;website name&gt;'].bindings.[protocol='http',bindingInformation='*:80:&lt;host header&gt;'].bindingInformation:"*:80:&lt;host header&gt;""  /commit:apphost
</xhtml:code>
                  <xhtml:p>
                     <xhtml:em>OR</xhtml:em>
                  </xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure the host header:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter 'system.applicationHost/sites/site[@name='&lt;website name&gt;']/bindings/binding[@protocol='http' and @bindingInformation='*:80:']' -name 'bindingInformation' -value '*:80:&lt;host header value&gt;'
</xhtml:code>
                  <xhtml:p>
                     <xhtml:em>OR</xhtml:em>
                  </xhtml:p>
                  <xhtml:p>Perform the following in IIS Manager to configure host headers for the Default Web Site:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager</xhtml:li>
                     <xhtml:li>In the Connections pane expand the Sites node and select Default Web Site</xhtml:li>
                     <xhtml:li>In the Actions pane click Bindings</xhtml:li>
                     <xhtml:li>In the Site Bindings dialog box, select the binding for which host headers are going to be configured, Port 80 in this example</xhtml:li>
                     <xhtml:li>Click Edit</xhtml:li>
                     <xhtml:li>
Under host name, enter the sites FQDN, such as                 <xhtml:em>&lt;www.examplesite.com&gt;</xhtml:em>
                     </xhtml:li>
                     <xhtml:li>Click OK, then Close</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>
                     <xhtml:strong>Note:</xhtml:strong>
 Requiring a host header may impair site functionality for HTTP/1.0 clients.            </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If a wildcard DNS entry exists and a wildcard host header is used, it may be serving data to more domains than intended.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061312" value-id="xccdf_org.cisecurity.benchmarks_value_4061312_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061312"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.3_L1_Ensure_Directory_browsing_is_set_to_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'Directory browsing' is set to Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Directory browsing allows the contents of a directory to be displayed upon request from a web client. If directory browsing is enabled for a directory in Internet Information Services, users receive a page that lists the contents of the directory when the following two conditions are met:</xhtml:p>
            <xhtml:ol>
               <xhtml:li>No specific file is requested in the URL</xhtml:li>
               <xhtml:li>The Default Documents feature is disabled in IIS, or if it is enabled, IIS is unable to locate a file in the directory that matches a name specified in the IIS default document list</xhtml:li>
            </xhtml:ol>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 If directory browsing is enabled (an exception to this recommendation), make sure that it is only enabled on the particular directory or directories that need to be shared.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Ensuring that directory browsing is disabled may reduce the probability of disclosing sensitive content that is inadvertently accessible via IIS.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc725840%28WS.10%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc731109%28WS.10%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Directory Browsing can be set by using the UI, running               <xhtml:span class="inline_block">appcmd.exe</xhtml:span>
 commands, by editing configuration files directly, or by writing WMI scripts. To disable directory browsing at the server level using an               <xhtml:span class="inline_block">appcmd.exe</xhtml:span>
 command:            </xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /section:directoryBrowse /enabled:false
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -Filter system.webserver/directorybrowse -PSPath iis:\ -Name Enabled  -Value False
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Users will not be able to see the contents of directories.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061313" value-id="xccdf_org.cisecurity.benchmarks_value_4061313_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061313"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.4_L1_Ensure_application_pool_identity_is_configured_for_all_application_pools" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'application pool identity' is configured for all application pools</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Application Pool Identities are the actual users/authorities that will run the worker process -           <xhtml:span class="inline_block">w3wp.exe</xhtml:span>
. Assigning the correct user authority will help ensure that applications can function properly, while not giving overly permissive permissions on the system. These identities can further be used in ACLs to protect system content. It is recommended that each Application Pool run under a unique identity.        </xhtml:p>
            <xhtml:p>IIS has additional built-in least privilege identities intended for use by Application Pools. It is recommended that the default Application Pool Identity be changed to a least privilege principle other than Network Service. Furthermore, it is recommended that all application pool identities be assigned a unique least privilege principal.</xhtml:p>
            <xhtml:p>To achieve isolation in IIS, application pools can be run as separate identities. IIS can be configured to automatically use the application pool identity if no anonymous user account is configured for a Web site. This can greatly reduce the number of accounts needed for Web sites and make management of the accounts easier. It is recommended the Application Pool Identity be set as the Anonymous User Identity.</xhtml:p>
            <xhtml:p>
The name of the Application Pool account corresponds to the name of the Application Pool. Application Pool Identities were introduced in Windows Server 2008 SP2. It is recommended that Application Pools be set to run as           <xhtml:span class="inline_block">ApplicationPoolIdentity</xhtml:span>
 unless there is an underlying reason that the application pool needs to run as a specified end user account. One example where this is needed is for web farms using Kerberos authentication.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Setting Application Pools to use unique least privilege identities such as           <xhtml:span class="inline_block">ApplicationPoolIdentity</xhtml:span>
 reduces the potential harm the identity could cause should the application ever become compromised.        </xhtml:p>
            <xhtml:p>Additionally, it will simplify application pools configuration and account management.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc771170%28WS.10%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/140/understanding-built-in-user-and-group-accounts-in-iis-7/</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/624/application-pool-identities/</xccdf:ident>
         <xccdf:ident system="URL">http://blogs.iis.net/tomwoolums/archive/2008/12/17/iis-7-0-application-pools.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
The default Application Pool identity may be set for an application using the IIS Manager GUI, using               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, directly editing the configuration files, or by writing WMI scripts. Perform the following to change the default identity to the built-in               <xhtml:span class="inline_block">ApplicationPoolIdentity</xhtml:span>
 in the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open the IIS Manager GUI</xhtml:li>
                     <xhtml:li>In the connections pane, expand the server node and click Application Pools</xhtml:li>
                     <xhtml:li>
On the Application Pools page, select the                 <xhtml:span class="inline_block">DefaultAppPool</xhtml:span>
, and then click Advanced Settings in the Actions pane              </xhtml:li>
                     <xhtml:li>
For the Identity property, click the                 <xhtml:span class="inline_block">'...'</xhtml:span>
 button to open the Application Pool Identity dialog box              </xhtml:li>
                     <xhtml:li>
Select the Built-in account option choose                 <xhtml:span class="inline_block">ApplicationPoolIdentity</xhtml:span>
 from the list, or input a unique application user created for this purpose              </xhtml:li>
                     <xhtml:li>Restart IIS</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>
To change the               <xhtml:span class="inline_block">ApplicationPool</xhtml:span>
 identity to the built-in               <xhtml:span class="inline_block">ApplicationPoolIdentity</xhtml:span>
 using AppCmd.exe, run the following from a command prompt:            </xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /section:applicationPools /[name='&lt;apppool name&gt;'].processModel.identityType:ApplicationPoolIdentity 
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>
To change the               <xhtml:span class="inline_block">ApplicationPool</xhtml:span>
 identity to the built-in               <xhtml:span class="inline_block">ApplicationPoolIdentity</xhtml:span>
 using PowerShell:            </xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter 'system.applicationHost/applicationPools/add[@name='&lt;apppool name&gt;']/processModel' -name 'identityType' -value 'ApplicationPoolIdentity'
</xhtml:code>
                  <xhtml:p>
The example code above will set just the               <xhtml:span class="inline_block">DefaultAppPool</xhtml:span>
. Run this command for each configured Application Pool. Additionally,               <xhtml:span class="inline_block">ApplicationPoolIdentity</xhtml:span>
 can be made the default for all Application Pools by using the Set Application Pool Defaults action on the Application Pools node.            </xhtml:p>
                  <xhtml:p>If using a custom defined Windows user such as a dedicated service account, that user will need to be a member of the IIS_IUSRS group. The IIS_IUSRS group has access to all the necessary file and system resources so that an account, when added to this group, can seamlessly act as an application pool identity.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If Application Pool Identities are not set properly to users/authorities applications may not function properly.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061314" value-id="xccdf_org.cisecurity.benchmarks_value_4061314_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061314"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.5_L1_Ensure_unique_application_pools_is_set_for_sites" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'unique application pools' is set for sites</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Application Pool Identities allows Application Pools to be run under unique accounts without the need to create and manage local or domain accounts.</xhtml:p>
            <xhtml:p>It is recommended that all Sites run under unique, dedicated Application Pools.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By setting sites to run under unique Application Pools, resource-intensive applications can be assigned to their own application pools which could improve server and application performance. In addition, it can help maintain application availability: if an application in one pool fails, applications in other pools are not affected. Last, isolating applications helps mitigate the potential risk of one application being allowed access to the resources of another application. It is also recommended to stop any application pool that is not in use or was created by an installation such as .Net 4.0.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc753449%28WS.10%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://blogs.iis.net/tomwoolums/archive/2008/12/17/iis-7-0-application-pools.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/624/application-pool-identities/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>The following appcmd.exe command will set the application pool for a given application:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set app '&lt;website name&gt;/' /applicationpool:&lt;apppool name&gt;
</xhtml:code>
                  <xhtml:p>The output of this command will be similar to the following: APP object "Default Web Site/" changed (applicationPool:DefaultAppPool)</xhtml:p>
                  <xhtml:p>Run the above command to ensure a unique application pool is assigned for each site listed</xhtml:p>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-ItemProperty -Path 'IIS:\Sites\&lt;website name&gt;' -Name applicationPool -Value &lt;apppool name&gt;
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager</xhtml:li>
                     <xhtml:li>Open the Sites node underneath the machine node</xhtml:li>
                     <xhtml:li>Select the Site to be changed</xhtml:li>
                     <xhtml:li>In the Actions pane, select Basic Settings</xhtml:li>
                     <xhtml:li>Click the Select… box next to the Application Pool text box</xhtml:li>
                     <xhtml:li>Select the desired Application Pool</xhtml:li>
                     <xhtml:li>Once selected, click OK</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>All sites will need to be run under unique dedicated Application Pools.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061315" value-id="xccdf_org.cisecurity.benchmarks_value_4061315_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061315"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.6_L1_Ensure_application_pool_identity_is_configured_for_anonymous_user_identity" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'application pool identity' is configured for anonymous user identity</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>To achieve isolation in IIS, application pools can be run as separate identities. IIS can be configured to automatically use the application pool identity if no anonymous user account is configured for a web site. This can greatly reduce the number of accounts needed for Web sites and make management of the accounts easier.</xhtml:p>
            <xhtml:p>It is recommended the Application Pool Identity be set as the Anonymous User Identity.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Configuring the anonymous user identity to use the application pool identity will help ensure site isolation - provided sites are set to use the application pool identity. Since a unique principal will run each application pool, it will ensure the identity is least privilege. Additionally, it will simplify Site management.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/202/application-pool-identity-as-anonymous-user/</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/624/application-pool-identities/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
The Anonymous User Identity can be set to Application Pool Identity by using the IIS Manager GUI, using               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, directly editing the configuration files, or by writing WMI scripts. Perform the following to set the username attribute of the               <xhtml:span class="inline_block">anonymousAuthentication</xhtml:span>
 node in the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open the IIS Manager GUI and navigate to the desired server, site, or application</xhtml:li>
                     <xhtml:li>In Features View, find and double-click the Authentication icon</xhtml:li>
                     <xhtml:li>Select the Anonymous Authentication option and in the Actions pane select Edit...</xhtml:li>
                     <xhtml:li>Choose Application pool identity in the modal window and then press the OK button</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>
To use AppCmd.exe to configure               <xhtml:span class="inline_block">anonymousAuthentication</xhtml:span>
 at the server level, the command would look like this:            </xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config -section:anonymousAuthentication /username:"" --password
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-ItemProperty -Path IIS:\AppPools\&lt;apppool name&gt; -Name passAnonymousToken -Value True
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061316" value-id="xccdf_org.cisecurity.benchmarks_value_4061316_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061316"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_1.7_L1_Ensure_WebDav_feature_is_disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure' WebDav' feature is disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>WebDAV is an extension to the HTTP protocol which allows clients to create, move, and delete files and resources on the web server.</xhtml:p>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 The WebDAV feature must be enabled for this functionality to be available in IIS.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Apply Secure Design Principles in Application Architectures" urn="urn:cisecurity.org:controls:8.0:16:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Applications</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure Only Approved Ports, Protocols and Services Are Running" urn="urn:cisecurity.org:controls:7.0:9:2">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>WebDAV is not widely used, and it has serious security concerns because it may allow clients to modify unauthorized files on the web server. Therefore, the WebDav feature should be disabled.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/16/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To disable this feature using PowerShell, enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">Uninstall-WindowsFeature Web-DAV-Publishing
</xhtml:code>
                  <xhtml:p>Verify that Success is True</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The WebDav feature will not be available in IIS.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_2_Configure_Authentication_and_Authorization">
      <xccdf:title xml:lang="en">Configure Authentication and Authorization</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations around the different layers of authentication in IIS.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.1_L1_Ensure_global_authorization_rule_is_set_to_restrict_access" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'global authorization rule' is set to restrict access</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>IIS introduced URL Authorization, which allows the addition of Authorization rules to the actual URL, instead of the underlying file system resource, as a way to protect it. Authorization rules can be configured at the server, web site, folder (including Virtual Directories), or file level. The native URL Authorization module applies to all requests, whether they are .NET managed or other types of files (e.g., static files or ASP files). It is recommended that URL Authorization be configured to only grant access to the necessary security principals.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Configuring a global Authorization rule that restricts access will ensure inheritance of the settings down through the hierarchy of web directories; if that content is copied elsewhere, the authorization rules flow with it. This will ensure access to current and future content is only granted to the appropriate principals, mitigating risk of accidental or unauthorized access.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.iis.net/learn/manage/configuring-security/understanding-iis-url-authorization</xccdf:ident>
         <xccdf:ident system="URL">http://www.iis.net/learn/get-started/whats-new-in-iis-7/changes-in-security-between-iis-60-and-iis-7-and-above#Authorization</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To configure URL Authorization at the server level using command line utilities:</xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config  -section:system.webServer/security/authorization /-"[users='*',roles='',verbs='']"
</xhtml:code>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config  -section:system.webServer/security/authorization /+"[accessType='Allow',roles='Administrators']"
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Remove-WebConfigurationProperty  -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/security/authorization" -name "." -AtElement @{users='*';roles='';verbs=''}
</xhtml:code>
                  <xhtml:code class="code_block">Add-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/security/authorization" -name "." -value @{accessType='Allow';roles='Administrators'}
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>To configure URL Authorization at the server level using IIS Manager:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Connect to Internet Information Services (IIS Manager)</xhtml:li>
                     <xhtml:li>Select the server</xhtml:li>
                     <xhtml:li>Select Authorization Rules</xhtml:li>
                     <xhtml:li>Remove the "Allow All Users" rule</xhtml:li>
                     <xhtml:li>Click Add Allow Rule…</xhtml:li>
                     <xhtml:li>Allow access to the user(s), user groups, or roles that are authorized across all of the web sites and applications (e.g. the Administrators group)</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If not set properly, the authorization rule could restrict assess at a level that is not intended to be restricted.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.2_L1_Ensure_access_to_sensitive_site_features_is_restricted_to_authenticated_principals_only" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Ensure access to sensitive site features is restricted to authenticated principals only</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>IIS supports both challenge-based and login redirection-based authentication methods. Challenge-based authentication methods, such as Integrated Windows Authentication, require a client to respond correctly to a server-initiated challenge. A login redirection-based authentication method such as Forms Authentication relies on redirection to a login page to determine the identity of the principal. Challenge-based authentication and login redirection-based authentication methods cannot be used in conjunction with one another.</xhtml:p>
            <xhtml:p>Public servers/sites are typically configured to use Anonymous Authentication. This method typically works, provided the content or services is intended for use by the public. When sites, applications, or specific content containers are not intended for anonymous public use, an appropriate authentication mechanism should be utilized. Authentication will help confirm the identity of clients who request access to sites, application, and content. IIS provides the following authentication modules by default:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>Anonymous Authentication - allows anonymous users to access sites, applications, and/or content</xhtml:li>
               <xhtml:li>Integrated Windows Authentication - authenticates users using the NTLM or Kerberos protocols; Kerberos v5 requires a connection to Active Directory</xhtml:li>
               <xhtml:li>ASP.NET Impersonation - allows ASP.NET applications to run under a security context different from the default security context for an application</xhtml:li>
               <xhtml:li>Forms Authentication - enables a user to login to the configured space with a valid username and password which is then validated against a database or other credentials store</xhtml:li>
               <xhtml:li>Basic authentication - requires a valid username and password to access content</xhtml:li>
               <xhtml:li>Client Certificate Mapping Authentication - allows automatic authentication of users who log on with client certificates that have been configured; requires SSL</xhtml:li>
               <xhtml:li>Digest Authentication - uses Windows domain controller to authenticate users who request access</xhtml:li>
            </xhtml:ul>
            <xhtml:p>Note that none of the challenge-based authentication modules can be used at the same time Forms Authentication is enabled for certain applications/content. Forms Authentication does not rely on IIS authentication, so anonymous access for the ASP.NET application can be configured if Forms Authentication will be used.</xhtml:p>
            <xhtml:p>It is recommended that sites containing sensitive information, confidential data, or non-public web services be configured with a credentials-based authentication mechanism.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Configuring authentication will help mitigate the risk of unauthorized users accessing data and/or services, and in some cases reduce the potential harm that can be done to a system.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/377/using-aspnet-forms-authentication/rev/1</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/244/how-to-take-advantage-of-the-iis7-integrated-pipeline/</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc733010%28WS.10%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa480476.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://technet.microsoft.com/en-us/library/hh831496(v=ws.11).aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>When configuring an authentication module for the first time, each mechanism must be completely configured before use.</xhtml:p>
                  <xhtml:p>
Enabling authentication can be performed by using the user interface (UI), running               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, editing configuration files directly, or by writing WMI scripts. To verify an authentication mechanism is in place for sensitive content using the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager and navigate to level with sensitive content</xhtml:li>
                     <xhtml:li>In Features View, double-click Authentication</xhtml:li>
                     <xhtml:li>On the Authentication page, make sure an authentication module is enabled, while anonymous authentication is enabled (Forms Authentication can have anonymous as well)</xhtml:li>
                     <xhtml:li>If necessary, select the desired authentication module, then in the Actions pane, click Enable</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config  -section:system.web/authentication /mode:&lt;Windows|Passport|Forms&gt;
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -location '&lt;website location&gt;' -filter 'system.webServer/security/authentication/anonymousAuthentication' -name 'enabled' -value 'False'
</xhtml:code>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -location '&lt;website location&gt;' -filter 'system.webServer/security/authentication/windowsAuthentication' -name 'enabled' -value 'True'
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Authentication will be restricted to the method that is applied.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.3_L1_Ensure_forms_authentication_require_SSL" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'forms authentication' require SSL</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Forms-based authentication can pass credentials across the network in clear text. It is therefore imperative that the traffic between client and server be encrypted using SSL, especially in cases where the site is publicly accessible. It is recommended that communications with any portion of a site using Forms Authentication be encrypted using SSL.</xhtml:p>
            <xhtml:p>
               <xhtml:strong>NOTE</xhtml:strong>
 Due to identified security vulnerabilities, SSL no longer provides adequate protection for a sensitive information.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Requiring SSL for Forms Authentication will protect the confidentiality of credentials during the login process, helping mitigate the risk of stolen user information.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc771077(WS.10).aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager and navigate to the appropriate tier</xhtml:li>
                     <xhtml:li>In Features View, double-click Authentication</xhtml:li>
                     <xhtml:li>On the Authentication page, select Forms Authentication</xhtml:li>
                     <xhtml:li>In the Actions pane, click Edit</xhtml:li>
                     <xhtml:li>Check the Requires SSL checkbox in the cookie settings section, click OK</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config  -section:system.web/authentication /mode:Forms
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST/Default Web Site'  -filter 'system.web/authentication/forms' -name 'requireSSL' -value 'True'
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>None.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066530" value-id="xccdf_org.cisecurity.benchmarks_value_4066530_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066530"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.4_L2_Ensure_forms_authentication_is_set_to_use_cookies" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure 'forms authentication' is set to use cookies</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Forms Authentication can be configured to maintain the site visitor's session identifier in either a URI or cookie. It is recommended that Forms Authentication be set to use cookies.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Using cookies to manage session state may help mitigate the risk of session hi-jacking attempts by preventing ASP.NET from having to move session information to the URL. Moving session information identifiers into the URL may cause session IDs to show up in proxy logs, browsing history, and be accessible to client scripting via           <xhtml:span class="inline_block">document.location</xhtml:span>
.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc732830%28WS.10%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager and navigate to the level where Forms Authentication is enabled</xhtml:li>
                     <xhtml:li>In Features View, double-click Authentication</xhtml:li>
                     <xhtml:li>On the Authentication page, select Forms Authentication</xhtml:li>
                     <xhtml:li>In the Actions pane, click Edit</xhtml:li>
                     <xhtml:li>In the Cookie settings section, select Use cookies from the Mode dropdown</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config  -section:system.web/authentication /forms.cookieless:"UseCookies"
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST/Default Web Site'  -filter 'system.web/authentication/forms' -name 'cookieless' -value 'UseCookies'
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Site visitor's session identifier will be stored via cookies.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066531" value-id="xccdf_org.cisecurity.benchmarks_value_4066531_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066531"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.5_L1_Ensure_cookie_protection_mode_is_configured_for_forms_authentication" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'cookie protection mode' is configured for forms authentication</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The cookie protection mode defines the protection Forms Authentication cookies will be given within a configured application. The four cookie protection modes that can be defined are:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>Encryption and validation - Specifies that the application use both data validation and encryption to help protect the cookie; this option uses the configured data validation algorithm (based on the machine key) and triple-DES (3DES) for encryption, if available and if the key is long enough (48 bytes or more)</xhtml:li>
               <xhtml:li>None - Specifies that both encryption and validation are disabled for sites that are using cookies only for personalization and have weaker security requirements</xhtml:li>
               <xhtml:li>Encryption - Specifies that the cookie is encrypted by using Triple-DES or DES, but data validation is not performed on the cookie; cookies used in this manner might be subject to plain text attacks</xhtml:li>
               <xhtml:li>Validation - Specifies that a validation scheme verifies that the contents of an encrypted cookie have not been changed in transit</xhtml:li>
            </xhtml:ul>
            <xhtml:p>It is recommended that cookie protection mode always encrypt and validate Forms Authentication cookies.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By encrypting and validating the cookie, the confidentiality and integrity of data within the cookie is assured. This helps mitigate the risk of attacks such as session hijacking and impersonation.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc731804%28WS.10%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Cookie protection mode can be configured by using the user interface (UI), by running               <xhtml:span class="inline_block">Appcmd.exe</xhtml:span>
 commands in a command-line window, by editing configuration files directly, or by writing WMI scripts. Using IIS Manager:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager and navigate to the level where Forms Authentication is enabled</xhtml:li>
                     <xhtml:li>In Features View, double-click Authentication</xhtml:li>
                     <xhtml:li>On the Authentication page, select Forms Authentication</xhtml:li>
                     <xhtml:li>In the Actions pane, click Edit</xhtml:li>
                     <xhtml:li>In the Cookie settings section, verify the drop-down for Protection mode is set for Encryption and validation</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST/&lt;website name&gt;'  -filter 'system.web/authentication/forms' -name 'protection' -value 'All'
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Protection Forms Authentication cookies will restricted to the mode defined.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066532" value-id="xccdf_org.cisecurity.benchmarks_value_4066532_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066532"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.6_L1_Ensure_transport_layer_security_for_basic_authentication_is_configured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure transport layer security for 'basic authentication' is configured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Basic Authentication can pass credentials across the network in clear text. It is therefore imperative that the traffic between client and server be encrypted, especially in cases where the site is publicly accessible and is recommended that TLS be configured and required for any Site or Application using Basic Authentication.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Credentials sent in clear text can be easily intercepted by malicious code or persons. Enforcing the use of Transport Layer Security will help mitigate the chances of hijacked credentials.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dd378853%28WS.10%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To protect Basic Authentication with transport layer security:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager</xhtml:li>
                     <xhtml:li>In the Connections pane on the left, select the server to be configured</xhtml:li>
                     <xhtml:li>In the Connections pane, expand the server, then expand Sites and select the site to be configured</xhtml:li>
                     <xhtml:li>In the Actions pane, click Bindings; the Site Bindings dialog appears</xhtml:li>
                     <xhtml:li>If an HTTPS binding is available, click Close and see below "To require SSL"</xhtml:li>
                     <xhtml:li>If no HTTPS binding is visible, perform the following steps</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To add an HTTPS binding:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>In the Site Bindings dialog, click Add; the Add Site Binding dialog appears</xhtml:li>
                     <xhtml:li>Under Type, select https</xhtml:li>
                     <xhtml:li>Under SSL certificate, select an X.509 certificate</xhtml:li>
                     <xhtml:li>Click OK, then close</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>To require SSL:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>In Features View, double-click SSL Settings</xhtml:li>
                     <xhtml:li>On the SSL Settings page, select Require SSL.</xhtml:li>
                     <xhtml:li>In the Actions pane, click Apply</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -location '&lt;website name&gt;' -filter 'system.webServer/security/access' -name 'sslFlags' -value 'Ssl'
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Credentials will not be passed across the network in plain text.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.7_L1_Ensure_passwordFormat_is_not_set_to_clear" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'passwordFormat' is not set to clear</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">&lt;credentials&gt;</xhtml:span>
 element of the           <xhtml:span class="inline_block">&lt;authentication&gt;</xhtml:span>
 element allows optional definitions of name and password for IIS Manager User accounts within the configuration file. Forms based authentication also uses these elements to define the users. IIS Manager Users can use the administration interface to connect to sites and applications in which they've been granted authorization.        </xhtml:p>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 The           <xhtml:span class="inline_block">&lt;credentials&gt;</xhtml:span>
 element only applies when the default provider,           <xhtml:span class="inline_block">ConfigurationAuthenticationProvider</xhtml:span>
, is configured as the authentication provider.        </xhtml:p>
            <xhtml:p>
It is recommended that           <xhtml:span class="inline_block">passwordFormat</xhtml:span>
 be set to a value other than           <xhtml:span class="inline_block">Clear</xhtml:span>
, such as           <xhtml:span class="inline_block">SHA1</xhtml:span>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data at Rest" urn="urn:cisecurity.org:controls:8.0:3:11">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt or Hash all Authentication Credentials" urn="urn:cisecurity.org:controls:7.0:16:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Authentication credentials should always be protected to reduce the risk of stolen authentication credentials.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/11" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.iis.net/ConfigReference/system.webServer/management/authentication/credentials</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/bb422401%28VS.90%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://docs.microsoft.com/en-us/dotnet/framework/whats-new/#v471</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Authentication mode is configurable at the               <xhtml:span class="inline_block">machine.config</xhtml:span>
, root-level               <xhtml:span class="inline_block">web.config</xhtml:span>
, or application-level               <xhtml:span class="inline_block">web.config</xhtml:span>
:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Locate and open the configuration file where the credentials are stored</xhtml:li>
                     <xhtml:li>
Find the                 <xhtml:span class="inline_block">&lt;credentials&gt;</xhtml:span>
 element              </xhtml:li>
                     <xhtml:li>
If present, ensure                 <xhtml:span class="inline_block">passwordFormat</xhtml:span>
 is not set to                 <xhtml:span class="inline_block">Clear</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>
Change                 <xhtml:span class="inline_block">passwordFormat </xhtml:span>
to                 <xhtml:span class="inline_block">SHA1</xhtml:span>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>The clear text passwords will need to be replaced with the appropriate hashed version.</xhtml:p>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST/&lt;website name&gt;'  -filter 'system.web/authentication/forms/credentials' -name 'passwordFormat' -value 'SHA1'
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:span class="inline_block">passwordFormat</xhtml:span>
 will be encrypted.              </xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066533" value-id="xccdf_org.cisecurity.benchmarks_value_4066533_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066533"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_2.8_L2_Ensure_credentials_are_not_stored_in_configuration_files" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure 'credentials' are not stored in configuration files</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">&lt;credentials&gt;</xhtml:span>
 element of the           <xhtml:span class="inline_block">&lt;authentication&gt;</xhtml:span>
 element allows optional definitions of name and password for IIS Manager User accounts within the configuration file. Forms based authentication also uses these elements to define the users. IIS Manager Users can use the administration interface to connect to sites and applications in which they've been granted authorization.        </xhtml:p>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 The           <xhtml:span class="inline_block">&lt;credentials&gt;</xhtml:span>
 element only applies when the default provider,           <xhtml:span class="inline_block">ConfigurationAuthenticationProvider</xhtml:span>
, is configured as the authentication provider.        </xhtml:p>
            <xhtml:p>It is recommended to avoid storing passwords in the configuration file even in form of hash.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt or Hash all Authentication Credentials" urn="urn:cisecurity.org:controls:7.0:16:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Users</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Authentication credentials should always be protected to reduce the risk of stolen authentication credentials. For security reasons, it is recommended that user credentials not be stored an any IIS configuration files.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/16/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://www.iis.net/ConfigReference/system.webServer/management/authentication/credentials</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/bb422401%28VS.90%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Authentication mode is configurable at the               <xhtml:span class="inline_block">machine.config</xhtml:span>
, root-level               <xhtml:span class="inline_block">web.config</xhtml:span>
, or application-level               <xhtml:span class="inline_block">web.config</xhtml:span>
:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Locate and open the configuration file where the credentials are stored</xhtml:li>
                     <xhtml:li>
Find the                 <xhtml:span class="inline_block">&lt;credentials&gt;</xhtml:span>
 element              </xhtml:li>
                     <xhtml:li>If present, remove the section</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>This will remove all references to stored users in the configuration files.</xhtml:p>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Remove-WebConfigurationProperty  -pspath 'MACHINE/WEBROOT/APPHOST/&lt;website name&gt;'  -filter 'system.web/authentication/forms/credentials' -name '.'
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Passwords in the configuration file will be stored in form of a hash.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066534" value-id="xccdf_org.cisecurity.benchmarks_value_4066534_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066534"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_3_ASP.NET_Configuration_Recommendations">
      <xccdf:title xml:lang="en">ASP.NET Configuration Recommendations</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations specific to ASP.NET.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.1_L1_Ensure_deployment_method_retail_is_set" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'deployment method retail' is set</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">&lt;deployment retail&gt;</xhtml:span>
 switch is intended for use by production IIS servers. This switch is used to help applications run with the best possible performance and least possible security information leakages by disabling the application's ability to generate trace output on a page, disabling the ability to display detailed error messages to end users, and disabling the debug switch. Often times, switches and options that are developer-focused, such as failed request tracing and debugging, are enabled during active development.        </xhtml:p>
            <xhtml:p>
It is recommended that the deployment method on any production server be set to           <xhtml:span class="inline_block">retail</xhtml:span>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Utilizing the switch specifically intended for production IIS servers will eliminate the risk of vital application and system information leakages that would otherwise occur if tracing or debug were to be left enabled, or           <xhtml:span class="inline_block">customErrors</xhtml:span>
 were to be left off.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-US/library/ms228298%28VS.80%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Open the                 <xhtml:span class="inline_block">machine.config</xhtml:span>
 file located in:                 <xhtml:span class="inline_block">%systemroot%\Microsoft.NET\Framework&lt;bitness (if not the 32 bit)&gt;\&lt;framework version&gt;\CONFIG</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>
Add the line                 <xhtml:span class="inline_block">&lt;deployment retail="true" /&gt;</xhtml:span>
 within the                 <xhtml:span class="inline_block">&lt;system.web&gt;</xhtml:span>
 section              </xhtml:li>
                     <xhtml:li>
If systems are 64-bit, do the same for the                 <xhtml:span class="inline_block">machine.config</xhtml:span>
 located in:                 <xhtml:span class="inline_block">%systemroot%\Microsoft.NET\Framework&lt;bitness (if not the 32 bit)&gt;\&lt;framework version&gt;\CONFIG</xhtml:span>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.2_L2_Ensure_debug_is_turned_off" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure 'debug' is turned off</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Developers often enable the debug mode during active ASP.NET development so that they do not have to continually clear their browsers cache every time they make a change to a resource handler. The problem would arise from this being left "on" or set to "true". Compilation debug output is displayed to the end user, allowing malicious persons to obtain detailed information about applications.</xhtml:p>
            <xhtml:p>
This is a defense in depth recommendation due to the           <xhtml:span class="inline_block">&lt;deployment retail="true" /&gt;</xhtml:span>
 in the           <xhtml:span class="inline_block">machine.config</xhtml:span>
 configuration file overriding any debug settings.        </xhtml:p>
            <xhtml:p>It is recommended that debugging still be turned off.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Setting           <xhtml:span class="inline_block">&lt;compilation debug&gt;</xhtml:span>
 to           <xhtml:span class="inline_block">false</xhtml:span>
 ensures that detailed error information does not inadvertently display during live application usage, mitigating the risk of application information leakage falling into unscrupulous hands.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc725812%28WS.10%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To use the UI to make this change:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager and navigate desired server, site, or application</xhtml:li>
                     <xhtml:li>In Features View, double-click .NET Compilation</xhtml:li>
                     <xhtml:li>On the .NET Compilation page, in the Behavior section, ensure the Debug field is set to False</xhtml:li>
                     <xhtml:li>When finished, click Apply in the Actions pane</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>
Note: The               <xhtml:span class="inline_block">&lt;compilation debug&gt;</xhtml:span>
 switch will not be present in the               <xhtml:span class="inline_block">web.config</xhtml:span>
 file unless it has been added manually, or has previously been configured using the IIS Manager GUI.            </xhtml:p>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST/&lt;website name&gt;'  -filter "system.web/compilation" -name "debug" -value "False"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Debugging will be disabled.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066535" value-id="xccdf_org.cisecurity.benchmarks_value_4066535_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066535"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.3_L2_Ensure_custom_error_messages_are_not_off" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure custom error messages are not off</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
When an ASP.NET application fails and causes an HTTP/1.x 500 Internal Server Error, or a feature configuration (such as Request Filtering) prevents a page from being displayed, an error message will be generated. Administrators can choose whether or not the application should display a friendly message to the client, detailed error message to the client, or detailed error message to localhost only. The           <xhtml:span class="inline_block">&lt;customErrors&gt;</xhtml:span>
 tag in the           <xhtml:span class="inline_block">web.config</xhtml:span>
 has three modes:        </xhtml:p>
            <xhtml:ul>
               <xhtml:li>
On: Specifies that custom errors are enabled. If no             <xhtml:span class="inline_block">defaultRedirect</xhtml:span>
 attribute is specified, users see a generic error. The custom errors are shown to the remote clients and to the local host          </xhtml:li>
               <xhtml:li>Off: Specifies that custom errors are disabled. The detailed ASP.NET errors are shown to the remote clients and to the local host</xhtml:li>
               <xhtml:li>RemoteOnly: Specifies that custom errors are shown only to the remote clients, and that ASP.NET errors are shown to the local host. This is the default value</xhtml:li>
            </xhtml:ul>
            <xhtml:p>
This is a defense in depth recommendation due to the           <xhtml:span class="inline_block">&lt;deployment retail="true" /&gt;</xhtml:span>
 in the           <xhtml:span class="inline_block">machine.config</xhtml:span>
 file overriding any settings for           <xhtml:span class="inline_block">customErrors</xhtml:span>
 to be turned           <xhtml:span class="inline_block">Off</xhtml:span>
.        </xhtml:p>
            <xhtml:p>
It is recommended that           <xhtml:span class="inline_block">customErrors</xhtml:span>
 still be turned to           <xhtml:span class="inline_block">On </xhtml:span>
or           <xhtml:span class="inline_block">RemoteOnly</xhtml:span>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
               <xhtml:span class="inline_block">customErrors</xhtml:span>
 can be set to           <xhtml:span class="inline_block">On </xhtml:span>
or           <xhtml:span class="inline_block">RemoteOnly</xhtml:span>
 without leaking detailed application information to the client. Ensuring that           <xhtml:span class="inline_block">customErrors</xhtml:span>
 is not set to           <xhtml:span class="inline_block">Off </xhtml:span>
will help mitigate the risk of malicious persons learning detailed application error and server configuration information.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dd569096%28WS.10%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
                     <xhtml:span class="inline_block">customErrors</xhtml:span>
 may be set for a server, site, or application using the IIS Manager GUI, using               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, directly editing the configuration files, or by writing WMI scripts. Perform the following to set the               <xhtml:span class="inline_block">customErrors</xhtml:span>
 mode to               <xhtml:span class="inline_block">RemoteOnly</xhtml:span>
 or               <xhtml:span class="inline_block">On</xhtml:span>
 for a Web Site in the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open the IIS Manager GUI and navigate to the site to be configured</xhtml:li>
                     <xhtml:li>In Features View, find and double-click .NET Error Pages icon</xhtml:li>
                     <xhtml:li>In the Actions Pane, click Edit Feature Settings</xhtml:li>
                     <xhtml:li>In modal dialog, choose On or Remote Only for Mode settings</xhtml:li>
                     <xhtml:li>Click OK</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST/Default Web Site'  -filter "system.web/customErrors" -name "mode" -value "RemoteOnly"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066536" value-id="xccdf_org.cisecurity.benchmarks_value_4066536_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066536"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.4_L1_Ensure_IIS_HTTP_detailed_errors_are_hidden_from_displaying_remotely" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure IIS HTTP detailed errors are hidden from displaying remotely</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
A Web site's error pages are often set to show detailed error information for troubleshooting purposes during testing or initial deployment. To prevent unauthorized users from viewing this privileged information, detailed error pages must not be seen by remote users. This setting can be modified in the           <xhtml:span class="inline_block">errorMode</xhtml:span>
 attribute setting for a Web site's error pages. By default, the           <xhtml:span class="inline_block">errorMode</xhtml:span>
 attribute is set in the           <xhtml:span class="inline_block">Web.config</xhtml:span>
 file for the Web site or application and is located in the           <xhtml:span class="inline_block">&lt;httpErrors&gt;</xhtml:span>
 element of the           <xhtml:span class="inline_block">&lt;system.webServer&gt;</xhtml:span>
 section.        </xhtml:p>
            <xhtml:p>It is recommended that custom errors be prevented from displaying remotely.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The information contained in custom error messages can provide clues as to how applications function, opening up unnecessary attack vectors. Ensuring custom errors are never displayed remotely can help mitigate the risk of malicious persons obtaining information as to how the application works.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dd391900%28WS.10%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://www.iis.net/configreference/system.webserver/httperrors</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
The following describes how to change the               <xhtml:span class="inline_block">errorMode</xhtml:span>
 attribute to               <xhtml:span class="inline_block">DetailedLocalOnly</xhtml:span>
 or               <xhtml:span class="inline_block">Custom</xhtml:span>
 for a Web site by using IIS Manager:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager with Administrative privileges</xhtml:li>
                     <xhtml:li>In the Connections pane on the left, expand the server, then expand the Sites folder</xhtml:li>
                     <xhtml:li>Select the Web site or application to be configured</xhtml:li>
                     <xhtml:li>In Features View, select Error Pages, in the Actions pane, select Open Feature</xhtml:li>
                     <xhtml:li>In the Actions pane, select Edit Feature Settings</xhtml:li>
                     <xhtml:li>In the Edit Error Pages Settings dialog, under Error Responses, select either Custom error pages or Detailed errors for local requests and custom error pages for remote requests</xhtml:li>
                     <xhtml:li>Click OK and exit the Edit Error Pages Settings dialog</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST/&lt;website name&gt;'  -filter "system.webServer/httpErrors" -name "errorMode" -value "DetailedLocalOnly"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Custom errors will not be viewable remotely.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066537" value-id="xccdf_org.cisecurity.benchmarks_value_4066537_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066537"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.5_L2_Ensure_ASP.NET_stack_tracing_is_not_enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure ASP.NET stack tracing is not enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">trace</xhtml:span>
 element configures the ASP.NET code tracing service that controls how trace results are gathered, stored, and displayed. When tracing is enabled, each page request generates trace messages that can be appended to the page output or stored in an application trace log.        </xhtml:p>
            <xhtml:p>
This is a defense in depth recommendation due to the           <xhtml:span class="inline_block">&lt;deployment retail="true" /&gt;</xhtml:span>
 in the           <xhtml:span class="inline_block">machine.config</xhtml:span>
 file overriding any settings for ASP.NET stack tracing that are left on.        </xhtml:p>
            <xhtml:p>It is recommended that ASP.NET stack tracing still be turned off.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>In an active Web Site, tracing should not be enabled because it can display sensitive configuration and detailed stack trace information to anyone who views the pages in the site.</xhtml:p>
            <xhtml:p>
If necessary, the           <xhtml:span class="inline_block">localOnly</xhtml:span>
 attribute can be set to true to have trace information displayed only for localhost requests. Ensuring that ASP.NET stack tracing is not on will help mitigate the risk of malicious persons learning detailed stack trace information.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/94c55d08%28v=vs.100%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/0x5wc973%28v=vs.100%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Ensure                 <xhtml:span class="inline_block">&lt;deployment retail="true" /&gt; </xhtml:span>
is enabled in the                 <xhtml:span class="inline_block">machine.config</xhtml:span>
.              </xhtml:li>
                     <xhtml:li>Remove all attribute references to ASP.NET tracing by deleting the trace and trace enable attributes.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Per Page:</xhtml:p>
                  <xhtml:p>Remove any references to:</xhtml:p>
                  <xhtml:code class="code_block">Trace="true"
</xhtml:code>
                  <xhtml:p>Per Application:</xhtml:p>
                  <xhtml:code class="code_block">
&lt;configuration&gt;              <br/>
  &lt;system.web&gt;              <br/>
     &lt;trace enabled="true"&gt;              <br/>
  &lt;/system.web&gt;              <br/>
&lt;/configuration&gt;
            </xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST/&lt;website name&gt;'  -filter "system.web/trace" -name "enabled" -value "False"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>ASP.NET stack tracing still be turned off and sensitive configuration and detailed stack trace information will not be viewable to anyone who views the pages in the site.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066538" value-id="xccdf_org.cisecurity.benchmarks_value_4066538_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066538"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.6_L2_Ensure_httpcookie_mode_is_configured_for_session_state" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure 'httpcookie' mode is configured for session state</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>A session cookie associates session information with client information for that session, which can be the duration of a user's connection to a site. The cookie is passed in a HTTP header together with all requests between the client and server.</xhtml:p>
            <xhtml:p>
Session information can also be stored in the URL. However, storing session information in this manner has security implications that can open attack vectors such as session hijacking. An effective method used to prevent session hijacking attacks is to force web applications to use cookies to store the session token. This is accomplished by setting the           <xhtml:span class="inline_block">cookieless</xhtml:span>
 attribute of the           <xhtml:span class="inline_block">sessionState</xhtml:span>
 node to           <xhtml:span class="inline_block">UseCookies</xhtml:span>
 or           <xhtml:span class="inline_block">False</xhtml:span>
 which will in turn keep session state data out of URI.        </xhtml:p>
            <xhtml:p>
It is recommended that session state be configured to           <xhtml:span class="inline_block">UseCookies</xhtml:span>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Cookies that have been properly configured help mitigate the risk of attacks such as session hi-jacking attempts by preventing ASP.NET from having to move session information to the URL; moving session information in URI causes session IDs to show up in proxy logs and is accessible to client scripting via           <xhtml:span class="inline_block">document.location</xhtml:span>
.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://www.iis.net/learn/application-frameworks/scenario-build-an-aspnet-website-on-iis/planning-step-2-plan-asp-net-settings</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/h6bb9cz9%28VS.71%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
                     <xhtml:span class="inline_block">SessionState</xhtml:span>
 can be set to               <xhtml:span class="inline_block">UseCookies</xhtml:span>
 by using the IIS Manager GUI, using               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, directly editing the configuration files, or by writing WMI scripts. Perform the following to set the               <xhtml:span class="inline_block">cookieless</xhtml:span>
 attribute of the               <xhtml:span class="inline_block">sessionState</xhtml:span>
 node to               <xhtml:span class="inline_block">UseCookies</xhtml:span>
 in the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open the IIS Manager GUI and navigate desired server, site, or application</xhtml:li>
                     <xhtml:li>In Features View, find and double-click the Session State icon</xhtml:li>
                     <xhtml:li>In the Cookie Settings section, choose Use Cookies from the Mode dropdown</xhtml:li>
                     <xhtml:li>In the Actions Pane, click Apply</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>
To use               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 to configure               <xhtml:span class="inline_block">sessionState</xhtml:span>
 at the server level, the command would look like this:            </xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /commit:WEBROOT /section:sessionState /cookieless:UseCookies /cookieName:ASP.NET_SessionID /timeout:20 
</xhtml:code>
                  <xhtml:p>
When               <xhtml:span class="inline_block">Appcmd.exe</xhtml:span>
 is used to configure the               <xhtml:span class="inline_block">&lt;sessionstate&gt;</xhtml:span>
 element at the global level in IIS, the               <xhtml:span class="inline_block">/commit:WEBROOT</xhtml:span>
 switch must be included so that configuration changes are made to the root               <xhtml:span class="inline_block">web.config</xhtml:span>
 file instead of               <xhtml:span class="inline_block">ApplicationHost.config</xhtml:span>
.            </xhtml:p>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST/&lt;website name&gt;'  -filter "system.web/sessionState" -name "mode" -value "StateServer"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Session information in URI session IDs will not show up in proxy logs.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066539" value-id="xccdf_org.cisecurity.benchmarks_value_4066539_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066539"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.7_L1_Ensure_cookies_are_set_with_HttpOnly_attribute" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'cookies' are set with HttpOnly attribute</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">httpOnlyCookies</xhtml:span>
 attribute of the           <xhtml:span class="inline_block">httpCookies</xhtml:span>
 node determines if IIS will set the           <xhtml:span class="inline_block">HttpOnly</xhtml:span>
 flag on HTTP cookies it sets. The           <xhtml:span class="inline_block">HttpOnly</xhtml:span>
 flag indicates to the user agent that the cookie must not be accessible by client-side script (i.e document.cookie).        </xhtml:p>
            <xhtml:p>
It is recommended that the           <xhtml:span class="inline_block">httpOnlyCookies</xhtml:span>
 attribute be set to           <xhtml:span class="inline_block">true</xhtml:span>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
When cookies are set with the           <xhtml:span class="inline_block">HttpOnly</xhtml:span>
 flag, they cannot be accessed by client-side scripting running in the user's browser. Preventing client-side scripting from accessing cookie content may reduce the probability of a cross site scripting attack materializing into a successful session hijack.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">https://tools.ietf.org/wg/httpstate/charters</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/HTTPOnly#Browsers_Supporting_HttpOnly</xccdf:ident>
         <xccdf:ident system="URL">https://msdn.microsoft.com/en-us/library/ms533046.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Locate and open the application's                 <xhtml:span class="inline_block">web.config</xhtml:span>
 file              </xhtml:li>
                     <xhtml:li>
Add the                 <xhtml:span class="inline_block">&lt;httpCookies httpOnlyCookies="true" /&gt;</xhtml:span>
 tag within                 <xhtml:span class="inline_block">&lt;system.web&gt;</xhtml:span>
:              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">
&lt;configuration&gt;              <br/>
  &lt;system.web&gt;              <br/>
    &lt;httpCookies httpOnlyCookies="true" /&gt;              <br/>
  &lt;/system.web&gt;              <br/>
&lt;/configuration&gt; 
            </xhtml:code>
                  <xhtml:p>
Setting the value of the               <xhtml:span class="inline_block">httpOnlyCookies</xhtml:span>
 attribute of the               <xhtml:span class="inline_block">httpCookies</xhtml:span>
 element to               <xhtml:span class="inline_block">true</xhtml:span>
 will add the               <xhtml:span class="inline_block">HttpOnly</xhtml:span>
 flag to all the cookies set by the application. All modern versions of browsers recognize               <xhtml:span class="inline_block">HttpOnly</xhtml:span>
 attribute; older versions will either treat them as normal cookies or simply ignore them altogether.            </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066540" value-id="xccdf_org.cisecurity.benchmarks_value_4066540_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066540"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.8_L2_Ensure_MachineKey_validation_method_-_.Net_3.5_is_configured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure 'MachineKey validation method - .Net 3.5' is configured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">machineKey</xhtml:span>
 element of the ASP.NET           <xhtml:span class="inline_block">web.config</xhtml:span>
 specifies the algorithm and keys that ASP.NET will use for encryption. The Machine Key feature can be managed to specify hashing and encryption settings for application services such as view state, Forms authentication, membership and roles, and anonymous identification.        </xhtml:p>
            <xhtml:p>The following validation methods are available:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>Advanced Encryption Standard (AES) is relatively easy to implement and requires little memory. AES has a key size of 128, 192, or 256 bits. This method uses the same private key to encrypt and decrypt data, whereas a public-key method must use a pair of keys</xhtml:li>
               <xhtml:li>Message Digest 5 (MD5) is used for digital signing of applications. This method produces a 128-bit message digest, which is a compressed form of the original data</xhtml:li>
               <xhtml:li>Secure Hash Algorithm (SHA1) is considered more secure than MD5 because it produces a 160-bit message digest</xhtml:li>
               <xhtml:li>Triple Data Encryption Standard (TripleDES) is a minor variation of Data Encryption Standard (DES). It is three times slower than regular DES but can be more secure because it has a key size of 192 bits. If performance is not a primary consideration, consider using TripleDES</xhtml:li>
            </xhtml:ul>
            <xhtml:p>It is recommended that AES or SHA1 methods be configured for use at the global level.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Setting the validation property to AES will provide confidentiality and integrity protection to the viewstate. AES is the strongest encryption algorithm supported by the validation property. Setting the validation property to SHA1 will provide integrity protection to the viewstate. SHA1 is the strongest hashing algorithm supported by the validation property.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc772271%28WS.10%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc772287%28WS.10%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Machine key encryption can be set by using the UI, running               <xhtml:span class="inline_block">appcmd.exe</xhtml:span>
 commands, by editing configuration files directly, or by writing WMI scripts. To set the Machine Key encryption at the global level using an               <xhtml:span class="inline_block">appcmd.exe</xhtml:span>
 command:            </xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /commit:WEBROOT /section:machineKey /validation:SHA1 
</xhtml:code>
                  <xhtml:p>
Note: When               <xhtml:span class="inline_block">Appcmd.exe</xhtml:span>
 is used to configure the               <xhtml:span class="inline_block">&lt;machineKey&gt;</xhtml:span>
 element at the global level in IIS, the               <xhtml:span class="inline_block">/commit:WEBROOT</xhtml:span>
 switch must be included so that configuration changes are made to the root               <xhtml:span class="inline_block">web.config</xhtml:span>
 file instead of               <xhtml:span class="inline_block">ApplicationHost.config</xhtml:span>
.            </xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066541" value-id="xccdf_org.cisecurity.benchmarks_value_4066541_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066541"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.9_L1_Ensure_MachineKey_validation_method_-_.Net_4.5_is_configured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'MachineKey validation method - .Net 4.5' is configured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">machineKey</xhtml:span>
 element of the ASP.NET           <xhtml:span class="inline_block">web.config</xhtml:span>
 specifies the algorithm and keys that ASP.NET will use for encryption. The Machine Key feature can be managed to specify hashing and encryption settings for application services such as view state, Forms authentication, membership and roles, and anonymous identification.        </xhtml:p>
            <xhtml:p>The following validation methods are available:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>Advanced Encryption Standard (AES) is relatively easy to implement and requires little memory. AES has a key size of 128, 192, or 256 bits. This method uses the same private key to encrypt and decrypt data, whereas a public-key method must use a pair of keys</xhtml:li>
               <xhtml:li>Message Digest 5 (MD5) is used for digital signing of applications. This method produces a 128-bit message digest, which is a compressed form of the original data</xhtml:li>
               <xhtml:li>Secure Hash Algorithm (SHA1) is considered more secure than MD5 because it produces a 160-bit message digest</xhtml:li>
               <xhtml:li>Triple Data Encryption Standard (TripleDES) is a minor variation of Data Encryption Standard (DES). It is three times slower than regular DES but can be more secure because it has a key size of 192 bits. If performance is not a primary consideration, consider using TripleDES</xhtml:li>
               <xhtml:li>Secure Hash Algorithm (SHA-2) is a family of two similar hash functions, with different block sizes known as SHA-256 and SHA-512. They differ in the word size; SHAS-256 used 32-bit words and SHA-512 uses 64-bit words.</xhtml:li>
            </xhtml:ul>
            <xhtml:p>It is recommended that SHA-2 methods be configured for use at the global level.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>SHA-2 is the strongest hashing algorithm supported by the validation property so it should be used as the validation method for the MachineKey in .Net 4.5.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-aspnet-configuration-management</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Machine key encryption can be set by using the UI, running               <xhtml:span class="inline_block">appcmd.exe</xhtml:span>
 commands, by editing configuration files directly, or by writing WMI scripts. To set the Machine Key encryption at the global level using an               <xhtml:span class="inline_block">appcmd.exe</xhtml:span>
 command:            </xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /commit:WEBROOT /section:machineKey /validation:&lt;validation method&gt; 
</xhtml:code>
                  <xhtml:p>
Note: When               <xhtml:span class="inline_block">Appcmd.exe</xhtml:span>
 is used to configure the               <xhtml:span class="inline_block">&lt;machineKey&gt;</xhtml:span>
 element at the global level in IIS, the               <xhtml:span class="inline_block">/commit:WEBROOT</xhtml:span>
 switch must be included so that configuration changes are made to the root               <xhtml:span class="inline_block">web.config</xhtml:span>
 file instead of               <xhtml:span class="inline_block">ApplicationHost.config</xhtml:span>
.            </xhtml:p>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT'  -filter "system.web/machineKey" -name "validation" -value "&lt;validation method&gt;"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066542" value-id="xccdf_org.cisecurity.benchmarks_value_4066542_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066542"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.10_L1_Ensure_global_.NET_trust_level_is_configured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure global .NET trust level is configured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>An application's trust level determines the permissions that are granted by the ASP.NET code access security (CAS) policy. CAS defines two trust categories: full trust and partial trust. An application that has full trust permissions may access all resource types on a server and perform privileged operations, while applications that run with partial trust have varying levels of operating permissions and access to resources.</xhtml:p>
            <xhtml:p>The possible values for the Level property of the TrustSection class are:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>Full: Specifies unrestricted permissions and grants the ASP.NET application permissions to access any resource that is subject to operating system security; all privileged operations are supported</xhtml:li>
               <xhtml:li>
High: specifies a high level of code access security which limits the application from doing the following:
            <xhtml:ul>
                     <xhtml:li>Call unmanaged code</xhtml:li>
                     <xhtml:li>Call serviced components</xhtml:li>
                     <xhtml:li>Write to the event log</xhtml:li>
                     <xhtml:li>Access Microsoft Windows Message Queuing queues</xhtml:li>
                     <xhtml:li>Access ODBC, OLD DB, or Oracle data sources</xhtml:li>
                  </xhtml:ul>
               </xhtml:li>
               <xhtml:li>
Medium: specifies a medium level of code access security, which means that in addition to the restrictions for High, the ASP.NET application cannot do any of the following things:
            <xhtml:ul>
                     <xhtml:li>Access files outside the application directory</xhtml:li>
                     <xhtml:li>Access the registry</xhtml:li>
                  </xhtml:ul>
               </xhtml:li>
               <xhtml:li>
Low: specifies a low level of code access security, which means that in addition to the restrictions for Medium, the application is prevented from performing any of the following actions:
            <xhtml:ul>
                     <xhtml:li>Write to the file system</xhtml:li>
                     <xhtml:li>
Call the                 <xhtml:span class="inline_block">System.Security.CodeAccessPermission.Assert</xhtml:span>
 method to expand permissions to resources              </xhtml:li>
                     <xhtml:li>Minimal: specifies a minimal level of code access security, which means that the application has only execute permission</xhtml:li>
                  </xhtml:ul>
               </xhtml:li>
            </xhtml:ul>
            <xhtml:p>It is recommended that the global .NET Trust Level be set to Medium or lower.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Configure Data Access Control Lists" urn="urn:cisecurity.org:controls:8.0:3:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Protect Information through  Access Control Lists" urn="urn:cisecurity.org:controls:7.0:14:6">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The CAS determines the permissions that are granted to the application on the server. Setting a minimal level of trust that is compatible with the applications will limit the potential harm that a compromised application could cause to a system.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/cc772237(WS.10).aspx</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/ms691448%28VS.90%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://support.microsoft.com/kb/2698981</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Trust level can be set by using the UI, running               <xhtml:span class="inline_block">appcmd.exe</xhtml:span>
 commands, by editing configuration files directly, or by writing WMI scripts. To set the .Net Trust Level to Medium at the server level using an               <xhtml:span class="inline_block">appcmd.exe</xhtml:span>
 command:            </xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /commit:WEBROOT /section:trust /level:Medium 
</xhtml:code>
                  <xhtml:p>
When               <xhtml:span class="inline_block">Appcmd.exe</xhtml:span>
 is used to configure the element at the global level in IIS, the               <xhtml:span class="inline_block">/commit:WEBROOT</xhtml:span>
 switch must be included so that configuration changes are made to the root               <xhtml:span class="inline_block">web.config</xhtml:span>
 file instead of               <xhtml:span class="inline_block">ApplicationHost.config</xhtml:span>
.            </xhtml:p>
                  <xhtml:p>
                     <xhtml:em>OR</xhtml:em>
                  </xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT'  -filter "system.web/trust" -name "level" -value "Medium"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If not set properly, the application may not run.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4066543" value-id="xccdf_org.cisecurity.benchmarks_value_4066543_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4066543"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.11_L2_Ensure_X-Powered-By_Header_is_removed" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Ensure X-Powered-By Header is removed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The x-powered-by headers specify the underlying technology used by the webserver.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Attackers are able to conduct reconnaissance on a website using these response headers. This header could be used to target attacks for specific known vulnerabilities associated with the underlying technology. Removing this header will prevent targeting of your application for specific exploits by non-determined attackers.</xhtml:p>
            <xhtml:p>While this is not the only way to fingerprint a site through the response headers, it makes it harder and prevents some potential attackers.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://blogs.msdn.microsoft.com/jpsanders/2015/10/07/remove-server-and-x-powered-by-headers-from-your-azure-mobile-apps/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config  -section:system.webServer/httpProtocol /-"customHeaders.[name='X-Powered-By']" /commit:apphost
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Remove-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter "system.webserver/httpProtocol/customHeaders" -name "." -AtElement @{name='X-Powered-By'}
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>X-powered-by headers will not be available on the webserver.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_3.12_L2_Ensure_Server_Header_is_removed" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Ensure Server Header is removed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The server header headers specify the underlying technology used by the application.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Uninstall or Disable Unnecessary Services on Enterprise Assets and Software" urn="urn:cisecurity.org:controls:8.0:4:8">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>While this is not the only way to fingerprint a site through the response headers, it makes it harder and prevents some potential attackers. The server header removal directive is a new feature in IIS 10 that can assist in mitigating this risk.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/4/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://blogs.msdn.microsoft.com/jpsanders/2015/10/07/remove-server-and-x-powered-by-headers-from-your-azure-mobile-apps/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Enter the following command to use AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config -section:system.webServer/security/requestFiltering /removeServerHeader:"True"  /commit:apphost
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST/' -filter "system.webServer/security/requestFiltering" -name "removeServerHeader" -value "True"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>This will remove the server header.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_4_Request_Filtering_and_Other_Restriction_Modules">
      <xccdf:title xml:lang="en">Request Filtering and Other Restriction Modules</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>Introduced in IIS 7.0 for the first time, Request Filtering is a powerful module that provides a configurable set of rules that enables administrators to allow or reject the types of requests that they determine should be allowed or rejected at the server, web site, or web application levels.</xhtml:p>
         <xhtml:p>Earlier versions of Internet Information Services provided the tool UrlScan, which was provided as an add-on to enable system administrators to enforce tighter security policies on their web servers. All of the core features of URLScan have been incorporated into the Request Filtering module. Due to the close nature of functionality in these two tools, reference to legacy URLScan settings will be made where applicable.</xhtml:p>
         <xhtml:p>IIS 8 also introduced modules for Dynamic IP Address Restrictions. This module can be configured to automatically block web site access based on specific rules.</xhtml:p>
         <xhtml:p>Note: Request Filtering and IP and Domain Restrictions must be enabled as a role service under IIS in order to configure any of its features.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.1_L2_Ensure_maxAllowedContentLength_is_configured" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Ensure 'maxAllowedContentLength' is configured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">maxAllowedContentLength</xhtml:span>
 Request Filter is the maximum size of the http request, measured in bytes, which can be sent from a client to the server. Configuring this value enables the total request size to be restricted to a configured value.        </xhtml:p>
            <xhtml:p>It is recommended that the overall size of requests be restricted to a maximum value appropriate for the server, site, or application.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Setting an appropriate value that has been tested for the           <xhtml:span class="inline_block">maxAllowedContentLength</xhtml:span>
 filter will lower the impact an abnormally large request would otherwise have on IIS and/or web applications. This helps to ensure availability of web content and services, and may also help mitigate the risk of buffer overflow type attacks in unmanaged components.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://www.iis.net/ConfigReference/system.webServer/security/requestFiltering/requestLimits</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/143/use-request-filtering/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
The               <xhtml:span class="inline_block">MaxAllowedContentLength</xhtml:span>
 Request Filter may be set for a server, website, or application using the IIS Manager GUI, using               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open Internet Information Services (IIS) Manager</xhtml:li>
                     <xhtml:li>In the Connections pane, click on the server, site, application, or directory to be configured</xhtml:li>
                     <xhtml:li>In the Home pane, double-click Request Filtering</xhtml:li>
                     <xhtml:li>Click Edit Feature Settings... in the Actions pane</xhtml:li>
                     <xhtml:li>Under the Request Limits section, key the maximum content length in bytes that will allow applications to retain their intended functionality, such as 30000000 (approx. 28.6 MB)</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /section:requestfiltering /requestLimits.maxAllowedContentLength:30000000
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/security/requestFiltering/requestLimits" -name "maxAllowedContentLength" -value 30000000
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Size of requests be restricted to the maximum value set.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.2_L2_Ensure_maxURL_request_filter_is_configured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure 'maxURL request filter' is configured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">maxURL</xhtml:span>
 attribute of the           <xhtml:span class="inline_block">&lt;requestLimits&gt;</xhtml:span>
 property is the maximum length (in Bytes) in which a requested URL can be (excluding query string) in order for IIS to accept. Configuring this Request Filter enables administrators to restrict the length of the requests that the server will accept.        </xhtml:p>
            <xhtml:p>It is recommended that a limit be put on the length of URL.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>With a properly configured Request Filter limiting the amount of data accepted in the URL, chances of undesired application behaviors affecting the availability of content and services are reduced.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://www.iis.net/ConfigReference/system.webServer/security/requestFiltering/requestLimits</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/143/use-request-filtering/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
The               <xhtml:span class="inline_block">MaxURL</xhtml:span>
 Request Filter may be set for a server, website, or application using the IIS Manager GUI, using               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open Internet Information Services (IIS) Manager</xhtml:li>
                     <xhtml:li>In the Connections pane, click on the connection, site, application, or directory to be configured</xhtml:li>
                     <xhtml:li>In the Home pane, double-click Request Filtering</xhtml:li>
                     <xhtml:li>Click Edit Feature Settings... in the Actions pane</xhtml:li>
                     <xhtml:li>Under the Request Limits section, key the maximum URL length in bytes that has been tested with web applications</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /section:requestfiltering /requestLimits.maxURL:4096
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/security/requestFiltering/requestLimits" -name "maxUrl" -value 4096
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Length of the URL will be restricted to the maximum value set.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061317" value-id="xccdf_org.cisecurity.benchmarks_value_4061317_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061317"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.3_L2_Ensure_MaxQueryString_request_filter_is_configured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure 'MaxQueryString request filter' is configured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">MaxQueryString</xhtml:span>
 Request Filter describes the upper limit on the length of the query string that the configured IIS server will allow for websites or applications.        </xhtml:p>
            <xhtml:p>It is recommended that values always be established to limit the amount of data that can be accepted in the query string.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>With a properly configured Request Filter limiting the amount of data accepted in the query string, chances of undesired application behaviors such as app pool failures are reduced.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://www.iis.net/ConfigReference/system.webServer/security/requestFiltering/requestLimits</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/143/use-request-filtering/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
The               <xhtml:span class="inline_block">MaxQueryString</xhtml:span>
 Request Filter may be set for a server, website, or application using the IIS Manager GUI, using               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open Internet Information Services (IIS) Manager</xhtml:li>
                     <xhtml:li>In the Connections pane, go to the connection, site, application, or directory to be configured</xhtml:li>
                     <xhtml:li>In the Home pane, double-click Request Filtering</xhtml:li>
                     <xhtml:li>Click Edit Feature Settings... in the Actions pane</xhtml:li>
                     <xhtml:li>Under the Request Limits section, key in a safe upper bound in the Maximum query string (Bytes) textbox</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /section:requestfiltering /requestLimits.maxQueryString:2048
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter "system.webServer/security/requestFiltering/requestLimits" -name "maxQueryString" -value 2048
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The amount of data to be accepted in the query string will be limited.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061318" value-id="xccdf_org.cisecurity.benchmarks_value_4061318_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061318"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.4_L2_Ensure_non-ASCII_characters_in_URLs_are_not_allowed" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure non-ASCII characters in URLs are not allowed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
This feature is used to allow or reject all requests to IIS that contain non-ASCII characters. When using this feature, Request Filtering will deny the request if high-bit characters are present in the URL. The UrlScan equivalent is           <xhtml:span class="inline_block">AllowHighBitCharacters</xhtml:span>
.        </xhtml:p>
            <xhtml:p>It is recommended that requests containing non-ASCII characters be rejected, where possible.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>This feature can help defend against canonicalization attacks, reducing the potential attack surface of servers, sites, and/or applications.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/143/use-request-filtering/</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/936/urlscan-1-reference/</xccdf:ident>
         <xccdf:ident system="URL">Professional IIS 7 by Ken Schaefer, Jeff Cochran, Scott Forsyth, Rob Baugh, Mike Everest, Dennis Glendenning</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
The               <xhtml:span class="inline_block">AllowHighBitCharacters</xhtml:span>
 Request Filter may be set for a server, website, or application using the IIS Manager GUI, using               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open Internet Information Services (IIS) Manager</xhtml:li>
                     <xhtml:li>In the Connections pane, go to the connection, site, application, or directory to be configured</xhtml:li>
                     <xhtml:li>In the Home pane, double-click Request Filtering</xhtml:li>
                     <xhtml:li>Click Edit Feature Settings... in the Actions pane</xhtml:li>
                     <xhtml:li>Under the General section, uncheck Allow high-bit characters</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Note: Disallowing high-bit ASCII characters in the URL may negatively impact the functionality of sites requiring international language support.</xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /section:requestfiltering /allowHighBitCharacters:false
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter "system.webServer/security/requestFiltering" -name "allowHighBitCharacters" -value "False"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Requests containing non-ASCII characters be rejected.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061319" value-id="xccdf_org.cisecurity.benchmarks_value_4061319_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061319"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.5_L1_Ensure_Double-Encoded_requests_will_be_rejected" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure Double-Encoded requests will be rejected</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
This Request Filter feature prevents attacks that rely on double-encoded requests and applies if an attacker submits a double-encoded request to IIS. When the double-encoded requests filter is enabled, IIS will go through a two iteration process of normalizing the request. If the first normalization differs from the second, the request is rejected and the error code is logged as a 404.11. The double-encoded requests filter was the           <xhtml:span class="inline_block">VerifyNormalization</xhtml:span>
 option in UrlScan.        </xhtml:p>
            <xhtml:p>It is recommended that double-encoded requests be rejected.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Enable Anti-Exploitation Features" urn="urn:cisecurity.org:controls:8.0:10:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>This feature will help prevent attacks that rely on URLs that have been crafted to contain double-encoded request(s).</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.iis.net/ConfigReference/system.webServer/security/requestFiltering/requestLimits</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/143/use-request-filtering/</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
The               <xhtml:span class="inline_block">allowDoubleEscaping</xhtml:span>
 Request Filter may be set for a server, website, or application using the IIS Manager GUI, using               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, and/or directly editing the configuration files. To configure using the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open Internet Information Services (IIS) Manager</xhtml:li>
                     <xhtml:li>In the Connections pane, select the site, application, or directory to be configured</xhtml:li>
                     <xhtml:li>In the Home pane, double-click Request Filtering</xhtml:li>
                     <xhtml:li>Click Edit Feature Settings... in the Actions pane</xhtml:li>
                     <xhtml:li>Under the General section, uncheck Allow double escaping</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>
If a file name in a URL includes "+" then               <xhtml:span class="inline_block">allowDoubleEscaping</xhtml:span>
 must be set to               <xhtml:span class="inline_block">true</xhtml:span>
 to allow functionality.            </xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /section:requestfiltering /allowDoubleEscaping:false
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter "system.webServer/security/requestFiltering" -name "allowDoubleEscaping" -value "True"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Double-encoded requests will be rejected.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061320" value-id="xccdf_org.cisecurity.benchmarks_value_4061320_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061320"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.6_L1_Ensure_HTTP_Trace_Method_is_disabled" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'HTTP Trace Method' is disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The HTTP TRACE method returns the contents of client HTTP requests in the entity-body of the TRACE response. Attackers could leverage this behavior to access sensitive information, such as authentication data or cookies, contained in the HTTP headers of the request. One such way to mitigate this is by using the           <xhtml:span class="inline_block">&lt;verbs&gt;</xhtml:span>
 element of the           <xhtml:span class="inline_block">&lt;requestFiltering&gt;</xhtml:span>
 collection. The           <xhtml:span class="inline_block">&lt;verbs&gt;</xhtml:span>
 element replaces the [AllowVerbs] and [DenyVerbs] features in UrlScan.        </xhtml:p>
            <xhtml:p>It is recommended the HTTP TRACE method be denied.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Attackers may abuse HTTP TRACE functionality to gain access to information in HTTP headers such as cookies and authentication data. This risk can be mitigated by not allowing the TRACE verb.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://www.kb.cert.org/vuls/id/867593</xccdf:ident>
         <xccdf:ident system="URL">http://www.iis.net/ConfigReference/system.webServer/security/requestFiltering/verbs</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open Internet Information Services (IIS) Manager</xhtml:li>
                     <xhtml:li>In the Connections pane, select the site, application, or directory to be configured</xhtml:li>
                     <xhtml:li>In the Home pane, double-click Request Filtering</xhtml:li>
                     <xhtml:li>In the Request Filtering pane, click the HTTP verbs tab, and then click Deny Verb... in the Actions pane</xhtml:li>
                     <xhtml:li>In the Deny Verb dialog box, enter the TRACE, and then click OK</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /section:requestfiltering /+verbs.[verb='TRACE',allowed='false']
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Add-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/security/requestFiltering/verbs" -name "." -value @{verb='TRACE';allowed='False'}
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Contents of client HTTP requests in the entity-body of the TRACE response will not be available.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.7_L1_Ensure_Unlisted_File_Extensions_are_not_allowed" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure Unlisted File Extensions are not allowed</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">FileExtensions</xhtml:span>
 Request Filter allows administrators to define specific extensions their web server(s) will allow and disallow. The property           <xhtml:span class="inline_block">allowUnlisted</xhtml:span>
 will cover all other file extensions not explicitly allowed or denied. Often times, extensions such as           <xhtml:span class="inline_block">.config</xhtml:span>
,           <xhtml:span class="inline_block">.bat</xhtml:span>
,           <xhtml:span class="inline_block">.exe</xhtml:span>
, to name a few, should never be served. The           <xhtml:span class="inline_block">AllowExtensions</xhtml:span>
 and           <xhtml:span class="inline_block">DenyExtensions</xhtml:span>
 options are the UrlScan equivalents.        </xhtml:p>
            <xhtml:p>It is recommended that all extensions be disallowed at the most global level possible, with only those necessary being allowed.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Disallowing all but the necessary file extensions can greatly reduce the attack surface of applications and servers.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://www.iis.net/ConfigReference/system.webServer/security/requestFiltering/requestLimits</xccdf:ident>
         <xccdf:ident system="URL">http://www.iis.net/learn/manage/configuring-security/configure-request-filtering-in-iis</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
The               <xhtml:span class="inline_block">allowUnlisted</xhtml:span>
 Request Filter may be set for a server, website, or application using the IIS Manager GUI, using               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 commands in a command-line window, and/or directly editing the configuration files. To configure at the server level using the IIS Manager GUI:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open Internet Information Services (IIS) Manager</xhtml:li>
                     <xhtml:li>In the Connections pane, select the server</xhtml:li>
                     <xhtml:li>In the Home pane, double-click Request Filtering</xhtml:li>
                     <xhtml:li>Click Edit Feature Settings... in the Actions pane</xhtml:li>
                     <xhtml:li>Under the General section, uncheck Allow unlisted file name extensions</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Enter the following command in AppCmd.exe  to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /section:requestfiltering /fileExtensions.allowunlisted:false
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/security/requestFiltering/fileExtensions" -name "allowUnlisted" -value "False"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If not set properly, file extensions that are needed will be rejected.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061322" value-id="xccdf_org.cisecurity.benchmarks_value_4061322_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061322"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.8_L1_Ensure_Handler_is_not_granted_Write_and_ScriptExecute" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Ensure Handler is not granted Write and Script/Execute</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
Handler mappings can be configured to give permissions to           <xhtml:span class="inline_block">Read</xhtml:span>
,           <xhtml:span class="inline_block">Write</xhtml:span>
,           <xhtml:span class="inline_block">Script</xhtml:span>
, or           <xhtml:span class="inline_block">Execute</xhtml:span>
 depending on what the use is for - reading static content, uploading files, executing scripts, etc.        </xhtml:p>
            <xhtml:p>
It is recommended to grant a handler either           <xhtml:span class="inline_block">Execute/Script</xhtml:span>
 or           <xhtml:span class="inline_block">Write</xhtml:span>
 permissions, but not both.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Define and Maintain Role-Based Access Control" urn="urn:cisecurity.org:controls:8.0:6:8">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
By allowing both           <xhtml:span class="inline_block">Execute/Script</xhtml:span>
 and           <xhtml:span class="inline_block">Write</xhtml:span>
 permissions, a handler can run malicious code on the target server. Ensuring these two permissions are never together will help lower the risk of malicious code being executed on the server.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dd391910%28WS.10%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://blogs.iis.net/thomad/archive/2006/11/05/quo-vadis-accessflags.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
The               <xhtml:span class="inline_block">accessPolicy</xhtml:span>
 attribute in the               <xhtml:span class="inline_block">&lt;handlers&gt;</xhtml:span>
 section of either the               <xhtml:span class="inline_block">ApplicationHost.config</xhtml:span>
 (server-wide) or               <xhtml:span class="inline_block">web.config</xhtml:span>
 (site or application) must not have               <xhtml:span class="inline_block">Write</xhtml:span>
 present when               <xhtml:span class="inline_block">Script</xhtml:span>
 or               <xhtml:span class="inline_block">Execute</xhtml:span>
 are present. To resolve this issue for a Web server, the attribute in the               <xhtml:span class="inline_block">&lt;handlers&gt;</xhtml:span>
 section of the               <xhtml:span class="inline_block">ApplicationHost.config</xhtml:span>
 file for the server must manually be edited. To edit the ApplicationHost.config file by using Notepad, perform the following steps:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open Notepad as Administrator</xhtml:li>
                     <xhtml:li>
Open the ApplicationHost.config file in                 <xhtml:span class="inline_block">%systemroot%\system32\inetsrv\config</xhtml:span>
                     </xhtml:li>
                     <xhtml:li>
Edit the                 <xhtml:span class="inline_block">&lt;handlers&gt;</xhtml:span>
 section                 <xhtml:span class="inline_block">accessPolicy</xhtml:span>
 attribute so that                 <xhtml:span class="inline_block">Write</xhtml:span>
 is not present when                 <xhtml:span class="inline_block">Script</xhtml:span>
 or                 <xhtml:span class="inline_block">Execute</xhtml:span>
 are present              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config /section:handlers /accessPolicy:Read,Script
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/handlers" -name "accessPolicy" -value "Read,Script"
</xhtml:code>
                  <xhtml:p>Note: This configuration change cannot be made by using IIS Manager.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.9_L1_Ensure_notListedIsapisAllowed_is_set_to_false" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'notListedIsapisAllowed' is set to false</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">notListedIsapisAllowed </xhtml:span>
attribute is a server-level setting that is located in the           <xhtml:span class="inline_block">ApplicationHost.config</xhtml:span>
 file in the           <xhtml:span class="inline_block">&lt;isapiCgiRestriction&gt;</xhtml:span>
 element of the           <xhtml:span class="inline_block">&lt;system.webServer&gt;</xhtml:span>
 section under           <xhtml:span class="inline_block">&lt;security&gt;</xhtml:span>
. This element ensures that malicious users cannot copy unauthorized ISAPI binaries to the Web server and then run them.        </xhtml:p>
            <xhtml:p>
It is recommended that           <xhtml:span class="inline_block">notListedIsapisAllowed</xhtml:span>
 be set to           <xhtml:span class="inline_block">false</xhtml:span>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Restricting this attribute to           <xhtml:span class="inline_block">false </xhtml:span>
will help prevent potentially malicious ISAPI extensions from being run.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dd378846%28WS.10%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://www.iis.net/ConfigReference/system.webServer/security/isapiCgiRestriction</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
To use IIS Manager to set the               <xhtml:span class="inline_block">notListedIsapisAllowed</xhtml:span>
 attribute to               <xhtml:span class="inline_block">false</xhtml:span>
:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager as Administrator</xhtml:li>
                     <xhtml:li>In the Connections pane on the left, select server to be configured</xhtml:li>
                     <xhtml:li>In Features View, select ISAPI and CGI Restrictions; in the Actions pane, select Open Feature</xhtml:li>
                     <xhtml:li>In the Actions pane, select Edit Feature Settings</xhtml:li>
                     <xhtml:li>In the Edit ISAPI and CGI Restrictions Settings dialog, clear the Allow unspecified ISAPI modules check box, if checked</xhtml:li>
                     <xhtml:li>Click OK</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config  -section:system.webServer/security/isapiCgiRestriction /notListedIsapisAllowed:false
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/security/isapiCgiRestriction" -name "notListedIsapisAllowed" -value "False"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Unauthorized ISAPI binaries will not be allowed.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061324" value-id="xccdf_org.cisecurity.benchmarks_value_4061324_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061324"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.10_L1_Ensure_notListedCgisAllowed_is_set_to_false" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'notListedCgisAllowed' is set to false</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>
The           <xhtml:span class="inline_block">notListedCgisAllowed</xhtml:span>
 attribute is a server-level setting that is located in the           <xhtml:span class="inline_block">ApplicationHost.config</xhtml:span>
 file in the           <xhtml:span class="inline_block">&lt;isapiCgiRestriction&gt;</xhtml:span>
 element of the           <xhtml:span class="inline_block">&lt;system.webServer&gt;</xhtml:span>
 section under           <xhtml:span class="inline_block">&lt;security&gt;</xhtml:span>
. This element ensures that malicious users cannot copy unauthorized CGI binaries to the Web server and then run them.        </xhtml:p>
            <xhtml:p>
It is recommended that           <xhtml:span class="inline_block">notListedCgisAllowed</xhtml:span>
 be set to           <xhtml:span class="inline_block">false</xhtml:span>
.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>
Restricting this attribute to           <xhtml:span class="inline_block">false</xhtml:span>
 will help prevent unlisted CGI extensions, including potentially malicious CGI scripts from being run.        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dd391919%28WS.10%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
To set the               <xhtml:span class="inline_block">notListedCgisAllowed</xhtml:span>
 attribute to false using IIS Manager:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager as Administrator</xhtml:li>
                     <xhtml:li>In the Connections pane on the left, select the server to configure</xhtml:li>
                     <xhtml:li>In Features View, select ISAPI and CGI Restrictions; in the Actions pane, select Open Feature</xhtml:li>
                     <xhtml:li>In the Actions pane, select Edit Feature Settings</xhtml:li>
                     <xhtml:li>In the Edit ISAPI and CGI Restrictions Settings dialog, clear the Allow unspecified CGI modules check box</xhtml:li>
                     <xhtml:li>Click OK</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config  -section:system.webServer/security/isapiCgiRestriction /notListedCgisAllowed:false
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/security/isapiCgiRestriction" -name "notListedCgisAllowed" -value "False"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Unlisted CGI extensions will not be allowed.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:4061326" value-id="xccdf_org.cisecurity.benchmarks_value_4061326_var"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061326"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_4.11_L1_Ensure_Dynamic_IP_Address_Restrictions_is_enabled" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'Dynamic IP Address Restrictions' is enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Dynamic IP address filtering allows administrators to configure the server to block access for IPs that exceed the specified number of requests or request frequency.</xhtml:p>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 Ensure that you receive the Forbidden page once the block has been enforced.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Application Layer Filtering" urn="urn:cisecurity.org:controls:8.0:13:10">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Implement Application Firewalls" urn="urn:cisecurity.org:controls:7.0:9:5">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>IIS Dynamic IP Address Restrictions capability can be used to thwart DDos attacks. This is complimentary to the IP Addresses and Domain names Restrictions lists that can be manually maintained within IIS. In contrast, Dynamic IP address filtering allows administrators to configure the server to block access for IPs that exceed the specified request threshold. The default action Deny action for restrictions is to return a Forbidden response to the client.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/5" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-dynamic-ip-address-restrictions</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
                        <xhtml:p>Open IIS Manager.</xhtml:p>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:p>Open the IP Address and Domain Restrictions feature.</xhtml:p>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:p>Click Edit Dynamic Restrictions Settings..</xhtml:p>
                     </xhtml:li>
                     <xhtml:li>
                        <xhtml:p>Check the Deny IP Address based on the number of concurrent requests and the Deny IP Address based on the number of requests over a period of time boxes. The values can be tweaked as needed for your specific environment.</xhtml:p>
                     </xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/security/dynamicIpSecurity/denyByConcurrentRequests" -name "enabled" -value "True"
</xhtml:code>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.webServer/security/dynamicIpSecurity/denyByConcurrentRequests" -name "maxConcurrentRequests" -value &lt;number of requests&gt;
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Clients will receive a forbidden response when the specified number of requests or request frequency is exceeded.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_5_IIS_Logging_Recommendations">
      <xccdf:title xml:lang="en">IIS Logging Recommendations</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations regarding IIS logging that have not been covered in the Basic Configurations section.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.1_L1_Ensure_Default_IIS_web_log_location_is_moved" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure Default IIS web log location is moved</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>IIS will log relatively detailed information on every request. These logs are usually the first item looked at in a security response and can be the most valuable. Malicious users are aware of this and will often try to remove evidence of their activities.</xhtml:p>
            <xhtml:p>It is recommended that the default location for IIS log files be changed to a restricted, non-system drive.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Ensure Adequate Audit Log Storage" urn="urn:cisecurity.org:controls:8.0:8:3">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Ensure adequate storage for logs" urn="urn:cisecurity.org:controls:7.0:6:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Moving IIS logging to a restricted, non-system drive will help mitigate the risk of logs being maliciously altered, removed, or lost in the event of system drive failure(s).</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/3" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://technet.microsoft.com/en-us/library/cc770709(v=ws.10).aspx?</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Moving the default log location can be easily accomplished using the Logging feature in the IIS Management UI,               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
, or PowerShell.            </xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd set config -section:sites -siteDefaults.logfile.directory:&lt;new log location&gt; 
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter "system.applicationHost/sites/siteDefaults/logFile" -name "directory" -value &lt;new log location&gt;
</xhtml:code>
                  <xhtml:p>Moving log file stores to a non-system drive or partition separate from where web applications run and/or content is served is preferred. Additionally, folder-level NTFS permissions should be set as restrictive as possible; Administrators and SYSTEM are typically the only principals requiring access.</xhtml:p>
                  <xhtml:p>While standard IIS logs can be moved and edited using IIS Manager, additional management tool add-ons are required in order to manage logs generated by other IIS features, such as Request Filtering and IIS Advanced Logging. These add-ons can be obtained using the Web Platform Installer or from Microsoft's site. The HTTPErr logging location can be changed by adding a registry key.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>If an administrator needs access to the log file, that does not have drive permission, they will be unable to view that file.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.2_L1_Ensure_Advanced_IIS_logging_is_enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure Advanced IIS logging is enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>IIS Advanced Logging is a module which provides flexibility in logging requests and client data. It provides controls that allow businesses to specify what fields are important, easily add additional fields, and provide policies pertaining to log file rollover and Request Filtering. HTTP request/response headers, server variables, and client-side fields can be easily logged with minor configuration in the IIS management console.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Collect Detailed Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Activate audit logging" urn="urn:cisecurity.org:controls:7.0:6:2">
                     <controls:implementation_groups ig1="true" ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Enable Detailed Logging" urn="urn:cisecurity.org:controls:7.0:6:3">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Many of the fields available in Advanced Logging can provide extensive, real-time data and details not otherwise obtainable. Developers and security professionals can use this information to identify and remediate application vulnerabilities/attack patterns.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/2" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/3" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://www.iis.net/learn/get-started/whats-new-in-iis-85/enhanced-logging-for-iis85</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>IIS Advanced Logging can be configured for servers, Web sites, and directories in IIS Manager. To enable Advanced Logging using the UI:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open Internet Information Services (IIS) Manager</xhtml:li>
                     <xhtml:li>Click the server in the Connections pane</xhtml:li>
                     <xhtml:li>Double-click the Logging icon on the Home page</xhtml:li>
                     <xhtml:li>Click Select Fields</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p>The fields that will be logged need to be configured using the Add or Edit Fields button.</xhtml:p>
                  <xhtml:p>Note: There may be performance considerations depending on the extent of the configuration.</xhtml:p>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Collecting detailed log files will take more space on the specified drive.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_5.3_L1_Ensure_ETW_Logging_is_enabled" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Ensure 'ETW Logging' is enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Event Tracing for Windows (ETW) is a Windows feature that allows Administrators to send logging information to another location. This information is then compiled on the server and can be queried.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Centralize Audit Logs" urn="urn:cisecurity.org:controls:8.0:8:9">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Deploy SIEM or Log Analytic tool" urn="urn:cisecurity.org:controls:7.0:6:6">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
                  <controls:safeguard title="Regularly Tune SIEM" urn="urn:cisecurity.org:controls:7.0:6:8">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Detect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>IIS flushes log information to disk, therefore prior to IIS, administrators do not have access to real-time logging information. Text-based log files can also be difficult and time consuming to process. By enabling ETW, administrators have access to use standard query tools for viewing real-time logging information.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/6" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/6/subcontrol/8" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/8/subcontrol/9" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.iis.net/learn/get-started/whats-new-in-iis-85/logging-to-etw-in-iis-85</xccdf:ident>
         <xccdf:ident system="URL">http://blogs.technet.com/b/erezs_iis_blog/archive/2013/07/15/hook-me-up.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://blogs.msdn.microsoft.com/dcook/2015/09/30/etw-overview/</xccdf:ident>
         <xccdf:ident system="URL">https://social.msdn.microsoft.com/Forums/en-US/a1aa1350-41a0-4490-9ae3-9b4520aeb9d4/faq-common-questions-for-etw-and-windows-event-log?forum=etw</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To configure ETW logging:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>Open IIS Manager</xhtml:li>
                     <xhtml:li>Select the server or site to enable ETW</xhtml:li>
                     <xhtml:li>Select Logging.</xhtml:li>
                     <xhtml:li>Ensure Log file format is W3C.</xhtml:li>
                     <xhtml:li>Select Both log file and ETW event</xhtml:li>
                     <xhtml:li>Save your settings.</xhtml:li>
                  </xhtml:ol>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>A dedicated server hosting Event Tracing for Windows (ETW) will be needed.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_6_FTP_Requests">
      <xccdf:title xml:lang="en">FTP Requests</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains a crucial configuration setting for running file transfer protocol (FTP).</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.1_L1_Ensure_FTP_requests_are_encrypted" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Ensure FTP requests are encrypted</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>FTP Publishing Service for IIS supports adding an SSL certificate to an FTP site. Using an SSL certificate with an FTP site is also known as FTP-S or FTP over Secure Socket Layers (SSL). FTP-S is an RFC standard (RFC 4217) where an SSL certificate is added to an FTP site and thereby making it possible to perform secure file transfers.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By using SSL, the FTP transmission is encrypted and secured from point to point and all FTP traffic as well as credentials are thereby guarded against interception.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.windowsnetworking.com/articles_tutorials/IIS-FTP-Publishing-Service-Part3.html</xccdf:ident>
         <xccdf:ident system="URL">http://learn.iis.net/page.aspx/304/using-ftp-over-ssl/#03</xccdf:ident>
         <xccdf:ident system="URL">https://tools.ietf.org/html/rfc4217</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To configure FTP over SSL at the server level using AppCmd.exe or PowerShell:</xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config  -section:system.applicationHost/sites /siteDefaults.ftpServer.security.ssl.controlChannelPolicy:"SslRequire" /siteDefaults.ftpServer.security.ssl.dataChannelPolicy:"SslRequire"  /commit:apphost
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following commands in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter "system.applicationHost/sites/siteDefaults/ftpServer/security/ssl" -name "controlChannelPolicy" -value "SslRequire"
</xhtml:code>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST' -filter "system.applicationHost/sites/siteDefaults/ftpServer/security/ssl" -name "dataChannelPolicy" -value "SslRequire"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>SSL will be needed for the FTP transmission.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_6.2_L1_Ensure_FTP_Logon_attempt_restrictions_is_enabled" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L1) Ensure FTP Logon attempt restrictions is enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>FTP Logon attempt restrictions is a built-in network security feature to automatically block brute force FTP attacks. This can be used to mitigate a malicious client from attempting a brute-force attack on a discovered account, such as the local administrator account.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Enable Anti-Exploitation Features" urn="urn:cisecurity.org:controls:8.0:10:5">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Associate Active Ports, Services and Protocols to Asset Inventory" urn="urn:cisecurity.org:controls:7.0:9:1">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Devices</controls:asset_type>
                     <controls:security_function>Identify</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Successful brute force FTP attacks can allow an otherwise unauthorized user to make changes to data that should not be made. This could allow the unauthorized user to modify website code by uploading malicious software or even changing functionality for items such as online payments.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/9/subcontrol/1" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/10/subcontrol/5" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-ftp-logon-attempt-restrictions</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>To configure FTP Logon Attempt Restrictions at the server level using AppCmd.exe or PowerShell:</xhtml:p>
                  <xhtml:p>Enter the following command in AppCmd.exe to configure:</xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config  -section:system.ftpServer/security/authentication /denyByFailure.enabled:"True"  /commit:apphost
</xhtml:code>
                  <xhtml:p>OR</xhtml:p>
                  <xhtml:p>Enter the following command in PowerShell to configure:</xhtml:p>
                  <xhtml:code class="code_block">Set-WebConfigurationProperty -pspath 'MACHINE/WEBROOT/APPHOST'  -filter "system.ftpServer/security/authentication/denyByFailure" -name "enabled" -value "True"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
   </xccdf:Group>
   <xccdf:Group id="xccdf_org.cisecurity.benchmarks_group_7_Transport_Encryption">
      <xccdf:title xml:lang="en">Transport Encryption</xccdf:title>
      <xccdf:description xml:lang="en">
         <xhtml:p>This section contains recommendations for configuring IIS protocols and cipher suites.</xhtml:p>
         <xhtml:p>For security protocols (SSL, TLS), there are 2 registry paths that control a protocol state in the O/S: TLS client and TLS server. A web server normally acts as the TLS server in that it is serving web content to clients. There are some instances where a web server is configured as a 'client'. An example of a server acting as a client can be seen when there is dynamic content generation. The webserver queries a remote database server to return content specific to a user's request. In this configuration, the web server is acting as a TLS client. In cases such as these, the configured TLS server protocol and cipher suite preferences take precedence over the client's. This behavior is why for the IIS benchmark we require specific protocol settings for a TLS server and only recommend settings for TLS clients.</xhtml:p>
         <xhtml:p>If SSLv3 registry keys are not set, the O/S defaults take precedence.</xhtml:p>
         <xhtml:p>
For example, to disable SSLv3 protocol on the TLS server, you need to set the following registry key to 0:
        <xhtml:span class="inline_block">HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server\Enabled</xhtml:span>
         </xhtml:p>
         <xhtml:p>
To prevent a client from issuing the Hello command over that legacy protocol the following registry must be set to 0:
        <xhtml:span class="inline_block">HKLM\System\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Client\Enabled</xhtml:span>
         </xhtml:p>
         <xhtml:p>The fact that the key is named Enabled can be confusing. The setting of the value to either 0 or 1 actually sets the state of the protocol. 0 being disabled and 1 being enabled.</xhtml:p>
         <xhtml:p>
Here are some specifics into how  "Enabled" and "DisabledByDefault" registry settings work. The following article,         <xhtml:a href="https://support.microsoft.com/en-us/help/245030/how-to-restrict-the-use-of-certain-cryptographic-algorithms-and-protocols-in-schannel.dll">How to restrict the use of certain cryptographic algorithms and protocols in Schannel.dll</xhtml:a>
, provides additional information related to controlling these protocols and ciphers.      </xhtml:p>
         <xhtml:p>Using the "Enabled = 0" registry setting disables the protocol in a way that can't be overridden by application settings. This is the only robust way to prevent  the protocol from being used and no additional settings are required. At the same time, using the "DisabledByDefault" registry setting only prevents that protocol from issuing the Hello command over that protocol when an SSL connection with a server is initiated. This O/S level setting can be overridden by an application which has application specific TLS coding. An example of this can be shown by setting the protocol within a line of code in your .Net 4.5 application: ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12. This can override the O/S setting if the DisabledByDefault key is present. "DisabledByDefault" is useful in the case when you want to have some control over the system settings but also allow an application to explicitly specify the protocols they would like to use.</xhtml:p>
         <xhtml:p>Enabled only works strongly in the negative case ("Enabled = 0"). If "Enabled=1" or is not set, then "DisabledByDefault" will override in the case where the application takes the system defaults. "Enabled=1" is also overridden by application specific protocol flags.</xhtml:p>
      </xccdf:description>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.1_L2_Ensure_HSTS_Header_is_set" role="unscored" selected="false" weight="0.0">
         <xccdf:title xml:lang="en">(L2) Ensure HSTS Header is set</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>HTTP Strict Transport Security (HSTS) allows a site to inform the user agent to communicate with the site only over HTTPS. This header takes two parameters: max-age, "specifies the number of seconds, after the reception of the STS header field, during which the user agent regards the host (from whom the message was received) as a Known HSTS Host [speaks only HTTPS]"; and includeSubDomains. includeSubDomains is an optional directive that defines how this policy is applied to subdomains. If includeSubDomains is included in the header, it provides the following definition: this HSTS Policy also applies to any hosts whose domain names are subdomains of the Known HSTS Host's domain name.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:control title="Application Software Security" urn="urn:cisecurity.org:controls:7.0:18"/>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>HTTP Strict Transport Security (HSTS) is a simple and widely supported standard to protect visitors by ensuring that their browsers always connect to a website over HTTPS. HSTS exists to remove the need for the common, insecure practice of redirecting users from http:// to https:// URLs. HSTS relies on the User Agent/Browser to enforce the required behavior. All major browsers support it. If the browser doesn't support HSTS, it will be ignored.</xhtml:p>
            <xhtml:p>When a browser knows that a domain has enabled HSTS, it does two things:</xhtml:p>
            <xhtml:ol>
               <xhtml:li>
                  <xhtml:p>Always uses an https:// connection, even when clicking on an http:// link or after typing a domain into the location bar without specifying a protocol.</xhtml:p>
               </xhtml:li>
               <xhtml:li>
                  <xhtml:p>Removes the ability for users to click through warnings about invalid certificates.</xhtml:p>
               </xhtml:li>
            </xhtml:ol>
            <xhtml:p>A domain instructs browsers that it has enabled HSTS by returning an HTTP header over an HTTPS connection.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/18" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://tools.ietf.org/html/rfc6797#section-5.1</xccdf:ident>
         <xccdf:ident system="URL">https://https.cio.gov/hsts/</xccdf:ident>
         <xccdf:ident system="URL">https://www.iis.net/configreference/system.webserver/httpprotocol/customheaders#006</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Any value greater than 0 meets this recommendation. The examples below are specific to 8 minutes but can be adjusted to meet your requirements.</xhtml:p>
                  <xhtml:p>
To set the HTTP Header at the server level using an               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 command, run the following command from an elevated command prompt:            </xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config -section:system.webServer/httpProtocol /+"customHeaders.[name='Strict-Transport-Security',value='max-age=480; preload']"
</xhtml:code>
                  <xhtml:p>
To set the HTTP Header and include subdomains at the server level using an               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 command, run the following command from an elevated command prompt:            </xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config -section:system.webServer/httpProtocol /+"customHeaders.[name='Strict-Transport-Security',value='max-age=480; includeSubDomains; preload']"
</xhtml:code>
                  <xhtml:p>
To set the HTTP Header at the Website level using an               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 command, run the following command from an elevated command prompt:            </xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config "&lt;em&gt;Website"&lt;/em&gt; -section:system.webServer/httpProtocol /+"customHeaders.[name='Strict-Transport-Security',value='max-age=480; preload']"
</xhtml:code>
                  <xhtml:p>
To set the HTTP Header and include subdomains at the Website level using an               <xhtml:span class="inline_block">AppCmd.exe</xhtml:span>
 command, run the following command from an elevated command prompt:            </xhtml:p>
                  <xhtml:code class="code_block">%systemroot%\system32\inetsrv\appcmd.exe set config "&lt;em&gt;Website"&lt;/em&gt; -section:system.webServer/httpProtocol /+"customHeaders.[name='Strict-Transport-Security',value='max-age=480; includeSubDomains; preload']"
</xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The user agent will only be able to communicate with the site over HTTPS.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.2_L1_Ensure_SSLv2_is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure SSLv2 is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The SSLv2 protocol is not considered cryptographically secure, therefore should be disabled.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Application Layer Filtering" urn="urn:cisecurity.org:controls:8.0:13:10">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Disabling weak protocols will help ensure the confidentiality and integrity of in-transit data.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786419.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786433.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa374757%28v=vs.85%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to disable SSL 2.0:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server:Enabled              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Client:Enabled
            </xhtml:code>
                  <xhtml:ol start="2">
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">1</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server:DisabledByDefault              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Client:DisabledByDefault
            </xhtml:code>
                  <xhtml:p>To disable using PowerShell enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server' -Force | Out-Null              <br/>
                     <br/>
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Client' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Client' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Client' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The SSLv2 protocol will not be available for use.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613211" value-id="xccdf_org.cisecurity.benchmarks_value_4061321_var1"/>
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613212" value-id="xccdf_org.cisecurity.benchmarks_value_4061321_var2"/>
                     <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061321"/>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613231" value-id="xccdf_org.cisecurity.benchmarks_value_4061323_var1"/>
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613232" value-id="xccdf_org.cisecurity.benchmarks_value_4061323_var2"/>
                     <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061323"/>
                  </check>
               </xccdf:complex-check>
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613251" value-id="xccdf_org.cisecurity.benchmarks_value_4061325_var1"/>
                  <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613252" value-id="xccdf_org.cisecurity.benchmarks_value_4061325_var2"/>
                  <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061325"/>
               </check>
            </xccdf:complex-check>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613271" value-id="xccdf_org.cisecurity.benchmarks_value_4061327_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613272" value-id="xccdf_org.cisecurity.benchmarks_value_4061327_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061327"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.3_L1_Ensure_SSLv3_is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure SSLv3 is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The SSLv3 protocol is not considered cryptographically secure, therefore should be disabled.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Disabling weak protocols will help ensure the confidentiality and integrity of in-transit data.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://www.openssl.org/~bodo/ssl-poodle.pdf</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786419.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786433.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa374757%28v=vs.85%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to disable SSL 3.0:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server:Enabled              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Client:Enabled
            </xhtml:code>
                  <xhtml:ol start="2">
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">1</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server:DisabledByDefault              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Client:DisabledByDefault
            </xhtml:code>
                  <xhtml:p>To disable using PowerShell enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server' -Force | Out-Null              <br/>
                     <br/>
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Client' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Client' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Client' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The SSLv3 protocol will not be available.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613281" value-id="xccdf_org.cisecurity.benchmarks_value_4061328_var1"/>
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613282" value-id="xccdf_org.cisecurity.benchmarks_value_4061328_var2"/>
                     <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061328"/>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613291" value-id="xccdf_org.cisecurity.benchmarks_value_4061329_var1"/>
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613292" value-id="xccdf_org.cisecurity.benchmarks_value_4061329_var2"/>
                     <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061329"/>
                  </check>
               </xccdf:complex-check>
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613301" value-id="xccdf_org.cisecurity.benchmarks_value_4061330_var1"/>
                  <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613302" value-id="xccdf_org.cisecurity.benchmarks_value_4061330_var2"/>
                  <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061330"/>
               </check>
            </xccdf:complex-check>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613311" value-id="xccdf_org.cisecurity.benchmarks_value_4061331_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613312" value-id="xccdf_org.cisecurity.benchmarks_value_4061331_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061331"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.4_L1_Ensure_TLS_1.0_is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure TLS 1.0 is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The TLS 1.0 protocol is not considered cryptographically secure, therefore should be disabled.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Disabling weak protocols will help ensure the confidentiality and integrity of in-transit data.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa374757%28v=vs.85%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786419.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786433.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to disable TLS 1.0:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server:Enabled              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Client:Enabled
            </xhtml:code>
                  <xhtml:ol start="2">
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">1</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server:DisabledByDefault              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Client:DisabledByDefault
            </xhtml:code>
                  <xhtml:p>To disable using PowerShell enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server' -Force | Out-Null              <br/>
                     <br/>
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Client' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Client' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Client' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The TLS 1.0 protocol will not be available.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613321" value-id="xccdf_org.cisecurity.benchmarks_value_4061332_var1"/>
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613322" value-id="xccdf_org.cisecurity.benchmarks_value_4061332_var2"/>
                     <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061332"/>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613331" value-id="xccdf_org.cisecurity.benchmarks_value_4061333_var1"/>
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613332" value-id="xccdf_org.cisecurity.benchmarks_value_4061333_var2"/>
                     <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061333"/>
                  </check>
               </xccdf:complex-check>
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613341" value-id="xccdf_org.cisecurity.benchmarks_value_4061334_var1"/>
                  <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613342" value-id="xccdf_org.cisecurity.benchmarks_value_4061334_var2"/>
                  <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061334"/>
               </check>
            </xccdf:complex-check>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613351" value-id="xccdf_org.cisecurity.benchmarks_value_4061335_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613352" value-id="xccdf_org.cisecurity.benchmarks_value_4061335_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061335"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.5_L1_Ensure_TLS_1.1_is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure TLS 1.1 is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The TLS 1.1 protocol is not considered cryptographically secure, therefore should be disabled.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Perform Application Layer Filtering" urn="urn:cisecurity.org:controls:8.0:13:10">
                     <controls:implementation_groups ig3="true"/>
                     <controls:asset_type>Network</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Disabling weak protocols will help ensure the confidentiality and integrity of in-transit data.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/13/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786433.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786419.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa374757%28v=vs.85%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://community.qualys.com/thread/16565-is-there-a-reason-for-still-having-tlsv11-enabled</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to disable TLS 1.1:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Server:Enabled              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Client:Enabled
            </xhtml:code>
                  <xhtml:ol start="2">
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">1</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Server:DisabledByDefault              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Client:DisabledByDefault
            </xhtml:code>
                  <xhtml:p>To disable using PowerShell enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Server' -Force | Out-Null              <br/>
                     <br/>
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Client' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Server' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Client' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Server' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Client' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>TLS 1.1 may be needed for backward compatibility.</xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Warning:</xhtml:strong>
 Fully test the application to ensure that backwards compatibility is not needed. If it is, build in exceptions as necessary for backwards compatibility.              </xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613361" value-id="xccdf_org.cisecurity.benchmarks_value_4061336_var1"/>
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613362" value-id="xccdf_org.cisecurity.benchmarks_value_4061336_var2"/>
                     <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061336"/>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613371" value-id="xccdf_org.cisecurity.benchmarks_value_4061337_var1"/>
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613372" value-id="xccdf_org.cisecurity.benchmarks_value_4061337_var2"/>
                     <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061337"/>
                  </check>
               </xccdf:complex-check>
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613381" value-id="xccdf_org.cisecurity.benchmarks_value_4061338_var1"/>
                  <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613382" value-id="xccdf_org.cisecurity.benchmarks_value_4061338_var2"/>
                  <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061338"/>
               </check>
            </xccdf:complex-check>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613391" value-id="xccdf_org.cisecurity.benchmarks_value_4061339_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613392" value-id="xccdf_org.cisecurity.benchmarks_value_4061339_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061339"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.6_L1_Ensure_TLS_1.2_is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure TLS 1.2 is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>TLS 1.2 is the most recent and mature protocol for protecting the confidentiality and integrity of HTTP traffic.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling this protocol will help ensure the confidentiality and integrity of data in transit.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa374757%28v=vs.85%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786419.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786433.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to enable TLS 1.2:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">1</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server:Enabled
</xhtml:code>
                  <xhtml:ol start="2">
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server:DisabledByDefault
</xhtml:code>
                  <xhtml:p>To enable using PowerShell enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server' -name 'Enabled' -value '1' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server' -name 'DisabledByDefault' -value '0' -PropertyType 'DWord' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613401" value-id="xccdf_org.cisecurity.benchmarks_value_4061340_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613402" value-id="xccdf_org.cisecurity.benchmarks_value_4061340_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061340"/>
            </check>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613411" value-id="xccdf_org.cisecurity.benchmarks_value_4061341_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613412" value-id="xccdf_org.cisecurity.benchmarks_value_4061341_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061341"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.7_L1_Ensure_NULL_Cipher_Suites_is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure NULL Cipher Suites is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The NULL cipher does not provide data confidentiality or integrity, therefore it is recommended that the NULL cipher be disabled.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By disabling the NULL cipher, there is a better chance of maintaining data confidentiality and integrity.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786419.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786433.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa374757%28v=vs.85%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform the following to disable               <xhtml:span class="inline_block">NULL</xhtml:span>
 cipher:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\NULL:Enabled
</xhtml:code>
                  <xhtml:p>To disable using PowerShell enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\NULL' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\NULL' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The NULL cipher suite will not be available.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613421" value-id="xccdf_org.cisecurity.benchmarks_value_4061342_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613422" value-id="xccdf_org.cisecurity.benchmarks_value_4061342_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061342"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.8_L1_Ensure_DES_Cipher_Suites_is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure DES Cipher Suites is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The DES Cipher Suite is considered a weak symmetric-key cipher, therefore it is recommended that it be disabled.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>By disabling DES, there is a better chance of maintaining data confidentiality and integrity.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786433.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786419.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa374757%28v=vs.85%29.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform the following to disable               <xhtml:span class="inline_block">DES 56/56</xhtml:span>
 cipher:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\DES 56/56:Enabled
</xhtml:code>
                  <xhtml:p>To disable using PowerShell enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">
(Get-Item 'HKLM:\').OpenSubKey('SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers', $true).CreateSubKey('DES 56/56')              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\DES 56/56' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The DES Cipher Suite will not be avaiable.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613431" value-id="xccdf_org.cisecurity.benchmarks_value_4061343_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613432" value-id="xccdf_org.cisecurity.benchmarks_value_4061343_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061343"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.9_L1_Ensure_RC4_Cipher_Suites_is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure RC4 Cipher Suites is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The RC4 Cipher Suites are considered insecure, therefore should be disabled.</xhtml:p>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 RC4 cipher enabled by default on Server 2012 and 2012 R2 is RC4 128/128.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>The use of RC4 may increase an adversaries ability to read sensitive information sent over SSL/TLS.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa374757%28v=vs.85%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786433.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786419.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform the following to disable               <xhtml:span class="inline_block">RC4 40/128</xhtml:span>
,               <xhtml:span class="inline_block">RC4 56/128</xhtml:span>
,               <xhtml:span class="inline_block">RC4 64/128</xhtml:span>
,               <xhtml:span class="inline_block">RC4 128/128</xhtml:span>
 ciphers:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry keys to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 40/128:Enabled              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 56/128:Enabled              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 64/128:Enabled              <br/>
HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 128/128:Enabled
            </xhtml:code>
                  <xhtml:p>To disable using PowerShell enter the following commands:</xhtml:p>
                  <xhtml:code class="code_block">
(Get-Item 'HKLM:\').OpenSubKey('SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers', $true).CreateSubKey('RC4 40/128')              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 40/128' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
(Get-Item 'HKLM:\').OpenSubKey('SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers', $true).CreateSubKey('RC4 56/128')              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 56/128' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
(Get-Item 'HKLM:\').OpenSubKey('SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers', $true).CreateSubKey('RC4 64/128')              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 64/128' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null              <br/>
                     <br/>
(Get-Item 'HKLM:\').OpenSubKey('SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers', $true).CreateSubKey('RC4 128/128')              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\RC4 128/128' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>The RC4 Cipher Suites will not be available. The use of RC4 in TLS and SSL could allow an attacker to perform man-in-the-middle attacks and recover plaintext from encrypted sessions.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <xccdf:complex-check operator="AND">
               <xccdf:complex-check operator="AND">
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613441" value-id="xccdf_org.cisecurity.benchmarks_value_4061344_var1"/>
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613442" value-id="xccdf_org.cisecurity.benchmarks_value_4061344_var2"/>
                     <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061344"/>
                  </check>
                  <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613451" value-id="xccdf_org.cisecurity.benchmarks_value_4061345_var1"/>
                     <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613452" value-id="xccdf_org.cisecurity.benchmarks_value_4061345_var2"/>
                     <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061345"/>
                  </check>
               </xccdf:complex-check>
               <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                  <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613461" value-id="xccdf_org.cisecurity.benchmarks_value_4061346_var1"/>
                  <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613462" value-id="xccdf_org.cisecurity.benchmarks_value_4061346_var2"/>
                  <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061346"/>
               </check>
            </xccdf:complex-check>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613471" value-id="xccdf_org.cisecurity.benchmarks_value_4061347_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613472" value-id="xccdf_org.cisecurity.benchmarks_value_4061347_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061347"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.10_L1_Ensure_AES_128128_Cipher_Suite_is_Disabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure AES 128/128 Cipher Suite is Disabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>The AES 128/128 Cipher Suite is not considered secure and therefore should be disabled, if possible.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>This item is Scored for the following reasons and should be disabled:</xhtml:p>
            <xhtml:ul>
               <xhtml:li>Enabling AES 256/256 is recommended.</xhtml:li>
               <xhtml:li>This cipher does not suffer from known practical attacks.</xhtml:li>
            </xhtml:ul>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786419.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa374757%28v=vs.85%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786433.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform the following to disable               <xhtml:span class="inline_block">AES 128/128</xhtml:span>
 cipher:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">0</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\AES 128/128:Enabled
</xhtml:code>
                  <xhtml:p>To disable using PowerShell enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">
(Get-Item 'HKLM:\').OpenSubKey('SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers', $true).CreateSubKey('AES 128/128')              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\AES 128/128' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>
                        <xhtml:strong>Warning:</xhtml:strong>
 Enabling AES 128/128 may be required for client compatibility.              </xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613481" value-id="xccdf_org.cisecurity.benchmarks_value_4061348_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613482" value-id="xccdf_org.cisecurity.benchmarks_value_4061348_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061348"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.11_L1_Ensure_AES_256256_Cipher_Suite_is_Enabled" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L1) Ensure AES 256/256 Cipher Suite is Enabled</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>AES 256/256 is the most recent and mature cipher suite for protecting the confidentiality and integrity of HTTP traffic. Enabling AES 256/256 is recommended.</xhtml:p>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 AES 256/256 is enabled by default starting with Server 2012 and 2012 R2.        </xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Enabling this cipher will help ensure the confidentiality and integrity of data in transit.</xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786419.aspx</xccdf:ident>
         <xccdf:ident system="URL">http://msdn.microsoft.com/en-us/library/aa374757%28v=vs.85%29.aspx</xccdf:ident>
         <xccdf:ident system="URL">https://www.owasp.org/index.php/Testing_for_SSL-TLS_%28OWASP-CM-001%29</xccdf:ident>
         <xccdf:ident system="URL">http://technet.microsoft.com/en-us/library/dn786433.aspx</xccdf:ident>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>
Perform the following to enable               <xhtml:span class="inline_block">AES 256/256</xhtml:span>
 cipher:            </xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">1</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\AES 256/256:Enabled
</xhtml:code>
                  <xhtml:p>To enable using PowerShell enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">
(Get-Item 'HKLM:\').OpenSubKey('SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers', $true).CreateSubKey('AES 256/256')              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Ciphers\AES 256/256' -name 'Enabled' -value '1' -PropertyType 'DWord' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>N/A</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613491" value-id="xccdf_org.cisecurity.benchmarks_value_4061349_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613492" value-id="xccdf_org.cisecurity.benchmarks_value_4061349_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061349"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
      <xccdf:Rule id="xccdf_org.cisecurity.benchmarks_rule_7.12_L2_Ensure_TLS_Cipher_Suite_ordering_is_Configured" role="full" selected="false" weight="1.0">
         <xccdf:title xml:lang="en">(L2) Ensure TLS Cipher Suite ordering is Configured</xccdf:title>
         <xccdf:description xml:lang="en">
            <xhtml:p>Cipher suites are a named combination of authentication, encryption, message authentication code, and key exchange algorithms used for the security settings of a network connection using TLS protocol. Clients send a cipher list and a list of ciphers that it supports in order of preference to a server. The server then replies with the cipher suite that it selects from the client cipher suite list.</xhtml:p>
         </xccdf:description>
         <xccdf:metadata>
            <controls:cis_controls xmlns:controls="http://cisecurity.org/controls">
               <controls:framework urn="urn:cisecurity.org:controls:8.0">
                  <controls:safeguard title="Encrypt Sensitive Data in Transit" urn="urn:cisecurity.org:controls:8.0:3:10">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
               <controls:framework urn="urn:cisecurity.org:controls:7.0">
                  <controls:safeguard title="Encrypt All Sensitive Information in Transit" urn="urn:cisecurity.org:controls:7.0:14:4">
                     <controls:implementation_groups ig2="true" ig3="true"/>
                     <controls:asset_type>Data</controls:asset_type>
                     <controls:security_function>Protect</controls:security_function>
                  </controls:safeguard>
               </controls:framework>
            </controls:cis_controls>
         </xccdf:metadata>
         <xccdf:rationale xml:lang="en">
            <xhtml:p>Cipher suites should be ordered from strongest to weakest in order to ensure that the more secure configuration is used for encryption between the server and client.</xhtml:p>
            <xhtml:p>
               <xhtml:strong>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</xhtml:strong>
            </xhtml:p>
            <xhtml:p>
               <xhtml:strong>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</xhtml:strong>
            </xhtml:p>
            <xhtml:p>
               <xhtml:strong>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</xhtml:strong>
            </xhtml:p>
            <xhtml:p>
               <xhtml:strong>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</xhtml:strong>
            </xhtml:p>
            <xhtml:p>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</xhtml:p>
            <xhtml:p>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</xhtml:p>
            <xhtml:p>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</xhtml:p>
            <xhtml:p>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</xhtml:p>
            <xhtml:p>Avoid cipher suits that do not provide Perfect Forward Secrecy or use weak hashing function, use them only if you need to support backwards compatibility and in the bottom of the list and you will have to create exceptions for the items that cause this to become out of compliance:</xhtml:p>
            <xhtml:p>TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA (uses SHA-1)</xhtml:p>
            <xhtml:p>TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (uses SHA-1)</xhtml:p>
            <xhtml:p>TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA (uses SHA-1)</xhtml:p>
            <xhtml:p>TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (uses SHA-1)</xhtml:p>
            <xhtml:p>TLS_RSA_WITH_AES_256_GCM_SHA384 (lack of Perfect Forward Secrecy)</xhtml:p>
            <xhtml:p>TLS_RSA_WITH_AES_128_GCM_SHA256 (lack of Perfect Forward Secrecy)</xhtml:p>
            <xhtml:p>TLS_RSA_WITH_AES_256_CBC_SHA256 (lack of Perfect Forward Secrecy)</xhtml:p>
            <xhtml:p>TLS_RSA_WITH_AES_128_CBC_SHA256 (lack of Perfect Forward Secrecy)</xhtml:p>
            <xhtml:p>TLS_RSA_WITH_AES_256_CBC_SHA (uses SHA-1, lack of Perfect Forward Secrecy)</xhtml:p>
            <xhtml:p>TLS_RSA_WITH_AES_128_CBC_SHA (uses SHA-1, lack of Perfect Forward Secrecy)</xhtml:p>
            <xhtml:p>
               <xhtml:strong>Note:</xhtml:strong>
 HTTP/2 compatibility: first 4 ciphers (in bold) in the top part list are compatible with HTTP/2        </xhtml:p>
         </xccdf:rationale>
         <xccdf:ident cc7:controlURI="http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/4" system="http://cisecurity.org/20-cc/v7.0"/>
         <xccdf:ident cc8:controlURI="http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/10" system="http://cisecurity.org/20-cc/v8.0"/>
         <xccdf:fixtext xml:lang="en">
            <xhtml:div>
               <xhtml:p>
                  <xhtml:p>Perform the following to configure TLS cipher suite order:</xhtml:p>
                  <xhtml:ol>
                     <xhtml:li>
Set the following Registry key to                 <xhtml:span class="inline_block">TLS_AES_256_GCM_SHA384, TLS_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</xhtml:span>
.              </xhtml:li>
                  </xhtml:ol>
                  <xhtml:code class="code_block">HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002:Functions
</xhtml:code>
                  <xhtml:p>To configure TLS cipher suite order using PowerShell enter the following command:</xhtml:p>
                  <xhtml:code class="code_block">
New-Item 'HKLM:\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002' -Force | Out-Null              <br/>
                     <br/>
New-ItemProperty -path 'HKLM:\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002' -name 'Functions' -value 'TLS_AES_256_GCM_SHA384,TLS_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256' -PropertyType 'MultiString' -Force | Out-Null
            </xhtml:code>
                  <xhtml:p class="bold">Impact:</xhtml:p>
                  <xhtml:p>
                     <xhtml:p>Cipher ordering is important to ensure that the most secure ciphers are listed first and will be applied over weaker ciphers when possible.</xhtml:p>
                  </xhtml:p>
               </xhtml:p>
            </xhtml:div>
         </xccdf:fixtext>
         <xccdf:complex-check operator="AND">
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613501" value-id="xccdf_org.cisecurity.benchmarks_value_4061350_var1"/>
               <check-export export-name="oval:org.cisecurity.benchmarks.microsoft_iis_10:var:40613502" value-id="xccdf_org.cisecurity.benchmarks_value_4061350_var2"/>
               <check-content-ref href="CIS_Microsoft_IIS_10_Benchmark_v1.2.1-oval.xml" name="oval:org.cisecurity.benchmarks.microsoft_iis_10:def:4061350"/>
            </check>
         </xccdf:complex-check>
      </xccdf:Rule>
   </xccdf:Group>
<xccdf:signature><ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:SignedInfo>
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
<ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
<ds:Reference URI="">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
<ds:DigestValue>1dgQoBBPyJNtO8er2cY9rcIvtPo=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>
ajiQa7zgKiX3poxqNSgP90uXuvf0EdaDw0ahYZiDunKJtVP1CloINpRKsMkU3pvfJkbOKAlHpaVV
W6r67Vc5dLymm5TxpZexXlB+Dbgvemf8AHYdMQoI6JxvIkZvM/vKVjTjryqO2KQgJBBLheijQExj
ruwDNrzknPt9TWAqFF+BCltyA1+H94eMWyg3PHweVmRzScGAmEeifPqv0wEbIjbLFCS80TXR7iNG
hXtM0LelkyxOxVubzKto7EkYpqUrzyB1tuP8Ewv0irBMFIEipCjwe8y49lAlPkPqLAXn72/N7NDI
/Oyhye9E0VHhpe/PEaBHQtph+N3qM2K0iTJbtg==
</ds:SignatureValue>
<ds:KeyInfo>
<ds:X509Data>
<ds:X509Certificate>
MIIFUjCCBDqgAwIBAgIIPx+qZKptEY4wDQYJKoZIhvcNAQELBQAwgbQxCzAJBgNVBAYTAlVTMRAw
DgYDVQQIEwdBcml6b25hMRMwEQYDVQQHEwpTY290dHNkYWxlMRowGAYDVQQKExFHb0RhZGR5LmNv
bSwgSW5jLjEtMCsGA1UECxMkaHR0cDovL2NlcnRzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvMTMw
MQYDVQQDEypHbyBEYWRkeSBTZWN1cmUgQ2VydGlmaWNhdGUgQXV0aG9yaXR5IC0gRzIwHhcNMjAw
OTA4MTMzOTM5WhcNMjMxMDI4MDAzMjA1WjCBkzELMAkGA1UEBhMCVVMxETAPBgNVBAgTCE5ldyBZ
b3JrMRcwFQYDVQQHEw5FYXN0IEdyZWVuYnVzaDErMCkGA1UEChMiQ2VudGVyIGZvciBJbnRlcm5l
dCBTZWN1cml0eSwgSW5jLjErMCkGA1UEAxMiQ2VudGVyIGZvciBJbnRlcm5ldCBTZWN1cml0eSwg
SW5jLjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANDBp4+sl9kB5JRmnQH0wcbLLz/t
n2HoD6TRl3xJj12V61njBNgaiGzvoSl07sFLnESukb0CU44MzYDoUMdx3HJUcEAeMY/9eITqGUnk
N4WsP145eFqH7FoszOY/4NYlgYMYt8ZP2kRHyim9LpQTLT/1mBaUkY2f2e5uUCootH3iT8W3/sK2
flLzWfLgXTvkhJm4Uvw1RErBFs15+krW0KWtnZ6NmiDhmV0CnFGNnd1meGZPs2sBXEVGLJVSKzoT
G9Ht/oWyRLRcJuXpHoXTYpkqM2MsixmSaJy5b6/D35r0NXHru3p1gkX2a0VgJQxxWqLi3bVPzpl3
PlJu3C8M/FUCAwEAAaOCAYUwggGBMAwGA1UdEwEB/wQCMAAwEwYDVR0lBAwwCgYIKwYBBQUHAwMw
DgYDVR0PAQH/BAQDAgeAMDUGA1UdHwQuMCwwKqAooCaGJGh0dHA6Ly9jcmwuZ29kYWRkeS5jb20v
Z2RpZzJzNS02LmNybDBdBgNVHSAEVjBUMEgGC2CGSAGG/W0BBxcCMDkwNwYIKwYBBQUHAgEWK2h0
dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS8wCAYGZ4EMAQQBMHYGCCsG
AQUFBwEBBGowaDAkBggrBgEFBQcwAYYYaHR0cDovL29jc3AuZ29kYWRkeS5jb20vMEAGCCsGAQUF
BzAChjRodHRwOi8vY2VydGlmaWNhdGVzLmdvZGFkZHkuY29tL3JlcG9zaXRvcnkvZ2RpZzIuY3J0
MB8GA1UdIwQYMBaAFEDCvSeOzDSDMKIz1/tss/C0LIDOMB0GA1UdDgQWBBT7fOf4ISDprbE+qUFe
+friFTKgHjANBgkqhkiG9w0BAQsFAAOCAQEAT0XLw2vmuq6e58bkLDXdqKeGQjREDChLw2Mae9LI
JB93QgdA2OCLA1FwU2s7lawEDcma9wPiugxVGoaQNOfRw2/+cz0xmR3uaKQq6I24dWbHF20N2tSz
1RAAK1lRZKewA1fj+qqKWjzETA0LpqZlaFF+CKBpQcyfYyQRZxpHkB1vvKMf4kMIRKruvl4ixLjN
uAZrbQUWlXuq/MUkVP3FgdxWBPfmMGyngHs4hNMaSQGb1TEhBjj+PGoSunAyaOgO/P94XJPQQX3O
2oNDsPou6gKcNtbZrH+iYTJ8rcqQTontMwSP/HrYj8lgG3neG53vk05p0jCn2M5W0ukJ4LPEnA==
</ds:X509Certificate>
</ds:X509Data>
<ds:KeyValue>
<ds:RSAKeyValue>
<ds:Modulus>0MGnj6yX2QHklGadAfTBxssvP+2fYegPpNGXfEmPXZXrWeME2BqIbO+hKXTuwUucRK6RvQJTjgzN
gOhQx3HcclRwQB4xj/14hOoZSeQ3haw/Xjl4WofsWizM5j/g1iWBgxi3xk/aREfKKb0ulBMtP/WY
FpSRjZ/Z7m5QKii0feJPxbf+wrZ+UvNZ8uBdO+SEmbhS/DVESsEWzXn6StbQpa2dno2aIOGZXQKc
UY2d3WZ4Zk+zawFcRUYslVIrOhMb0e3+hbJEtFwm5ekehdNimSozYyyLGZJonLlvr8PfmvQ1ceu7
enWCRfZrRWAlDHFaouLdtU/OmXc+Um7cLwz8VQ==</ds:Modulus>
<ds:Exponent>AQAB</ds:Exponent>
</ds:RSAKeyValue>
</ds:KeyValue>
</ds:KeyInfo>
</ds:Signature></xccdf:signature></xccdf:Benchmark>